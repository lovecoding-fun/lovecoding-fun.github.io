{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"source/CNAME","path":"CNAME","modified":0,"renderable":0},{"_id":"source/img/icon_wechat.png","path":"img/icon_wechat.png","modified":0,"renderable":0},{"_id":"themes/huweihuang/source/css/archive.styl","path":"css/archive.styl","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/css/beantech.css","path":"css/beantech.css","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/css/beantech.min.css","path":"css/beantech.min.css","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/css/donate.css","path":"css/donate.css","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/css/hux-blog.min.css","path":"css/hux-blog.min.css","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/css/rocket.styl","path":"css/rocket.styl","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/css/signature.styl","path":"css/signature.styl","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/css/toc.styl","path":"css/toc.styl","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/css/highlight.styl","path":"css/highlight.styl","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/css/widget.styl","path":"css/widget.styl","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/fonts/glyphicons-halflings-regular.woff","path":"fonts/glyphicons-halflings-regular.woff","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/fonts/glyphicons-halflings-regular.ttf","path":"fonts/glyphicons-halflings-regular.ttf","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/fonts/glyphicons-halflings-regular.eot","path":"fonts/glyphicons-halflings-regular.eot","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/fonts/glyphicons-halflings-regular.woff2","path":"fonts/glyphicons-halflings-regular.woff2","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/js/hux-blog.min.js","path":"js/hux-blog.min.js","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/js/hux-blog.js","path":"js/hux-blog.js","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/js/bootstrap.min.js","path":"js/bootstrap.min.js","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/js/jquery.nav.js","path":"js/jquery.nav.js","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/js/jquery.tagcloud.js","path":"js/jquery.tagcloud.js","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/js/toc.js","path":"js/toc.js","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/js/totop.js","path":"js/totop.js","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/css/bootstrap.min.css","path":"css/bootstrap.min.css","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/fonts/glyphicons-halflings-regular.svg","path":"fonts/glyphicons-halflings-regular.svg","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/js/bootstrap.js","path":"js/bootstrap.js","modified":0,"renderable":1},{"_id":"source/img/signature/BeanTechSign-white.png","path":"img/signature/BeanTechSign-white.png","modified":0,"renderable":0},{"_id":"themes/huweihuang/source/css/bootstrap.css","path":"css/bootstrap.css","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/css/images/ironman.png","path":"css/images/ironman.png","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/css/images/rocket.png","path":"css/images/rocket.png","modified":0,"renderable":1},{"_id":"source/img/avatar/we.png","path":"img/avatar/we.png","modified":0,"renderable":0},{"_id":"source/img/signature/BeanTechSign-black.png","path":"img/signature/BeanTechSign-black.png","modified":0,"renderable":0},{"_id":"source/img/header_img/home.jpg","path":"img/header_img/home.jpg","modified":0,"renderable":0},{"_id":"source/img/article_header/article_bg.jpg","path":"img/article_header/article_bg.jpg","modified":0,"renderable":0},{"_id":"themes/huweihuang/source/js/jquery.min.js","path":"js/jquery.min.js","modified":0,"renderable":1},{"_id":"source/img/header_img/404.jpg","path":"img/header_img/404.jpg","modified":0,"renderable":0},{"_id":"source/img/header_img/tag.jpg","path":"img/header_img/tag.jpg","modified":0,"renderable":0},{"_id":"themes/huweihuang/source/js/jquery.js","path":"js/jquery.js","modified":0,"renderable":1},{"_id":"source/img/header_img/about.jpg","path":"img/header_img/about.jpg","modified":0,"renderable":0},{"_id":"source/img/blog.jpg","path":"img/blog.jpg","modified":0,"renderable":0},{"_id":"source/img/article_header/article_header.png","path":"img/article_header/article_header.png","modified":0,"renderable":0},{"_id":"source/img/header_img/archive.jpg","path":"img/header_img/archive.jpg","modified":0,"renderable":0},{"_id":"source/img/avatar/we.jpg","path":"img/avatar/we.jpg","modified":0,"renderable":0}],"Cache":[{"_id":"source/CNAME","hash":"60a9ce3696e7262df3d5ba09815b15082353176e","modified":1575788116882},{"_id":"source/404.md","hash":"8b9e17605b69cf3d2b0cbf8ddc5c7357d538ccd9","modified":1575788116882},{"_id":"themes/huweihuang/_config.yml","hash":"f29811ef62e8d1bec51d14eac30eae0d345b130a","modified":1575795257635},{"_id":"themes/huweihuang/LICENSE","hash":"c48eaae47a703282e0ffe7b91d69366452046214","modified":1575788117127},{"_id":"source/_posts/FrontEnd-Daily-Learning.md","hash":"3c1367fa0e9c88023090bbb44435c18edc8327a3","modified":1575793973615},{"_id":"source/_posts/FrontEnd-Notes-2019-12.md","hash":"666482d88a364d1d7ccd828ef4bfa1ae96fb900c","modified":1577930268925},{"_id":"source/_posts/FrontEnd-Notes-2020-01.md","hash":"67be6d26783f422f71c9344c13d70a96e4368f7e","modified":1580191485218},{"_id":"source/_posts/React-å®˜æ–¹æ–‡æ¡£é˜…è¯»ç¬”è®°.md","hash":"4966442d45de92b0bc5f9f9eeb85f44a24e16873","modified":1581061991044},{"_id":"source/_posts/FE-Resources-Collection.md","hash":"1f2ebe1b19e7abbca23c1978f9a3211d3f01d279","modified":1579058705415},{"_id":"source/_posts/FE-Technical-Docs-Collection.md","hash":"47bc3d4bed8ab7eafd8211f1df4681b305c90fb9","modified":1580886547922},{"_id":"source/_posts/FrontEnd-Notes-2020-02.md","hash":"6e40c0a43fd7e4f7f4afb5dc9b0bbb2897f36deb","modified":1582806412607},{"_id":"source/_posts/ã€Šä½ ä¸çŸ¥é“çš„-JavaScriptã€‹ï¼ˆä¸Šå·ï¼‰-è¯»ä¹¦ç¬”è®°.md","hash":"b0ba04f71e17c83c4e8f45d2c76505458a6a97a5","modified":1582527024981},{"_id":"source/_posts/Resources.md","hash":"a0b0f179d0e2cb4802b3b64ef5934660b518b75f","modified":1577930452567},{"_id":"source/_posts/We Are Graduated!.md","hash":"c75b86faa55caae69d57ef2ccf0138e0be0b419d","modified":1575788116892},{"_id":"source/_posts/What-is-Gumbel-Softmax-Trick.md","hash":"d78fd9ad10ac89959082577441ed07ae172e7420","modified":1575907751836},{"_id":"source/img/icon_wechat.png","hash":"4188058026609de06c6cac88b349a2da831a1783","modified":1575790252732},{"_id":"source/archive/index.md","hash":"87e995582a1fedab64a901410a1a9d7390f75b94","modified":1575788116926},{"_id":"source/about/index.md","hash":"563abf8b0f19e4b3476e8ed0669b56bafc32a2dc","modified":1575797945824},{"_id":"themes/huweihuang/languages_to_be_added/default.yml","hash":"3cd0873b310cbf2fe022ee18d55a6113b347ea09","modified":1575788117130},{"_id":"source/tags/index.md","hash":"9a417cb743a80a4ea6e78e833c13d5faeba2508c","modified":1575798133019},{"_id":"themes/huweihuang/languages_to_be_added/de.yml","hash":"02a98ba2b93e30a00ae7979fbe90b767a27290f0","modified":1575788117129},{"_id":"themes/huweihuang/languages_to_be_added/en.yml","hash":"3cd0873b310cbf2fe022ee18d55a6113b347ea09","modified":1575788117130},{"_id":"themes/huweihuang/languages_to_be_added/no.yml","hash":"5ce3a1043ff85cecf83f3b5b0cdad2df44fa0192","modified":1575788117132},{"_id":"themes/huweihuang/languages_to_be_added/es.yml","hash":"fb089145368422ac47da9eb00fed05b15c904aa2","modified":1575788117131},{"_id":"themes/huweihuang/languages_to_be_added/pl.yml","hash":"6dc5d1b2aa75ae4c527089a770f43bafb91d80f4","modified":1575788117132},{"_id":"themes/huweihuang/languages_to_be_added/ru.yml","hash":"2cfaf93704ea4ac3f374c69bab89ca31916faa33","modified":1575788117134},{"_id":"themes/huweihuang/languages_to_be_added/zh-TW.yml","hash":"45c84384a05fdb7e32a3e2d498ea180be7dccfa9","modified":1575788117136},{"_id":"themes/huweihuang/languages_to_be_added/zh-CN.yml","hash":"6d712d9eb6ba12213dcd76b532cd86e9da83cfa3","modified":1575788117135},{"_id":"themes/huweihuang/layout/404.ejs","hash":"2e8d719fab50014b7963d3c2f4ee34c23e749d7b","modified":1575788117137},{"_id":"themes/huweihuang/layout/archive.ejs","hash":"62781e8b0ce4de9c3db6042fedeaf13c26d138f8","modified":1575788117145},{"_id":"themes/huweihuang/layout/index.ejs","hash":"f293cefe4bf9f9c6848dff08b6dac4aeb7948892","modified":1575788117145},{"_id":"themes/huweihuang/layout/about.ejs","hash":"96c08fc3580b842ad9d8f37f2cdf02e6fa57d7bc","modified":1575788117144},{"_id":"themes/huweihuang/layout/layout.ejs","hash":"389fc11a45676f94b77ebd2cb0d658a0358979c8","modified":1575788117146},{"_id":"themes/huweihuang/layout/tags.ejs","hash":"63911a99e6daf9968bfdd7d69f0d3d697039902e","modified":1575788117148},{"_id":"source/_posts/FrontEnd-Daily-Learning/FE_20190806.png","hash":"cf1e11f4935faca118ffa5ec422350393827b54b","modified":1575788116886},{"_id":"source/_posts/FrontEnd-Daily-Learning/FE_20190808.png","hash":"bca41264a7be4e31f610710c569b14e04e0e68a8","modified":1575788116887},{"_id":"source/_posts/FrontEnd-Daily-Learning/FE_20190809.png","hash":"8e381370d624b8863b6eb44fd2fa8e55c4ce5296","modified":1575788116888},{"_id":"themes/huweihuang/layout/page.ejs","hash":"f77a9eb0e09931eac85e8244027eb5678c7b0705","modified":1575788117147},{"_id":"themes/huweihuang/layout/keynote.ejs","hash":"e177b9e4a159f40b512f4ae1bfd928be4ab60840","modified":1575788117146},{"_id":"themes/huweihuang/layout/post.ejs","hash":"1d5e2e84ed5d8e7679612ae07660128b02f8e954","modified":1575793973615},{"_id":"themes/huweihuang/layout/_partial/head.ejs","hash":"07e23da21331914b971bb0317f545ea677484180","modified":1575788117139},{"_id":"themes/huweihuang/layout/_partial/header.ejs","hash":"10d5e0966895f86373b0652e9ad2df69d742bfe4","modified":1575788117140},{"_id":"themes/huweihuang/layout/_partial/pagination.ejs","hash":"cd61e4dbbf6020ad094c8e66ec06e8c38ebcd122","modified":1575788117141},{"_id":"themes/huweihuang/layout/_partial/sidebar.ejs","hash":"bc7834dd769eeac94a76ffd9cfbb13a622861b62","modified":1575788117141},{"_id":"themes/huweihuang/layout/_partial/nav.ejs","hash":"e65bfec3d14a9eb9f1e09b592bb34023e6bf6e83","modified":1575788117140},{"_id":"themes/huweihuang/layout/_partial/toc.ejs","hash":"aa41fc56f2fa03559aa266fc062772e9e3bbebbf","modified":1575788117141},{"_id":"themes/huweihuang/layout/_widget/category.ejs","hash":"c32e6fb8f3a07c5cbaffcebf93c357237c18b009","modified":1575788117142},{"_id":"themes/huweihuang/layout/_widget/archive.ejs","hash":"ad9fb0073d40fe90bfe3a1e3246e0b07e12b3ecf","modified":1575788117142},{"_id":"themes/huweihuang/layout/_widget/featured-tags.ejs","hash":"e29431fa78c81d7c521bb1f7be356651fcde959c","modified":1575788117142},{"_id":"themes/huweihuang/layout/_widget/friends-blog.ejs","hash":"b185fcffb0d181ddd9eb2259af38cf7d82fb2846","modified":1575788117143},{"_id":"themes/huweihuang/layout/_widget/recent-posts.ejs","hash":"814dd716083a8a75eb31f9d2d6ab28150b01c533","modified":1575788117143},{"_id":"themes/huweihuang/layout/_partial/footer.ejs","hash":"f3619af90437b15c757b2fdd37907cc6a7484e7d","modified":1575788117138},{"_id":"themes/huweihuang/source/css/archive.styl","hash":"bcb216ef65804c97b1a5dbe5f519fc171a13aaf1","modified":1575788117149},{"_id":"themes/huweihuang/source/css/beantech.css","hash":"5e9bee0a553da83a3efd4e9bc975a0ebd13b1b7d","modified":1575788117149},{"_id":"themes/huweihuang/layout/_widget/short-about.ejs","hash":"bc918e897eead442ca3b6e5a11824402a8aeb18d","modified":1575788117144},{"_id":"themes/huweihuang/source/css/beantech.min.css","hash":"05a06230b1a9eca0b30cece54a397008cb77dc50","modified":1575788117150},{"_id":"themes/huweihuang/source/css/donate.css","hash":"948c148076e7e0e0f78225f753813012938f5022","modified":1575788117153},{"_id":"themes/huweihuang/source/css/hux-blog.min.css","hash":"1baef04de262aeb7023d835429b49a805ac4ab40","modified":1575788117154},{"_id":"themes/huweihuang/source/css/rocket.styl","hash":"0abbccdbcd6cce70e8a0bab7152c38adc0b708f1","modified":1575788117155},{"_id":"themes/huweihuang/source/css/signature.styl","hash":"63ae8051f59d5e69544647cc4173eabc81d99aae","modified":1575788117155},{"_id":"themes/huweihuang/source/css/toc.styl","hash":"e197d57dc5312b20974193b6991c779e266fadca","modified":1575788117156},{"_id":"themes/huweihuang/source/css/highlight.styl","hash":"831f8195f3577ba5bea374f2e24b90054d445055","modified":1575788117154},{"_id":"themes/huweihuang/source/css/widget.styl","hash":"f996466e299c68274145ba5afaca9b6d1dd83114","modified":1575788117157},{"_id":"themes/huweihuang/source/fonts/glyphicons-halflings-regular.woff","hash":"278e49a86e634da6f2a02f3b47dd9d2a8f26210f","modified":1575788117160},{"_id":"themes/huweihuang/source/fonts/glyphicons-halflings-regular.ttf","hash":"44bc1850f570972267b169ae18f1cb06b611ffa2","modified":1575788117159},{"_id":"themes/huweihuang/source/fonts/glyphicons-halflings-regular.eot","hash":"86b6f62b7853e67d3e635f6512a5a5efc58ea3c3","modified":1575788117157},{"_id":"themes/huweihuang/source/fonts/glyphicons-halflings-regular.woff2","hash":"ca35b697d99cae4d1b60f2d60fcd37771987eb07","modified":1575788117161},{"_id":"themes/huweihuang/source/js/hux-blog.min.js","hash":"ee99af17a1a69ac8d85a695fed0349ba202789ae","modified":1575788117166},{"_id":"themes/huweihuang/source/js/hux-blog.js","hash":"3d3c93e42a9990b2a2e6df5a08e9816f9a221e0f","modified":1575788117165},{"_id":"themes/huweihuang/source/js/bootstrap.min.js","hash":"313da686ebbe387064f2d1899c64ea562b81eb40","modified":1575788117164},{"_id":"themes/huweihuang/source/js/jquery.nav.js","hash":"bc6383fa2aa8f437978cf044a3b6f10a65114398","modified":1575788117173},{"_id":"themes/huweihuang/source/js/jquery.tagcloud.js","hash":"448017ff32f75f444ed7985d10a21b3ad92ab100","modified":1575788117174},{"_id":"themes/huweihuang/source/js/toc.js","hash":"4ffe95b7755b035ee1b41664fa72b0ebea29c3f8","modified":1575788117174},{"_id":"source/_posts/Reinforcement-Learning-Post-1-Basic-Knowledge-and-Background/LDS-GNN.png","hash":"5fcbe43d5637218a0a05b5938af037d262ebd53e","modified":1575788116891},{"_id":"themes/huweihuang/source/js/totop.js","hash":"f796b09b4f6177c3674a8c1542a8c92e8590cb5c","modified":1575788117175},{"_id":"themes/huweihuang/source/css/bootstrap.min.css","hash":"1818a346630e7133a1f194669f613f613fcfa97c","modified":1575788117153},{"_id":"themes/huweihuang/source/fonts/glyphicons-halflings-regular.svg","hash":"4dcf0ab896f5417047f881de91bad10dcbda48c6","modified":1575788117158},{"_id":"themes/huweihuang/source/js/bootstrap.js","hash":"5d69034fb6eded2e5961ea54dd47129a88cd5182","modified":1575788117163},{"_id":"source/img/signature/BeanTechSign-white.png","hash":"34289ed41cf9ddac2d56be46fbb1515b7d5913cd","modified":1575788117125},{"_id":"themes/huweihuang/source/css/bootstrap.css","hash":"d1a24afac31222d70b4e001e0361ef045aa42043","modified":1575788117151},{"_id":"themes/huweihuang/source/css/images/ironman.png","hash":"2f0db0ab15d466c4065d9f6102fdf829726d9e3f","modified":1575788117155},{"_id":"themes/huweihuang/source/css/images/rocket.png","hash":"6dee0406955aa9b7a261161d30f2538a671e806b","modified":1575788117155},{"_id":"source/_posts/What-is-Gumbel-Softmax-Trick/gumbel1.png","hash":"f4553c67e4b451a8461cfccd9ec7ebf767631b52","modified":1575788116897},{"_id":"source/img/avatar/we.png","hash":"bcb66101bf0be4147664ad308baf85904e7054d5","modified":1575788117008},{"_id":"source/img/signature/BeanTechSign-black.png","hash":"94b7102e819fd6ee082d3fb0166f4de7458c22ff","modified":1575788117121},{"_id":"source/img/header_img/home.jpg","hash":"67be147e02ddb76ea40a3c07e0f7e41805b52354","modified":1575817320311},{"_id":"source/_posts/What-is-Gumbel-Softmax-Trick/gumbel2.png","hash":"723753b396f4b0490ef5c831db3be60c3f0aff75","modified":1575788116902},{"_id":"source/_posts/What-is-Gumbel-Softmax-Trick/re-paramerise.png","hash":"44fd0e604c5419e1aa8bc710b9696ed860f891cb","modified":1575788116906},{"_id":"source/img/article_header/article_bg.jpg","hash":"acc16e8a1e024239415bed316e09f481651c342d","modified":1575796664058},{"_id":"themes/huweihuang/source/js/jquery.min.js","hash":"17a740d68a1c330876c198b6a4d9319f379f3af2","modified":1575788117172},{"_id":"source/img/header_img/404.jpg","hash":"5313a0db2c29e6ea1c48e952e48ffc59f931d169","modified":1575816281673},{"_id":"source/img/header_img/tag.jpg","hash":"f16f692e9fd31cba89b2df25d23079260a8fe8ec","modified":1575816045471},{"_id":"themes/huweihuang/source/js/jquery.js","hash":"4bb763dc96da604aed08ac024a1a3f5de73eea39","modified":1575788117170},{"_id":"source/img/header_img/about.jpg","hash":"eee9ab1704c5220d629cc552611954c8f1420137","modified":1575815839059},{"_id":"source/img/blog.jpg","hash":"a76af0b98dbe92ca2d21babcef13f094e409554b","modified":1575790252731},{"_id":"source/img/article_header/article_header.png","hash":"d9fa12f1e40924a0db57761d09d52dce450b4f7b","modified":1575788116952},{"_id":"source/img/header_img/archive.jpg","hash":"78ab7bc8c864c0e1922cd5229ff115edf80f999d","modified":1575815899943},{"_id":"source/_posts/hexo-theme-huweihuang/Demo.png","hash":"d9fa12f1e40924a0db57761d09d52dce450b4f7b","modified":1575790252725},{"_id":"source/img/avatar/we.jpg","hash":"86b6728028a68a6ba9cbf1302ee08daa73e95d65","modified":1575788117005},{"_id":"source/_posts/PaperReadingNotes2020-0223.md","hash":"56eaacbb27e66a3578aba02cd0c7c72963d5b056","modified":1582527095233},{"_id":"source/_posts/PaperReadingNotes2020-0223/progressive_shrinking.png","hash":"0374e42f70486bf39358b4de0e7092981b088228","modified":1582527095247},{"_id":"source/_posts/PaperReadingNotes2020-0223/ofa-results1.png","hash":"9e7665874afd1bd8f93a5c91412a5402a6bdc64a","modified":1582527095238}],"Category":[],"Data":[],"Page":[{"layout":"404","description":"ä½ æ¥åˆ°äº†æ²¡æœ‰çŸ¥è¯†çš„è’åŸ","header-img":"/img/header_img/404.png","_content":"","source":"404.md","raw":"---\nlayout: 404\ndescription: \"ä½ æ¥åˆ°äº†æ²¡æœ‰çŸ¥è¯†çš„è’åŸ\"\nheader-img: \"/img/header_img/404.png\"\n---\n","date":"2019-12-08T06:55:16.882Z","updated":"2019-12-08T06:55:16.882Z","path":"404.html","title":"","comments":1,"_id":"ck6vknhcj0000osue3e811v88","content":"","site":{"data":{}},"excerpt":"","more":""},{"layout":"archive","title":"Archives","header-img":"/img/header_img/archive.jpg","comments":0,"date":"2017-09-20T12:49:56.000Z","description":"Hey, this is archives","_content":"","source":"archive/index.md","raw":"---\nlayout: \"archive\"\ntitle: \"Archives\"\nheader-img: \"/img/header_img/archive.jpg\"\ncomments: false\ndate: 2017-09-20 20:49:56\ndescription: \"Hey, this is archives\"\n---\n","updated":"2019-12-08T06:55:16.926Z","path":"archive/index.html","_id":"ck6vknhei0002osuewvfdv8jt","content":"","site":{"data":{}},"excerpt":"","more":""},{"layout":"about","title":"About","date":"2017-10-03T02:48:33.000Z","description":"Enjoy Coding, Enjoy Life","header-img":"/img/header_img/about.jpg","aplayer":false,"fixed":false,"_content":"\n### Who Are We?\n\nWe are lovers:couple_with_heart: graduated from [School of Data and Computer Science](http://sdcs.sysu.edu.cn/) in [Sun Yat-Sen university](http://www.sysu.edu.cn/2012/en/index.htm). \n\n### What This Blog for?\n\nWe build this site to track our life and thoughts.\n\n### What Are in This Blog?\n\nWe are interested in Front-end technologies, Machine Learning & Deep Learning Algorithms.  \nWe also track our life moments here.\n","source":"about/index.md","raw":"---\nlayout: \"about\"\ntitle: \"About\"\ndate: 2017-10-03 10:48:33\ndescription: \"Enjoy Coding, Enjoy Life\"\nheader-img: \"/img/header_img/about.jpg\"\naplayer: false\nfixed: false\n---\n\n### Who Are We?\n\nWe are lovers:couple_with_heart: graduated from [School of Data and Computer Science](http://sdcs.sysu.edu.cn/) in [Sun Yat-Sen university](http://www.sysu.edu.cn/2012/en/index.htm). \n\n### What This Blog for?\n\nWe build this site to track our life and thoughts.\n\n### What Are in This Blog?\n\nWe are interested in Front-end technologies, Machine Learning & Deep Learning Algorithms.  \nWe also track our life moments here.\n","updated":"2019-12-08T09:39:05.824Z","path":"about/index.html","comments":1,"_id":"ck6vknheo0004osue6a306ykc","content":"<h3 id=\"who-are-we\">Who Are We?</h3>\n<p>We are lovers:couple_with_heart: graduated from <a href=\"http://sdcs.sysu.edu.cn/\" target=\"_blank\" rel=\"noopener\">School of Data and Computer Science</a> in <a href=\"http://www.sysu.edu.cn/2012/en/index.htm\" target=\"_blank\" rel=\"noopener\">Sun Yat-Sen university</a>.</p>\n<h3 id=\"what-this-blog-for\">What This Blog for?</h3>\n<p>We build this site to track our life and thoughts.</p>\n<h3 id=\"what-are-in-this-blog\">What Are in This Blog?</h3>\n<p>We are interested in Front-end technologies, Machine Learning &amp; Deep Learning Algorithms.<br>\nWe also track our life moments here.</p>\n","site":{"data":{}},"excerpt":"","more":"<h3>Who Are We?</h3>\n<p>We are lovers:couple_with_heart: graduated from <a href=\"http://sdcs.sysu.edu.cn/\" target=\"_blank\" rel=\"noopener\">School of Data and Computer Science</a> in <a href=\"http://www.sysu.edu.cn/2012/en/index.htm\" target=\"_blank\" rel=\"noopener\">Sun Yat-Sen university</a>.</p>\n<h3>What This Blog for?</h3>\n<p>We build this site to track our life and thoughts.</p>\n<h3>What Are in This Blog?</h3>\n<p>We are interested in Front-end technologies, Machine Learning &amp; Deep Learning Algorithms.<br>\nWe also track our life moments here.</p>\n"},{"layout":"tags","title":"Tags","description":"Hey, this is Tags.","header-img":"/img/header_img/tag.jpg","_content":"","source":"tags/index.md","raw":"---\nlayout: \"tags\"\ntitle: \"Tags\"\ndescription: \"Hey, this is Tags.\"\nheader-img: \"/img/header_img/tag.jpg\"\n---\n","date":"2019-12-08T09:42:13.019Z","updated":"2019-12-08T09:42:13.019Z","path":"tags/index.html","comments":1,"_id":"ck6vknhez0007osuevf0wdrdm","content":"","site":{"data":{}},"excerpt":"","more":""}],"Post":[{"title":"FrontEnd Daily Learning","catalog":true,"date":"2019-07-11T11:44:53.000Z","subtitle":null,"header-img":null,"_content":"#### å‰è¨€\nğŸ“ recap and cheat sheet ï¼Œè®°å½•æ¯å¤©å­¦åˆ°çš„çŸ¥è¯†/æƒ³æ³•ã€‚\nğŸ”Š æ¯æ—¥ä¸€é—®ï¼šä»Šå¤©ä½ æ¯”æ˜¨å¤©æ›´åšå­¦äº†å—ï¼Ÿ\n\n\n#### 2019/8/25\nä»Šæ—¥è¸©å‘è®°å½•ï¼š\nå±•å¼€è¯­æ³•ï¼ˆspread syntaxï¼‰åªèƒ½å–åˆ° enumerable propertiesã€‚ä¾‹å¦‚ï¼š\n```\nconst imageData = new ImageData(200, 100);\n// ImageData { width: 200, height: 100, data: Uint8ClampedArray[80000] }\nconst result = {...imageData}\n// result åªä¼šåŒ…å« data ï¼Œä¸èƒ½å–åˆ° width å’Œ height\n```\n\n\n#### 2019/8/24\né¿å…ç»„ä»¶é‡æ–°æŒ‚è½½ï¼Œå¯ä»¥ä½¿ç”¨äº‹ä»¶çš„å½¢å¼ï¼š\n```\nclass BussinessProvider {\n  sp$ = new Subject<{url: string, slic: string}>();\n}\n\nclass Canvas {\n  componentDidMount() {\n     this.props.sp$.pipe(takeUntil(this.unmount$)).subscribe(ev => {\n        if (ev.url === this.url) {\n           this.handleSuperPixelChange(ev.slic)\n        }\n     })\n  }\n}\n```\n\n\n#### 2019/8/24\nä¸€ã€Promise\n```\nnew Promise((resolve,reject) => {\n  // do something...\n})\n\npromise.then(onFulfilled[, onRejected]);\npromise.then(value => {\n  // fulfillment\n}, reason => {\n  // rejection\n});\n\npromise.catch(onRejected);\npromise.catch(function(reason) {\n   // rejection\n});\n```\nç®€å•æ¥è¯´ï¼Œ`reject(value)` å¯ä»¥è¢« `promise.then` ç¬¬äºŒä¸ªå‡½æ•°å‚æ•°æ•è·ï¼Œä¹Ÿå¯ä»¥è¢« `promise.catch` æ•è·ã€‚å¦‚æœä¸¤è€…åŒæ—¶å­˜åœ¨ï¼Œä¼šè¢« `promise.then` ç¬¬äºŒä¸ªå‡½æ•°å‚æ•°æ•è·ï¼Œ`promise.catch` æ— è¾“å‡ºã€‚\n\nä¸‹è½½å›¾ç‰‡çš„å…¸å‹ä¾‹å­ï¼š\n```\nfunction loadImage(url) {\n  return new Promise((resolve, reject) => {\n    let img = new Image();\n    // img.onload = () => resolve(img)\n    img.addEventListener('load', e => resolve(img));\n    // img.onerror = () => reject(XXX)\n    img.addEventListener('error', () => {\n      reject(new Error(`Failed to load image's URL: ${url}`));\n    });\n    img.src = url;\n  });\n}\n\nloadImage('http://thecatapi.com/api/images/get?format=src&type=jpg&size=small')\n  .then(img => document.getElementById('image-holder').appendChild(img))\n  .catch(error => console.error(error));\n```\n\näºŒã€await\n`[rv] = await expression`:\n>TL;DR returns the fulfilled value of the promise, \nThe await expression causes async function execution to pause until a Promise is settled, that is fulfilled or rejected, and to resume execution of the async function after fulfillment. When resumed, the value of the await expression is that of the fulfilled Promise.\nIf the Promise is rejected, the await expression throws the rejected value.\nIf the value of the expression following the await operator is not a Promise, it's converted to a resolved Promise.\n\n\n#### 2019/8/23\n`String.prototype.localeCompare()`\n> return a number, indicating whether the reference string comes before, after or is the same as the compareString in sort order. Returns one of three values:\n-1: if the reference string is sorted before the compareString\n 0: if the two strings are equal\n 1: if the reference string is sorted after the compareString\n\n`Array.prototype.sort()`\n>  sorts the elements of an array in place and returns the sorted array. \n\n```\nitems.sort((a,b) => a.localeCompare(b))\n```\n\n\n#### 2019/8/21\nä»Šæ—¥é˜…è¯»ï¼š\n[What is the difference between â€œnpm installâ€ and â€œnpm ciâ€?](https://stackoverflow.com/questions/52499617/what-is-the-difference-between-npm-install-and-npm-ci)\n[Everything You Wanted To Know About package-lock.json But Were Too Afraid To Ask](https://medium.com/coinmonks/everything-you-wanted-to-know-about-package-lock-json-b81911aa8ab8)\n\n\n#### 2019/8/20\næ¨¡ä»¿ react hook `useState` çš„ç¬¬äºŒä¸ªå‚æ•°ï¼š\n&emsp;&emsp;å› ä¸ºåœ¨ jest æµ‹è¯•ä¸­æŸä¸ªå‡½æ•°çš„å‚æ•°æ˜¯ `useState` çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œå†™äº†ä¸€ä¸ªæ›¿ä»£ï¼Œä¸è¿‡ä¸ç¡®å®šæ˜¯å¦æœ‰é”™ã€‚ğŸ˜³\n```\n// for example\nconst [str,setStr] = useState<string[]>([]);\n\n// fake setStr\nlet str:string[] = [];\nconst setStr = (val: string[] | ((prev:string[]) => string[])) => {\n  if (typeof val === \"object\") {\n    str = val;\n  } else if (typeof val === \"function\") {\n    str = val(str)\n  }\n}\n```\n\n#### 2019/8/19\nä»Šæ—¥é˜…è¯»ï¼š[What is rel=noopener noreferrer link](https://searchenginelaws.com/seo/what-is-rel-noopener-noreferrer-tag/)\n&emsp;&emsp;ä½¿ç”¨ `a` æ ‡ç­¾ï¼Œä¸”å±æ€§ `target=\"_blank\"` æ—¶ï¼Œéœ€è¦åŠ ä¸Š `rel=\"noopener noreferrer\"` ã€‚å¯ä»¥é˜²æ­¢æ–°çª—å£åˆ©ç”¨ `window.opener` çš„ç‰¹æ€§çªƒå–åŸçª—å£ä¿¡æ¯ã€‚å…·ä½“è€Œè¨€ï¼Œå¦‚æœ window A æ‰“å¼€äº† window Bï¼Œé‚£ä¹ˆ B.opener ä¼šè¿”å› Aã€‚å¦‚æœåŠ ä¸Š `rel=\"noopener\"` ï¼Œä¼šè¿”å› null ã€‚\n\n\n#### 2019/8/12\nä¸€ã€download files using axios\n```\nimport axios from \"axios\"\n\naxios.get(url,{\n  responseType: 'blob', // important\n  headers: {\n    'Authorization': AuthStr \n  }\n}).then(resp => {\n  const {data} = resp;\n  const file = new File([data],\"data.txt\");\n  const objectURL = URL.createObjectURL(file);\n  const a = document.createElement(\"a\");\n  a.href = objectURL;\n  a.download = \"data.txt\";\n  a.click();\n  URL.revokeObjectURL(objectURL);\n})\n```\n&emsp;&emsp;å¦‚æœæ˜¯å•æ¬¡ç‚¹å‡»ä¸‹è½½å¤šä¸ªæ–‡ä»¶ï¼ŒChrome åªä¼šå¼¹å‡ºä¸€ä¸ªå¼¹çª—ä¸‹è½½æœ€åä¸€ä¸ªæ–‡ä»¶ã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥åŠ ä¸Š `setTimeout` ï¼Œè§¦å‘å¤šæ¬¡ä¸‹è½½ï¼Œæˆ–æ˜¯åŠ ä¸Š `a.target = \"_blank\"` ï¼Œæ‰“å¼€å¤šä¸ªæ–°çª—å£ã€‚\näºŒã€curl\næŸ¥çœ‹å‘½ä»¤ï¼š\n`curl --help`\n-H æŒ‡å®šHeaderï¼š\n`curl -H \"Authorization: XXXXXXXX\" URL`\n`curl POST -d data -H \"Authorization: XXXXXXXX\" URL`\n\n\n#### 2019/8/9\nä¸€ã€[useRef vs useState: Should we re-render or not?](https://www.codebeast.dev/usestate-vs-useref-re-render-or-not/)\n![FE_20190808](FE_20190809.png)\näºŒã€Hooks ç›‘å¬é”®ç›˜äº‹ä»¶\nkeyCode: https://keycode.info/\n```\nfunction useKeyPress(targetKey) {\n  const [keyPressed, setKeyPressed] = useState(false);\n\n  function downHandler({ key }) {\n    if (key === targetKey) {\n      setKeyPressed(true);\n    }\n  }\n\n  const upHandler = ({ key }) => {\n    if (key === targetKey) {\n      setKeyPressed(false);\n    }\n  };\n\n  useEffect(() => {\n    window.addEventListener('keydown', downHandler);\n    window.addEventListener('keyup', upHandler);\n    return () => {\n      window.removeEventListener('keydown', downHandler);\n      window.removeEventListener('keyup', upHandler);\n    };\n  }, []);\n\n  return keyPressed;\n}\n```\n\n\n#### 2019/8/8\n&emsp;&emsp;å·¥ç¨‹ä¸­ç»å¸¸ä¼šçœ‹åˆ° CI/CD çš„æ¦‚å¿µã€‚CI æŒ‡çš„æ˜¯æŒç»­é›†æˆï¼Œä¾§é‡äºç®€åŒ–å‘å¸ƒå‡†å¤‡å·¥ä½œçš„å®è·µï¼Œæ¯”å¦‚è‡ªåŠ¨æµ‹è¯•ï¼›CD æŒ‡çš„æ˜¯æŒç»­äº¤ä»˜ï¼Œæ„å‘³ç€ä¸ä»…è®©æµ‹è¯•è‡ªåŠ¨åŒ–ï¼Œè®©å‘å¸ƒæµç¨‹ä¹Ÿè‡ªåŠ¨åŒ–äº†ã€‚æ›´å¤šæ¦‚å¿µå¯¹æ¯”å¯ä»¥å‚è€ƒï¼š[Continuous integration VS continuous delivery VS continuous deployment](https://www.atlassian.com/continuous-delivery/principles/continuous-integration-vs-delivery-vs-deployment)\n&emsp;&emsp;ä¸‹é¢è¿™ä¸ªå›¾å¾ˆæ¸…æ™°åœ°æè¿°äº†ä¸‰è€…çš„ä¸åŒï¼š\n![FE_20190808](FE_20190808.png)\n&emsp;&emsp;åœ¨ gitlab ä¸Šçš„å®è·µå¯ä»¥å‚è€ƒï¼š[åŸºäº GitLab CI/CD çš„è‡ªåŠ¨åŒ–æ„å»ºã€å‘å¸ƒå®è·µ](https://mp.weixin.qq.com/s/z2f1i2FgrVGofQR6nKTd1A)\n\n#### 2019/8/7\nTypescript: [Discriminated Unions](https://www.typescriptlang.org/docs/handbook/advanced-types.html#discriminated-unions) \n&emsp;&emsp;å½“æˆ‘ä»¬æŸä¸ªå‚æ•°å¯èƒ½æœ‰å¤šä¸ªç±»å‹ï¼Œè€Œè¿™äº›ç±»å‹ä¸­åˆæœ‰å…¬å…±çš„å±æ€§æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨è¿™ç§å½¢å¼çº¦æŸã€‚\n```\n// Each interface has a kind property with a different string literal type. \n// The kind property is called the discriminant or tag. \ninterface Square {\n    kind: \"square\";\n    size: number;\n}\ninterface Rectangle {\n    kind: \"rectangle\";\n    width: number;\n    height: number;\n}\ninterface Circle {\n    kind: \"circle\";\n    radius: number;\n}\n\n// put the interfaces into a union\ntype Shape = Square | Rectangle | Circle;\n\n// use the discriminated union\nfunction area(s: Shape) {\n    switch (s.kind) {\n        case \"square\": return s.size * s.size;\n        case \"rectangle\": return s.height * s.width;\n        case \"circle\": return Math.PI * s.radius ** 2;\n        default: return assertNever(s); // error here if there are missing cases\n    }\n}\n\n// Exhaustiveness checking \nfunction assertNever(x: never): never {\n    throw new Error(\"Unexpected object: \" + x);\n}\n```\n\n\n#### 2019/8/6\nStack Overflow: [useState set method not reflecting change immediately.](https://stackoverflow.com/questions/54069253/usestate-set-method-not-reflecting-change-immediately)\n&emsp;&emsp;ä»Šå¤©åœ¨å®è·µä¸­å‘ç°ï¼Œ`setState` åé©¬ä¸Šæ‰“å°ï¼Œå¹¶ä¸ä¼šå–åˆ°æ›´æ–°åçš„å€¼ã€‚æŸ¥é˜…èµ„æ–™åå‘ç°è¿™ä¸ªå‡½æ•°æ˜¯ä¸€ä¸ªå¼‚æ­¥çš„å‡½æ•°ï¼Œä¸ä¼šç«‹å³æ›´æ–°ï¼Œä½†ä¼šè§¦å‘é‡æ–°æ¸²æŸ“ã€‚å¦‚ä¸‹ï¼š\n![FE_20190806](FE_20190806.png)\n\n\n#### 2019/8/1\nä¸€ã€[Fetch API](https://javascript.info/fetch-api)\n&emsp;&emsp;ç”¨ fetch æ¥è¯·æ±‚ç½‘ç»œèµ„æºï¼Œå¯ä»¥é…ç½®ä¸åŒçš„å‚æ•°æ¥è§£å†³ç¼“å­˜ã€è·¨åŸŸç­‰é—®é¢˜ï¼Œå¦‚ä¸‹ç¤ºä¾‹ä»£ç ï¼š\n```\n// ä¸ç¼“å­˜è¯·æ±‚ç»“æœ \n// https://stackoverflow.com/questions/29246444/fetch-how-do-you-make-a-non-cached-request\nconst headers = new Headers();\nheaders.append(\"pragma\", \"no-cache\");\nheaders.append(\"cache-control\", \"no-store\");\n\n// å®Œå…¨å¿½ç•¥ http-cache ï¼Œæ¯æ¬¡éƒ½ä»æœåŠ¡å™¨è¯·æ±‚æ•°æ®\n// https://developer.mozilla.org/en-US/docs/Web/API/Request/cache\nconst cache: RequestCache = \"no-store\";\n\n// è¯·æ±‚æ¨¡å¼ï¼Œè‹¥æœ‰çš„è¯·æ±‚ä¼šå› ä¸º cors è€Œå¤±è´¥ï¼Œå¯ä»¥è®¾ç½®ä¸º \"no-cors\"\n// https://developer.mozilla.org/en-US/docs/Web/API/Request/mode\nconst mode: RequestMode = needCors ? \"cors\" : \"no-cors\";\n\nawait fetch(url. {headers, cache, mode})\n  .then(res => res.blob())\n  .then(blob => {\n    // doSomething with blob\n    const url = URL.createObjectURL(blob)\n    let a = document.createElement('a')\n    a.download = 'example.zip'\n    a.href = url\n    document.body.appendChild(a)\n    a.click()\n    document.body.removeChild(a)\n  })\n  .catch(err => {\n    console.log(err)\n  })\n  .finally(() => {\n    // doSomething\n  })\n```\n&emsp;&emsp;å…³äº `res.blob()` ï¼Œå¯ä»¥å‚è€ƒçŸ¥ä¹ä¸Š[è°ˆä¸€è°ˆ Fetch API ä¸­çš„ â€œres.blob()â€](https://zhuanlan.zhihu.com/p/32909043)ï¼›ä¹Ÿå¯ä»¥å‚è€ƒ [fetch documentation](https://github.github.io/fetch/) ï¼Œè¿™ä¸€ç¯‡æ¯”è¾ƒè¯¦ç»†ï¼Œä¹Ÿæä¾›äº†è¾ƒå¤šå…¶ä»–çš„ä¾‹å­ã€‚\nå…³äºæµè§ˆå™¨ç¼“å­˜é—®é¢˜ï¼ŒMedium ä¸Šè¿™ç¯‡ [A Web Developerâ€™s Guide to Browser Caching](https://medium.com/@codebyamir/a-web-developers-guide-to-browser-caching-cc41f3b73e7c) å†™å¾—ä¸é”™ã€‚å¦‚æœå­˜åœ¨ä»£ç†æœåŠ¡å™¨ï¼Œå³ä½¿æˆ‘ä»¬è®¾ç½®äº† `mode: 'no-store'` ï¼Œä»£ç†æœåŠ¡å™¨ä¹Ÿä¼šç¼“å­˜ã€‚ä¸ºäº†é¿å…è¿™ä¸ªæƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ¯æ¬¡å‘é€è¯·æ±‚æ—¶æ„é€ æ–°çš„ URL ï¼ŒåŠ ä¸Šæ—¶é—´æˆ³ `?t=Date.now()` ã€‚ğŸ®ğŸº\näºŒã€Jest\n&emsp;&emsp;æˆ‘ä»¬åœ¨ä½¿ç”¨ jest æµ‹è¯•æ—¶ï¼Œæœ‰æ—¶å€™éœ€è¦å¼•å…¥ä¸€äº›å¤–éƒ¨æ–‡ä»¶/å¤–éƒ¨å˜é‡ï¼Œå¦‚ä» `config.json` æ–‡ä»¶ä¸­å¼•å…¥æŸä¸ªå˜é‡ã€‚ä¸ºäº†åœ¨æµ‹è¯•æ–‡ä»¶ä¸­å¯ä»¥è®¿é—®åˆ°è¯¥å˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ `jest.config.js` ä¸­é…ç½®å…¨å±€å˜é‡ï¼š\n```\nmodule.exports = {\n  globals: {\n    API_BASE: \"\",\n    DATA_API: \"\",\n    TRACK_API: \"\"\n  },\n  setupFiles: [\"./jestSetup.ts\"]\n}\n```\n&emsp;&emsp;ç”±äº `globals` åªæ”¯æŒ JSON æ ¼å¼çš„å˜é‡ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦å®šä¹‰å…¨å±€å‡½æ•°ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ `setupFiles`ã€‚\n```\n// jestSetup.ts\n(global as any).fn= () => {};\n(global as any).variable = \"XXX\";\n```\n\n\n#### 2019/7/31\n1ï¼‰`position: fixed` å’Œ flex å¸ƒå±€æ˜¯ä¸èƒ½åŒæ—¶èµ·ä½œç”¨çš„ã€‚ç»å¯¹å¸ƒå±€è„±ç¦»æ–‡æ¡£æµï¼Œä¸ä¼šå‚ä¸åˆ° flex layout ä¸­ã€‚å¦‚æœæƒ³å®ç°å·¦ä¾§èœå•æ ï¼Œå³ä¾§å†…å®¹ï¼Œä¸¤è€…ä¸åŒæ—¶æ»šåŠ¨ï¼ˆèœå•æ  fixedï¼‰ï¼Œä½†èœå•æ çš„å¤§å°å¯ä»¥æ”¹å˜ï¼ˆflex çˆ¶å¸ƒå±€ï¼‰ã€‚å¯ä»¥è®©çˆ¶å®¹å™¨æ˜¯ flex å¸ƒå±€ï¼Œå·¦ä¾§èœå•æ å’Œå³ä¾§å†…å®¹åŒºåŸŸéƒ½æ˜¯ flex element ï¼Œ èœå•æ å†…éƒ¨å†æœ‰ä¸€ä¸ª `position: fixed` çš„ div ã€‚\n2ï¼‰å¦‚æœæƒ³è®© `position: fixed` çš„å…ƒç´ ç›¸å¯¹çˆ¶å®¹å™¨å®šä½ï¼Œå¯ä»¥ç»™çˆ¶å®¹å™¨å¢åŠ  CSS å±æ€§ `transform: translate(0,0)` ã€‚å‚è€ƒï¼š[MDN - position](https://developer.mozilla.org/en-US/docs/Web/CSS/position)\n> fixed: It is positioned relative to the initial containing block established by the viewport, except when one of its ancestors has a transform, perspective, or filter property set to something other than none. \n\n\n#### 2019/7/30\n`useEffect` ä¸­çš„å¼‚æ­¥è¯·æ±‚ï¼š\n```\n// é”™è¯¯å†™æ³•ï¼Œ return å¿…é¡»æ˜¯ cleanup function\nuseEffect(async () => {\n  const newVal = await asyncCall();\n  setVal(newVal);\n});\n\n// æ­£ç¡®å†™æ³•\nuseEffect(() => {\n  asyncCall().then(resp => setVal(resp.data));\n});\n```\nå¥½æ–‡å…±äº«ï¼š[How to fetch data with React Hooks?](https://www.robinwieruch.de/react-hooks-fetch-data/)ï¼Œä»£ç å¦‚ä¸‹ï¼š\n```\nuseEffect(() => {\n  async function fetchMyAPI() {\n    let url = 'http://something/' + productId;\n    let config = {};\n    const response = await myFetch(url);\n    console.log(response);\n  }  \n\n  fetchMyAPI();\n}, [productId]);\n```\nå¦‚æœè¦ä¿è¯è¯·æ±‚æŒ‰é¡ºåºå‘å‡ºï¼Œå¯ä»¥é‡‡ç”¨å¦‚ä¸‹å†™æ³•ï¼š\n```\nuseEffect(() => {\n  let didCancel = false;\n\n  async function fetchMyAPI() {\n    let url = 'http://something/' + productId;\n    let config = {};\n    const response = await myFetch(url);\n    if (!didCancel) { // Ignore if we started fetching something else\n      console.log(response);\n    } \n  }  \n\n  fetchMyAPI();\n  return () => { didCancel = true; }; // Remember if we start fetching something else\n}, [productId]);\n```\n\n\n#### 2019/7/29\nä¸€ã€[performance.now() vs Date.now()](https://stackoverflow.com/questions/30795525/performance-now-vs-date-now)\n&emsp;&emsp;åœ¨ç¨‹åºä¸­æ‰“å°æ‰§è¡Œæ—¶é—´æ—¶ï¼Œä½¿ç”¨ `performance.now(ï¼‰` æ›´å‡†ç¡®ã€‚\n```\nconst start = performance.now();\ndoSomething();\nconst end = performance.now();\nconsole.log(\"Call to doSomething took \" + (start - end) + \" milliseconds.\");\n```\näºŒã€[Does javascript slice method return a shallow copy?](https://stackoverflow.com/questions/47738344/does-javascript-slice-method-return-a-shallow-copy)\n&emsp;&emsp;mdn ä¸Šå¯¹ `slice()` æ–¹æ³•çš„ä»‹ç»ï¼š\n>The slice() method returns a shallow copy of a portion of an array into a new array object selected from begin to end (end not included) where begin and end represent the index of items in that array. The original array will not be modified.\n\n&emsp;&emsp;æ³¨æ„è¿™é‡Œçš„æµ…å¤åˆ¶æŒ‡çš„æ˜¯å¯¹æ•°ç»„ä¸­å€¼çš„æµ…å¤åˆ¶ï¼Œè€Œä¸æ˜¯å¯¹æ•´ä¸ªæ•°ç»„çš„æµ…å¤åˆ¶ã€‚å¦‚æœæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œåˆ™ä¿®æ”¹æ–°æ•°ç»„æ—¶ï¼ŒåŸæ•°ç»„ä¸ä¼šæ”¹å˜ï¼›å¦‚æœæ˜¯å¯¹è±¡æ•°ç»„ï¼Œä¿®æ”¹æ–°æ•°ç»„å¯¹è±¡å€¼æ—¶ï¼ŒåŸæ•°ç»„ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ã€‚\n```\nconst animals = [{name: 'ant'}, {name: 'bison'}, {name: 'camel'}];\nconst newAnimals = animals.slice(2);\n\nnewAnimals[0].name = 'aaa';\nconsole.log(newAnimals); // [{name: 'aaa'}]\nconsole.log(animals);    // [{name: 'ant'}, {name: 'bison'}, {name: 'aaa'}]\n```\n&emsp;&emsp;æ³¨æ„å¦‚æœæ˜¯é‡æ–°èµ‹å€¼ï¼Œåˆ™ç­‰äºé‡æ–°åˆ†é…ç©ºé—´ï¼Œä¸ä¼šæ”¹å˜åŸæ•°ç»„ã€‚\n```\nconst animals = [{name: 'ant'}, {name: 'bison'}, {name: 'camel'}];\nconst newAnimals = animals.slice(2);\n\nnewAnimals[0] = {name: 'aaa'};\nconsole.log(newAnimals); // [{name: 'aaa'}]\nconsole.log(animals);    // [{name: 'ant'}, {name: 'bison'}, {name: 'camel'}]\n```\n\n#### 2019/7/26\n&emsp;&emsp;åº”ç”¨åœºæ™¯ï¼šæˆ‘ä»¬éœ€è¦è¯·æ±‚å¹¶æ›´æ–°èœå•æ ä¸­ä»»åŠ¡çš„çŠ¶æ€ï¼Œå¦‚æœä¸€ä¸ªè¯·æ±‚å®Œæˆç«‹é©¬æ›´æ–°ä¼šå¯¼è‡´ React é¢‘ç¹åˆ·æ–°ï¼Œéœ€è¦ç¼“å†²æ‰¹å¤„ç†ï¼š\n```\nimport { runInAction } from \"mobx\";\n\nlet handlers: Array<() => void> = [];\nconst runHandlers = () => {\n  runInAction(() => {\n    handlers.forEach(f => f());\n    handlers = [];\n  });\n};\n\nfor (const task of tasks) {\n  const {data} = await requestFn();\n  \n  handlers.push(() => {\n    // deal with data, update state\n    ...\n  });\n\n  if(handlers.length > 30) {\n    runHandlers();\n  }\n}\n\nrunHandlers();\n```\n&emsp;&emsp;ä¸Šè¿°ä»£ç ä¸»è¦æ˜¯åˆ©ç”¨äº†è‡ªå®šä¹‰çš„ `handlers` æ¥æš‚å­˜çŠ¶æ€æ›´æ–°å‡½æ•°ï¼Œä¹‹åä½¿ç”¨ mobx æä¾›çš„ `runInAction` æ‰§è¡Œå‡½æ•°å¹¶æ›´æ–°çŠ¶æ€ï¼Œæ›´æ–°çŠ¶æ€éƒ½éœ€è¦ä½¿ç”¨ `action` å‡½æ•°ï¼Œ `runInAction` æ¥å—ä¸€ä¸ªä»£ç å—å¹¶åœ¨ä¸€ä¸ª(åŒ¿å)æ“ä½œä¸­æ‰§è¡Œï¼Œæœ‰åˆ©äºåŠ¨æ€åˆ›å»ºå’Œæ‰§è¡Œæ“ä½œï¼Œ`runInAction(f) = action(f)()`ã€‚æ­¤å¤–ï¼Œå¿…è¦æ—¶è¿˜å¯åŠ ä¸Š `lodash.memoize(func,[resolver])`ï¼Œè®°å½•ä¸»å‡½æ•°è¯·æ±‚ç»“æœã€‚\n> For one-time-actions runInAction(name?, fn) can be used, which is sugar for action(name, fn)()\n\n\n#### 2019/7/18 \nä¸€ã€ç¼–ç¨‹æ¨¡å¼ï¼š\n&emsp;&emsp; é¦–å…ˆå…ˆè®°ä½è¿™å‡ ç§ç¼–ç¨‹æ¨¡å¼çš„ä¸­æ–‡ï¼šImperative Programming æ˜¯å‘½ä»¤å¼ç¼–ç¨‹ï¼ŒDeclarative Programming æ˜¯å£°æ˜å¼ç¼–ç¨‹ï¼ŒReactive Programming æ˜¯å“åº”å¼ç¼–ç¨‹ã€‚ï¼ˆæµä¸‹äº†è‹±æ–‡ä¸å¥½çš„æ³ªæ°´ï¼‰\n1ï¼‰å…ˆçœ‹å‘½ä»¤å¼ç¼–ç¨‹å’Œå£°æ˜å¼ç¼–ç¨‹çš„åŒºåˆ«ï¼Œç›´æ¥ä¸Šä»£ç ï¼š\n```\n// å‘½ä»¤å¼ç¼–ç¨‹ imperative programming\nconst array = [0,1,2,3,4,5];\nconst output = [];\nfor (let i = 0; i < array.length; i++) {\n  const tmp = array[i] * 2;\n  output.push(tmp)\n};\nconsole.log(output) // => [0,2,4,6,8,10]\n```\n```\n// å£°æ˜å¼ç¼–ç¨‹ declarative programming\nconst array = [0,1,2,3,4,5];\nconst output = array.map(item => item * 2);\nconsole.log(output) // => [0,2,3,6,8,10]\n```\n&emsp;&emsp;å¾ˆæ˜æ˜¾å¯ä»¥çœ‹åˆ°ï¼Œå‘½ä»¤å¼ç¼–ç¨‹çš„å…³æ³¨ç‚¹åœ¨äº how ï¼Œæˆ‘ä»¬éœ€è¦ä¸€æ­¥æ­¥å‘Šè¯‰æœºå™¨æ¥ä¸‹æ¥è¦åšä»€ä¹ˆï¼Œå‘Šè¯‰ä»–æ€ä¹ˆå»éå†ä¸€ä¸ªæ•°ç»„ï¼Œæ€ä¹ˆå»è¿ç®—å¾—åˆ°æœ€åçš„ç»“æœï¼Œæ€ä¹ˆå»è¾“å‡ºï¼›å£°æ˜å¼ç¼–ç¨‹çš„å…³æ³¨ç‚¹åœ¨äº what ï¼Œæˆ‘ä»¬åªå…³æ³¨æœ€åçš„ç»“æœï¼Œç”±æœºå™¨è‡ªå·±å»æ‘¸ç´¢è¿‡ç¨‹ï¼Œå¦‚ç›´æ¥è°ƒç”¨ `map` å‡½æ•°ï¼Œåªå‘Šè¯‰ç¨‹åºæˆ‘ä»¬éœ€è¦ä¸€ä¸ª2å€è¾“å‡ºã€‚\n2ï¼‰æ¥ç€çœ‹å£°æ˜å¼ç¼–ç¨‹å’Œå“åº”å¼ç¼–ç¨‹çš„å¯¹æ¯”\n&emsp;&emsp;å¯ä»¥é˜…è¯»ï¼š[Imperative vs Reactive](https://codepen.io/HunorMarton/post/imperative-vs-reactive)ï¼Œè§£é‡Šå¾ˆæ¸…æ™°ï¼Œæ¯”å–»ä¹Ÿå¾ˆå½¢è±¡ï¼Œä½†æˆ‘è§‰å¾—æ–‡ç« é‡Œçš„ Imperative åº”è¯¥æ”¹æˆ Declarative æ¯”è¾ƒå‡†ç¡®ã€‚ç»§ç»­æ²¿ç”¨ä¸Šé¢çš„ä¾‹å­ï¼Œä¿®æ”¹ä¸€ä¸‹å£°æ˜å¼ç¼–ç¨‹çš„ä¾‹å­ï¼š\n```\n// å£°æ˜å¼ç¼–ç¨‹ declarative programming\nconst array = [1,2];\nconst output = array.map(item => item * 2);\noutput.forEach(item => console.log(item)) // => 2 4\narray.push(3);  // => no output \narray.push(4);  // => no output\n```\nå“åº”å¼ç¼–ç¨‹çš„ä¾‹å­ï¼š\n```\nimport { Subject } from `rxjs`;\nlet array = new Subject();\narray.next(1);\narray.next(2);\n\nconst output = array.map(item => item * 2);\noutput.forEach(item => console.log(item)); // => 2 4\n\narray.next(3); // => 6\narray.next(4); // => 8\n```\n&emsp;&emsp;é¦–å…ˆè¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸¤ç§æ–¹å¼ä¸­çš„ `map` ï¼Œ `forEach` ç­‰å‡½æ•°å¹¶ä¸æ˜¯ä¸€æ ·çš„ï¼Œå†…éƒ¨å®ç°æœºåˆ¶æ˜¯ä¸åŒçš„ã€‚æˆ‘ä»¬å¯ä»¥å‘ç°åŒºåˆ«ï¼šåœ¨å£°æ˜å¼ç¼–ç¨‹ä¸­ï¼Œå¦‚æœåœ¨æœ€åå‘åŸæ•°ç»„æ·»åŠ å€¼ï¼Œå¹¶ä¸ä¼šæ‰“å°å‡ºæ¥ï¼Œå› ä¸ºè¿™æ˜¯åœ¨ `console.log` è¯­å¥æ‰§è¡Œåå‘ç”Ÿçš„ã€‚ä½†åœ¨å“åº”å¼ç¼–ç¨‹é‡Œï¼Œä»»ä½•å˜åŒ–éƒ½å¯ä»¥è¢«ååº”å‡ºæ¥ï¼Œå®ƒå¼•å…¥äº†ä¸€ä¸ª**å¼‚æ­¥æ•°æ®æµ**ï¼ˆasynchronous data streamsï¼‰çš„æ¦‚å¿µï¼Œå¯ä»¥éšæ—¶åˆ›å»ºã€æ›´æ”¹æˆ–ç»„åˆè¿™äº›æ•°æ®æµï¼Œæ‰€ä»¥æ‰“å°äº‹ä»¶æ˜¯ä¸€ä¸ª continuous observation caseã€‚\näºŒã€ç±»åº“\n[react-virtualized](https://github.com/bvaughn/react-virtualized) çš„è½»é‡çº§ç‰ˆ [react-window](https://github.com/bvaughn/react-window)ï¼Œç”¨äºé«˜æ•ˆæ¸²æŸ“é•¿åˆ—è¡¨ã€‚\n\n\n#### 2019/7/17 \n&emsp;&emsp;å¦‚æœæˆ‘ä»¬åœ¨é¡¹ç›®ä¸­éœ€è¦è¯·æ±‚å¾ˆå¤šå›¾ç‰‡ï¼Œæƒ³è¦å®ç°è¯·æ±‚å‡ºé”™æ—¶ç»§ç»­å‘é€è¯·æ±‚ï¼ŒæˆåŠŸæ—¶è¿”å›æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ `Promise` ï¼š\n```\nfunction fetchURL(url: string):Promise<Blob> {\n  return Axios.get(url, {responeType: \"blob\"})\n              .then( resp => Promise.resolve(resp.data) )\n              .catch( () => fetchURL(url) )\n}\n```\nä¹‹åå¯ä»¥ä½¿ç”¨ `rxjs` ï¼š\n```\nimport { mergeMap, bufferTime, takeUntil } from \"rxjs/operators\";\n\n[url1,...,url10]\n  .pipe(\n    mergeMap( url => fetchURL(url).then( val => val )),\n    bufferTime(10000)\n  )\n  .subscribe({\n    next: resps => {\n      // do sth with resps:Blob[]\n    }\n  })\n```\n&emsp;&emsp;æ¯æ¬¡é‡åˆ° `rxjs` éƒ½å¾ˆå¤´å¤§ï¼Œç°åœ¨ä¹Ÿæ²¡æœ‰å‘ç°ä¸€ä¸ªæ¯”è¾ƒå®Œå–„æ¸…æ™°çš„æ•™ç¨‹ï¼Œä½†å®ƒåˆçœŸçš„å¾ˆå¼ºå¤§ï¼Œåç»­è¦å¼€ä¸“é¢˜å¥½å¥½å­¦ä¹ è®°å½•è¿™ä¸ªä¸œè¥¿ã€‚\n\n\n#### 2019/7/16\nä¸€ã€ä»Šæ—¥é˜…è¯»ï¼š[How to read an often-changing value from useCallback?](https://reactjs.org/docs/hooks-faq.html#how-to-read-an-often-changing-value-from-usecallback)\nç›´æ¥ä¸Šå®˜ç½‘ä»£ç ï¼š\n```\nfunction Form() {\n  const [text, updateText] = useState('');\n  const textRef = useRef();\n\n  useEffect(() => {\n    textRef.current = text; // Write it to the ref\n  });\n\n  const handleSubmit = useCallback(() => {\n    const currentText = textRef.current; // Read it from the ref\n    alert(currentText);\n  }, [textRef]); // Don't recreate handleSubmit like [text] would do\n\n  return (\n    <>\n      <input value={text} onChange={e => updateText(e.target.value)} />\n      <ExpensiveTree onSubmit={handleSubmit} />\n    </>\n  );\n}\n```\n&emsp;&emsp; ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ `text` çš„å€¼ç»å¸¸å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå³ä½¿ `handleSubmit` ç”¨ `useCallback` åŒ…è£¹äº†ï¼Œè¿˜æ˜¯ä¼šé‡æ–°å£°æ˜ã€‚è§£å†³åŠæ³•æ˜¯ä¼ å…¥ä¸€ä¸ª `ref` å¯¹è±¡ä»£æ›¿åŸå§‹å€¼ã€‚ä¹Ÿå¯ä»¥å†™ä¸€ä¸ª custom hook ï¼š\n1ï¼‰å®˜ç½‘çš„ç‰ˆæœ¬ï¼š\n```\nfunction useEventCallback(fn, dependencies) {\n  const ref = useRef(() => {\n    throw new Error('Cannot call an event handler while rendering.');\n  });\n\n  useEffect(() => {\n    ref.current = fn;\n  }, [fn, ...dependencies]);\n\n  return useCallback(() => {\n    const fn = ref.current;\n    return fn();\n  }, [ref]);\n}\n```\nå®é™…ä½¿ç”¨ï¼š\n```\nfunction Form() {\n  const [text, updateText] = useState('');\n  // Will be memoized even if `text` changes:\n  const handleSubmit = useEventCallback(() => {\n    alert(text);\n  }, [text]);\n\n  return (\n    <>\n      <input value={text} onChange={e => updateText(e.target.value)} />\n      <ExpensiveTree onSubmit={handleSubmit} />\n    </>\n  );\n}\n```\n2ï¼‰å¯¼å¸ˆçš„ç‰ˆæœ¬ï¼šï¼ˆä»–æ¥äº†ï¼Œä»–å¸¦ç€ä»£ç åˆæ¥äº†ï¼‰\n```\n/**\n * @param callback\n * @param oRefs\n */\nexport function useCallbackWithRefs<\n  Refs,\n  Callback extends (...args: any[]) => void\n>(callback: (refs: Refs) => Callback, oRefs: Refs) {\n  const refs = useRef(oRefs);\n  useEffect(\n    () => {\n      refs.current = oRefs;\n    },\n    [oRefs]\n  );\n\n  return useCallback(\n    (...args: any[]) => callback(refs.current)(...args),\n    []\n  ) as Callback;\n}\n```\nå®é™…ä½¿ç”¨ï¼š\n```\nfunction Form() {\n  const [text, updateText] = useState('');\n  \n  // åŸå…ˆçš„ callback ä¹Ÿå¯ä»¥æœ‰å‚æ•°\n  const handleSubmit = useCallbackWithRefs(\n    refs => (params: any) => {\n      // è¦æ³¨æ„åœ¨å‡½æ•°å†…å¿…é¡»ä½¿ç”¨ `refs.xxx`ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨å‡½æ•°å¤–éƒ¨çš„ä»»ä½•å˜é‡ `xxx`\n      console.log(refs.text);\n  }, {text});\n\n  return (\n    <>\n      <input value={text} onChange={e => updateText(e.target.value)} />\n      <ExpensiveTree onSubmit={handleSubmit} />\n    </>\n  );\n}\n```\n&emsp;&emsp;æ€»çš„æ¥è¯´ï¼Œå®˜ç½‘çš„å®ç°æ˜¯å°† `callback` ä½œä¸º `ref` å¯¹è±¡ï¼Œå¹¶ä½œä¸º `useCallback` çš„ä¾èµ–ï¼Œä¸ä¼šé¢‘ç¹æ”¹å˜ï¼›å¦‚æœåœ¨å‡½æ•° `handleSubmit` ä¸­è¦è®¿é—®å¤–éƒ¨å˜é‡ `text` ï¼Œç›´æ¥ä½¿ç”¨ `test` å³å¯ã€‚ç¬¬äºŒç§å®ç°æ–¹å¼æ˜¯æŠŠç»å¸¸å˜åŒ–çš„å€¼ä½œä¸º `ref` å¯¹è±¡ï¼Œè¿”å›å€¼ `useCallback` ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ `refs => callback` ï¼Œä¾èµ–æ˜¯ç©ºæ•°ç»„ï¼›è¿™æ—¶å¦‚æœè¦åœ¨å‡½æ•° `handleSubmit` ä¸­è¦è®¿é—®å¤–éƒ¨å˜é‡ `text` ï¼Œå¿…é¡»ä½¿ç”¨ `refs.test` ï¼Œå¦åˆ™è®¿é—®çš„åªæ˜¯ `test` çš„åˆå§‹å€¼ã€‚\n&emsp;&emsp;React åšå¤§ç²¾æ·±ï¼Œæ¥ä¸‹æ¥è¦å¥½å¥½ç ”è¯»ä¸€ä¸‹è¿™ä¸ª [FAQ](https://reactjs.org/docs/hooks-faq.html)ã€‚\näºŒã€ä»Šæ—¥ç½‘å€\n&emsp;&emsp;ä¸€ä¸ª [emoji copy](https://www.emojicopy.com/) ç½‘ç«™ï¼Œæˆ‘ä»¬ ğŸ‘§ å°±æ˜¯å–œæ¬¢è¿™äº›èŠ±é‡Œèƒ¡å“¨çš„ä¸œè¥¿ã€‚\n\n\n#### 2019/7/15\n&emsp;&emsp;ä»Šå¤©åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ React Hooks åˆè¸©å‘äº†ï¼Œçœ‹æ¥è‡ªå·±å¯¹è¿™éƒ¨åˆ†è¿˜æ˜¯æ²¡æœ‰ç†è§£é€å½»ã€‚åœ¨ä½¿ç”¨ `useCallback` å’Œ `useEffect` æ—¶ï¼Œè¦æ³¨æ„ç¬¬äºŒä¸ªå‚æ•°ï¼Œä¹Ÿå°±æ˜¯ä¼ å…¥çš„ `[deps]`ã€‚å¦‚æœä½¿ç”¨ `useCallback(fn,[deps])` ï¼Œ `[deps]` åº”è¯¥åŒ…å«å‡½æ•° `fn` æ‰€æ¶‰åŠçš„æ‰€æœ‰å˜é‡ï¼›å¦‚æœä½¿ç”¨ `useEffect(fn,[deps])` ï¼Œ å½“ `deps` çš„å€¼å˜åŒ–æ—¶ï¼Œå°±ä¼šæ‰§è¡Œ `fn`ï¼Œå› æ­¤`[deps]` ä¸ä¸€å®šè¦åŒ…å«å‡½æ•° `fn` æ‰€æ¶‰åŠçš„æ‰€æœ‰å˜é‡ï¼Œè€Œæ˜¯åº”è¯¥ä¼ å…¥ä¼šå¼•èµ·è¯¥å‡½æ•°æ‰§è¡Œçš„é‚£äº›å‚æ•°ã€‚\n&emsp;&emsp;ä»Šæ—¥è¸©å‘è®°å½•ï¼šä¸ºäº†ä¼˜åŒ–å­ç»„ä»¶ï¼Œä½œä¸º `props` çš„å‡½æ•°éƒ½ä½¿ç”¨ `useCallback` åŒ…è£¹äº†ï¼Œå¹¶ä¼ å…¥äº†ç©ºæ•°ç»„ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ï¼Œè¡¨ç¤ºæ²¡æœ‰ä¾èµ–ã€‚ä½†æ˜¯å‡½æ•°ä¸­çš„è¿ç®—éœ€è¦ç”¨åˆ°ç»„ä»¶ä¸­ä¸€ä¸ªå˜é‡ï¼Œå¦‚æœæ²¡æœ‰å°†è¯¥å˜é‡ä½œä¸º `deps` ï¼Œè¿™ä¸ªå˜é‡å°±ä¼šä¸€ç›´ä¿æŒåˆå§‹å€¼ï¼Œå€¼å¹¶ä¸ä¼šæ”¹å˜ï¼Œè¿è¡Œç»“æœå°±ä¼šä¸é¢„æœŸä¸ç¬¦ã€‚ï¼ˆçœŸçš„å¤ªè ¢äº†ï¼Œç¼“ç¼“èººå€’ï¼‰\n\n\n#### 2019/7/14\nå‘¨æœ«å½“ç„¶æ˜¯çº¦ä¼šå•¦ã€‚ğŸ˜\n\n\n#### 2019/7/13\nä¸€ã€ä»Šæ—¥é˜…è¯»ï¼š[How to compare oldValues and newValues on React Hooks useEffect?](https://stackoverflow.com/questions/53446020/how-to-compare-oldvalues-and-newvalues-on-react-hooks-useeffect)\n&emsp;&emsp; React class ç»„ä»¶æä¾›äº† `ComponentDidUpdate` ä¹‹ç±»çš„æ–¹æ³•æ¥è·å–åˆ°å½“å‰ `props` å’Œå‰ä¸€ä¸ª `props` ï¼Œå¹¶è¿›è¡Œæ¯”è¾ƒï¼Œå†³å®šæ˜¯å¦è¿›è¡Œæ›´æ–°ã€‚å‡½æ•°å¼ç»„ä»¶åªæœ‰ `useEffect` å‡½æ•°æ¥æ¨¡ä»¿ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œå½“æˆ‘ä»¬éœ€è¦è·å–ç»„ä»¶å…ˆå‰çš„ `props` æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ custom hook ï¼š\n```\nfunction usePrevious(value) {\n  const ref = useRef();\n  useEffect(() => {\n    ref.current = value;\n  });\n  return ref.current;\n}\n```\n&emsp;&emsp;ä¹‹ååœ¨ `useEffect` ä¸­ä½¿ç”¨ä¸Šé¢çš„å‡½æ•°æ¥æ¨¡æ‹Ÿ `ComponentDidUpdate` ï¼š\n```\nconst Component = (props) => {\n    const {receiveAmount, sendAmount } = props\n    const prevAmount = usePrevious({receiveAmount, sendAmount});\n    useEffect(() => {\n        if(prevAmount.receiveAmount !== receiveAmount) {\n\n         // process here\n        }\n        if(prevAmount.sendAmount !== sendAmount) {\n\n         // process here\n        }\n    }, [receiveAmount, sendAmount])\n}\n```\n&emsp;&emsp;æœ‰æ—¶å€™åœ¨ debug æ—¶ï¼Œæˆ‘ä»¬æƒ³çŸ¥é“ç»„ä»¶ä¸ºä»€ä¹ˆä¼šé‡æ–°æ¸²æŸ“ï¼Œæ˜¯é‚£äº› `props` æ›´æ–°äº†ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸Šé¢çš„æ–¹æ³•æ¥è·å– `prevProps`ï¼Œå¹¶åœ¨å‡½æ•°ç»„ä»¶æœ€å¼€å§‹æ—¶å†™ä¸€ä¸ª `useEffect` å°†å‚æ•°éƒ½æ‰“å°å‡ºæ¥ï¼Œä½¿ç”¨ `===` æ¯”è¾ƒã€‚ \n\n\n\n#### 2019/7/12\nä¸€ã€ä»Šæ—¥æŠ€èƒ½\n&emsp;&emsp;é¡¹ç›®ä¸­ç»å¸¸ä¼šæ¶‰åŠåˆ° JSON å­—ç¬¦ä¸²çš„è§£æï¼Œè§£æå‡ºé”™å°±æ‰‘è¡—äº†ï¼Œä¸€èˆ¬æ˜¯ç”¨ `try {...} catch {...}` åŒ…è£¹ã€‚ä»Šå¤©å¯¼å¸ˆåœ¨ code review æ—¶å»ºè®®æˆ‘ä½¿ç”¨å¦‚ä¸‹å‡½æ•°ï¼Œè¯¥å‡½æ•°ä¹Ÿå¯ä»¥è¦†ç›–ç©ºå­—ç¬¦ä¸²çš„æ£€æµ‹ï¼š\n```\nfunction safeJsonParse<T>(str): { ok: true, value: T } | { ok: false } {\n  try {\n    return {\n      ok: true,\n      value: JSON.parse(str)\n    }\n  } catch {\n    return {\n      ok: false\n    }\n  }\n}\n```\näºŒã€ä»Šæ—¥é˜…è¯»ï¼š[ä»æµè§ˆå™¨å¤šè¿›ç¨‹åˆ°JSå•çº¿ç¨‹ï¼ŒJSè¿è¡Œæœºåˆ¶æœ€å…¨é¢çš„ä¸€æ¬¡æ¢³ç†](https://imweb.io/topic/5b72d4ef15554e6d3409f817)ã€‚\n&emsp;&emsp;è¿™ä¸€ç¯‡å¾ˆå¥½åœ°æ¢³ç†äº†è¿›ç¨‹ã€çº¿ç¨‹ã€æµè§ˆå™¨**å¤šè¿›ç¨‹**ã€æµè§ˆå™¨å†…æ ¸**å¤šçº¿ç¨‹**ã€JSå•çº¿ç¨‹ã€JSè¿è¡Œæœºåˆ¶çš„ç›¸å…³çŸ¥è¯†ï¼Œå¾ˆè¿è´¯ï¼Œå»ºè®®æ—¶ä¸æ—¶å›é¡¾ã€‚ç®€å•è®°å½•å‡ ä¸ªçŸ¥è¯†ç‚¹ï¼š\n1ï¼‰è¿›ç¨‹æ˜¯CPUèµ„æºåˆ†é…çš„æœ€å°å•ä½ï¼Œçº¿ç¨‹æ˜¯CPUè°ƒåº¦çš„æœ€å°å•ä½ã€‚ï¼ˆæƒ³å½“å¹´è€ƒæ“ä½œç³»ç»Ÿçš„æ—¶å€™è¿˜èƒŒå¾—æ»šç“œçƒ‚ç†Ÿï¼‰\n2ï¼‰**æµè§ˆå™¨æ˜¯å¤šè¿›ç¨‹çš„**ï¼ŒåŒ…æ‹¬çš„ä¸»è¦è¿›ç¨‹æœ‰ï¼š\n- Browserè¿›ç¨‹ï¼ˆæµè§ˆå™¨çš„ä¸»è¿›ç¨‹ï¼Œåªæœ‰ä¸€ä¸ªï¼‰\n- æµè§ˆå™¨æ¸²æŸ“è¿›ç¨‹ï¼ˆæµè§ˆå™¨å†…æ ¸ï¼ŒRendererè¿›ç¨‹ï¼Œæ¸²æŸ“è¿›ç¨‹ï¼Œå†…éƒ¨æ˜¯å¤šçº¿ç¨‹çš„ï¼‰ï¼šé»˜è®¤æ¯ä¸ªTabä¸€ä¸ªè¿›ç¨‹\n- ç¬¬ä¸‰æ–¹æ’ä»¶è¿›ç¨‹\n- GPUè¿›ç¨‹ï¼š3Dç»˜åˆ¶\n\n3ï¼‰é‡ç‚¹æ˜¯æµè§ˆå™¨å†…æ ¸ï¼Œå®ƒæ˜¯å¤šçº¿ç¨‹çš„ï¼Œä¸»è¦å¸¸é©»çº¿ç¨‹æœ‰ï¼š\n- GUIæ¸²æŸ“çº¿ç¨‹ï¼šæ¸²æŸ“é¡µé¢ï¼Œè§£æHTMLï¼ŒCSSï¼Œæ„å»ºDOMæ ‘å’ŒRenderObjectæ ‘ï¼Œå¸ƒå±€å’Œç»˜åˆ¶ï¼Œrepaint å’Œ reflow ç­‰ã€‚\n- JSå¼•æ“çº¿ç¨‹ï¼šå¤„ç†ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼Œä¸ GUI æ¸²æŸ“çº¿ç¨‹æ˜¯äº’æ–¥çš„ã€‚\n- äº‹ä»¶è§¦å‘çº¿ç¨‹ï¼šæ§åˆ¶äº‹ä»¶å¾ªç¯ï¼ŒæŠŠäº‹ä»¶æ·»åŠ åˆ°ä»»åŠ¡é˜Ÿåˆ—çš„æœ«å°¾ã€‚\n- å®šæ—¶è§¦å‘çº¿ç¨‹ï¼š`setTimeout` å’Œ `setInterval`ï¼ŒåŒæ ·ä¹Ÿæ˜¯è®¡æ—¶å®Œæ¯•åæ·»åŠ åˆ°é˜Ÿåˆ—æœ«å°¾ã€‚\n- å¼‚æ­¥ http è¯·æ±‚çº¿ç¨‹\n\n4ï¼‰Browserè¿›ç¨‹å’Œæµè§ˆå™¨å†…æ ¸ä¹‹é—´æ˜¯éœ€è¦é€šä¿¡çš„\n5ï¼‰æ—¶é—´å¾ªç¯æœºåˆ¶ `Event Loop` ï¼šJSåˆ†ä¸ºåŒæ­¥ä»»åŠ¡å’Œå¼‚æ­¥ä»»åŠ¡ï¼ŒåŒæ­¥ä»»åŠ¡éƒ½ä¼šåœ¨ä¸»çº¿ç¨‹ä¸Šè¿è¡Œï¼Œå½¢æˆä¸€ä¸ªæ‰§è¡Œæ ˆï¼›ä¸»çº¿ç¨‹ä¹‹å¤–ï¼Œç”±äº‹ä»¶è§¦å‘çº¿ç¨‹ç®¡ç†ä¸€ä¸ª**ä»»åŠ¡é˜Ÿåˆ—/äº‹ä»¶é˜Ÿåˆ—**ï¼Œå¼‚æ­¥ä»»åŠ¡çš„è¿è¡Œç»“æœä¼šè¢«æ·»åŠ åˆ°ä»»åŠ¡é˜Ÿåˆ—ä¸­ã€‚ä¸€æ—¦æ‰§è¡Œæ ˆä¸­æ‰€æœ‰åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œç³»ç»Ÿå°±ä¼šè¯»å–ä»»åŠ¡é˜Ÿåˆ—ï¼Œå°†å¯è¿è¡Œçš„å¼‚æ­¥ä»»åŠ¡æ·»åŠ åˆ°æ‰§è¡Œæ ˆä¸­å¼€å§‹æ‰§è¡Œã€‚ \n6ï¼‰è¿›é˜¶ï¼šmacrotask / task å’Œ microtask/ jobã€‚ES6ä¸­çš„ `Promise` å°±å±äº microtask å¾®ä»»åŠ¡ ï¼Œè€Œä¸»ä»£ç å—ï¼Œäº‹ä»¶é˜Ÿåˆ—ä¸­çš„æ—¶é—´å¦‚ `setTimeout` å’Œ `setInterval` å°±å±äº macrotask å®ä»»åŠ¡ã€‚æ€»ç»“çš„è¿è¡Œæœºåˆ¶å°±æ˜¯ï¼š\n- æ‰§è¡Œå®ä»»åŠ¡ã€‚ï¼ˆä»æ‰§è¡Œæ ˆä¸­è·å–ï¼Œå¦‚æœæ²¡æœ‰å°±ä»äº‹ä»¶é˜Ÿåˆ—ä¸­è·å–ï¼‰\n- æ‰§è¡Œè¿‡ç¨‹ä¸­å¦‚æœé‡åˆ°å¾®ä»»åŠ¡ï¼Œå°±æ·»åŠ åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ— Job Queues ä¸­ã€‚ï¼ˆä½œè€…çŒœæµ‹è¿™ä¸ªé˜Ÿåˆ—ç”±JSå¼•æ“çº¿ç¨‹ç»´æŠ¤ï¼Œå› ä¸ºæ˜¯åœ¨ä¸»çº¿ç¨‹ä¸‹æ— ç¼æ‰§è¡Œçš„ï¼‰\n- å®ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åï¼Œç«‹å³ä¾æ¬¡æ‰§è¡Œå½“å‰å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­æ‰€æœ‰å¾®ä»»åŠ¡ã€‚\n- æ£€æŸ¥æ¸²æŸ“ï¼Œç”± GUI çº¿ç¨‹æ¥ç®¡ã€‚\n- æ¸²æŸ“å®Œæ¯•åï¼Œç”± JS å¼•æ“çº¿ç¨‹æ¥ç®¡ï¼Œä»æ—¶é—´é˜Ÿåˆ—ä¸­è·å–å¹¶æ‰§è¡Œä¸‹ä¸€ä¸ªå®ä»»åŠ¡ã€‚\n\n7ï¼‰åœ¨ç¬¬å…­ç‚¹ä¸­æåˆ°çš„æ˜¯ä¸€ä¸ªè¿›é˜¶çš„æ¦‚å¿µï¼Œå¯¹åº”ä¸€é“é¢˜ç›®ï¼Œå¦‚æœä»£ç ä¸­ä¾æ¬¡æœ‰ `setTimeout` å’Œ `Promise` ï¼Œæ˜¯ä¼šå…ˆæ‰“å°å‡º `Promise` çš„æ‰§è¡Œç»“æœçš„ã€‚\n\n\n#### 2019/7/11\n&emsp;&emsp; React 16.8 æå‡ºäº† `hook` çš„æ¦‚å¿µï¼Œå‡½æ•°å¼ç»„ä»¶ä¹Ÿå¯ä»¥æ‹¥æœ‰è‡ªå·±çš„çŠ¶æ€ã€‚ç°åœ¨çš„å·¥ä½œé¡¹ç›®å·²ç»æ‘’å¼ƒäº† `class` ï¼Œæ”¹ç”¨å‡½æ•°å¼ç»„ä»¶ï¼Œæ­£åœ¨æ…¢æ…¢æ‘¸ç´¢ä¸­ã€‚ä»Šå¤©åœ¨è…¾è®¯[IMWebå‰ç«¯åšå®¢](http://imweb.io/)ä¸­çœ‹åˆ°äº†ä¸¤ç¯‡ä»‹ç» `React hook` çš„æ–‡ç« ï¼Œå—ç›ŠåŒªæµ…ï¼Œç®€å•è®°å½•ä¸€ä¸‹ã€‚\n ä¸€ã€[react hookâ€”â€”ä½ å¯èƒ½ä¸æ˜¯â€œæˆ‘â€æ‰€è®¤è¯†çš„useEffect](https://imweb.io/topic/5cd845cadcd62f86299fcd76)\n&emsp;&emsp;è¿™ç¯‡ä»‹ç»äº† `useEffect` è¿™ä¸ªAPIï¼Œç”¨å®ƒæ¨¡æ‹Ÿäº†classç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ã€‚`useEffect` ç”¨äºæ‰§è¡Œå‰¯ä½œç”¨ï¼Œç›¸å½“äº `ComponentDidMount` å’Œ `ComponentDidUpdate`ã€‚è¯¥APIæœ‰ä¸¤ä¸ªå‚æ•°å’Œä¸€ä¸ªè¿”å›å€¼ã€‚ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå‰¯ä½œç”¨å‡½æ•°ï¼Œè¿”å›å€¼æ˜¯æ¸…é™¤å‡½æ•°ï¼Œç›¸å½“äº `ComponentWillUnmount`ï¼Œæ¯ä¸€æ¬¡ `render` éƒ½ä¼šæ‰§è¡Œå‰¯ä½œç”¨å’Œæ¸…é™¤ä¸Šä¸€æ¬¡å‰¯ä½œç”¨ã€‚**ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä¼ å…¥çš„æ˜¯å‰¯ä½œç”¨å‡½æ•°æ‰€éœ€è¦çš„ä¾èµ–ï¼Œå½“ä»»ä¸€ä¾èµ–æ›´æ–°æ—¶ï¼Œä¼šé‡æ–°ç”Ÿæˆä¸€ä¸ªæ–°çš„å‰¯ä½œç”¨å¹¶æ‰§è¡Œï¼›å¦‚æœä¼ å…¥ä¸€ä¸ªç©ºæ•°ç»„ï¼Œæ²¡æœ‰ä¾èµ–ï¼Œåªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œç›¸å½“äº `ComponentDidMount`ï¼›å¦‚æœä¸ä¼ ï¼Œå°±æ˜¯æ²¡æœ‰è¯´æ˜è‡ªå·±æœ‰æ²¡æœ‰ä¾èµ–ï¼ˆæ³¨æ„æ˜¯ä¸çŸ¥é“æœ‰æ²¡æœ‰ï¼Œä¸æ˜¯æ²¡æœ‰ï¼ï¼‰ï¼Œæ¯æ¬¡ `render` æ—¶å°±æ‰§è¡Œï¼Œç›¸å½“äº `ComponentDidUpdate` ã€‚**\n&emsp;&emsp; æœ€åè¿˜è®²äº† `useEffect` å’Œ `useLayoutEffect` çš„åŒºåˆ«ï¼Œç®€å•æ¥è¯´å‰è€…æ˜¯å¼‚æ­¥çš„ï¼Œåè€…æ˜¯åŒæ­¥çš„ã€‚è¿˜æ²¡å¥½å¥½æ·±å…¥è¿™éƒ¨åˆ†ï¼ŒTODOã€‚\näºŒã€[å¯èƒ½ä½ çš„reactå‡½æ•°ç»„ä»¶ä»æ¥æ²¡æœ‰ä¼˜åŒ–è¿‡](https://imweb.io/topic/5d1e3657f7b5692b080f2651)\n&emsp;&emsp;ä¼˜åŒ–é—®é¢˜çœŸæ˜¯æˆ‘ä¸€ä¸ªç—›ç‚¹ã€‚è¿™ç¯‡æ–‡ç« å¾ˆæ¸…æ¥šåœ°è§£é‡Šäº† `Hooks` ä¸€äº›å¯ç”¨äºç»„ä»¶ä¼˜åŒ–çš„APIã€‚å¼ºæ¨ï¼\n&emsp;&emsp; ç‰¹åˆ«åœ°ï¼Œæ–‡ç« ä»‹ç»äº†å½“å‡½æ•°ç»„ä»¶ä¸­ä¼ å…¥çš„ `props` å€¼ä¸ºå‡½æ•°æ—¶ï¼Œç”±äºæ¯ä¸€æ¬¡æ‰§è¡Œæˆ–é‡æ–°æ‰§è¡Œï¼Œä½œç”¨åŸŸé‡Œé¢ä¸€åˆ‡éƒ½æ˜¯é‡æ–°å¼€å§‹ï¼Œå‡½æ•°ä¸æ˜¯ç®€å•æ•°æ®ç±»å‹ï¼Œä¸èƒ½ç”»ä¸Šç­‰å·ï¼Œå­ç»„ä»¶éƒ½ä¼šé‡æ–°æ¸²æŸ“ã€‚é’ˆå¯¹è¿™ä¸ªé—®é¢˜æ–‡ç« æå‡ºäº†å‡ ç§è§£å†³åŠæ³•ï¼š\n1ï¼‰ ä½œä¸º `props` çš„å‡½æ•°åœ¨å‡½æ•°ç»„ä»¶å¤–å®šä¹‰ï¼Œå‡½æ•°ç»„ä»¶ç”¨ `React.memo()` åŒ…è£¹ã€‚\n &emsp;&emsp; `React.memo()` ç±»ä¼¼äº `PureComponent` å’Œ `ComponentDidUpdate` ï¼Œå¦‚æœå‡½æ•°ç»„ä»¶çš„ `props` å€¼éƒ½ä¸€æ ·ï¼Œå°±ä¼šè·³è¿‡è¯¥ç»„ä»¶çš„æ‰§è¡Œï¼Œå‡å°‘ä¸å¿…è¦çš„æ¸²æŸ“ï¼Œå®ç°æ€§èƒ½ä¼˜åŒ–ã€‚\n2ï¼‰ ä½œä¸º `props` çš„å‡½æ•°åœ¨å‡½æ•°ç»„ä»¶å†…å®šä¹‰ï¼Œä½¿ç”¨`useCallBack` æˆ– `useMemo`åŒ…è£¹ï¼Œå‡½æ•°ç»„ä»¶ç”¨ `React.memo()` åŒ…è£¹ã€‚\n&emsp;&emsp; `useCallback(() => {}, [deps])` è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œå½“ `deps` ä¸å˜æ—¶ï¼ˆå¦‚ä¼ å…¥ç©ºæ•°ç»„ï¼Œè¡¨ç¤ºæ²¡æœ‰ä¾èµ–ï¼‰ï¼Œéƒ½æ˜¯åŒä¸€ä¸ªå‡½æ•°ã€‚`const a = useMemo(() => memorizeValue, [deps])`ï¼Œå½“ `deps` ä¸å˜æ—¶ï¼Œ`a` çš„å€¼è¿˜æ˜¯ä¸Šæ¬¡çš„ `memorizeValue`ï¼Œçœå»äº†é‡æ–°è®¡ç®—çš„è¿‡ç¨‹ã€‚\n&emsp;&emsp; æ³¨æ„å½“ `memorizeValue` æ˜¯ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œ`useCallback(fn, inputs) <=> useMemo(() => fn, inputs)`ã€‚\n\n\n#### 2019/7/10\n&emsp;&emsp;ä»Šå¤©åœ¨é¡¹ç›®ä¸­æ¥è§¦åˆ°äº† `symbol`ï¼Œé‰´äºä¹‹å‰ä¸€ç›´æ²¡æœ‰æ³¨æ„è¿™ä¸ªæ•°æ®ç±»å‹ï¼Œåœ¨ä»Šå¤©è¡¥ä¸Šã€‚ `symbol` æ˜¯ ES6 æ–°å¢çš„**åŸºæœ¬**æ•°æ®ç±»å‹ã€‚å®ƒçš„ä½¿ç”¨å¦‚ä¸‹ï¼š\n```\nconst s1 = Symbol();\nconst s2 = Symbol();\nconsole.log(s1 === s2); // false\n\nconst s3 = new Symbol() // TypeError: Symbol is not a constructor\nSymbol(\"foo\") === Symbol(\"foo\"); // false\n```\n`Symbol()` è¿”å›çš„æ¯ä¸ª `symbol` å€¼éƒ½æ˜¯å”¯ä¸€çš„ï¼Œå¯ä»¥æ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ã€‚å®ƒæœ€å¸¸è¢«ç”¨äºå¯¹è±¡å±æ€§çš„æ ‡è¯†ç¬¦ï¼Œå¦‚ï¼š\n```\nconst obj = {}\nconst foo = Symbol(\"foo\")\nobj[foo] = \"foo\"\nobj.bar = \"bar\"\n\nconsole.log(obj); // { bar: \"bar\" , Symbol(foo): \"foo\"}\nconsole.log(foo in obj); // true\nconsole.log(obj[foo]); // foo\nconsole.log(Object.keys(obj)); // [\"bar\"]\nconsole.log(Object.getOwnPropertySymbols(obj)) // [Symbol(foo)]\n```\nä¹Ÿå°±æ˜¯è¯´ï¼Œ `Object.key()` ä¸ä¼šè¿”å› `symbol` å€¼ï¼ŒåŒç†ï¼Œ`Object.getOwnPropertyNames()`ã€`for..in`ã€`for...of` ä¹Ÿä¸ä¼šè¿”å›ã€‚`JSON.stringify()` ä¹Ÿä¼šå¿½ç•¥ï¼š\n```\nJSON.stringify({[Symbol('foo')]: 'foo'});                 \n// '{}'\n```\n`Symbol` è¿˜æœ‰ä¸¤ä¸ªæ–¹æ³•ã€‚ `Symbol.for(key)` æ˜¯æ ¹æ®æŒ‡å®šçš„ `key` æœç´¢ç°æœ‰çš„ `symbol` å¹¶è¿”å›, å¦‚æœæ‰¾ä¸åˆ°ï¼Œä¼šä½¿ç”¨ `key` åœ¨å…¨å±€çš„ `symbol` æ³¨å†Œè¡¨ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„ `symbol` ã€‚`Symbol.keyFor(sym)` æ˜¯åœ¨å…¨å±€æ³¨å†Œè¡¨ä¸­æ£€ç´¢ï¼Œè¿”å›å…±äº«çš„ `symbol key` ã€‚\n\n\n#### 2019/7/9\nä¸€ä¸ªä¸å¥½çš„ç¼–ç¨‹ä¹ æƒ¯ï¼šè®©å‡½æ•°åœ¨å†…éƒ¨è·å–è‡ªå·±æ‰€éœ€çš„ä¾èµ–ã€‚ä¾‹å¦‚ï¼š\n```\n// ä¸€ä¸ªå¯å¤ç”¨å‡½æ•°\nfunction doSomething(key: string) {\n    return (\n        <Button\n            loading = {key===\"str1\"? Compoment1 : Compoment2}\n        >\n            button\n        </Button>\n    )\n}\n```\n`lodaing` æ‰€éœ€çš„ç»„ä»¶åº”è¯¥æ˜¯ä½œä¸ºå‡½æ•°å‚æ•°ä¼ å…¥çš„ï¼Œä¸ç„¶å¦‚æœæˆ‘ä»¬æ–°å¢äº†ä¸€ä¸ª `key`ï¼Œå¾ˆå®¹æ˜“å¿½ç•¥äº†è¯¥åœ°æ–¹çš„ä¿®æ”¹ã€‚è¿™ä¸ªè§‚ç‚¹ç±»ä¼¼äºä¾èµ–åè½¬ã€‚","source":"_posts/FrontEnd-Daily-Learning.md","raw":"---\ntitle: FrontEnd Daily Learning\ncatalog: true\ndate: 2019-07-11 19:44:53\nsubtitle:\nheader-img:\ntags: FE\n---\n#### å‰è¨€\nğŸ“ recap and cheat sheet ï¼Œè®°å½•æ¯å¤©å­¦åˆ°çš„çŸ¥è¯†/æƒ³æ³•ã€‚\nğŸ”Š æ¯æ—¥ä¸€é—®ï¼šä»Šå¤©ä½ æ¯”æ˜¨å¤©æ›´åšå­¦äº†å—ï¼Ÿ\n\n\n#### 2019/8/25\nä»Šæ—¥è¸©å‘è®°å½•ï¼š\nå±•å¼€è¯­æ³•ï¼ˆspread syntaxï¼‰åªèƒ½å–åˆ° enumerable propertiesã€‚ä¾‹å¦‚ï¼š\n```\nconst imageData = new ImageData(200, 100);\n// ImageData { width: 200, height: 100, data: Uint8ClampedArray[80000] }\nconst result = {...imageData}\n// result åªä¼šåŒ…å« data ï¼Œä¸èƒ½å–åˆ° width å’Œ height\n```\n\n\n#### 2019/8/24\né¿å…ç»„ä»¶é‡æ–°æŒ‚è½½ï¼Œå¯ä»¥ä½¿ç”¨äº‹ä»¶çš„å½¢å¼ï¼š\n```\nclass BussinessProvider {\n  sp$ = new Subject<{url: string, slic: string}>();\n}\n\nclass Canvas {\n  componentDidMount() {\n     this.props.sp$.pipe(takeUntil(this.unmount$)).subscribe(ev => {\n        if (ev.url === this.url) {\n           this.handleSuperPixelChange(ev.slic)\n        }\n     })\n  }\n}\n```\n\n\n#### 2019/8/24\nä¸€ã€Promise\n```\nnew Promise((resolve,reject) => {\n  // do something...\n})\n\npromise.then(onFulfilled[, onRejected]);\npromise.then(value => {\n  // fulfillment\n}, reason => {\n  // rejection\n});\n\npromise.catch(onRejected);\npromise.catch(function(reason) {\n   // rejection\n});\n```\nç®€å•æ¥è¯´ï¼Œ`reject(value)` å¯ä»¥è¢« `promise.then` ç¬¬äºŒä¸ªå‡½æ•°å‚æ•°æ•è·ï¼Œä¹Ÿå¯ä»¥è¢« `promise.catch` æ•è·ã€‚å¦‚æœä¸¤è€…åŒæ—¶å­˜åœ¨ï¼Œä¼šè¢« `promise.then` ç¬¬äºŒä¸ªå‡½æ•°å‚æ•°æ•è·ï¼Œ`promise.catch` æ— è¾“å‡ºã€‚\n\nä¸‹è½½å›¾ç‰‡çš„å…¸å‹ä¾‹å­ï¼š\n```\nfunction loadImage(url) {\n  return new Promise((resolve, reject) => {\n    let img = new Image();\n    // img.onload = () => resolve(img)\n    img.addEventListener('load', e => resolve(img));\n    // img.onerror = () => reject(XXX)\n    img.addEventListener('error', () => {\n      reject(new Error(`Failed to load image's URL: ${url}`));\n    });\n    img.src = url;\n  });\n}\n\nloadImage('http://thecatapi.com/api/images/get?format=src&type=jpg&size=small')\n  .then(img => document.getElementById('image-holder').appendChild(img))\n  .catch(error => console.error(error));\n```\n\näºŒã€await\n`[rv] = await expression`:\n>TL;DR returns the fulfilled value of the promise, \nThe await expression causes async function execution to pause until a Promise is settled, that is fulfilled or rejected, and to resume execution of the async function after fulfillment. When resumed, the value of the await expression is that of the fulfilled Promise.\nIf the Promise is rejected, the await expression throws the rejected value.\nIf the value of the expression following the await operator is not a Promise, it's converted to a resolved Promise.\n\n\n#### 2019/8/23\n`String.prototype.localeCompare()`\n> return a number, indicating whether the reference string comes before, after or is the same as the compareString in sort order. Returns one of three values:\n-1: if the reference string is sorted before the compareString\n 0: if the two strings are equal\n 1: if the reference string is sorted after the compareString\n\n`Array.prototype.sort()`\n>  sorts the elements of an array in place and returns the sorted array. \n\n```\nitems.sort((a,b) => a.localeCompare(b))\n```\n\n\n#### 2019/8/21\nä»Šæ—¥é˜…è¯»ï¼š\n[What is the difference between â€œnpm installâ€ and â€œnpm ciâ€?](https://stackoverflow.com/questions/52499617/what-is-the-difference-between-npm-install-and-npm-ci)\n[Everything You Wanted To Know About package-lock.json But Were Too Afraid To Ask](https://medium.com/coinmonks/everything-you-wanted-to-know-about-package-lock-json-b81911aa8ab8)\n\n\n#### 2019/8/20\næ¨¡ä»¿ react hook `useState` çš„ç¬¬äºŒä¸ªå‚æ•°ï¼š\n&emsp;&emsp;å› ä¸ºåœ¨ jest æµ‹è¯•ä¸­æŸä¸ªå‡½æ•°çš„å‚æ•°æ˜¯ `useState` çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œå†™äº†ä¸€ä¸ªæ›¿ä»£ï¼Œä¸è¿‡ä¸ç¡®å®šæ˜¯å¦æœ‰é”™ã€‚ğŸ˜³\n```\n// for example\nconst [str,setStr] = useState<string[]>([]);\n\n// fake setStr\nlet str:string[] = [];\nconst setStr = (val: string[] | ((prev:string[]) => string[])) => {\n  if (typeof val === \"object\") {\n    str = val;\n  } else if (typeof val === \"function\") {\n    str = val(str)\n  }\n}\n```\n\n#### 2019/8/19\nä»Šæ—¥é˜…è¯»ï¼š[What is rel=noopener noreferrer link](https://searchenginelaws.com/seo/what-is-rel-noopener-noreferrer-tag/)\n&emsp;&emsp;ä½¿ç”¨ `a` æ ‡ç­¾ï¼Œä¸”å±æ€§ `target=\"_blank\"` æ—¶ï¼Œéœ€è¦åŠ ä¸Š `rel=\"noopener noreferrer\"` ã€‚å¯ä»¥é˜²æ­¢æ–°çª—å£åˆ©ç”¨ `window.opener` çš„ç‰¹æ€§çªƒå–åŸçª—å£ä¿¡æ¯ã€‚å…·ä½“è€Œè¨€ï¼Œå¦‚æœ window A æ‰“å¼€äº† window Bï¼Œé‚£ä¹ˆ B.opener ä¼šè¿”å› Aã€‚å¦‚æœåŠ ä¸Š `rel=\"noopener\"` ï¼Œä¼šè¿”å› null ã€‚\n\n\n#### 2019/8/12\nä¸€ã€download files using axios\n```\nimport axios from \"axios\"\n\naxios.get(url,{\n  responseType: 'blob', // important\n  headers: {\n    'Authorization': AuthStr \n  }\n}).then(resp => {\n  const {data} = resp;\n  const file = new File([data],\"data.txt\");\n  const objectURL = URL.createObjectURL(file);\n  const a = document.createElement(\"a\");\n  a.href = objectURL;\n  a.download = \"data.txt\";\n  a.click();\n  URL.revokeObjectURL(objectURL);\n})\n```\n&emsp;&emsp;å¦‚æœæ˜¯å•æ¬¡ç‚¹å‡»ä¸‹è½½å¤šä¸ªæ–‡ä»¶ï¼ŒChrome åªä¼šå¼¹å‡ºä¸€ä¸ªå¼¹çª—ä¸‹è½½æœ€åä¸€ä¸ªæ–‡ä»¶ã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥åŠ ä¸Š `setTimeout` ï¼Œè§¦å‘å¤šæ¬¡ä¸‹è½½ï¼Œæˆ–æ˜¯åŠ ä¸Š `a.target = \"_blank\"` ï¼Œæ‰“å¼€å¤šä¸ªæ–°çª—å£ã€‚\näºŒã€curl\næŸ¥çœ‹å‘½ä»¤ï¼š\n`curl --help`\n-H æŒ‡å®šHeaderï¼š\n`curl -H \"Authorization: XXXXXXXX\" URL`\n`curl POST -d data -H \"Authorization: XXXXXXXX\" URL`\n\n\n#### 2019/8/9\nä¸€ã€[useRef vs useState: Should we re-render or not?](https://www.codebeast.dev/usestate-vs-useref-re-render-or-not/)\n![FE_20190808](FE_20190809.png)\näºŒã€Hooks ç›‘å¬é”®ç›˜äº‹ä»¶\nkeyCode: https://keycode.info/\n```\nfunction useKeyPress(targetKey) {\n  const [keyPressed, setKeyPressed] = useState(false);\n\n  function downHandler({ key }) {\n    if (key === targetKey) {\n      setKeyPressed(true);\n    }\n  }\n\n  const upHandler = ({ key }) => {\n    if (key === targetKey) {\n      setKeyPressed(false);\n    }\n  };\n\n  useEffect(() => {\n    window.addEventListener('keydown', downHandler);\n    window.addEventListener('keyup', upHandler);\n    return () => {\n      window.removeEventListener('keydown', downHandler);\n      window.removeEventListener('keyup', upHandler);\n    };\n  }, []);\n\n  return keyPressed;\n}\n```\n\n\n#### 2019/8/8\n&emsp;&emsp;å·¥ç¨‹ä¸­ç»å¸¸ä¼šçœ‹åˆ° CI/CD çš„æ¦‚å¿µã€‚CI æŒ‡çš„æ˜¯æŒç»­é›†æˆï¼Œä¾§é‡äºç®€åŒ–å‘å¸ƒå‡†å¤‡å·¥ä½œçš„å®è·µï¼Œæ¯”å¦‚è‡ªåŠ¨æµ‹è¯•ï¼›CD æŒ‡çš„æ˜¯æŒç»­äº¤ä»˜ï¼Œæ„å‘³ç€ä¸ä»…è®©æµ‹è¯•è‡ªåŠ¨åŒ–ï¼Œè®©å‘å¸ƒæµç¨‹ä¹Ÿè‡ªåŠ¨åŒ–äº†ã€‚æ›´å¤šæ¦‚å¿µå¯¹æ¯”å¯ä»¥å‚è€ƒï¼š[Continuous integration VS continuous delivery VS continuous deployment](https://www.atlassian.com/continuous-delivery/principles/continuous-integration-vs-delivery-vs-deployment)\n&emsp;&emsp;ä¸‹é¢è¿™ä¸ªå›¾å¾ˆæ¸…æ™°åœ°æè¿°äº†ä¸‰è€…çš„ä¸åŒï¼š\n![FE_20190808](FE_20190808.png)\n&emsp;&emsp;åœ¨ gitlab ä¸Šçš„å®è·µå¯ä»¥å‚è€ƒï¼š[åŸºäº GitLab CI/CD çš„è‡ªåŠ¨åŒ–æ„å»ºã€å‘å¸ƒå®è·µ](https://mp.weixin.qq.com/s/z2f1i2FgrVGofQR6nKTd1A)\n\n#### 2019/8/7\nTypescript: [Discriminated Unions](https://www.typescriptlang.org/docs/handbook/advanced-types.html#discriminated-unions) \n&emsp;&emsp;å½“æˆ‘ä»¬æŸä¸ªå‚æ•°å¯èƒ½æœ‰å¤šä¸ªç±»å‹ï¼Œè€Œè¿™äº›ç±»å‹ä¸­åˆæœ‰å…¬å…±çš„å±æ€§æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨è¿™ç§å½¢å¼çº¦æŸã€‚\n```\n// Each interface has a kind property with a different string literal type. \n// The kind property is called the discriminant or tag. \ninterface Square {\n    kind: \"square\";\n    size: number;\n}\ninterface Rectangle {\n    kind: \"rectangle\";\n    width: number;\n    height: number;\n}\ninterface Circle {\n    kind: \"circle\";\n    radius: number;\n}\n\n// put the interfaces into a union\ntype Shape = Square | Rectangle | Circle;\n\n// use the discriminated union\nfunction area(s: Shape) {\n    switch (s.kind) {\n        case \"square\": return s.size * s.size;\n        case \"rectangle\": return s.height * s.width;\n        case \"circle\": return Math.PI * s.radius ** 2;\n        default: return assertNever(s); // error here if there are missing cases\n    }\n}\n\n// Exhaustiveness checking \nfunction assertNever(x: never): never {\n    throw new Error(\"Unexpected object: \" + x);\n}\n```\n\n\n#### 2019/8/6\nStack Overflow: [useState set method not reflecting change immediately.](https://stackoverflow.com/questions/54069253/usestate-set-method-not-reflecting-change-immediately)\n&emsp;&emsp;ä»Šå¤©åœ¨å®è·µä¸­å‘ç°ï¼Œ`setState` åé©¬ä¸Šæ‰“å°ï¼Œå¹¶ä¸ä¼šå–åˆ°æ›´æ–°åçš„å€¼ã€‚æŸ¥é˜…èµ„æ–™åå‘ç°è¿™ä¸ªå‡½æ•°æ˜¯ä¸€ä¸ªå¼‚æ­¥çš„å‡½æ•°ï¼Œä¸ä¼šç«‹å³æ›´æ–°ï¼Œä½†ä¼šè§¦å‘é‡æ–°æ¸²æŸ“ã€‚å¦‚ä¸‹ï¼š\n![FE_20190806](FE_20190806.png)\n\n\n#### 2019/8/1\nä¸€ã€[Fetch API](https://javascript.info/fetch-api)\n&emsp;&emsp;ç”¨ fetch æ¥è¯·æ±‚ç½‘ç»œèµ„æºï¼Œå¯ä»¥é…ç½®ä¸åŒçš„å‚æ•°æ¥è§£å†³ç¼“å­˜ã€è·¨åŸŸç­‰é—®é¢˜ï¼Œå¦‚ä¸‹ç¤ºä¾‹ä»£ç ï¼š\n```\n// ä¸ç¼“å­˜è¯·æ±‚ç»“æœ \n// https://stackoverflow.com/questions/29246444/fetch-how-do-you-make-a-non-cached-request\nconst headers = new Headers();\nheaders.append(\"pragma\", \"no-cache\");\nheaders.append(\"cache-control\", \"no-store\");\n\n// å®Œå…¨å¿½ç•¥ http-cache ï¼Œæ¯æ¬¡éƒ½ä»æœåŠ¡å™¨è¯·æ±‚æ•°æ®\n// https://developer.mozilla.org/en-US/docs/Web/API/Request/cache\nconst cache: RequestCache = \"no-store\";\n\n// è¯·æ±‚æ¨¡å¼ï¼Œè‹¥æœ‰çš„è¯·æ±‚ä¼šå› ä¸º cors è€Œå¤±è´¥ï¼Œå¯ä»¥è®¾ç½®ä¸º \"no-cors\"\n// https://developer.mozilla.org/en-US/docs/Web/API/Request/mode\nconst mode: RequestMode = needCors ? \"cors\" : \"no-cors\";\n\nawait fetch(url. {headers, cache, mode})\n  .then(res => res.blob())\n  .then(blob => {\n    // doSomething with blob\n    const url = URL.createObjectURL(blob)\n    let a = document.createElement('a')\n    a.download = 'example.zip'\n    a.href = url\n    document.body.appendChild(a)\n    a.click()\n    document.body.removeChild(a)\n  })\n  .catch(err => {\n    console.log(err)\n  })\n  .finally(() => {\n    // doSomething\n  })\n```\n&emsp;&emsp;å…³äº `res.blob()` ï¼Œå¯ä»¥å‚è€ƒçŸ¥ä¹ä¸Š[è°ˆä¸€è°ˆ Fetch API ä¸­çš„ â€œres.blob()â€](https://zhuanlan.zhihu.com/p/32909043)ï¼›ä¹Ÿå¯ä»¥å‚è€ƒ [fetch documentation](https://github.github.io/fetch/) ï¼Œè¿™ä¸€ç¯‡æ¯”è¾ƒè¯¦ç»†ï¼Œä¹Ÿæä¾›äº†è¾ƒå¤šå…¶ä»–çš„ä¾‹å­ã€‚\nå…³äºæµè§ˆå™¨ç¼“å­˜é—®é¢˜ï¼ŒMedium ä¸Šè¿™ç¯‡ [A Web Developerâ€™s Guide to Browser Caching](https://medium.com/@codebyamir/a-web-developers-guide-to-browser-caching-cc41f3b73e7c) å†™å¾—ä¸é”™ã€‚å¦‚æœå­˜åœ¨ä»£ç†æœåŠ¡å™¨ï¼Œå³ä½¿æˆ‘ä»¬è®¾ç½®äº† `mode: 'no-store'` ï¼Œä»£ç†æœåŠ¡å™¨ä¹Ÿä¼šç¼“å­˜ã€‚ä¸ºäº†é¿å…è¿™ä¸ªæƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ¯æ¬¡å‘é€è¯·æ±‚æ—¶æ„é€ æ–°çš„ URL ï¼ŒåŠ ä¸Šæ—¶é—´æˆ³ `?t=Date.now()` ã€‚ğŸ®ğŸº\näºŒã€Jest\n&emsp;&emsp;æˆ‘ä»¬åœ¨ä½¿ç”¨ jest æµ‹è¯•æ—¶ï¼Œæœ‰æ—¶å€™éœ€è¦å¼•å…¥ä¸€äº›å¤–éƒ¨æ–‡ä»¶/å¤–éƒ¨å˜é‡ï¼Œå¦‚ä» `config.json` æ–‡ä»¶ä¸­å¼•å…¥æŸä¸ªå˜é‡ã€‚ä¸ºäº†åœ¨æµ‹è¯•æ–‡ä»¶ä¸­å¯ä»¥è®¿é—®åˆ°è¯¥å˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ `jest.config.js` ä¸­é…ç½®å…¨å±€å˜é‡ï¼š\n```\nmodule.exports = {\n  globals: {\n    API_BASE: \"\",\n    DATA_API: \"\",\n    TRACK_API: \"\"\n  },\n  setupFiles: [\"./jestSetup.ts\"]\n}\n```\n&emsp;&emsp;ç”±äº `globals` åªæ”¯æŒ JSON æ ¼å¼çš„å˜é‡ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦å®šä¹‰å…¨å±€å‡½æ•°ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ `setupFiles`ã€‚\n```\n// jestSetup.ts\n(global as any).fn= () => {};\n(global as any).variable = \"XXX\";\n```\n\n\n#### 2019/7/31\n1ï¼‰`position: fixed` å’Œ flex å¸ƒå±€æ˜¯ä¸èƒ½åŒæ—¶èµ·ä½œç”¨çš„ã€‚ç»å¯¹å¸ƒå±€è„±ç¦»æ–‡æ¡£æµï¼Œä¸ä¼šå‚ä¸åˆ° flex layout ä¸­ã€‚å¦‚æœæƒ³å®ç°å·¦ä¾§èœå•æ ï¼Œå³ä¾§å†…å®¹ï¼Œä¸¤è€…ä¸åŒæ—¶æ»šåŠ¨ï¼ˆèœå•æ  fixedï¼‰ï¼Œä½†èœå•æ çš„å¤§å°å¯ä»¥æ”¹å˜ï¼ˆflex çˆ¶å¸ƒå±€ï¼‰ã€‚å¯ä»¥è®©çˆ¶å®¹å™¨æ˜¯ flex å¸ƒå±€ï¼Œå·¦ä¾§èœå•æ å’Œå³ä¾§å†…å®¹åŒºåŸŸéƒ½æ˜¯ flex element ï¼Œ èœå•æ å†…éƒ¨å†æœ‰ä¸€ä¸ª `position: fixed` çš„ div ã€‚\n2ï¼‰å¦‚æœæƒ³è®© `position: fixed` çš„å…ƒç´ ç›¸å¯¹çˆ¶å®¹å™¨å®šä½ï¼Œå¯ä»¥ç»™çˆ¶å®¹å™¨å¢åŠ  CSS å±æ€§ `transform: translate(0,0)` ã€‚å‚è€ƒï¼š[MDN - position](https://developer.mozilla.org/en-US/docs/Web/CSS/position)\n> fixed: It is positioned relative to the initial containing block established by the viewport, except when one of its ancestors has a transform, perspective, or filter property set to something other than none. \n\n\n#### 2019/7/30\n`useEffect` ä¸­çš„å¼‚æ­¥è¯·æ±‚ï¼š\n```\n// é”™è¯¯å†™æ³•ï¼Œ return å¿…é¡»æ˜¯ cleanup function\nuseEffect(async () => {\n  const newVal = await asyncCall();\n  setVal(newVal);\n});\n\n// æ­£ç¡®å†™æ³•\nuseEffect(() => {\n  asyncCall().then(resp => setVal(resp.data));\n});\n```\nå¥½æ–‡å…±äº«ï¼š[How to fetch data with React Hooks?](https://www.robinwieruch.de/react-hooks-fetch-data/)ï¼Œä»£ç å¦‚ä¸‹ï¼š\n```\nuseEffect(() => {\n  async function fetchMyAPI() {\n    let url = 'http://something/' + productId;\n    let config = {};\n    const response = await myFetch(url);\n    console.log(response);\n  }  \n\n  fetchMyAPI();\n}, [productId]);\n```\nå¦‚æœè¦ä¿è¯è¯·æ±‚æŒ‰é¡ºåºå‘å‡ºï¼Œå¯ä»¥é‡‡ç”¨å¦‚ä¸‹å†™æ³•ï¼š\n```\nuseEffect(() => {\n  let didCancel = false;\n\n  async function fetchMyAPI() {\n    let url = 'http://something/' + productId;\n    let config = {};\n    const response = await myFetch(url);\n    if (!didCancel) { // Ignore if we started fetching something else\n      console.log(response);\n    } \n  }  \n\n  fetchMyAPI();\n  return () => { didCancel = true; }; // Remember if we start fetching something else\n}, [productId]);\n```\n\n\n#### 2019/7/29\nä¸€ã€[performance.now() vs Date.now()](https://stackoverflow.com/questions/30795525/performance-now-vs-date-now)\n&emsp;&emsp;åœ¨ç¨‹åºä¸­æ‰“å°æ‰§è¡Œæ—¶é—´æ—¶ï¼Œä½¿ç”¨ `performance.now(ï¼‰` æ›´å‡†ç¡®ã€‚\n```\nconst start = performance.now();\ndoSomething();\nconst end = performance.now();\nconsole.log(\"Call to doSomething took \" + (start - end) + \" milliseconds.\");\n```\näºŒã€[Does javascript slice method return a shallow copy?](https://stackoverflow.com/questions/47738344/does-javascript-slice-method-return-a-shallow-copy)\n&emsp;&emsp;mdn ä¸Šå¯¹ `slice()` æ–¹æ³•çš„ä»‹ç»ï¼š\n>The slice() method returns a shallow copy of a portion of an array into a new array object selected from begin to end (end not included) where begin and end represent the index of items in that array. The original array will not be modified.\n\n&emsp;&emsp;æ³¨æ„è¿™é‡Œçš„æµ…å¤åˆ¶æŒ‡çš„æ˜¯å¯¹æ•°ç»„ä¸­å€¼çš„æµ…å¤åˆ¶ï¼Œè€Œä¸æ˜¯å¯¹æ•´ä¸ªæ•°ç»„çš„æµ…å¤åˆ¶ã€‚å¦‚æœæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œåˆ™ä¿®æ”¹æ–°æ•°ç»„æ—¶ï¼ŒåŸæ•°ç»„ä¸ä¼šæ”¹å˜ï¼›å¦‚æœæ˜¯å¯¹è±¡æ•°ç»„ï¼Œä¿®æ”¹æ–°æ•°ç»„å¯¹è±¡å€¼æ—¶ï¼ŒåŸæ•°ç»„ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ã€‚\n```\nconst animals = [{name: 'ant'}, {name: 'bison'}, {name: 'camel'}];\nconst newAnimals = animals.slice(2);\n\nnewAnimals[0].name = 'aaa';\nconsole.log(newAnimals); // [{name: 'aaa'}]\nconsole.log(animals);    // [{name: 'ant'}, {name: 'bison'}, {name: 'aaa'}]\n```\n&emsp;&emsp;æ³¨æ„å¦‚æœæ˜¯é‡æ–°èµ‹å€¼ï¼Œåˆ™ç­‰äºé‡æ–°åˆ†é…ç©ºé—´ï¼Œä¸ä¼šæ”¹å˜åŸæ•°ç»„ã€‚\n```\nconst animals = [{name: 'ant'}, {name: 'bison'}, {name: 'camel'}];\nconst newAnimals = animals.slice(2);\n\nnewAnimals[0] = {name: 'aaa'};\nconsole.log(newAnimals); // [{name: 'aaa'}]\nconsole.log(animals);    // [{name: 'ant'}, {name: 'bison'}, {name: 'camel'}]\n```\n\n#### 2019/7/26\n&emsp;&emsp;åº”ç”¨åœºæ™¯ï¼šæˆ‘ä»¬éœ€è¦è¯·æ±‚å¹¶æ›´æ–°èœå•æ ä¸­ä»»åŠ¡çš„çŠ¶æ€ï¼Œå¦‚æœä¸€ä¸ªè¯·æ±‚å®Œæˆç«‹é©¬æ›´æ–°ä¼šå¯¼è‡´ React é¢‘ç¹åˆ·æ–°ï¼Œéœ€è¦ç¼“å†²æ‰¹å¤„ç†ï¼š\n```\nimport { runInAction } from \"mobx\";\n\nlet handlers: Array<() => void> = [];\nconst runHandlers = () => {\n  runInAction(() => {\n    handlers.forEach(f => f());\n    handlers = [];\n  });\n};\n\nfor (const task of tasks) {\n  const {data} = await requestFn();\n  \n  handlers.push(() => {\n    // deal with data, update state\n    ...\n  });\n\n  if(handlers.length > 30) {\n    runHandlers();\n  }\n}\n\nrunHandlers();\n```\n&emsp;&emsp;ä¸Šè¿°ä»£ç ä¸»è¦æ˜¯åˆ©ç”¨äº†è‡ªå®šä¹‰çš„ `handlers` æ¥æš‚å­˜çŠ¶æ€æ›´æ–°å‡½æ•°ï¼Œä¹‹åä½¿ç”¨ mobx æä¾›çš„ `runInAction` æ‰§è¡Œå‡½æ•°å¹¶æ›´æ–°çŠ¶æ€ï¼Œæ›´æ–°çŠ¶æ€éƒ½éœ€è¦ä½¿ç”¨ `action` å‡½æ•°ï¼Œ `runInAction` æ¥å—ä¸€ä¸ªä»£ç å—å¹¶åœ¨ä¸€ä¸ª(åŒ¿å)æ“ä½œä¸­æ‰§è¡Œï¼Œæœ‰åˆ©äºåŠ¨æ€åˆ›å»ºå’Œæ‰§è¡Œæ“ä½œï¼Œ`runInAction(f) = action(f)()`ã€‚æ­¤å¤–ï¼Œå¿…è¦æ—¶è¿˜å¯åŠ ä¸Š `lodash.memoize(func,[resolver])`ï¼Œè®°å½•ä¸»å‡½æ•°è¯·æ±‚ç»“æœã€‚\n> For one-time-actions runInAction(name?, fn) can be used, which is sugar for action(name, fn)()\n\n\n#### 2019/7/18 \nä¸€ã€ç¼–ç¨‹æ¨¡å¼ï¼š\n&emsp;&emsp; é¦–å…ˆå…ˆè®°ä½è¿™å‡ ç§ç¼–ç¨‹æ¨¡å¼çš„ä¸­æ–‡ï¼šImperative Programming æ˜¯å‘½ä»¤å¼ç¼–ç¨‹ï¼ŒDeclarative Programming æ˜¯å£°æ˜å¼ç¼–ç¨‹ï¼ŒReactive Programming æ˜¯å“åº”å¼ç¼–ç¨‹ã€‚ï¼ˆæµä¸‹äº†è‹±æ–‡ä¸å¥½çš„æ³ªæ°´ï¼‰\n1ï¼‰å…ˆçœ‹å‘½ä»¤å¼ç¼–ç¨‹å’Œå£°æ˜å¼ç¼–ç¨‹çš„åŒºåˆ«ï¼Œç›´æ¥ä¸Šä»£ç ï¼š\n```\n// å‘½ä»¤å¼ç¼–ç¨‹ imperative programming\nconst array = [0,1,2,3,4,5];\nconst output = [];\nfor (let i = 0; i < array.length; i++) {\n  const tmp = array[i] * 2;\n  output.push(tmp)\n};\nconsole.log(output) // => [0,2,4,6,8,10]\n```\n```\n// å£°æ˜å¼ç¼–ç¨‹ declarative programming\nconst array = [0,1,2,3,4,5];\nconst output = array.map(item => item * 2);\nconsole.log(output) // => [0,2,3,6,8,10]\n```\n&emsp;&emsp;å¾ˆæ˜æ˜¾å¯ä»¥çœ‹åˆ°ï¼Œå‘½ä»¤å¼ç¼–ç¨‹çš„å…³æ³¨ç‚¹åœ¨äº how ï¼Œæˆ‘ä»¬éœ€è¦ä¸€æ­¥æ­¥å‘Šè¯‰æœºå™¨æ¥ä¸‹æ¥è¦åšä»€ä¹ˆï¼Œå‘Šè¯‰ä»–æ€ä¹ˆå»éå†ä¸€ä¸ªæ•°ç»„ï¼Œæ€ä¹ˆå»è¿ç®—å¾—åˆ°æœ€åçš„ç»“æœï¼Œæ€ä¹ˆå»è¾“å‡ºï¼›å£°æ˜å¼ç¼–ç¨‹çš„å…³æ³¨ç‚¹åœ¨äº what ï¼Œæˆ‘ä»¬åªå…³æ³¨æœ€åçš„ç»“æœï¼Œç”±æœºå™¨è‡ªå·±å»æ‘¸ç´¢è¿‡ç¨‹ï¼Œå¦‚ç›´æ¥è°ƒç”¨ `map` å‡½æ•°ï¼Œåªå‘Šè¯‰ç¨‹åºæˆ‘ä»¬éœ€è¦ä¸€ä¸ª2å€è¾“å‡ºã€‚\n2ï¼‰æ¥ç€çœ‹å£°æ˜å¼ç¼–ç¨‹å’Œå“åº”å¼ç¼–ç¨‹çš„å¯¹æ¯”\n&emsp;&emsp;å¯ä»¥é˜…è¯»ï¼š[Imperative vs Reactive](https://codepen.io/HunorMarton/post/imperative-vs-reactive)ï¼Œè§£é‡Šå¾ˆæ¸…æ™°ï¼Œæ¯”å–»ä¹Ÿå¾ˆå½¢è±¡ï¼Œä½†æˆ‘è§‰å¾—æ–‡ç« é‡Œçš„ Imperative åº”è¯¥æ”¹æˆ Declarative æ¯”è¾ƒå‡†ç¡®ã€‚ç»§ç»­æ²¿ç”¨ä¸Šé¢çš„ä¾‹å­ï¼Œä¿®æ”¹ä¸€ä¸‹å£°æ˜å¼ç¼–ç¨‹çš„ä¾‹å­ï¼š\n```\n// å£°æ˜å¼ç¼–ç¨‹ declarative programming\nconst array = [1,2];\nconst output = array.map(item => item * 2);\noutput.forEach(item => console.log(item)) // => 2 4\narray.push(3);  // => no output \narray.push(4);  // => no output\n```\nå“åº”å¼ç¼–ç¨‹çš„ä¾‹å­ï¼š\n```\nimport { Subject } from `rxjs`;\nlet array = new Subject();\narray.next(1);\narray.next(2);\n\nconst output = array.map(item => item * 2);\noutput.forEach(item => console.log(item)); // => 2 4\n\narray.next(3); // => 6\narray.next(4); // => 8\n```\n&emsp;&emsp;é¦–å…ˆè¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸¤ç§æ–¹å¼ä¸­çš„ `map` ï¼Œ `forEach` ç­‰å‡½æ•°å¹¶ä¸æ˜¯ä¸€æ ·çš„ï¼Œå†…éƒ¨å®ç°æœºåˆ¶æ˜¯ä¸åŒçš„ã€‚æˆ‘ä»¬å¯ä»¥å‘ç°åŒºåˆ«ï¼šåœ¨å£°æ˜å¼ç¼–ç¨‹ä¸­ï¼Œå¦‚æœåœ¨æœ€åå‘åŸæ•°ç»„æ·»åŠ å€¼ï¼Œå¹¶ä¸ä¼šæ‰“å°å‡ºæ¥ï¼Œå› ä¸ºè¿™æ˜¯åœ¨ `console.log` è¯­å¥æ‰§è¡Œåå‘ç”Ÿçš„ã€‚ä½†åœ¨å“åº”å¼ç¼–ç¨‹é‡Œï¼Œä»»ä½•å˜åŒ–éƒ½å¯ä»¥è¢«ååº”å‡ºæ¥ï¼Œå®ƒå¼•å…¥äº†ä¸€ä¸ª**å¼‚æ­¥æ•°æ®æµ**ï¼ˆasynchronous data streamsï¼‰çš„æ¦‚å¿µï¼Œå¯ä»¥éšæ—¶åˆ›å»ºã€æ›´æ”¹æˆ–ç»„åˆè¿™äº›æ•°æ®æµï¼Œæ‰€ä»¥æ‰“å°äº‹ä»¶æ˜¯ä¸€ä¸ª continuous observation caseã€‚\näºŒã€ç±»åº“\n[react-virtualized](https://github.com/bvaughn/react-virtualized) çš„è½»é‡çº§ç‰ˆ [react-window](https://github.com/bvaughn/react-window)ï¼Œç”¨äºé«˜æ•ˆæ¸²æŸ“é•¿åˆ—è¡¨ã€‚\n\n\n#### 2019/7/17 \n&emsp;&emsp;å¦‚æœæˆ‘ä»¬åœ¨é¡¹ç›®ä¸­éœ€è¦è¯·æ±‚å¾ˆå¤šå›¾ç‰‡ï¼Œæƒ³è¦å®ç°è¯·æ±‚å‡ºé”™æ—¶ç»§ç»­å‘é€è¯·æ±‚ï¼ŒæˆåŠŸæ—¶è¿”å›æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ `Promise` ï¼š\n```\nfunction fetchURL(url: string):Promise<Blob> {\n  return Axios.get(url, {responeType: \"blob\"})\n              .then( resp => Promise.resolve(resp.data) )\n              .catch( () => fetchURL(url) )\n}\n```\nä¹‹åå¯ä»¥ä½¿ç”¨ `rxjs` ï¼š\n```\nimport { mergeMap, bufferTime, takeUntil } from \"rxjs/operators\";\n\n[url1,...,url10]\n  .pipe(\n    mergeMap( url => fetchURL(url).then( val => val )),\n    bufferTime(10000)\n  )\n  .subscribe({\n    next: resps => {\n      // do sth with resps:Blob[]\n    }\n  })\n```\n&emsp;&emsp;æ¯æ¬¡é‡åˆ° `rxjs` éƒ½å¾ˆå¤´å¤§ï¼Œç°åœ¨ä¹Ÿæ²¡æœ‰å‘ç°ä¸€ä¸ªæ¯”è¾ƒå®Œå–„æ¸…æ™°çš„æ•™ç¨‹ï¼Œä½†å®ƒåˆçœŸçš„å¾ˆå¼ºå¤§ï¼Œåç»­è¦å¼€ä¸“é¢˜å¥½å¥½å­¦ä¹ è®°å½•è¿™ä¸ªä¸œè¥¿ã€‚\n\n\n#### 2019/7/16\nä¸€ã€ä»Šæ—¥é˜…è¯»ï¼š[How to read an often-changing value from useCallback?](https://reactjs.org/docs/hooks-faq.html#how-to-read-an-often-changing-value-from-usecallback)\nç›´æ¥ä¸Šå®˜ç½‘ä»£ç ï¼š\n```\nfunction Form() {\n  const [text, updateText] = useState('');\n  const textRef = useRef();\n\n  useEffect(() => {\n    textRef.current = text; // Write it to the ref\n  });\n\n  const handleSubmit = useCallback(() => {\n    const currentText = textRef.current; // Read it from the ref\n    alert(currentText);\n  }, [textRef]); // Don't recreate handleSubmit like [text] would do\n\n  return (\n    <>\n      <input value={text} onChange={e => updateText(e.target.value)} />\n      <ExpensiveTree onSubmit={handleSubmit} />\n    </>\n  );\n}\n```\n&emsp;&emsp; ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ `text` çš„å€¼ç»å¸¸å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå³ä½¿ `handleSubmit` ç”¨ `useCallback` åŒ…è£¹äº†ï¼Œè¿˜æ˜¯ä¼šé‡æ–°å£°æ˜ã€‚è§£å†³åŠæ³•æ˜¯ä¼ å…¥ä¸€ä¸ª `ref` å¯¹è±¡ä»£æ›¿åŸå§‹å€¼ã€‚ä¹Ÿå¯ä»¥å†™ä¸€ä¸ª custom hook ï¼š\n1ï¼‰å®˜ç½‘çš„ç‰ˆæœ¬ï¼š\n```\nfunction useEventCallback(fn, dependencies) {\n  const ref = useRef(() => {\n    throw new Error('Cannot call an event handler while rendering.');\n  });\n\n  useEffect(() => {\n    ref.current = fn;\n  }, [fn, ...dependencies]);\n\n  return useCallback(() => {\n    const fn = ref.current;\n    return fn();\n  }, [ref]);\n}\n```\nå®é™…ä½¿ç”¨ï¼š\n```\nfunction Form() {\n  const [text, updateText] = useState('');\n  // Will be memoized even if `text` changes:\n  const handleSubmit = useEventCallback(() => {\n    alert(text);\n  }, [text]);\n\n  return (\n    <>\n      <input value={text} onChange={e => updateText(e.target.value)} />\n      <ExpensiveTree onSubmit={handleSubmit} />\n    </>\n  );\n}\n```\n2ï¼‰å¯¼å¸ˆçš„ç‰ˆæœ¬ï¼šï¼ˆä»–æ¥äº†ï¼Œä»–å¸¦ç€ä»£ç åˆæ¥äº†ï¼‰\n```\n/**\n * @param callback\n * @param oRefs\n */\nexport function useCallbackWithRefs<\n  Refs,\n  Callback extends (...args: any[]) => void\n>(callback: (refs: Refs) => Callback, oRefs: Refs) {\n  const refs = useRef(oRefs);\n  useEffect(\n    () => {\n      refs.current = oRefs;\n    },\n    [oRefs]\n  );\n\n  return useCallback(\n    (...args: any[]) => callback(refs.current)(...args),\n    []\n  ) as Callback;\n}\n```\nå®é™…ä½¿ç”¨ï¼š\n```\nfunction Form() {\n  const [text, updateText] = useState('');\n  \n  // åŸå…ˆçš„ callback ä¹Ÿå¯ä»¥æœ‰å‚æ•°\n  const handleSubmit = useCallbackWithRefs(\n    refs => (params: any) => {\n      // è¦æ³¨æ„åœ¨å‡½æ•°å†…å¿…é¡»ä½¿ç”¨ `refs.xxx`ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨å‡½æ•°å¤–éƒ¨çš„ä»»ä½•å˜é‡ `xxx`\n      console.log(refs.text);\n  }, {text});\n\n  return (\n    <>\n      <input value={text} onChange={e => updateText(e.target.value)} />\n      <ExpensiveTree onSubmit={handleSubmit} />\n    </>\n  );\n}\n```\n&emsp;&emsp;æ€»çš„æ¥è¯´ï¼Œå®˜ç½‘çš„å®ç°æ˜¯å°† `callback` ä½œä¸º `ref` å¯¹è±¡ï¼Œå¹¶ä½œä¸º `useCallback` çš„ä¾èµ–ï¼Œä¸ä¼šé¢‘ç¹æ”¹å˜ï¼›å¦‚æœåœ¨å‡½æ•° `handleSubmit` ä¸­è¦è®¿é—®å¤–éƒ¨å˜é‡ `text` ï¼Œç›´æ¥ä½¿ç”¨ `test` å³å¯ã€‚ç¬¬äºŒç§å®ç°æ–¹å¼æ˜¯æŠŠç»å¸¸å˜åŒ–çš„å€¼ä½œä¸º `ref` å¯¹è±¡ï¼Œè¿”å›å€¼ `useCallback` ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ `refs => callback` ï¼Œä¾èµ–æ˜¯ç©ºæ•°ç»„ï¼›è¿™æ—¶å¦‚æœè¦åœ¨å‡½æ•° `handleSubmit` ä¸­è¦è®¿é—®å¤–éƒ¨å˜é‡ `text` ï¼Œå¿…é¡»ä½¿ç”¨ `refs.test` ï¼Œå¦åˆ™è®¿é—®çš„åªæ˜¯ `test` çš„åˆå§‹å€¼ã€‚\n&emsp;&emsp;React åšå¤§ç²¾æ·±ï¼Œæ¥ä¸‹æ¥è¦å¥½å¥½ç ”è¯»ä¸€ä¸‹è¿™ä¸ª [FAQ](https://reactjs.org/docs/hooks-faq.html)ã€‚\näºŒã€ä»Šæ—¥ç½‘å€\n&emsp;&emsp;ä¸€ä¸ª [emoji copy](https://www.emojicopy.com/) ç½‘ç«™ï¼Œæˆ‘ä»¬ ğŸ‘§ å°±æ˜¯å–œæ¬¢è¿™äº›èŠ±é‡Œèƒ¡å“¨çš„ä¸œè¥¿ã€‚\n\n\n#### 2019/7/15\n&emsp;&emsp;ä»Šå¤©åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ React Hooks åˆè¸©å‘äº†ï¼Œçœ‹æ¥è‡ªå·±å¯¹è¿™éƒ¨åˆ†è¿˜æ˜¯æ²¡æœ‰ç†è§£é€å½»ã€‚åœ¨ä½¿ç”¨ `useCallback` å’Œ `useEffect` æ—¶ï¼Œè¦æ³¨æ„ç¬¬äºŒä¸ªå‚æ•°ï¼Œä¹Ÿå°±æ˜¯ä¼ å…¥çš„ `[deps]`ã€‚å¦‚æœä½¿ç”¨ `useCallback(fn,[deps])` ï¼Œ `[deps]` åº”è¯¥åŒ…å«å‡½æ•° `fn` æ‰€æ¶‰åŠçš„æ‰€æœ‰å˜é‡ï¼›å¦‚æœä½¿ç”¨ `useEffect(fn,[deps])` ï¼Œ å½“ `deps` çš„å€¼å˜åŒ–æ—¶ï¼Œå°±ä¼šæ‰§è¡Œ `fn`ï¼Œå› æ­¤`[deps]` ä¸ä¸€å®šè¦åŒ…å«å‡½æ•° `fn` æ‰€æ¶‰åŠçš„æ‰€æœ‰å˜é‡ï¼Œè€Œæ˜¯åº”è¯¥ä¼ å…¥ä¼šå¼•èµ·è¯¥å‡½æ•°æ‰§è¡Œçš„é‚£äº›å‚æ•°ã€‚\n&emsp;&emsp;ä»Šæ—¥è¸©å‘è®°å½•ï¼šä¸ºäº†ä¼˜åŒ–å­ç»„ä»¶ï¼Œä½œä¸º `props` çš„å‡½æ•°éƒ½ä½¿ç”¨ `useCallback` åŒ…è£¹äº†ï¼Œå¹¶ä¼ å…¥äº†ç©ºæ•°ç»„ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ï¼Œè¡¨ç¤ºæ²¡æœ‰ä¾èµ–ã€‚ä½†æ˜¯å‡½æ•°ä¸­çš„è¿ç®—éœ€è¦ç”¨åˆ°ç»„ä»¶ä¸­ä¸€ä¸ªå˜é‡ï¼Œå¦‚æœæ²¡æœ‰å°†è¯¥å˜é‡ä½œä¸º `deps` ï¼Œè¿™ä¸ªå˜é‡å°±ä¼šä¸€ç›´ä¿æŒåˆå§‹å€¼ï¼Œå€¼å¹¶ä¸ä¼šæ”¹å˜ï¼Œè¿è¡Œç»“æœå°±ä¼šä¸é¢„æœŸä¸ç¬¦ã€‚ï¼ˆçœŸçš„å¤ªè ¢äº†ï¼Œç¼“ç¼“èººå€’ï¼‰\n\n\n#### 2019/7/14\nå‘¨æœ«å½“ç„¶æ˜¯çº¦ä¼šå•¦ã€‚ğŸ˜\n\n\n#### 2019/7/13\nä¸€ã€ä»Šæ—¥é˜…è¯»ï¼š[How to compare oldValues and newValues on React Hooks useEffect?](https://stackoverflow.com/questions/53446020/how-to-compare-oldvalues-and-newvalues-on-react-hooks-useeffect)\n&emsp;&emsp; React class ç»„ä»¶æä¾›äº† `ComponentDidUpdate` ä¹‹ç±»çš„æ–¹æ³•æ¥è·å–åˆ°å½“å‰ `props` å’Œå‰ä¸€ä¸ª `props` ï¼Œå¹¶è¿›è¡Œæ¯”è¾ƒï¼Œå†³å®šæ˜¯å¦è¿›è¡Œæ›´æ–°ã€‚å‡½æ•°å¼ç»„ä»¶åªæœ‰ `useEffect` å‡½æ•°æ¥æ¨¡ä»¿ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œå½“æˆ‘ä»¬éœ€è¦è·å–ç»„ä»¶å…ˆå‰çš„ `props` æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ custom hook ï¼š\n```\nfunction usePrevious(value) {\n  const ref = useRef();\n  useEffect(() => {\n    ref.current = value;\n  });\n  return ref.current;\n}\n```\n&emsp;&emsp;ä¹‹ååœ¨ `useEffect` ä¸­ä½¿ç”¨ä¸Šé¢çš„å‡½æ•°æ¥æ¨¡æ‹Ÿ `ComponentDidUpdate` ï¼š\n```\nconst Component = (props) => {\n    const {receiveAmount, sendAmount } = props\n    const prevAmount = usePrevious({receiveAmount, sendAmount});\n    useEffect(() => {\n        if(prevAmount.receiveAmount !== receiveAmount) {\n\n         // process here\n        }\n        if(prevAmount.sendAmount !== sendAmount) {\n\n         // process here\n        }\n    }, [receiveAmount, sendAmount])\n}\n```\n&emsp;&emsp;æœ‰æ—¶å€™åœ¨ debug æ—¶ï¼Œæˆ‘ä»¬æƒ³çŸ¥é“ç»„ä»¶ä¸ºä»€ä¹ˆä¼šé‡æ–°æ¸²æŸ“ï¼Œæ˜¯é‚£äº› `props` æ›´æ–°äº†ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸Šé¢çš„æ–¹æ³•æ¥è·å– `prevProps`ï¼Œå¹¶åœ¨å‡½æ•°ç»„ä»¶æœ€å¼€å§‹æ—¶å†™ä¸€ä¸ª `useEffect` å°†å‚æ•°éƒ½æ‰“å°å‡ºæ¥ï¼Œä½¿ç”¨ `===` æ¯”è¾ƒã€‚ \n\n\n\n#### 2019/7/12\nä¸€ã€ä»Šæ—¥æŠ€èƒ½\n&emsp;&emsp;é¡¹ç›®ä¸­ç»å¸¸ä¼šæ¶‰åŠåˆ° JSON å­—ç¬¦ä¸²çš„è§£æï¼Œè§£æå‡ºé”™å°±æ‰‘è¡—äº†ï¼Œä¸€èˆ¬æ˜¯ç”¨ `try {...} catch {...}` åŒ…è£¹ã€‚ä»Šå¤©å¯¼å¸ˆåœ¨ code review æ—¶å»ºè®®æˆ‘ä½¿ç”¨å¦‚ä¸‹å‡½æ•°ï¼Œè¯¥å‡½æ•°ä¹Ÿå¯ä»¥è¦†ç›–ç©ºå­—ç¬¦ä¸²çš„æ£€æµ‹ï¼š\n```\nfunction safeJsonParse<T>(str): { ok: true, value: T } | { ok: false } {\n  try {\n    return {\n      ok: true,\n      value: JSON.parse(str)\n    }\n  } catch {\n    return {\n      ok: false\n    }\n  }\n}\n```\näºŒã€ä»Šæ—¥é˜…è¯»ï¼š[ä»æµè§ˆå™¨å¤šè¿›ç¨‹åˆ°JSå•çº¿ç¨‹ï¼ŒJSè¿è¡Œæœºåˆ¶æœ€å…¨é¢çš„ä¸€æ¬¡æ¢³ç†](https://imweb.io/topic/5b72d4ef15554e6d3409f817)ã€‚\n&emsp;&emsp;è¿™ä¸€ç¯‡å¾ˆå¥½åœ°æ¢³ç†äº†è¿›ç¨‹ã€çº¿ç¨‹ã€æµè§ˆå™¨**å¤šè¿›ç¨‹**ã€æµè§ˆå™¨å†…æ ¸**å¤šçº¿ç¨‹**ã€JSå•çº¿ç¨‹ã€JSè¿è¡Œæœºåˆ¶çš„ç›¸å…³çŸ¥è¯†ï¼Œå¾ˆè¿è´¯ï¼Œå»ºè®®æ—¶ä¸æ—¶å›é¡¾ã€‚ç®€å•è®°å½•å‡ ä¸ªçŸ¥è¯†ç‚¹ï¼š\n1ï¼‰è¿›ç¨‹æ˜¯CPUèµ„æºåˆ†é…çš„æœ€å°å•ä½ï¼Œçº¿ç¨‹æ˜¯CPUè°ƒåº¦çš„æœ€å°å•ä½ã€‚ï¼ˆæƒ³å½“å¹´è€ƒæ“ä½œç³»ç»Ÿçš„æ—¶å€™è¿˜èƒŒå¾—æ»šç“œçƒ‚ç†Ÿï¼‰\n2ï¼‰**æµè§ˆå™¨æ˜¯å¤šè¿›ç¨‹çš„**ï¼ŒåŒ…æ‹¬çš„ä¸»è¦è¿›ç¨‹æœ‰ï¼š\n- Browserè¿›ç¨‹ï¼ˆæµè§ˆå™¨çš„ä¸»è¿›ç¨‹ï¼Œåªæœ‰ä¸€ä¸ªï¼‰\n- æµè§ˆå™¨æ¸²æŸ“è¿›ç¨‹ï¼ˆæµè§ˆå™¨å†…æ ¸ï¼ŒRendererè¿›ç¨‹ï¼Œæ¸²æŸ“è¿›ç¨‹ï¼Œå†…éƒ¨æ˜¯å¤šçº¿ç¨‹çš„ï¼‰ï¼šé»˜è®¤æ¯ä¸ªTabä¸€ä¸ªè¿›ç¨‹\n- ç¬¬ä¸‰æ–¹æ’ä»¶è¿›ç¨‹\n- GPUè¿›ç¨‹ï¼š3Dç»˜åˆ¶\n\n3ï¼‰é‡ç‚¹æ˜¯æµè§ˆå™¨å†…æ ¸ï¼Œå®ƒæ˜¯å¤šçº¿ç¨‹çš„ï¼Œä¸»è¦å¸¸é©»çº¿ç¨‹æœ‰ï¼š\n- GUIæ¸²æŸ“çº¿ç¨‹ï¼šæ¸²æŸ“é¡µé¢ï¼Œè§£æHTMLï¼ŒCSSï¼Œæ„å»ºDOMæ ‘å’ŒRenderObjectæ ‘ï¼Œå¸ƒå±€å’Œç»˜åˆ¶ï¼Œrepaint å’Œ reflow ç­‰ã€‚\n- JSå¼•æ“çº¿ç¨‹ï¼šå¤„ç†ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼Œä¸ GUI æ¸²æŸ“çº¿ç¨‹æ˜¯äº’æ–¥çš„ã€‚\n- äº‹ä»¶è§¦å‘çº¿ç¨‹ï¼šæ§åˆ¶äº‹ä»¶å¾ªç¯ï¼ŒæŠŠäº‹ä»¶æ·»åŠ åˆ°ä»»åŠ¡é˜Ÿåˆ—çš„æœ«å°¾ã€‚\n- å®šæ—¶è§¦å‘çº¿ç¨‹ï¼š`setTimeout` å’Œ `setInterval`ï¼ŒåŒæ ·ä¹Ÿæ˜¯è®¡æ—¶å®Œæ¯•åæ·»åŠ åˆ°é˜Ÿåˆ—æœ«å°¾ã€‚\n- å¼‚æ­¥ http è¯·æ±‚çº¿ç¨‹\n\n4ï¼‰Browserè¿›ç¨‹å’Œæµè§ˆå™¨å†…æ ¸ä¹‹é—´æ˜¯éœ€è¦é€šä¿¡çš„\n5ï¼‰æ—¶é—´å¾ªç¯æœºåˆ¶ `Event Loop` ï¼šJSåˆ†ä¸ºåŒæ­¥ä»»åŠ¡å’Œå¼‚æ­¥ä»»åŠ¡ï¼ŒåŒæ­¥ä»»åŠ¡éƒ½ä¼šåœ¨ä¸»çº¿ç¨‹ä¸Šè¿è¡Œï¼Œå½¢æˆä¸€ä¸ªæ‰§è¡Œæ ˆï¼›ä¸»çº¿ç¨‹ä¹‹å¤–ï¼Œç”±äº‹ä»¶è§¦å‘çº¿ç¨‹ç®¡ç†ä¸€ä¸ª**ä»»åŠ¡é˜Ÿåˆ—/äº‹ä»¶é˜Ÿåˆ—**ï¼Œå¼‚æ­¥ä»»åŠ¡çš„è¿è¡Œç»“æœä¼šè¢«æ·»åŠ åˆ°ä»»åŠ¡é˜Ÿåˆ—ä¸­ã€‚ä¸€æ—¦æ‰§è¡Œæ ˆä¸­æ‰€æœ‰åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œç³»ç»Ÿå°±ä¼šè¯»å–ä»»åŠ¡é˜Ÿåˆ—ï¼Œå°†å¯è¿è¡Œçš„å¼‚æ­¥ä»»åŠ¡æ·»åŠ åˆ°æ‰§è¡Œæ ˆä¸­å¼€å§‹æ‰§è¡Œã€‚ \n6ï¼‰è¿›é˜¶ï¼šmacrotask / task å’Œ microtask/ jobã€‚ES6ä¸­çš„ `Promise` å°±å±äº microtask å¾®ä»»åŠ¡ ï¼Œè€Œä¸»ä»£ç å—ï¼Œäº‹ä»¶é˜Ÿåˆ—ä¸­çš„æ—¶é—´å¦‚ `setTimeout` å’Œ `setInterval` å°±å±äº macrotask å®ä»»åŠ¡ã€‚æ€»ç»“çš„è¿è¡Œæœºåˆ¶å°±æ˜¯ï¼š\n- æ‰§è¡Œå®ä»»åŠ¡ã€‚ï¼ˆä»æ‰§è¡Œæ ˆä¸­è·å–ï¼Œå¦‚æœæ²¡æœ‰å°±ä»äº‹ä»¶é˜Ÿåˆ—ä¸­è·å–ï¼‰\n- æ‰§è¡Œè¿‡ç¨‹ä¸­å¦‚æœé‡åˆ°å¾®ä»»åŠ¡ï¼Œå°±æ·»åŠ åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ— Job Queues ä¸­ã€‚ï¼ˆä½œè€…çŒœæµ‹è¿™ä¸ªé˜Ÿåˆ—ç”±JSå¼•æ“çº¿ç¨‹ç»´æŠ¤ï¼Œå› ä¸ºæ˜¯åœ¨ä¸»çº¿ç¨‹ä¸‹æ— ç¼æ‰§è¡Œçš„ï¼‰\n- å®ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åï¼Œç«‹å³ä¾æ¬¡æ‰§è¡Œå½“å‰å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­æ‰€æœ‰å¾®ä»»åŠ¡ã€‚\n- æ£€æŸ¥æ¸²æŸ“ï¼Œç”± GUI çº¿ç¨‹æ¥ç®¡ã€‚\n- æ¸²æŸ“å®Œæ¯•åï¼Œç”± JS å¼•æ“çº¿ç¨‹æ¥ç®¡ï¼Œä»æ—¶é—´é˜Ÿåˆ—ä¸­è·å–å¹¶æ‰§è¡Œä¸‹ä¸€ä¸ªå®ä»»åŠ¡ã€‚\n\n7ï¼‰åœ¨ç¬¬å…­ç‚¹ä¸­æåˆ°çš„æ˜¯ä¸€ä¸ªè¿›é˜¶çš„æ¦‚å¿µï¼Œå¯¹åº”ä¸€é“é¢˜ç›®ï¼Œå¦‚æœä»£ç ä¸­ä¾æ¬¡æœ‰ `setTimeout` å’Œ `Promise` ï¼Œæ˜¯ä¼šå…ˆæ‰“å°å‡º `Promise` çš„æ‰§è¡Œç»“æœçš„ã€‚\n\n\n#### 2019/7/11\n&emsp;&emsp; React 16.8 æå‡ºäº† `hook` çš„æ¦‚å¿µï¼Œå‡½æ•°å¼ç»„ä»¶ä¹Ÿå¯ä»¥æ‹¥æœ‰è‡ªå·±çš„çŠ¶æ€ã€‚ç°åœ¨çš„å·¥ä½œé¡¹ç›®å·²ç»æ‘’å¼ƒäº† `class` ï¼Œæ”¹ç”¨å‡½æ•°å¼ç»„ä»¶ï¼Œæ­£åœ¨æ…¢æ…¢æ‘¸ç´¢ä¸­ã€‚ä»Šå¤©åœ¨è…¾è®¯[IMWebå‰ç«¯åšå®¢](http://imweb.io/)ä¸­çœ‹åˆ°äº†ä¸¤ç¯‡ä»‹ç» `React hook` çš„æ–‡ç« ï¼Œå—ç›ŠåŒªæµ…ï¼Œç®€å•è®°å½•ä¸€ä¸‹ã€‚\n ä¸€ã€[react hookâ€”â€”ä½ å¯èƒ½ä¸æ˜¯â€œæˆ‘â€æ‰€è®¤è¯†çš„useEffect](https://imweb.io/topic/5cd845cadcd62f86299fcd76)\n&emsp;&emsp;è¿™ç¯‡ä»‹ç»äº† `useEffect` è¿™ä¸ªAPIï¼Œç”¨å®ƒæ¨¡æ‹Ÿäº†classç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ã€‚`useEffect` ç”¨äºæ‰§è¡Œå‰¯ä½œç”¨ï¼Œç›¸å½“äº `ComponentDidMount` å’Œ `ComponentDidUpdate`ã€‚è¯¥APIæœ‰ä¸¤ä¸ªå‚æ•°å’Œä¸€ä¸ªè¿”å›å€¼ã€‚ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå‰¯ä½œç”¨å‡½æ•°ï¼Œè¿”å›å€¼æ˜¯æ¸…é™¤å‡½æ•°ï¼Œç›¸å½“äº `ComponentWillUnmount`ï¼Œæ¯ä¸€æ¬¡ `render` éƒ½ä¼šæ‰§è¡Œå‰¯ä½œç”¨å’Œæ¸…é™¤ä¸Šä¸€æ¬¡å‰¯ä½œç”¨ã€‚**ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä¼ å…¥çš„æ˜¯å‰¯ä½œç”¨å‡½æ•°æ‰€éœ€è¦çš„ä¾èµ–ï¼Œå½“ä»»ä¸€ä¾èµ–æ›´æ–°æ—¶ï¼Œä¼šé‡æ–°ç”Ÿæˆä¸€ä¸ªæ–°çš„å‰¯ä½œç”¨å¹¶æ‰§è¡Œï¼›å¦‚æœä¼ å…¥ä¸€ä¸ªç©ºæ•°ç»„ï¼Œæ²¡æœ‰ä¾èµ–ï¼Œåªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œç›¸å½“äº `ComponentDidMount`ï¼›å¦‚æœä¸ä¼ ï¼Œå°±æ˜¯æ²¡æœ‰è¯´æ˜è‡ªå·±æœ‰æ²¡æœ‰ä¾èµ–ï¼ˆæ³¨æ„æ˜¯ä¸çŸ¥é“æœ‰æ²¡æœ‰ï¼Œä¸æ˜¯æ²¡æœ‰ï¼ï¼‰ï¼Œæ¯æ¬¡ `render` æ—¶å°±æ‰§è¡Œï¼Œç›¸å½“äº `ComponentDidUpdate` ã€‚**\n&emsp;&emsp; æœ€åè¿˜è®²äº† `useEffect` å’Œ `useLayoutEffect` çš„åŒºåˆ«ï¼Œç®€å•æ¥è¯´å‰è€…æ˜¯å¼‚æ­¥çš„ï¼Œåè€…æ˜¯åŒæ­¥çš„ã€‚è¿˜æ²¡å¥½å¥½æ·±å…¥è¿™éƒ¨åˆ†ï¼ŒTODOã€‚\näºŒã€[å¯èƒ½ä½ çš„reactå‡½æ•°ç»„ä»¶ä»æ¥æ²¡æœ‰ä¼˜åŒ–è¿‡](https://imweb.io/topic/5d1e3657f7b5692b080f2651)\n&emsp;&emsp;ä¼˜åŒ–é—®é¢˜çœŸæ˜¯æˆ‘ä¸€ä¸ªç—›ç‚¹ã€‚è¿™ç¯‡æ–‡ç« å¾ˆæ¸…æ¥šåœ°è§£é‡Šäº† `Hooks` ä¸€äº›å¯ç”¨äºç»„ä»¶ä¼˜åŒ–çš„APIã€‚å¼ºæ¨ï¼\n&emsp;&emsp; ç‰¹åˆ«åœ°ï¼Œæ–‡ç« ä»‹ç»äº†å½“å‡½æ•°ç»„ä»¶ä¸­ä¼ å…¥çš„ `props` å€¼ä¸ºå‡½æ•°æ—¶ï¼Œç”±äºæ¯ä¸€æ¬¡æ‰§è¡Œæˆ–é‡æ–°æ‰§è¡Œï¼Œä½œç”¨åŸŸé‡Œé¢ä¸€åˆ‡éƒ½æ˜¯é‡æ–°å¼€å§‹ï¼Œå‡½æ•°ä¸æ˜¯ç®€å•æ•°æ®ç±»å‹ï¼Œä¸èƒ½ç”»ä¸Šç­‰å·ï¼Œå­ç»„ä»¶éƒ½ä¼šé‡æ–°æ¸²æŸ“ã€‚é’ˆå¯¹è¿™ä¸ªé—®é¢˜æ–‡ç« æå‡ºäº†å‡ ç§è§£å†³åŠæ³•ï¼š\n1ï¼‰ ä½œä¸º `props` çš„å‡½æ•°åœ¨å‡½æ•°ç»„ä»¶å¤–å®šä¹‰ï¼Œå‡½æ•°ç»„ä»¶ç”¨ `React.memo()` åŒ…è£¹ã€‚\n &emsp;&emsp; `React.memo()` ç±»ä¼¼äº `PureComponent` å’Œ `ComponentDidUpdate` ï¼Œå¦‚æœå‡½æ•°ç»„ä»¶çš„ `props` å€¼éƒ½ä¸€æ ·ï¼Œå°±ä¼šè·³è¿‡è¯¥ç»„ä»¶çš„æ‰§è¡Œï¼Œå‡å°‘ä¸å¿…è¦çš„æ¸²æŸ“ï¼Œå®ç°æ€§èƒ½ä¼˜åŒ–ã€‚\n2ï¼‰ ä½œä¸º `props` çš„å‡½æ•°åœ¨å‡½æ•°ç»„ä»¶å†…å®šä¹‰ï¼Œä½¿ç”¨`useCallBack` æˆ– `useMemo`åŒ…è£¹ï¼Œå‡½æ•°ç»„ä»¶ç”¨ `React.memo()` åŒ…è£¹ã€‚\n&emsp;&emsp; `useCallback(() => {}, [deps])` è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œå½“ `deps` ä¸å˜æ—¶ï¼ˆå¦‚ä¼ å…¥ç©ºæ•°ç»„ï¼Œè¡¨ç¤ºæ²¡æœ‰ä¾èµ–ï¼‰ï¼Œéƒ½æ˜¯åŒä¸€ä¸ªå‡½æ•°ã€‚`const a = useMemo(() => memorizeValue, [deps])`ï¼Œå½“ `deps` ä¸å˜æ—¶ï¼Œ`a` çš„å€¼è¿˜æ˜¯ä¸Šæ¬¡çš„ `memorizeValue`ï¼Œçœå»äº†é‡æ–°è®¡ç®—çš„è¿‡ç¨‹ã€‚\n&emsp;&emsp; æ³¨æ„å½“ `memorizeValue` æ˜¯ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œ`useCallback(fn, inputs) <=> useMemo(() => fn, inputs)`ã€‚\n\n\n#### 2019/7/10\n&emsp;&emsp;ä»Šå¤©åœ¨é¡¹ç›®ä¸­æ¥è§¦åˆ°äº† `symbol`ï¼Œé‰´äºä¹‹å‰ä¸€ç›´æ²¡æœ‰æ³¨æ„è¿™ä¸ªæ•°æ®ç±»å‹ï¼Œåœ¨ä»Šå¤©è¡¥ä¸Šã€‚ `symbol` æ˜¯ ES6 æ–°å¢çš„**åŸºæœ¬**æ•°æ®ç±»å‹ã€‚å®ƒçš„ä½¿ç”¨å¦‚ä¸‹ï¼š\n```\nconst s1 = Symbol();\nconst s2 = Symbol();\nconsole.log(s1 === s2); // false\n\nconst s3 = new Symbol() // TypeError: Symbol is not a constructor\nSymbol(\"foo\") === Symbol(\"foo\"); // false\n```\n`Symbol()` è¿”å›çš„æ¯ä¸ª `symbol` å€¼éƒ½æ˜¯å”¯ä¸€çš„ï¼Œå¯ä»¥æ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ã€‚å®ƒæœ€å¸¸è¢«ç”¨äºå¯¹è±¡å±æ€§çš„æ ‡è¯†ç¬¦ï¼Œå¦‚ï¼š\n```\nconst obj = {}\nconst foo = Symbol(\"foo\")\nobj[foo] = \"foo\"\nobj.bar = \"bar\"\n\nconsole.log(obj); // { bar: \"bar\" , Symbol(foo): \"foo\"}\nconsole.log(foo in obj); // true\nconsole.log(obj[foo]); // foo\nconsole.log(Object.keys(obj)); // [\"bar\"]\nconsole.log(Object.getOwnPropertySymbols(obj)) // [Symbol(foo)]\n```\nä¹Ÿå°±æ˜¯è¯´ï¼Œ `Object.key()` ä¸ä¼šè¿”å› `symbol` å€¼ï¼ŒåŒç†ï¼Œ`Object.getOwnPropertyNames()`ã€`for..in`ã€`for...of` ä¹Ÿä¸ä¼šè¿”å›ã€‚`JSON.stringify()` ä¹Ÿä¼šå¿½ç•¥ï¼š\n```\nJSON.stringify({[Symbol('foo')]: 'foo'});                 \n// '{}'\n```\n`Symbol` è¿˜æœ‰ä¸¤ä¸ªæ–¹æ³•ã€‚ `Symbol.for(key)` æ˜¯æ ¹æ®æŒ‡å®šçš„ `key` æœç´¢ç°æœ‰çš„ `symbol` å¹¶è¿”å›, å¦‚æœæ‰¾ä¸åˆ°ï¼Œä¼šä½¿ç”¨ `key` åœ¨å…¨å±€çš„ `symbol` æ³¨å†Œè¡¨ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„ `symbol` ã€‚`Symbol.keyFor(sym)` æ˜¯åœ¨å…¨å±€æ³¨å†Œè¡¨ä¸­æ£€ç´¢ï¼Œè¿”å›å…±äº«çš„ `symbol key` ã€‚\n\n\n#### 2019/7/9\nä¸€ä¸ªä¸å¥½çš„ç¼–ç¨‹ä¹ æƒ¯ï¼šè®©å‡½æ•°åœ¨å†…éƒ¨è·å–è‡ªå·±æ‰€éœ€çš„ä¾èµ–ã€‚ä¾‹å¦‚ï¼š\n```\n// ä¸€ä¸ªå¯å¤ç”¨å‡½æ•°\nfunction doSomething(key: string) {\n    return (\n        <Button\n            loading = {key===\"str1\"? Compoment1 : Compoment2}\n        >\n            button\n        </Button>\n    )\n}\n```\n`lodaing` æ‰€éœ€çš„ç»„ä»¶åº”è¯¥æ˜¯ä½œä¸ºå‡½æ•°å‚æ•°ä¼ å…¥çš„ï¼Œä¸ç„¶å¦‚æœæˆ‘ä»¬æ–°å¢äº†ä¸€ä¸ª `key`ï¼Œå¾ˆå®¹æ˜“å¿½ç•¥äº†è¯¥åœ°æ–¹çš„ä¿®æ”¹ã€‚è¿™ä¸ªè§‚ç‚¹ç±»ä¼¼äºä¾èµ–åè½¬ã€‚","slug":"FrontEnd-Daily-Learning","published":1,"updated":"2019-12-08T08:32:53.615Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck6vknhe80001osuewtvta71u","content":"<h4 id=\"å‰è¨€\">å‰è¨€</h4>\n<p>ğŸ“ recap and cheat sheet ï¼Œè®°å½•æ¯å¤©å­¦åˆ°çš„çŸ¥è¯†/æƒ³æ³•ã€‚<br>\nğŸ”Š æ¯æ—¥ä¸€é—®ï¼šä»Šå¤©ä½ æ¯”æ˜¨å¤©æ›´åšå­¦äº†å—ï¼Ÿ</p>\n<h4 id=\"2019825\">2019/8/25</h4>\n<p>ä»Šæ—¥è¸©å‘è®°å½•ï¼š<br>\nå±•å¼€è¯­æ³•ï¼ˆspread syntaxï¼‰åªèƒ½å–åˆ° enumerable propertiesã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const imageData = new ImageData(200, 100);</span><br><span class=\"line\">// ImageData &#123; width: 200, height: 100, data: Uint8ClampedArray[80000] &#125;</span><br><span class=\"line\">const result = &#123;...imageData&#125;</span><br><span class=\"line\">// result åªä¼šåŒ…å« data ï¼Œä¸èƒ½å–åˆ° width å’Œ height</span><br></pre></td></tr></table></figure>\n<h4 id=\"2019824\">2019/8/24</h4>\n<p>é¿å…ç»„ä»¶é‡æ–°æŒ‚è½½ï¼Œå¯ä»¥ä½¿ç”¨äº‹ä»¶çš„å½¢å¼ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">class BussinessProvider &#123;</span><br><span class=\"line\">  sp$ = new Subject&lt;&#123;url: string, slic: string&#125;&gt;();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class Canvas &#123;</span><br><span class=\"line\">  componentDidMount() &#123;</span><br><span class=\"line\">     this.props.sp$.pipe(takeUntil(this.unmount$)).subscribe(ev =&gt; &#123;</span><br><span class=\"line\">        if (ev.url === this.url) &#123;</span><br><span class=\"line\">           this.handleSuperPixelChange(ev.slic)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">     &#125;)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"2019824\">2019/8/24</h4>\n<p>ä¸€ã€Promise</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">new Promise((resolve,reject) =&gt; &#123;</span><br><span class=\"line\">  // do something...</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">promise.then(onFulfilled[, onRejected]);</span><br><span class=\"line\">promise.then(value =&gt; &#123;</span><br><span class=\"line\">  // fulfillment</span><br><span class=\"line\">&#125;, reason =&gt; &#123;</span><br><span class=\"line\">  // rejection</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">promise.catch(onRejected);</span><br><span class=\"line\">promise.catch(function(reason) &#123;</span><br><span class=\"line\">   // rejection</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<p>ç®€å•æ¥è¯´ï¼Œ<code>reject(value)</code> å¯ä»¥è¢« <code>promise.then</code> ç¬¬äºŒä¸ªå‡½æ•°å‚æ•°æ•è·ï¼Œä¹Ÿå¯ä»¥è¢« <code>promise.catch</code> æ•è·ã€‚å¦‚æœä¸¤è€…åŒæ—¶å­˜åœ¨ï¼Œä¼šè¢« <code>promise.then</code> ç¬¬äºŒä¸ªå‡½æ•°å‚æ•°æ•è·ï¼Œ<code>promise.catch</code> æ— è¾“å‡ºã€‚</p>\n<p>ä¸‹è½½å›¾ç‰‡çš„å…¸å‹ä¾‹å­ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function loadImage(url) &#123;</span><br><span class=\"line\">  return new Promise((resolve, reject) =&gt; &#123;</span><br><span class=\"line\">    let img = new Image();</span><br><span class=\"line\">    // img.onload = () =&gt; resolve(img)</span><br><span class=\"line\">    img.addEventListener(&apos;load&apos;, e =&gt; resolve(img));</span><br><span class=\"line\">    // img.onerror = () =&gt; reject(XXX)</span><br><span class=\"line\">    img.addEventListener(&apos;error&apos;, () =&gt; &#123;</span><br><span class=\"line\">      reject(new Error(`Failed to load image&apos;s URL: $&#123;url&#125;`));</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    img.src = url;</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">loadImage(&apos;http://thecatapi.com/api/images/get?format=src&amp;type=jpg&amp;size=small&apos;)</span><br><span class=\"line\">  .then(img =&gt; document.getElementById(&apos;image-holder&apos;).appendChild(img))</span><br><span class=\"line\">  .catch(error =&gt; console.error(error));</span><br></pre></td></tr></table></figure>\n<p>äºŒã€await<br>\n<code>[rv] = await expression</code>:</p>\n<blockquote>\n<p>TL;DR returns the fulfilled value of the promise,<br>\nThe await expression causes async function execution to pause until a Promise is settled, that is fulfilled or rejected, and to resume execution of the async function after fulfillment. When resumed, the value of the await expression is that of the fulfilled Promise.<br>\nIf the Promise is rejected, the await expression throws the rejected value.<br>\nIf the value of the expression following the await operator is not a Promise, itâ€™s converted to a resolved Promise.</p>\n</blockquote>\n<h4 id=\"2019823\">2019/8/23</h4>\n<p><code>String.prototype.localeCompare()</code></p>\n<blockquote>\n<p>return a number, indicating whether the reference string comes before, after or is the same as the compareString in sort order. Returns one of three values:<br>\n-1: if the reference string is sorted before the compareString<br>\n0: if the two strings are equal<br>\n1: if the reference string is sorted after the compareString</p>\n</blockquote>\n<p><code>Array.prototype.sort()</code></p>\n<blockquote>\n<p>sorts the elements of an array in place and returns the sorted array.</p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">items.sort((a,b) =&gt; a.localeCompare(b))</span><br></pre></td></tr></table></figure>\n<h4 id=\"2019821\">2019/8/21</h4>\n<p>ä»Šæ—¥é˜…è¯»ï¼š<br>\n<a href=\"https://stackoverflow.com/questions/52499617/what-is-the-difference-between-npm-install-and-npm-ci\" target=\"_blank\" rel=\"noopener\">What is the difference between â€œnpm installâ€ and â€œnpm ciâ€?</a><br>\n<a href=\"https://medium.com/coinmonks/everything-you-wanted-to-know-about-package-lock-json-b81911aa8ab8\" target=\"_blank\" rel=\"noopener\">Everything You Wanted To Know About package-lock.json But Were Too Afraid To Ask</a></p>\n<h4 id=\"2019820\">2019/8/20</h4>\n<p>æ¨¡ä»¿ react hook <code>useState</code> çš„ç¬¬äºŒä¸ªå‚æ•°ï¼š<br>\nâ€ƒâ€ƒå› ä¸ºåœ¨ jest æµ‹è¯•ä¸­æŸä¸ªå‡½æ•°çš„å‚æ•°æ˜¯ <code>useState</code> çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œå†™äº†ä¸€ä¸ªæ›¿ä»£ï¼Œä¸è¿‡ä¸ç¡®å®šæ˜¯å¦æœ‰é”™ã€‚ğŸ˜³</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// for example</span><br><span class=\"line\">const [str,setStr] = useState&lt;string[]&gt;([]);</span><br><span class=\"line\"></span><br><span class=\"line\">// fake setStr</span><br><span class=\"line\">let str:string[] = [];</span><br><span class=\"line\">const setStr = (val: string[] | ((prev:string[]) =&gt; string[])) =&gt; &#123;</span><br><span class=\"line\">  if (typeof val === &quot;object&quot;) &#123;</span><br><span class=\"line\">    str = val;</span><br><span class=\"line\">  &#125; else if (typeof val === &quot;function&quot;) &#123;</span><br><span class=\"line\">    str = val(str)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"2019819\">2019/8/19</h4>\n<p>ä»Šæ—¥é˜…è¯»ï¼š<a href=\"https://searchenginelaws.com/seo/what-is-rel-noopener-noreferrer-tag/\" target=\"_blank\" rel=\"noopener\">What is rel=noopener noreferrer link</a><br>\nâ€ƒâ€ƒä½¿ç”¨ <code>a</code> æ ‡ç­¾ï¼Œä¸”å±æ€§ <code>target=&quot;_blank&quot;</code> æ—¶ï¼Œéœ€è¦åŠ ä¸Š <code>rel=&quot;noopener noreferrer&quot;</code> ã€‚å¯ä»¥é˜²æ­¢æ–°çª—å£åˆ©ç”¨ <code>window.opener</code> çš„ç‰¹æ€§çªƒå–åŸçª—å£ä¿¡æ¯ã€‚å…·ä½“è€Œè¨€ï¼Œå¦‚æœ window A æ‰“å¼€äº† window Bï¼Œé‚£ä¹ˆ B.opener ä¼šè¿”å› Aã€‚å¦‚æœåŠ ä¸Š <code>rel=&quot;noopener&quot;</code> ï¼Œä¼šè¿”å› null ã€‚</p>\n<h4 id=\"2019812\">2019/8/12</h4>\n<p>ä¸€ã€download files using axios</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import axios from &quot;axios&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">axios.get(url,&#123;</span><br><span class=\"line\">  responseType: &apos;blob&apos;, // important</span><br><span class=\"line\">  headers: &#123;</span><br><span class=\"line\">    &apos;Authorization&apos;: AuthStr </span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;).then(resp =&gt; &#123;</span><br><span class=\"line\">  const &#123;data&#125; = resp;</span><br><span class=\"line\">  const file = new File([data],&quot;data.txt&quot;);</span><br><span class=\"line\">  const objectURL = URL.createObjectURL(file);</span><br><span class=\"line\">  const a = document.createElement(&quot;a&quot;);</span><br><span class=\"line\">  a.href = objectURL;</span><br><span class=\"line\">  a.download = &quot;data.txt&quot;;</span><br><span class=\"line\">  a.click();</span><br><span class=\"line\">  URL.revokeObjectURL(objectURL);</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p>â€ƒâ€ƒå¦‚æœæ˜¯å•æ¬¡ç‚¹å‡»ä¸‹è½½å¤šä¸ªæ–‡ä»¶ï¼ŒChrome åªä¼šå¼¹å‡ºä¸€ä¸ªå¼¹çª—ä¸‹è½½æœ€åä¸€ä¸ªæ–‡ä»¶ã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥åŠ ä¸Š <code>setTimeout</code> ï¼Œè§¦å‘å¤šæ¬¡ä¸‹è½½ï¼Œæˆ–æ˜¯åŠ ä¸Š <code>a.target = &quot;_blank&quot;</code> ï¼Œæ‰“å¼€å¤šä¸ªæ–°çª—å£ã€‚<br>\näºŒã€curl<br>\næŸ¥çœ‹å‘½ä»¤ï¼š<br>\n<code>curl --help</code><br>\n-H æŒ‡å®šHeaderï¼š<br>\n<code>curl -H &quot;Authorization: XXXXXXXX&quot; URL</code><br>\n<code>curl POST -d data -H &quot;Authorization: XXXXXXXX&quot; URL</code></p>\n<h4 id=\"201989\">2019/8/9</h4>\n<p>ä¸€ã€<a href=\"https://www.codebeast.dev/usestate-vs-useref-re-render-or-not/\" target=\"_blank\" rel=\"noopener\">useRef vs useState: Should we re-render or not?</a><br>\n<img src=\"FE_20190809.png\" alt=\"FE_20190808\"><br>\näºŒã€Hooks ç›‘å¬é”®ç›˜äº‹ä»¶<br>\nkeyCode: <a href=\"https://keycode.info/\" target=\"_blank\" rel=\"noopener\">https://keycode.info/</a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function useKeyPress(targetKey) &#123;</span><br><span class=\"line\">  const [keyPressed, setKeyPressed] = useState(false);</span><br><span class=\"line\"></span><br><span class=\"line\">  function downHandler(&#123; key &#125;) &#123;</span><br><span class=\"line\">    if (key === targetKey) &#123;</span><br><span class=\"line\">      setKeyPressed(true);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  const upHandler = (&#123; key &#125;) =&gt; &#123;</span><br><span class=\"line\">    if (key === targetKey) &#123;</span><br><span class=\"line\">      setKeyPressed(false);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">  useEffect(() =&gt; &#123;</span><br><span class=\"line\">    window.addEventListener(&apos;keydown&apos;, downHandler);</span><br><span class=\"line\">    window.addEventListener(&apos;keyup&apos;, upHandler);</span><br><span class=\"line\">    return () =&gt; &#123;</span><br><span class=\"line\">      window.removeEventListener(&apos;keydown&apos;, downHandler);</span><br><span class=\"line\">      window.removeEventListener(&apos;keyup&apos;, upHandler);</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">  &#125;, []);</span><br><span class=\"line\"></span><br><span class=\"line\">  return keyPressed;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"201988\">2019/8/8</h4>\n<p>â€ƒâ€ƒå·¥ç¨‹ä¸­ç»å¸¸ä¼šçœ‹åˆ° CI/CD çš„æ¦‚å¿µã€‚CI æŒ‡çš„æ˜¯æŒç»­é›†æˆï¼Œä¾§é‡äºç®€åŒ–å‘å¸ƒå‡†å¤‡å·¥ä½œçš„å®è·µï¼Œæ¯”å¦‚è‡ªåŠ¨æµ‹è¯•ï¼›CD æŒ‡çš„æ˜¯æŒç»­äº¤ä»˜ï¼Œæ„å‘³ç€ä¸ä»…è®©æµ‹è¯•è‡ªåŠ¨åŒ–ï¼Œè®©å‘å¸ƒæµç¨‹ä¹Ÿè‡ªåŠ¨åŒ–äº†ã€‚æ›´å¤šæ¦‚å¿µå¯¹æ¯”å¯ä»¥å‚è€ƒï¼š<a href=\"https://www.atlassian.com/continuous-delivery/principles/continuous-integration-vs-delivery-vs-deployment\" target=\"_blank\" rel=\"noopener\">Continuous integration VS continuous delivery VS continuous deployment</a><br>\nâ€ƒâ€ƒä¸‹é¢è¿™ä¸ªå›¾å¾ˆæ¸…æ™°åœ°æè¿°äº†ä¸‰è€…çš„ä¸åŒï¼š<br>\n<img src=\"FE_20190808.png\" alt=\"FE_20190808\"><br>\nâ€ƒâ€ƒåœ¨ gitlab ä¸Šçš„å®è·µå¯ä»¥å‚è€ƒï¼š<a href=\"https://mp.weixin.qq.com/s/z2f1i2FgrVGofQR6nKTd1A\" target=\"_blank\" rel=\"noopener\">åŸºäº GitLab CI/CD çš„è‡ªåŠ¨åŒ–æ„å»ºã€å‘å¸ƒå®è·µ</a></p>\n<h4 id=\"201987\">2019/8/7</h4>\n<p>Typescript: <a href=\"https://www.typescriptlang.org/docs/handbook/advanced-types.html#discriminated-unions\" target=\"_blank\" rel=\"noopener\">Discriminated Unions</a><br>\nâ€ƒâ€ƒå½“æˆ‘ä»¬æŸä¸ªå‚æ•°å¯èƒ½æœ‰å¤šä¸ªç±»å‹ï¼Œè€Œè¿™äº›ç±»å‹ä¸­åˆæœ‰å…¬å…±çš„å±æ€§æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨è¿™ç§å½¢å¼çº¦æŸã€‚</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// Each interface has a kind property with a different string literal type. </span><br><span class=\"line\">// The kind property is called the discriminant or tag. </span><br><span class=\"line\">interface Square &#123;</span><br><span class=\"line\">    kind: &quot;square&quot;;</span><br><span class=\"line\">    size: number;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">interface Rectangle &#123;</span><br><span class=\"line\">    kind: &quot;rectangle&quot;;</span><br><span class=\"line\">    width: number;</span><br><span class=\"line\">    height: number;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">interface Circle &#123;</span><br><span class=\"line\">    kind: &quot;circle&quot;;</span><br><span class=\"line\">    radius: number;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// put the interfaces into a union</span><br><span class=\"line\">type Shape = Square | Rectangle | Circle;</span><br><span class=\"line\"></span><br><span class=\"line\">// use the discriminated union</span><br><span class=\"line\">function area(s: Shape) &#123;</span><br><span class=\"line\">    switch (s.kind) &#123;</span><br><span class=\"line\">        case &quot;square&quot;: return s.size * s.size;</span><br><span class=\"line\">        case &quot;rectangle&quot;: return s.height * s.width;</span><br><span class=\"line\">        case &quot;circle&quot;: return Math.PI * s.radius ** 2;</span><br><span class=\"line\">        default: return assertNever(s); // error here if there are missing cases</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// Exhaustiveness checking </span><br><span class=\"line\">function assertNever(x: never): never &#123;</span><br><span class=\"line\">    throw new Error(&quot;Unexpected object: &quot; + x);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"201986\">2019/8/6</h4>\n<p>Stack Overflow: <a href=\"https://stackoverflow.com/questions/54069253/usestate-set-method-not-reflecting-change-immediately\" target=\"_blank\" rel=\"noopener\">useState set method not reflecting change immediately.</a><br>\nâ€ƒâ€ƒä»Šå¤©åœ¨å®è·µä¸­å‘ç°ï¼Œ<code>setState</code> åé©¬ä¸Šæ‰“å°ï¼Œå¹¶ä¸ä¼šå–åˆ°æ›´æ–°åçš„å€¼ã€‚æŸ¥é˜…èµ„æ–™åå‘ç°è¿™ä¸ªå‡½æ•°æ˜¯ä¸€ä¸ªå¼‚æ­¥çš„å‡½æ•°ï¼Œä¸ä¼šç«‹å³æ›´æ–°ï¼Œä½†ä¼šè§¦å‘é‡æ–°æ¸²æŸ“ã€‚å¦‚ä¸‹ï¼š<br>\n<img src=\"FE_20190806.png\" alt=\"FE_20190806\"></p>\n<h4 id=\"201981\">2019/8/1</h4>\n<p>ä¸€ã€<a href=\"https://javascript.info/fetch-api\" target=\"_blank\" rel=\"noopener\">Fetch API</a><br>\nâ€ƒâ€ƒç”¨ fetch æ¥è¯·æ±‚ç½‘ç»œèµ„æºï¼Œå¯ä»¥é…ç½®ä¸åŒçš„å‚æ•°æ¥è§£å†³ç¼“å­˜ã€è·¨åŸŸç­‰é—®é¢˜ï¼Œå¦‚ä¸‹ç¤ºä¾‹ä»£ç ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// ä¸ç¼“å­˜è¯·æ±‚ç»“æœ </span><br><span class=\"line\">// https://stackoverflow.com/questions/29246444/fetch-how-do-you-make-a-non-cached-request</span><br><span class=\"line\">const headers = new Headers();</span><br><span class=\"line\">headers.append(&quot;pragma&quot;, &quot;no-cache&quot;);</span><br><span class=\"line\">headers.append(&quot;cache-control&quot;, &quot;no-store&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">// å®Œå…¨å¿½ç•¥ http-cache ï¼Œæ¯æ¬¡éƒ½ä»æœåŠ¡å™¨è¯·æ±‚æ•°æ®</span><br><span class=\"line\">// https://developer.mozilla.org/en-US/docs/Web/API/Request/cache</span><br><span class=\"line\">const cache: RequestCache = &quot;no-store&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">// è¯·æ±‚æ¨¡å¼ï¼Œè‹¥æœ‰çš„è¯·æ±‚ä¼šå› ä¸º cors è€Œå¤±è´¥ï¼Œå¯ä»¥è®¾ç½®ä¸º &quot;no-cors&quot;</span><br><span class=\"line\">// https://developer.mozilla.org/en-US/docs/Web/API/Request/mode</span><br><span class=\"line\">const mode: RequestMode = needCors ? &quot;cors&quot; : &quot;no-cors&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">await fetch(url. &#123;headers, cache, mode&#125;)</span><br><span class=\"line\">  .then(res =&gt; res.blob())</span><br><span class=\"line\">  .then(blob =&gt; &#123;</span><br><span class=\"line\">    // doSomething with blob</span><br><span class=\"line\">    const url = URL.createObjectURL(blob)</span><br><span class=\"line\">    let a = document.createElement(&apos;a&apos;)</span><br><span class=\"line\">    a.download = &apos;example.zip&apos;</span><br><span class=\"line\">    a.href = url</span><br><span class=\"line\">    document.body.appendChild(a)</span><br><span class=\"line\">    a.click()</span><br><span class=\"line\">    document.body.removeChild(a)</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">  .catch(err =&gt; &#123;</span><br><span class=\"line\">    console.log(err)</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">  .finally(() =&gt; &#123;</span><br><span class=\"line\">    // doSomething</span><br><span class=\"line\">  &#125;)</span><br></pre></td></tr></table></figure>\n<p>â€ƒâ€ƒå…³äº <code>res.blob()</code> ï¼Œå¯ä»¥å‚è€ƒçŸ¥ä¹ä¸Š<a href=\"https://zhuanlan.zhihu.com/p/32909043\" target=\"_blank\" rel=\"noopener\">è°ˆä¸€è°ˆ Fetch API ä¸­çš„ â€œres.blob()â€</a>ï¼›ä¹Ÿå¯ä»¥å‚è€ƒ <a href=\"https://github.github.io/fetch/\" target=\"_blank\" rel=\"noopener\">fetch documentation</a> ï¼Œè¿™ä¸€ç¯‡æ¯”è¾ƒè¯¦ç»†ï¼Œä¹Ÿæä¾›äº†è¾ƒå¤šå…¶ä»–çš„ä¾‹å­ã€‚<br>\nå…³äºæµè§ˆå™¨ç¼“å­˜é—®é¢˜ï¼ŒMedium ä¸Šè¿™ç¯‡ <a href=\"https://medium.com/@codebyamir/a-web-developers-guide-to-browser-caching-cc41f3b73e7c\" target=\"_blank\" rel=\"noopener\">A Web Developerâ€™s Guide to Browser Caching</a> å†™å¾—ä¸é”™ã€‚å¦‚æœå­˜åœ¨ä»£ç†æœåŠ¡å™¨ï¼Œå³ä½¿æˆ‘ä»¬è®¾ç½®äº† <code>mode: 'no-store'</code> ï¼Œä»£ç†æœåŠ¡å™¨ä¹Ÿä¼šç¼“å­˜ã€‚ä¸ºäº†é¿å…è¿™ä¸ªæƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ¯æ¬¡å‘é€è¯·æ±‚æ—¶æ„é€ æ–°çš„ URL ï¼ŒåŠ ä¸Šæ—¶é—´æˆ³ <code>?t=Date.now()</code> ã€‚ğŸ®ğŸº<br>\näºŒã€Jest<br>\nâ€ƒâ€ƒæˆ‘ä»¬åœ¨ä½¿ç”¨ jest æµ‹è¯•æ—¶ï¼Œæœ‰æ—¶å€™éœ€è¦å¼•å…¥ä¸€äº›å¤–éƒ¨æ–‡ä»¶/å¤–éƒ¨å˜é‡ï¼Œå¦‚ä» <code>config.json</code> æ–‡ä»¶ä¸­å¼•å…¥æŸä¸ªå˜é‡ã€‚ä¸ºäº†åœ¨æµ‹è¯•æ–‡ä»¶ä¸­å¯ä»¥è®¿é—®åˆ°è¯¥å˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ <code>jest.config.js</code> ä¸­é…ç½®å…¨å±€å˜é‡ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">module.exports = &#123;</span><br><span class=\"line\">  globals: &#123;</span><br><span class=\"line\">    API_BASE: &quot;&quot;,</span><br><span class=\"line\">    DATA_API: &quot;&quot;,</span><br><span class=\"line\">    TRACK_API: &quot;&quot;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  setupFiles: [&quot;./jestSetup.ts&quot;]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>â€ƒâ€ƒç”±äº <code>globals</code> åªæ”¯æŒ JSON æ ¼å¼çš„å˜é‡ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦å®šä¹‰å…¨å±€å‡½æ•°ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ <code>setupFiles</code>ã€‚</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// jestSetup.ts</span><br><span class=\"line\">(global as any).fn= () =&gt; &#123;&#125;;</span><br><span class=\"line\">(global as any).variable = &quot;XXX&quot;;</span><br></pre></td></tr></table></figure>\n<h4 id=\"2019731\">2019/7/31</h4>\n<p>1ï¼‰<code>position: fixed</code> å’Œ flex å¸ƒå±€æ˜¯ä¸èƒ½åŒæ—¶èµ·ä½œç”¨çš„ã€‚ç»å¯¹å¸ƒå±€è„±ç¦»æ–‡æ¡£æµï¼Œä¸ä¼šå‚ä¸åˆ° flex layout ä¸­ã€‚å¦‚æœæƒ³å®ç°å·¦ä¾§èœå•æ ï¼Œå³ä¾§å†…å®¹ï¼Œä¸¤è€…ä¸åŒæ—¶æ»šåŠ¨ï¼ˆèœå•æ  fixedï¼‰ï¼Œä½†èœå•æ çš„å¤§å°å¯ä»¥æ”¹å˜ï¼ˆflex çˆ¶å¸ƒå±€ï¼‰ã€‚å¯ä»¥è®©çˆ¶å®¹å™¨æ˜¯ flex å¸ƒå±€ï¼Œå·¦ä¾§èœå•æ å’Œå³ä¾§å†…å®¹åŒºåŸŸéƒ½æ˜¯ flex element ï¼Œ èœå•æ å†…éƒ¨å†æœ‰ä¸€ä¸ª <code>position: fixed</code> çš„ div ã€‚<br>\n2ï¼‰å¦‚æœæƒ³è®© <code>position: fixed</code> çš„å…ƒç´ ç›¸å¯¹çˆ¶å®¹å™¨å®šä½ï¼Œå¯ä»¥ç»™çˆ¶å®¹å™¨å¢åŠ  CSS å±æ€§ <code>transform: translate(0,0)</code> ã€‚å‚è€ƒï¼š<a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/position\" target=\"_blank\" rel=\"noopener\">MDN - position</a></p>\n<blockquote>\n<p>fixed: It is positioned relative to the initial containing block established by the viewport, except when one of its ancestors has a transform, perspective, or filter property set to something other than none.</p>\n</blockquote>\n<h4 id=\"2019730\">2019/7/30</h4>\n<p><code>useEffect</code> ä¸­çš„å¼‚æ­¥è¯·æ±‚ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// é”™è¯¯å†™æ³•ï¼Œ return å¿…é¡»æ˜¯ cleanup function</span><br><span class=\"line\">useEffect(async () =&gt; &#123;</span><br><span class=\"line\">  const newVal = await asyncCall();</span><br><span class=\"line\">  setVal(newVal);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">// æ­£ç¡®å†™æ³•</span><br><span class=\"line\">useEffect(() =&gt; &#123;</span><br><span class=\"line\">  asyncCall().then(resp =&gt; setVal(resp.data));</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<p>å¥½æ–‡å…±äº«ï¼š<a href=\"https://www.robinwieruch.de/react-hooks-fetch-data/\" target=\"_blank\" rel=\"noopener\">How to fetch data with React Hooks?</a>ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">useEffect(() =&gt; &#123;</span><br><span class=\"line\">  async function fetchMyAPI() &#123;</span><br><span class=\"line\">    let url = &apos;http://something/&apos; + productId;</span><br><span class=\"line\">    let config = &#123;&#125;;</span><br><span class=\"line\">    const response = await myFetch(url);</span><br><span class=\"line\">    console.log(response);</span><br><span class=\"line\">  &#125;  </span><br><span class=\"line\"></span><br><span class=\"line\">  fetchMyAPI();</span><br><span class=\"line\">&#125;, [productId]);</span><br></pre></td></tr></table></figure>\n<p>å¦‚æœè¦ä¿è¯è¯·æ±‚æŒ‰é¡ºåºå‘å‡ºï¼Œå¯ä»¥é‡‡ç”¨å¦‚ä¸‹å†™æ³•ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">useEffect(() =&gt; &#123;</span><br><span class=\"line\">  let didCancel = false;</span><br><span class=\"line\"></span><br><span class=\"line\">  async function fetchMyAPI() &#123;</span><br><span class=\"line\">    let url = &apos;http://something/&apos; + productId;</span><br><span class=\"line\">    let config = &#123;&#125;;</span><br><span class=\"line\">    const response = await myFetch(url);</span><br><span class=\"line\">    if (!didCancel) &#123; // Ignore if we started fetching something else</span><br><span class=\"line\">      console.log(response);</span><br><span class=\"line\">    &#125; </span><br><span class=\"line\">  &#125;  </span><br><span class=\"line\"></span><br><span class=\"line\">  fetchMyAPI();</span><br><span class=\"line\">  return () =&gt; &#123; didCancel = true; &#125;; // Remember if we start fetching something else</span><br><span class=\"line\">&#125;, [productId]);</span><br></pre></td></tr></table></figure>\n<h4 id=\"2019729\">2019/7/29</h4>\n<p>ä¸€ã€<a href=\"https://stackoverflow.com/questions/30795525/performance-now-vs-date-now\" target=\"_blank\" rel=\"noopener\">performance.now() vs Date.now()</a><br>\nâ€ƒâ€ƒåœ¨ç¨‹åºä¸­æ‰“å°æ‰§è¡Œæ—¶é—´æ—¶ï¼Œä½¿ç”¨ <code>performance.now(ï¼‰</code> æ›´å‡†ç¡®ã€‚</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const start = performance.now();</span><br><span class=\"line\">doSomething();</span><br><span class=\"line\">const end = performance.now();</span><br><span class=\"line\">console.log(&quot;Call to doSomething took &quot; + (start - end) + &quot; milliseconds.&quot;);</span><br></pre></td></tr></table></figure>\n<p>äºŒã€<a href=\"https://stackoverflow.com/questions/47738344/does-javascript-slice-method-return-a-shallow-copy\" target=\"_blank\" rel=\"noopener\">Does javascript slice method return a shallow copy?</a><br>\nâ€ƒâ€ƒmdn ä¸Šå¯¹ <code>slice()</code> æ–¹æ³•çš„ä»‹ç»ï¼š</p>\n<blockquote>\n<p>The slice() method returns a shallow copy of a portion of an array into a new array object selected from begin to end (end not included) where begin and end represent the index of items in that array. The original array will not be modified.</p>\n</blockquote>\n<p>â€ƒâ€ƒæ³¨æ„è¿™é‡Œçš„æµ…å¤åˆ¶æŒ‡çš„æ˜¯å¯¹æ•°ç»„ä¸­å€¼çš„æµ…å¤åˆ¶ï¼Œè€Œä¸æ˜¯å¯¹æ•´ä¸ªæ•°ç»„çš„æµ…å¤åˆ¶ã€‚å¦‚æœæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œåˆ™ä¿®æ”¹æ–°æ•°ç»„æ—¶ï¼ŒåŸæ•°ç»„ä¸ä¼šæ”¹å˜ï¼›å¦‚æœæ˜¯å¯¹è±¡æ•°ç»„ï¼Œä¿®æ”¹æ–°æ•°ç»„å¯¹è±¡å€¼æ—¶ï¼ŒåŸæ•°ç»„ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ã€‚</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const animals = [&#123;name: &apos;ant&apos;&#125;, &#123;name: &apos;bison&apos;&#125;, &#123;name: &apos;camel&apos;&#125;];</span><br><span class=\"line\">const newAnimals = animals.slice(2);</span><br><span class=\"line\"></span><br><span class=\"line\">newAnimals[0].name = &apos;aaa&apos;;</span><br><span class=\"line\">console.log(newAnimals); // [&#123;name: &apos;aaa&apos;&#125;]</span><br><span class=\"line\">console.log(animals);    // [&#123;name: &apos;ant&apos;&#125;, &#123;name: &apos;bison&apos;&#125;, &#123;name: &apos;aaa&apos;&#125;]</span><br></pre></td></tr></table></figure>\n<p>â€ƒâ€ƒæ³¨æ„å¦‚æœæ˜¯é‡æ–°èµ‹å€¼ï¼Œåˆ™ç­‰äºé‡æ–°åˆ†é…ç©ºé—´ï¼Œä¸ä¼šæ”¹å˜åŸæ•°ç»„ã€‚</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const animals = [&#123;name: &apos;ant&apos;&#125;, &#123;name: &apos;bison&apos;&#125;, &#123;name: &apos;camel&apos;&#125;];</span><br><span class=\"line\">const newAnimals = animals.slice(2);</span><br><span class=\"line\"></span><br><span class=\"line\">newAnimals[0] = &#123;name: &apos;aaa&apos;&#125;;</span><br><span class=\"line\">console.log(newAnimals); // [&#123;name: &apos;aaa&apos;&#125;]</span><br><span class=\"line\">console.log(animals);    // [&#123;name: &apos;ant&apos;&#125;, &#123;name: &apos;bison&apos;&#125;, &#123;name: &apos;camel&apos;&#125;]</span><br></pre></td></tr></table></figure>\n<h4 id=\"2019726\">2019/7/26</h4>\n<p>â€ƒâ€ƒåº”ç”¨åœºæ™¯ï¼šæˆ‘ä»¬éœ€è¦è¯·æ±‚å¹¶æ›´æ–°èœå•æ ä¸­ä»»åŠ¡çš„çŠ¶æ€ï¼Œå¦‚æœä¸€ä¸ªè¯·æ±‚å®Œæˆç«‹é©¬æ›´æ–°ä¼šå¯¼è‡´ React é¢‘ç¹åˆ·æ–°ï¼Œéœ€è¦ç¼“å†²æ‰¹å¤„ç†ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import &#123; runInAction &#125; from &quot;mobx&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">let handlers: Array&lt;() =&gt; void&gt; = [];</span><br><span class=\"line\">const runHandlers = () =&gt; &#123;</span><br><span class=\"line\">  runInAction(() =&gt; &#123;</span><br><span class=\"line\">    handlers.forEach(f =&gt; f());</span><br><span class=\"line\">    handlers = [];</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">for (const task of tasks) &#123;</span><br><span class=\"line\">  const &#123;data&#125; = await requestFn();</span><br><span class=\"line\">  </span><br><span class=\"line\">  handlers.push(() =&gt; &#123;</span><br><span class=\"line\">    // deal with data, update state</span><br><span class=\"line\">    ...</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">  if(handlers.length &gt; 30) &#123;</span><br><span class=\"line\">    runHandlers();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">runHandlers();</span><br></pre></td></tr></table></figure>\n<p>â€ƒâ€ƒä¸Šè¿°ä»£ç ä¸»è¦æ˜¯åˆ©ç”¨äº†è‡ªå®šä¹‰çš„ <code>handlers</code> æ¥æš‚å­˜çŠ¶æ€æ›´æ–°å‡½æ•°ï¼Œä¹‹åä½¿ç”¨ mobx æä¾›çš„ <code>runInAction</code> æ‰§è¡Œå‡½æ•°å¹¶æ›´æ–°çŠ¶æ€ï¼Œæ›´æ–°çŠ¶æ€éƒ½éœ€è¦ä½¿ç”¨ <code>action</code> å‡½æ•°ï¼Œ <code>runInAction</code> æ¥å—ä¸€ä¸ªä»£ç å—å¹¶åœ¨ä¸€ä¸ª(åŒ¿å)æ“ä½œä¸­æ‰§è¡Œï¼Œæœ‰åˆ©äºåŠ¨æ€åˆ›å»ºå’Œæ‰§è¡Œæ“ä½œï¼Œ<code>runInAction(f) = action(f)()</code>ã€‚æ­¤å¤–ï¼Œå¿…è¦æ—¶è¿˜å¯åŠ ä¸Š <code>lodash.memoize(func,[resolver])</code>ï¼Œè®°å½•ä¸»å‡½æ•°è¯·æ±‚ç»“æœã€‚</p>\n<blockquote>\n<p>For one-time-actions runInAction(name?, fn) can be used, which is sugar for action(name, fn)()</p>\n</blockquote>\n<h4 id=\"2019718\">2019/7/18</h4>\n<p>ä¸€ã€ç¼–ç¨‹æ¨¡å¼ï¼š<br>\nâ€ƒâ€ƒ é¦–å…ˆå…ˆè®°ä½è¿™å‡ ç§ç¼–ç¨‹æ¨¡å¼çš„ä¸­æ–‡ï¼šImperative Programming æ˜¯å‘½ä»¤å¼ç¼–ç¨‹ï¼ŒDeclarative Programming æ˜¯å£°æ˜å¼ç¼–ç¨‹ï¼ŒReactive Programming æ˜¯å“åº”å¼ç¼–ç¨‹ã€‚ï¼ˆæµä¸‹äº†è‹±æ–‡ä¸å¥½çš„æ³ªæ°´ï¼‰<br>\n1ï¼‰å…ˆçœ‹å‘½ä»¤å¼ç¼–ç¨‹å’Œå£°æ˜å¼ç¼–ç¨‹çš„åŒºåˆ«ï¼Œç›´æ¥ä¸Šä»£ç ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// å‘½ä»¤å¼ç¼–ç¨‹ imperative programming</span><br><span class=\"line\">const array = [0,1,2,3,4,5];</span><br><span class=\"line\">const output = [];</span><br><span class=\"line\">for (let i = 0; i &lt; array.length; i++) &#123;</span><br><span class=\"line\">  const tmp = array[i] * 2;</span><br><span class=\"line\">  output.push(tmp)</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">console.log(output) // =&gt; [0,2,4,6,8,10]</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// å£°æ˜å¼ç¼–ç¨‹ declarative programming</span><br><span class=\"line\">const array = [0,1,2,3,4,5];</span><br><span class=\"line\">const output = array.map(item =&gt; item * 2);</span><br><span class=\"line\">console.log(output) // =&gt; [0,2,3,6,8,10]</span><br></pre></td></tr></table></figure>\n<p>â€ƒâ€ƒå¾ˆæ˜æ˜¾å¯ä»¥çœ‹åˆ°ï¼Œå‘½ä»¤å¼ç¼–ç¨‹çš„å…³æ³¨ç‚¹åœ¨äº how ï¼Œæˆ‘ä»¬éœ€è¦ä¸€æ­¥æ­¥å‘Šè¯‰æœºå™¨æ¥ä¸‹æ¥è¦åšä»€ä¹ˆï¼Œå‘Šè¯‰ä»–æ€ä¹ˆå»éå†ä¸€ä¸ªæ•°ç»„ï¼Œæ€ä¹ˆå»è¿ç®—å¾—åˆ°æœ€åçš„ç»“æœï¼Œæ€ä¹ˆå»è¾“å‡ºï¼›å£°æ˜å¼ç¼–ç¨‹çš„å…³æ³¨ç‚¹åœ¨äº what ï¼Œæˆ‘ä»¬åªå…³æ³¨æœ€åçš„ç»“æœï¼Œç”±æœºå™¨è‡ªå·±å»æ‘¸ç´¢è¿‡ç¨‹ï¼Œå¦‚ç›´æ¥è°ƒç”¨ <code>map</code> å‡½æ•°ï¼Œåªå‘Šè¯‰ç¨‹åºæˆ‘ä»¬éœ€è¦ä¸€ä¸ª2å€è¾“å‡ºã€‚<br>\n2ï¼‰æ¥ç€çœ‹å£°æ˜å¼ç¼–ç¨‹å’Œå“åº”å¼ç¼–ç¨‹çš„å¯¹æ¯”<br>\nâ€ƒâ€ƒå¯ä»¥é˜…è¯»ï¼š<a href=\"https://codepen.io/HunorMarton/post/imperative-vs-reactive\" target=\"_blank\" rel=\"noopener\">Imperative vs Reactive</a>ï¼Œè§£é‡Šå¾ˆæ¸…æ™°ï¼Œæ¯”å–»ä¹Ÿå¾ˆå½¢è±¡ï¼Œä½†æˆ‘è§‰å¾—æ–‡ç« é‡Œçš„ Imperative åº”è¯¥æ”¹æˆ Declarative æ¯”è¾ƒå‡†ç¡®ã€‚ç»§ç»­æ²¿ç”¨ä¸Šé¢çš„ä¾‹å­ï¼Œä¿®æ”¹ä¸€ä¸‹å£°æ˜å¼ç¼–ç¨‹çš„ä¾‹å­ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// å£°æ˜å¼ç¼–ç¨‹ declarative programming</span><br><span class=\"line\">const array = [1,2];</span><br><span class=\"line\">const output = array.map(item =&gt; item * 2);</span><br><span class=\"line\">output.forEach(item =&gt; console.log(item)) // =&gt; 2 4</span><br><span class=\"line\">array.push(3);  // =&gt; no output </span><br><span class=\"line\">array.push(4);  // =&gt; no output</span><br></pre></td></tr></table></figure>\n<p>å“åº”å¼ç¼–ç¨‹çš„ä¾‹å­ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import &#123; Subject &#125; from `rxjs`;</span><br><span class=\"line\">let array = new Subject();</span><br><span class=\"line\">array.next(1);</span><br><span class=\"line\">array.next(2);</span><br><span class=\"line\"></span><br><span class=\"line\">const output = array.map(item =&gt; item * 2);</span><br><span class=\"line\">output.forEach(item =&gt; console.log(item)); // =&gt; 2 4</span><br><span class=\"line\"></span><br><span class=\"line\">array.next(3); // =&gt; 6</span><br><span class=\"line\">array.next(4); // =&gt; 8</span><br></pre></td></tr></table></figure>\n<p>â€ƒâ€ƒé¦–å…ˆè¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸¤ç§æ–¹å¼ä¸­çš„ <code>map</code> ï¼Œ <code>forEach</code> ç­‰å‡½æ•°å¹¶ä¸æ˜¯ä¸€æ ·çš„ï¼Œå†…éƒ¨å®ç°æœºåˆ¶æ˜¯ä¸åŒçš„ã€‚æˆ‘ä»¬å¯ä»¥å‘ç°åŒºåˆ«ï¼šåœ¨å£°æ˜å¼ç¼–ç¨‹ä¸­ï¼Œå¦‚æœåœ¨æœ€åå‘åŸæ•°ç»„æ·»åŠ å€¼ï¼Œå¹¶ä¸ä¼šæ‰“å°å‡ºæ¥ï¼Œå› ä¸ºè¿™æ˜¯åœ¨ <code>console.log</code> è¯­å¥æ‰§è¡Œåå‘ç”Ÿçš„ã€‚ä½†åœ¨å“åº”å¼ç¼–ç¨‹é‡Œï¼Œä»»ä½•å˜åŒ–éƒ½å¯ä»¥è¢«ååº”å‡ºæ¥ï¼Œå®ƒå¼•å…¥äº†ä¸€ä¸ª<strong>å¼‚æ­¥æ•°æ®æµ</strong>ï¼ˆasynchronous data streamsï¼‰çš„æ¦‚å¿µï¼Œå¯ä»¥éšæ—¶åˆ›å»ºã€æ›´æ”¹æˆ–ç»„åˆè¿™äº›æ•°æ®æµï¼Œæ‰€ä»¥æ‰“å°äº‹ä»¶æ˜¯ä¸€ä¸ª continuous observation caseã€‚<br>\näºŒã€ç±»åº“<br>\n<a href=\"https://github.com/bvaughn/react-virtualized\" target=\"_blank\" rel=\"noopener\">react-virtualized</a> çš„è½»é‡çº§ç‰ˆ <a href=\"https://github.com/bvaughn/react-window\" target=\"_blank\" rel=\"noopener\">react-window</a>ï¼Œç”¨äºé«˜æ•ˆæ¸²æŸ“é•¿åˆ—è¡¨ã€‚</p>\n<h4 id=\"2019717\">2019/7/17</h4>\n<p>â€ƒâ€ƒå¦‚æœæˆ‘ä»¬åœ¨é¡¹ç›®ä¸­éœ€è¦è¯·æ±‚å¾ˆå¤šå›¾ç‰‡ï¼Œæƒ³è¦å®ç°è¯·æ±‚å‡ºé”™æ—¶ç»§ç»­å‘é€è¯·æ±‚ï¼ŒæˆåŠŸæ—¶è¿”å›æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ <code>Promise</code> ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function fetchURL(url: string):Promise&lt;Blob&gt; &#123;</span><br><span class=\"line\">  return Axios.get(url, &#123;responeType: &quot;blob&quot;&#125;)</span><br><span class=\"line\">              .then( resp =&gt; Promise.resolve(resp.data) )</span><br><span class=\"line\">              .catch( () =&gt; fetchURL(url) )</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ä¹‹åå¯ä»¥ä½¿ç”¨ <code>rxjs</code> ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import &#123; mergeMap, bufferTime, takeUntil &#125; from &quot;rxjs/operators&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">[url1,...,url10]</span><br><span class=\"line\">  .pipe(</span><br><span class=\"line\">    mergeMap( url =&gt; fetchURL(url).then( val =&gt; val )),</span><br><span class=\"line\">    bufferTime(10000)</span><br><span class=\"line\">  )</span><br><span class=\"line\">  .subscribe(&#123;</span><br><span class=\"line\">    next: resps =&gt; &#123;</span><br><span class=\"line\">      // do sth with resps:Blob[]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;)</span><br></pre></td></tr></table></figure>\n<p>â€ƒâ€ƒæ¯æ¬¡é‡åˆ° <code>rxjs</code> éƒ½å¾ˆå¤´å¤§ï¼Œç°åœ¨ä¹Ÿæ²¡æœ‰å‘ç°ä¸€ä¸ªæ¯”è¾ƒå®Œå–„æ¸…æ™°çš„æ•™ç¨‹ï¼Œä½†å®ƒåˆçœŸçš„å¾ˆå¼ºå¤§ï¼Œåç»­è¦å¼€ä¸“é¢˜å¥½å¥½å­¦ä¹ è®°å½•è¿™ä¸ªä¸œè¥¿ã€‚</p>\n<h4 id=\"2019716\">2019/7/16</h4>\n<p>ä¸€ã€ä»Šæ—¥é˜…è¯»ï¼š<a href=\"https://reactjs.org/docs/hooks-faq.html#how-to-read-an-often-changing-value-from-usecallback\" target=\"_blank\" rel=\"noopener\">How to read an often-changing value from useCallback?</a><br>\nç›´æ¥ä¸Šå®˜ç½‘ä»£ç ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function Form() &#123;</span><br><span class=\"line\">  const [text, updateText] = useState(&apos;&apos;);</span><br><span class=\"line\">  const textRef = useRef();</span><br><span class=\"line\"></span><br><span class=\"line\">  useEffect(() =&gt; &#123;</span><br><span class=\"line\">    textRef.current = text; // Write it to the ref</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">  const handleSubmit = useCallback(() =&gt; &#123;</span><br><span class=\"line\">    const currentText = textRef.current; // Read it from the ref</span><br><span class=\"line\">    alert(currentText);</span><br><span class=\"line\">  &#125;, [textRef]); // Don&apos;t recreate handleSubmit like [text] would do</span><br><span class=\"line\"></span><br><span class=\"line\">  return (</span><br><span class=\"line\">    &lt;&gt;</span><br><span class=\"line\">      &lt;input value=&#123;text&#125; onChange=&#123;e =&gt; updateText(e.target.value)&#125; /&gt;</span><br><span class=\"line\">      &lt;ExpensiveTree onSubmit=&#123;handleSubmit&#125; /&gt;</span><br><span class=\"line\">    &lt;/&gt;</span><br><span class=\"line\">  );</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>â€ƒâ€ƒ ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ <code>text</code> çš„å€¼ç»å¸¸å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå³ä½¿ <code>handleSubmit</code> ç”¨ <code>useCallback</code> åŒ…è£¹äº†ï¼Œè¿˜æ˜¯ä¼šé‡æ–°å£°æ˜ã€‚è§£å†³åŠæ³•æ˜¯ä¼ å…¥ä¸€ä¸ª <code>ref</code> å¯¹è±¡ä»£æ›¿åŸå§‹å€¼ã€‚ä¹Ÿå¯ä»¥å†™ä¸€ä¸ª custom hook ï¼š<br>\n1ï¼‰å®˜ç½‘çš„ç‰ˆæœ¬ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function useEventCallback(fn, dependencies) &#123;</span><br><span class=\"line\">  const ref = useRef(() =&gt; &#123;</span><br><span class=\"line\">    throw new Error(&apos;Cannot call an event handler while rendering.&apos;);</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">  useEffect(() =&gt; &#123;</span><br><span class=\"line\">    ref.current = fn;</span><br><span class=\"line\">  &#125;, [fn, ...dependencies]);</span><br><span class=\"line\"></span><br><span class=\"line\">  return useCallback(() =&gt; &#123;</span><br><span class=\"line\">    const fn = ref.current;</span><br><span class=\"line\">    return fn();</span><br><span class=\"line\">  &#125;, [ref]);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>å®é™…ä½¿ç”¨ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function Form() &#123;</span><br><span class=\"line\">  const [text, updateText] = useState(&apos;&apos;);</span><br><span class=\"line\">  // Will be memoized even if `text` changes:</span><br><span class=\"line\">  const handleSubmit = useEventCallback(() =&gt; &#123;</span><br><span class=\"line\">    alert(text);</span><br><span class=\"line\">  &#125;, [text]);</span><br><span class=\"line\"></span><br><span class=\"line\">  return (</span><br><span class=\"line\">    &lt;&gt;</span><br><span class=\"line\">      &lt;input value=&#123;text&#125; onChange=&#123;e =&gt; updateText(e.target.value)&#125; /&gt;</span><br><span class=\"line\">      &lt;ExpensiveTree onSubmit=&#123;handleSubmit&#125; /&gt;</span><br><span class=\"line\">    &lt;/&gt;</span><br><span class=\"line\">  );</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>2ï¼‰å¯¼å¸ˆçš„ç‰ˆæœ¬ï¼šï¼ˆä»–æ¥äº†ï¼Œä»–å¸¦ç€ä»£ç åˆæ¥äº†ï¼‰</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/**</span><br><span class=\"line\"> * @param callback</span><br><span class=\"line\"> * @param oRefs</span><br><span class=\"line\"> */</span><br><span class=\"line\">export function useCallbackWithRefs&lt;</span><br><span class=\"line\">  Refs,</span><br><span class=\"line\">  Callback extends (...args: any[]) =&gt; void</span><br><span class=\"line\">&gt;(callback: (refs: Refs) =&gt; Callback, oRefs: Refs) &#123;</span><br><span class=\"line\">  const refs = useRef(oRefs);</span><br><span class=\"line\">  useEffect(</span><br><span class=\"line\">    () =&gt; &#123;</span><br><span class=\"line\">      refs.current = oRefs;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    [oRefs]</span><br><span class=\"line\">  );</span><br><span class=\"line\"></span><br><span class=\"line\">  return useCallback(</span><br><span class=\"line\">    (...args: any[]) =&gt; callback(refs.current)(...args),</span><br><span class=\"line\">    []</span><br><span class=\"line\">  ) as Callback;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>å®é™…ä½¿ç”¨ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function Form() &#123;</span><br><span class=\"line\">  const [text, updateText] = useState(&apos;&apos;);</span><br><span class=\"line\">  </span><br><span class=\"line\">  // åŸå…ˆçš„ callback ä¹Ÿå¯ä»¥æœ‰å‚æ•°</span><br><span class=\"line\">  const handleSubmit = useCallbackWithRefs(</span><br><span class=\"line\">    refs =&gt; (params: any) =&gt; &#123;</span><br><span class=\"line\">      // è¦æ³¨æ„åœ¨å‡½æ•°å†…å¿…é¡»ä½¿ç”¨ `refs.xxx`ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨å‡½æ•°å¤–éƒ¨çš„ä»»ä½•å˜é‡ `xxx`</span><br><span class=\"line\">      console.log(refs.text);</span><br><span class=\"line\">  &#125;, &#123;text&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">  return (</span><br><span class=\"line\">    &lt;&gt;</span><br><span class=\"line\">      &lt;input value=&#123;text&#125; onChange=&#123;e =&gt; updateText(e.target.value)&#125; /&gt;</span><br><span class=\"line\">      &lt;ExpensiveTree onSubmit=&#123;handleSubmit&#125; /&gt;</span><br><span class=\"line\">    &lt;/&gt;</span><br><span class=\"line\">  );</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>â€ƒâ€ƒæ€»çš„æ¥è¯´ï¼Œå®˜ç½‘çš„å®ç°æ˜¯å°† <code>callback</code> ä½œä¸º <code>ref</code> å¯¹è±¡ï¼Œå¹¶ä½œä¸º <code>useCallback</code> çš„ä¾èµ–ï¼Œä¸ä¼šé¢‘ç¹æ”¹å˜ï¼›å¦‚æœåœ¨å‡½æ•° <code>handleSubmit</code> ä¸­è¦è®¿é—®å¤–éƒ¨å˜é‡ <code>text</code> ï¼Œç›´æ¥ä½¿ç”¨ <code>test</code> å³å¯ã€‚ç¬¬äºŒç§å®ç°æ–¹å¼æ˜¯æŠŠç»å¸¸å˜åŒ–çš„å€¼ä½œä¸º <code>ref</code> å¯¹è±¡ï¼Œè¿”å›å€¼ <code>useCallback</code> ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ <code>refs =&gt; callback</code> ï¼Œä¾èµ–æ˜¯ç©ºæ•°ç»„ï¼›è¿™æ—¶å¦‚æœè¦åœ¨å‡½æ•° <code>handleSubmit</code> ä¸­è¦è®¿é—®å¤–éƒ¨å˜é‡ <code>text</code> ï¼Œå¿…é¡»ä½¿ç”¨ <code>refs.test</code> ï¼Œå¦åˆ™è®¿é—®çš„åªæ˜¯ <code>test</code> çš„åˆå§‹å€¼ã€‚<br>\nâ€ƒâ€ƒReact åšå¤§ç²¾æ·±ï¼Œæ¥ä¸‹æ¥è¦å¥½å¥½ç ”è¯»ä¸€ä¸‹è¿™ä¸ª <a href=\"https://reactjs.org/docs/hooks-faq.html\" target=\"_blank\" rel=\"noopener\">FAQ</a>ã€‚<br>\näºŒã€ä»Šæ—¥ç½‘å€<br>\nâ€ƒâ€ƒä¸€ä¸ª <a href=\"https://www.emojicopy.com/\" target=\"_blank\" rel=\"noopener\">emoji copy</a> ç½‘ç«™ï¼Œæˆ‘ä»¬ ğŸ‘§ å°±æ˜¯å–œæ¬¢è¿™äº›èŠ±é‡Œèƒ¡å“¨çš„ä¸œè¥¿ã€‚</p>\n<h4 id=\"2019715\">2019/7/15</h4>\n<p>â€ƒâ€ƒä»Šå¤©åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ React Hooks åˆè¸©å‘äº†ï¼Œçœ‹æ¥è‡ªå·±å¯¹è¿™éƒ¨åˆ†è¿˜æ˜¯æ²¡æœ‰ç†è§£é€å½»ã€‚åœ¨ä½¿ç”¨ <code>useCallback</code> å’Œ <code>useEffect</code> æ—¶ï¼Œè¦æ³¨æ„ç¬¬äºŒä¸ªå‚æ•°ï¼Œä¹Ÿå°±æ˜¯ä¼ å…¥çš„ <code>[deps]</code>ã€‚å¦‚æœä½¿ç”¨ <code>useCallback(fn,[deps])</code> ï¼Œ <code>[deps]</code> åº”è¯¥åŒ…å«å‡½æ•° <code>fn</code> æ‰€æ¶‰åŠçš„æ‰€æœ‰å˜é‡ï¼›å¦‚æœä½¿ç”¨ <code>useEffect(fn,[deps])</code> ï¼Œ å½“ <code>deps</code> çš„å€¼å˜åŒ–æ—¶ï¼Œå°±ä¼šæ‰§è¡Œ <code>fn</code>ï¼Œå› æ­¤<code>[deps]</code> ä¸ä¸€å®šè¦åŒ…å«å‡½æ•° <code>fn</code> æ‰€æ¶‰åŠçš„æ‰€æœ‰å˜é‡ï¼Œè€Œæ˜¯åº”è¯¥ä¼ å…¥ä¼šå¼•èµ·è¯¥å‡½æ•°æ‰§è¡Œçš„é‚£äº›å‚æ•°ã€‚<br>\nâ€ƒâ€ƒä»Šæ—¥è¸©å‘è®°å½•ï¼šä¸ºäº†ä¼˜åŒ–å­ç»„ä»¶ï¼Œä½œä¸º <code>props</code> çš„å‡½æ•°éƒ½ä½¿ç”¨ <code>useCallback</code> åŒ…è£¹äº†ï¼Œå¹¶ä¼ å…¥äº†ç©ºæ•°ç»„ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ï¼Œè¡¨ç¤ºæ²¡æœ‰ä¾èµ–ã€‚ä½†æ˜¯å‡½æ•°ä¸­çš„è¿ç®—éœ€è¦ç”¨åˆ°ç»„ä»¶ä¸­ä¸€ä¸ªå˜é‡ï¼Œå¦‚æœæ²¡æœ‰å°†è¯¥å˜é‡ä½œä¸º <code>deps</code> ï¼Œè¿™ä¸ªå˜é‡å°±ä¼šä¸€ç›´ä¿æŒåˆå§‹å€¼ï¼Œå€¼å¹¶ä¸ä¼šæ”¹å˜ï¼Œè¿è¡Œç»“æœå°±ä¼šä¸é¢„æœŸä¸ç¬¦ã€‚ï¼ˆçœŸçš„å¤ªè ¢äº†ï¼Œç¼“ç¼“èººå€’ï¼‰</p>\n<h4 id=\"2019714\">2019/7/14</h4>\n<p>å‘¨æœ«å½“ç„¶æ˜¯çº¦ä¼šå•¦ã€‚ğŸ˜</p>\n<h4 id=\"2019713\">2019/7/13</h4>\n<p>ä¸€ã€ä»Šæ—¥é˜…è¯»ï¼š<a href=\"https://stackoverflow.com/questions/53446020/how-to-compare-oldvalues-and-newvalues-on-react-hooks-useeffect\" target=\"_blank\" rel=\"noopener\">How to compare oldValues and newValues on React Hooks useEffect?</a><br>\nâ€ƒâ€ƒ React class ç»„ä»¶æä¾›äº† <code>ComponentDidUpdate</code> ä¹‹ç±»çš„æ–¹æ³•æ¥è·å–åˆ°å½“å‰ <code>props</code> å’Œå‰ä¸€ä¸ª <code>props</code> ï¼Œå¹¶è¿›è¡Œæ¯”è¾ƒï¼Œå†³å®šæ˜¯å¦è¿›è¡Œæ›´æ–°ã€‚å‡½æ•°å¼ç»„ä»¶åªæœ‰ <code>useEffect</code> å‡½æ•°æ¥æ¨¡ä»¿ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œå½“æˆ‘ä»¬éœ€è¦è·å–ç»„ä»¶å…ˆå‰çš„ <code>props</code> æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ custom hook ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function usePrevious(value) &#123;</span><br><span class=\"line\">  const ref = useRef();</span><br><span class=\"line\">  useEffect(() =&gt; &#123;</span><br><span class=\"line\">    ref.current = value;</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">  return ref.current;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>â€ƒâ€ƒä¹‹ååœ¨ <code>useEffect</code> ä¸­ä½¿ç”¨ä¸Šé¢çš„å‡½æ•°æ¥æ¨¡æ‹Ÿ <code>ComponentDidUpdate</code> ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const Component = (props) =&gt; &#123;</span><br><span class=\"line\">    const &#123;receiveAmount, sendAmount &#125; = props</span><br><span class=\"line\">    const prevAmount = usePrevious(&#123;receiveAmount, sendAmount&#125;);</span><br><span class=\"line\">    useEffect(() =&gt; &#123;</span><br><span class=\"line\">        if(prevAmount.receiveAmount !== receiveAmount) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">         // process here</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        if(prevAmount.sendAmount !== sendAmount) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">         // process here</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;, [receiveAmount, sendAmount])</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>â€ƒâ€ƒæœ‰æ—¶å€™åœ¨ debug æ—¶ï¼Œæˆ‘ä»¬æƒ³çŸ¥é“ç»„ä»¶ä¸ºä»€ä¹ˆä¼šé‡æ–°æ¸²æŸ“ï¼Œæ˜¯é‚£äº› <code>props</code> æ›´æ–°äº†ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸Šé¢çš„æ–¹æ³•æ¥è·å– <code>prevProps</code>ï¼Œå¹¶åœ¨å‡½æ•°ç»„ä»¶æœ€å¼€å§‹æ—¶å†™ä¸€ä¸ª <code>useEffect</code> å°†å‚æ•°éƒ½æ‰“å°å‡ºæ¥ï¼Œä½¿ç”¨ <code>===</code> æ¯”è¾ƒã€‚</p>\n<h4 id=\"2019712\">2019/7/12</h4>\n<p>ä¸€ã€ä»Šæ—¥æŠ€èƒ½<br>\nâ€ƒâ€ƒé¡¹ç›®ä¸­ç»å¸¸ä¼šæ¶‰åŠåˆ° JSON å­—ç¬¦ä¸²çš„è§£æï¼Œè§£æå‡ºé”™å°±æ‰‘è¡—äº†ï¼Œä¸€èˆ¬æ˜¯ç”¨ <code>try {...} catch {...}</code> åŒ…è£¹ã€‚ä»Šå¤©å¯¼å¸ˆåœ¨ code review æ—¶å»ºè®®æˆ‘ä½¿ç”¨å¦‚ä¸‹å‡½æ•°ï¼Œè¯¥å‡½æ•°ä¹Ÿå¯ä»¥è¦†ç›–ç©ºå­—ç¬¦ä¸²çš„æ£€æµ‹ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function safeJsonParse&lt;T&gt;(str): &#123; ok: true, value: T &#125; | &#123; ok: false &#125; &#123;</span><br><span class=\"line\">  try &#123;</span><br><span class=\"line\">    return &#123;</span><br><span class=\"line\">      ok: true,</span><br><span class=\"line\">      value: JSON.parse(str)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125; catch &#123;</span><br><span class=\"line\">    return &#123;</span><br><span class=\"line\">      ok: false</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>äºŒã€ä»Šæ—¥é˜…è¯»ï¼š<a href=\"https://imweb.io/topic/5b72d4ef15554e6d3409f817\" target=\"_blank\" rel=\"noopener\">ä»æµè§ˆå™¨å¤šè¿›ç¨‹åˆ°JSå•çº¿ç¨‹ï¼ŒJSè¿è¡Œæœºåˆ¶æœ€å…¨é¢çš„ä¸€æ¬¡æ¢³ç†</a>ã€‚<br>\nâ€ƒâ€ƒè¿™ä¸€ç¯‡å¾ˆå¥½åœ°æ¢³ç†äº†è¿›ç¨‹ã€çº¿ç¨‹ã€æµè§ˆå™¨<strong>å¤šè¿›ç¨‹</strong>ã€æµè§ˆå™¨å†…æ ¸<strong>å¤šçº¿ç¨‹</strong>ã€JSå•çº¿ç¨‹ã€JSè¿è¡Œæœºåˆ¶çš„ç›¸å…³çŸ¥è¯†ï¼Œå¾ˆè¿è´¯ï¼Œå»ºè®®æ—¶ä¸æ—¶å›é¡¾ã€‚ç®€å•è®°å½•å‡ ä¸ªçŸ¥è¯†ç‚¹ï¼š<br>\n1ï¼‰è¿›ç¨‹æ˜¯CPUèµ„æºåˆ†é…çš„æœ€å°å•ä½ï¼Œçº¿ç¨‹æ˜¯CPUè°ƒåº¦çš„æœ€å°å•ä½ã€‚ï¼ˆæƒ³å½“å¹´è€ƒæ“ä½œç³»ç»Ÿçš„æ—¶å€™è¿˜èƒŒå¾—æ»šç“œçƒ‚ç†Ÿï¼‰<br>\n2ï¼‰<strong>æµè§ˆå™¨æ˜¯å¤šè¿›ç¨‹çš„</strong>ï¼ŒåŒ…æ‹¬çš„ä¸»è¦è¿›ç¨‹æœ‰ï¼š</p>\n<ul>\n<li>Browserè¿›ç¨‹ï¼ˆæµè§ˆå™¨çš„ä¸»è¿›ç¨‹ï¼Œåªæœ‰ä¸€ä¸ªï¼‰</li>\n<li>æµè§ˆå™¨æ¸²æŸ“è¿›ç¨‹ï¼ˆæµè§ˆå™¨å†…æ ¸ï¼ŒRendererè¿›ç¨‹ï¼Œæ¸²æŸ“è¿›ç¨‹ï¼Œå†…éƒ¨æ˜¯å¤šçº¿ç¨‹çš„ï¼‰ï¼šé»˜è®¤æ¯ä¸ªTabä¸€ä¸ªè¿›ç¨‹</li>\n<li>ç¬¬ä¸‰æ–¹æ’ä»¶è¿›ç¨‹</li>\n<li>GPUè¿›ç¨‹ï¼š3Dç»˜åˆ¶</li>\n</ul>\n<p>3ï¼‰é‡ç‚¹æ˜¯æµè§ˆå™¨å†…æ ¸ï¼Œå®ƒæ˜¯å¤šçº¿ç¨‹çš„ï¼Œä¸»è¦å¸¸é©»çº¿ç¨‹æœ‰ï¼š</p>\n<ul>\n<li>GUIæ¸²æŸ“çº¿ç¨‹ï¼šæ¸²æŸ“é¡µé¢ï¼Œè§£æHTMLï¼ŒCSSï¼Œæ„å»ºDOMæ ‘å’ŒRenderObjectæ ‘ï¼Œå¸ƒå±€å’Œç»˜åˆ¶ï¼Œrepaint å’Œ reflow ç­‰ã€‚</li>\n<li>JSå¼•æ“çº¿ç¨‹ï¼šå¤„ç†ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼Œä¸ GUI æ¸²æŸ“çº¿ç¨‹æ˜¯äº’æ–¥çš„ã€‚</li>\n<li>äº‹ä»¶è§¦å‘çº¿ç¨‹ï¼šæ§åˆ¶äº‹ä»¶å¾ªç¯ï¼ŒæŠŠäº‹ä»¶æ·»åŠ åˆ°ä»»åŠ¡é˜Ÿåˆ—çš„æœ«å°¾ã€‚</li>\n<li>å®šæ—¶è§¦å‘çº¿ç¨‹ï¼š<code>setTimeout</code> å’Œ <code>setInterval</code>ï¼ŒåŒæ ·ä¹Ÿæ˜¯è®¡æ—¶å®Œæ¯•åæ·»åŠ åˆ°é˜Ÿåˆ—æœ«å°¾ã€‚</li>\n<li>å¼‚æ­¥ http è¯·æ±‚çº¿ç¨‹</li>\n</ul>\n<p>4ï¼‰Browserè¿›ç¨‹å’Œæµè§ˆå™¨å†…æ ¸ä¹‹é—´æ˜¯éœ€è¦é€šä¿¡çš„<br>\n5ï¼‰æ—¶é—´å¾ªç¯æœºåˆ¶ <code>Event Loop</code> ï¼šJSåˆ†ä¸ºåŒæ­¥ä»»åŠ¡å’Œå¼‚æ­¥ä»»åŠ¡ï¼ŒåŒæ­¥ä»»åŠ¡éƒ½ä¼šåœ¨ä¸»çº¿ç¨‹ä¸Šè¿è¡Œï¼Œå½¢æˆä¸€ä¸ªæ‰§è¡Œæ ˆï¼›ä¸»çº¿ç¨‹ä¹‹å¤–ï¼Œç”±äº‹ä»¶è§¦å‘çº¿ç¨‹ç®¡ç†ä¸€ä¸ª<strong>ä»»åŠ¡é˜Ÿåˆ—/äº‹ä»¶é˜Ÿåˆ—</strong>ï¼Œå¼‚æ­¥ä»»åŠ¡çš„è¿è¡Œç»“æœä¼šè¢«æ·»åŠ åˆ°ä»»åŠ¡é˜Ÿåˆ—ä¸­ã€‚ä¸€æ—¦æ‰§è¡Œæ ˆä¸­æ‰€æœ‰åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œç³»ç»Ÿå°±ä¼šè¯»å–ä»»åŠ¡é˜Ÿåˆ—ï¼Œå°†å¯è¿è¡Œçš„å¼‚æ­¥ä»»åŠ¡æ·»åŠ åˆ°æ‰§è¡Œæ ˆä¸­å¼€å§‹æ‰§è¡Œã€‚<br>\n6ï¼‰è¿›é˜¶ï¼šmacrotask / task å’Œ microtask/ jobã€‚ES6ä¸­çš„ <code>Promise</code> å°±å±äº microtask å¾®ä»»åŠ¡ ï¼Œè€Œä¸»ä»£ç å—ï¼Œäº‹ä»¶é˜Ÿåˆ—ä¸­çš„æ—¶é—´å¦‚ <code>setTimeout</code> å’Œ <code>setInterval</code> å°±å±äº macrotask å®ä»»åŠ¡ã€‚æ€»ç»“çš„è¿è¡Œæœºåˆ¶å°±æ˜¯ï¼š</p>\n<ul>\n<li>æ‰§è¡Œå®ä»»åŠ¡ã€‚ï¼ˆä»æ‰§è¡Œæ ˆä¸­è·å–ï¼Œå¦‚æœæ²¡æœ‰å°±ä»äº‹ä»¶é˜Ÿåˆ—ä¸­è·å–ï¼‰</li>\n<li>æ‰§è¡Œè¿‡ç¨‹ä¸­å¦‚æœé‡åˆ°å¾®ä»»åŠ¡ï¼Œå°±æ·»åŠ åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ— Job Queues ä¸­ã€‚ï¼ˆä½œè€…çŒœæµ‹è¿™ä¸ªé˜Ÿåˆ—ç”±JSå¼•æ“çº¿ç¨‹ç»´æŠ¤ï¼Œå› ä¸ºæ˜¯åœ¨ä¸»çº¿ç¨‹ä¸‹æ— ç¼æ‰§è¡Œçš„ï¼‰</li>\n<li>å®ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åï¼Œç«‹å³ä¾æ¬¡æ‰§è¡Œå½“å‰å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­æ‰€æœ‰å¾®ä»»åŠ¡ã€‚</li>\n<li>æ£€æŸ¥æ¸²æŸ“ï¼Œç”± GUI çº¿ç¨‹æ¥ç®¡ã€‚</li>\n<li>æ¸²æŸ“å®Œæ¯•åï¼Œç”± JS å¼•æ“çº¿ç¨‹æ¥ç®¡ï¼Œä»æ—¶é—´é˜Ÿåˆ—ä¸­è·å–å¹¶æ‰§è¡Œä¸‹ä¸€ä¸ªå®ä»»åŠ¡ã€‚</li>\n</ul>\n<p>7ï¼‰åœ¨ç¬¬å…­ç‚¹ä¸­æåˆ°çš„æ˜¯ä¸€ä¸ªè¿›é˜¶çš„æ¦‚å¿µï¼Œå¯¹åº”ä¸€é“é¢˜ç›®ï¼Œå¦‚æœä»£ç ä¸­ä¾æ¬¡æœ‰ <code>setTimeout</code> å’Œ <code>Promise</code> ï¼Œæ˜¯ä¼šå…ˆæ‰“å°å‡º <code>Promise</code> çš„æ‰§è¡Œç»“æœçš„ã€‚</p>\n<h4 id=\"2019711\">2019/7/11</h4>\n<p>â€ƒâ€ƒ React 16.8 æå‡ºäº† <code>hook</code> çš„æ¦‚å¿µï¼Œå‡½æ•°å¼ç»„ä»¶ä¹Ÿå¯ä»¥æ‹¥æœ‰è‡ªå·±çš„çŠ¶æ€ã€‚ç°åœ¨çš„å·¥ä½œé¡¹ç›®å·²ç»æ‘’å¼ƒäº† <code>class</code> ï¼Œæ”¹ç”¨å‡½æ•°å¼ç»„ä»¶ï¼Œæ­£åœ¨æ…¢æ…¢æ‘¸ç´¢ä¸­ã€‚ä»Šå¤©åœ¨è…¾è®¯<a href=\"http://imweb.io/\" target=\"_blank\" rel=\"noopener\">IMWebå‰ç«¯åšå®¢</a>ä¸­çœ‹åˆ°äº†ä¸¤ç¯‡ä»‹ç» <code>React hook</code> çš„æ–‡ç« ï¼Œå—ç›ŠåŒªæµ…ï¼Œç®€å•è®°å½•ä¸€ä¸‹ã€‚<br>\nä¸€ã€<a href=\"https://imweb.io/topic/5cd845cadcd62f86299fcd76\" target=\"_blank\" rel=\"noopener\">react hookâ€”â€”ä½ å¯èƒ½ä¸æ˜¯â€œæˆ‘â€æ‰€è®¤è¯†çš„useEffect</a><br>\nâ€ƒâ€ƒè¿™ç¯‡ä»‹ç»äº† <code>useEffect</code> è¿™ä¸ªAPIï¼Œç”¨å®ƒæ¨¡æ‹Ÿäº†classç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ã€‚<code>useEffect</code> ç”¨äºæ‰§è¡Œå‰¯ä½œç”¨ï¼Œç›¸å½“äº <code>ComponentDidMount</code> å’Œ <code>ComponentDidUpdate</code>ã€‚è¯¥APIæœ‰ä¸¤ä¸ªå‚æ•°å’Œä¸€ä¸ªè¿”å›å€¼ã€‚ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå‰¯ä½œç”¨å‡½æ•°ï¼Œè¿”å›å€¼æ˜¯æ¸…é™¤å‡½æ•°ï¼Œç›¸å½“äº <code>ComponentWillUnmount</code>ï¼Œæ¯ä¸€æ¬¡ <code>render</code> éƒ½ä¼šæ‰§è¡Œå‰¯ä½œç”¨å’Œæ¸…é™¤ä¸Šä¸€æ¬¡å‰¯ä½œç”¨ã€‚<strong>ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä¼ å…¥çš„æ˜¯å‰¯ä½œç”¨å‡½æ•°æ‰€éœ€è¦çš„ä¾èµ–ï¼Œå½“ä»»ä¸€ä¾èµ–æ›´æ–°æ—¶ï¼Œä¼šé‡æ–°ç”Ÿæˆä¸€ä¸ªæ–°çš„å‰¯ä½œç”¨å¹¶æ‰§è¡Œï¼›å¦‚æœä¼ å…¥ä¸€ä¸ªç©ºæ•°ç»„ï¼Œæ²¡æœ‰ä¾èµ–ï¼Œåªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œç›¸å½“äº <code>ComponentDidMount</code>ï¼›å¦‚æœä¸ä¼ ï¼Œå°±æ˜¯æ²¡æœ‰è¯´æ˜è‡ªå·±æœ‰æ²¡æœ‰ä¾èµ–ï¼ˆæ³¨æ„æ˜¯ä¸çŸ¥é“æœ‰æ²¡æœ‰ï¼Œä¸æ˜¯æ²¡æœ‰ï¼ï¼‰ï¼Œæ¯æ¬¡ <code>render</code> æ—¶å°±æ‰§è¡Œï¼Œç›¸å½“äº <code>ComponentDidUpdate</code> ã€‚</strong><br>\nâ€ƒâ€ƒ æœ€åè¿˜è®²äº† <code>useEffect</code> å’Œ <code>useLayoutEffect</code> çš„åŒºåˆ«ï¼Œç®€å•æ¥è¯´å‰è€…æ˜¯å¼‚æ­¥çš„ï¼Œåè€…æ˜¯åŒæ­¥çš„ã€‚è¿˜æ²¡å¥½å¥½æ·±å…¥è¿™éƒ¨åˆ†ï¼ŒTODOã€‚<br>\näºŒã€<a href=\"https://imweb.io/topic/5d1e3657f7b5692b080f2651\" target=\"_blank\" rel=\"noopener\">å¯èƒ½ä½ çš„reactå‡½æ•°ç»„ä»¶ä»æ¥æ²¡æœ‰ä¼˜åŒ–è¿‡</a><br>\nâ€ƒâ€ƒä¼˜åŒ–é—®é¢˜çœŸæ˜¯æˆ‘ä¸€ä¸ªç—›ç‚¹ã€‚è¿™ç¯‡æ–‡ç« å¾ˆæ¸…æ¥šåœ°è§£é‡Šäº† <code>Hooks</code> ä¸€äº›å¯ç”¨äºç»„ä»¶ä¼˜åŒ–çš„APIã€‚å¼ºæ¨ï¼<br>\nâ€ƒâ€ƒ ç‰¹åˆ«åœ°ï¼Œæ–‡ç« ä»‹ç»äº†å½“å‡½æ•°ç»„ä»¶ä¸­ä¼ å…¥çš„ <code>props</code> å€¼ä¸ºå‡½æ•°æ—¶ï¼Œç”±äºæ¯ä¸€æ¬¡æ‰§è¡Œæˆ–é‡æ–°æ‰§è¡Œï¼Œä½œç”¨åŸŸé‡Œé¢ä¸€åˆ‡éƒ½æ˜¯é‡æ–°å¼€å§‹ï¼Œå‡½æ•°ä¸æ˜¯ç®€å•æ•°æ®ç±»å‹ï¼Œä¸èƒ½ç”»ä¸Šç­‰å·ï¼Œå­ç»„ä»¶éƒ½ä¼šé‡æ–°æ¸²æŸ“ã€‚é’ˆå¯¹è¿™ä¸ªé—®é¢˜æ–‡ç« æå‡ºäº†å‡ ç§è§£å†³åŠæ³•ï¼š<br>\n1ï¼‰ ä½œä¸º <code>props</code> çš„å‡½æ•°åœ¨å‡½æ•°ç»„ä»¶å¤–å®šä¹‰ï¼Œå‡½æ•°ç»„ä»¶ç”¨ <code>React.memo()</code> åŒ…è£¹ã€‚<br>\nâ€ƒâ€ƒ <code>React.memo()</code> ç±»ä¼¼äº <code>PureComponent</code> å’Œ <code>ComponentDidUpdate</code> ï¼Œå¦‚æœå‡½æ•°ç»„ä»¶çš„ <code>props</code> å€¼éƒ½ä¸€æ ·ï¼Œå°±ä¼šè·³è¿‡è¯¥ç»„ä»¶çš„æ‰§è¡Œï¼Œå‡å°‘ä¸å¿…è¦çš„æ¸²æŸ“ï¼Œå®ç°æ€§èƒ½ä¼˜åŒ–ã€‚<br>\n2ï¼‰ ä½œä¸º <code>props</code> çš„å‡½æ•°åœ¨å‡½æ•°ç»„ä»¶å†…å®šä¹‰ï¼Œä½¿ç”¨<code>useCallBack</code> æˆ– <code>useMemo</code>åŒ…è£¹ï¼Œå‡½æ•°ç»„ä»¶ç”¨ <code>React.memo()</code> åŒ…è£¹ã€‚<br>\nâ€ƒâ€ƒ <code>useCallback(() =&gt; {}, [deps])</code> è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œå½“ <code>deps</code> ä¸å˜æ—¶ï¼ˆå¦‚ä¼ å…¥ç©ºæ•°ç»„ï¼Œè¡¨ç¤ºæ²¡æœ‰ä¾èµ–ï¼‰ï¼Œéƒ½æ˜¯åŒä¸€ä¸ªå‡½æ•°ã€‚<code>const a = useMemo(() =&gt; memorizeValue, [deps])</code>ï¼Œå½“ <code>deps</code> ä¸å˜æ—¶ï¼Œ<code>a</code> çš„å€¼è¿˜æ˜¯ä¸Šæ¬¡çš„ <code>memorizeValue</code>ï¼Œçœå»äº†é‡æ–°è®¡ç®—çš„è¿‡ç¨‹ã€‚<br>\nâ€ƒâ€ƒ æ³¨æ„å½“ <code>memorizeValue</code> æ˜¯ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œ<code>useCallback(fn, inputs) &lt;=&gt; useMemo(() =&gt; fn, inputs)</code>ã€‚</p>\n<h4 id=\"2019710\">2019/7/10</h4>\n<p>â€ƒâ€ƒä»Šå¤©åœ¨é¡¹ç›®ä¸­æ¥è§¦åˆ°äº† <code>symbol</code>ï¼Œé‰´äºä¹‹å‰ä¸€ç›´æ²¡æœ‰æ³¨æ„è¿™ä¸ªæ•°æ®ç±»å‹ï¼Œåœ¨ä»Šå¤©è¡¥ä¸Šã€‚ <code>symbol</code> æ˜¯ ES6 æ–°å¢çš„<strong>åŸºæœ¬</strong>æ•°æ®ç±»å‹ã€‚å®ƒçš„ä½¿ç”¨å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const s1 = Symbol();</span><br><span class=\"line\">const s2 = Symbol();</span><br><span class=\"line\">console.log(s1 === s2); // false</span><br><span class=\"line\"></span><br><span class=\"line\">const s3 = new Symbol() // TypeError: Symbol is not a constructor</span><br><span class=\"line\">Symbol(&quot;foo&quot;) === Symbol(&quot;foo&quot;); // false</span><br></pre></td></tr></table></figure>\n<p><code>Symbol()</code> è¿”å›çš„æ¯ä¸ª <code>symbol</code> å€¼éƒ½æ˜¯å”¯ä¸€çš„ï¼Œå¯ä»¥æ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ã€‚å®ƒæœ€å¸¸è¢«ç”¨äºå¯¹è±¡å±æ€§çš„æ ‡è¯†ç¬¦ï¼Œå¦‚ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const obj = &#123;&#125;</span><br><span class=\"line\">const foo = Symbol(&quot;foo&quot;)</span><br><span class=\"line\">obj[foo] = &quot;foo&quot;</span><br><span class=\"line\">obj.bar = &quot;bar&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">console.log(obj); // &#123; bar: &quot;bar&quot; , Symbol(foo): &quot;foo&quot;&#125;</span><br><span class=\"line\">console.log(foo in obj); // true</span><br><span class=\"line\">console.log(obj[foo]); // foo</span><br><span class=\"line\">console.log(Object.keys(obj)); // [&quot;bar&quot;]</span><br><span class=\"line\">console.log(Object.getOwnPropertySymbols(obj)) // [Symbol(foo)]</span><br></pre></td></tr></table></figure>\n<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œ <code>Object.key()</code> ä¸ä¼šè¿”å› <code>symbol</code> å€¼ï¼ŒåŒç†ï¼Œ<code>Object.getOwnPropertyNames()</code>ã€<code>for..in</code>ã€<code>for...of</code> ä¹Ÿä¸ä¼šè¿”å›ã€‚<code>JSON.stringify()</code> ä¹Ÿä¼šå¿½ç•¥ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">JSON.stringify(&#123;[Symbol(&apos;foo&apos;)]: &apos;foo&apos;&#125;);                 </span><br><span class=\"line\">// &apos;&#123;&#125;&apos;</span><br></pre></td></tr></table></figure>\n<p><code>Symbol</code> è¿˜æœ‰ä¸¤ä¸ªæ–¹æ³•ã€‚ <code>Symbol.for(key)</code> æ˜¯æ ¹æ®æŒ‡å®šçš„ <code>key</code> æœç´¢ç°æœ‰çš„ <code>symbol</code> å¹¶è¿”å›, å¦‚æœæ‰¾ä¸åˆ°ï¼Œä¼šä½¿ç”¨ <code>key</code> åœ¨å…¨å±€çš„ <code>symbol</code> æ³¨å†Œè¡¨ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„ <code>symbol</code> ã€‚<code>Symbol.keyFor(sym)</code> æ˜¯åœ¨å…¨å±€æ³¨å†Œè¡¨ä¸­æ£€ç´¢ï¼Œè¿”å›å…±äº«çš„ <code>symbol key</code> ã€‚</p>\n<h4 id=\"201979\">2019/7/9</h4>\n<p>ä¸€ä¸ªä¸å¥½çš„ç¼–ç¨‹ä¹ æƒ¯ï¼šè®©å‡½æ•°åœ¨å†…éƒ¨è·å–è‡ªå·±æ‰€éœ€çš„ä¾èµ–ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// ä¸€ä¸ªå¯å¤ç”¨å‡½æ•°</span><br><span class=\"line\">function doSomething(key: string) &#123;</span><br><span class=\"line\">    return (</span><br><span class=\"line\">        &lt;Button</span><br><span class=\"line\">            loading = &#123;key===&quot;str1&quot;? Compoment1 : Compoment2&#125;</span><br><span class=\"line\">        &gt;</span><br><span class=\"line\">            button</span><br><span class=\"line\">        &lt;/Button&gt;</span><br><span class=\"line\">    )</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>lodaing</code> æ‰€éœ€çš„ç»„ä»¶åº”è¯¥æ˜¯ä½œä¸ºå‡½æ•°å‚æ•°ä¼ å…¥çš„ï¼Œä¸ç„¶å¦‚æœæˆ‘ä»¬æ–°å¢äº†ä¸€ä¸ª <code>key</code>ï¼Œå¾ˆå®¹æ˜“å¿½ç•¥äº†è¯¥åœ°æ–¹çš„ä¿®æ”¹ã€‚è¿™ä¸ªè§‚ç‚¹ç±»ä¼¼äºä¾èµ–åè½¬ã€‚</p>\n","site":{"data":{}},"excerpt":"","more":"<h4>å‰è¨€</h4>\n<p>ğŸ“ recap and cheat sheet ï¼Œè®°å½•æ¯å¤©å­¦åˆ°çš„çŸ¥è¯†/æƒ³æ³•ã€‚<br>\nğŸ”Š æ¯æ—¥ä¸€é—®ï¼šä»Šå¤©ä½ æ¯”æ˜¨å¤©æ›´åšå­¦äº†å—ï¼Ÿ</p>\n<h4>2019/8/25</h4>\n<p>ä»Šæ—¥è¸©å‘è®°å½•ï¼š<br>\nå±•å¼€è¯­æ³•ï¼ˆspread syntaxï¼‰åªèƒ½å–åˆ° enumerable propertiesã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const imageData = new ImageData(200, 100);</span><br><span class=\"line\">// ImageData &#123; width: 200, height: 100, data: Uint8ClampedArray[80000] &#125;</span><br><span class=\"line\">const result = &#123;...imageData&#125;</span><br><span class=\"line\">// result åªä¼šåŒ…å« data ï¼Œä¸èƒ½å–åˆ° width å’Œ height</span><br></pre></td></tr></table></figure>\n<h4>2019/8/24</h4>\n<p>é¿å…ç»„ä»¶é‡æ–°æŒ‚è½½ï¼Œå¯ä»¥ä½¿ç”¨äº‹ä»¶çš„å½¢å¼ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">class BussinessProvider &#123;</span><br><span class=\"line\">  sp$ = new Subject&lt;&#123;url: string, slic: string&#125;&gt;();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class Canvas &#123;</span><br><span class=\"line\">  componentDidMount() &#123;</span><br><span class=\"line\">     this.props.sp$.pipe(takeUntil(this.unmount$)).subscribe(ev =&gt; &#123;</span><br><span class=\"line\">        if (ev.url === this.url) &#123;</span><br><span class=\"line\">           this.handleSuperPixelChange(ev.slic)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">     &#125;)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4>2019/8/24</h4>\n<p>ä¸€ã€Promise</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">new Promise((resolve,reject) =&gt; &#123;</span><br><span class=\"line\">  // do something...</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">promise.then(onFulfilled[, onRejected]);</span><br><span class=\"line\">promise.then(value =&gt; &#123;</span><br><span class=\"line\">  // fulfillment</span><br><span class=\"line\">&#125;, reason =&gt; &#123;</span><br><span class=\"line\">  // rejection</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">promise.catch(onRejected);</span><br><span class=\"line\">promise.catch(function(reason) &#123;</span><br><span class=\"line\">   // rejection</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<p>ç®€å•æ¥è¯´ï¼Œ<code>reject(value)</code> å¯ä»¥è¢« <code>promise.then</code> ç¬¬äºŒä¸ªå‡½æ•°å‚æ•°æ•è·ï¼Œä¹Ÿå¯ä»¥è¢« <code>promise.catch</code> æ•è·ã€‚å¦‚æœä¸¤è€…åŒæ—¶å­˜åœ¨ï¼Œä¼šè¢« <code>promise.then</code> ç¬¬äºŒä¸ªå‡½æ•°å‚æ•°æ•è·ï¼Œ<code>promise.catch</code> æ— è¾“å‡ºã€‚</p>\n<p>ä¸‹è½½å›¾ç‰‡çš„å…¸å‹ä¾‹å­ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function loadImage(url) &#123;</span><br><span class=\"line\">  return new Promise((resolve, reject) =&gt; &#123;</span><br><span class=\"line\">    let img = new Image();</span><br><span class=\"line\">    // img.onload = () =&gt; resolve(img)</span><br><span class=\"line\">    img.addEventListener(&apos;load&apos;, e =&gt; resolve(img));</span><br><span class=\"line\">    // img.onerror = () =&gt; reject(XXX)</span><br><span class=\"line\">    img.addEventListener(&apos;error&apos;, () =&gt; &#123;</span><br><span class=\"line\">      reject(new Error(`Failed to load image&apos;s URL: $&#123;url&#125;`));</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    img.src = url;</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">loadImage(&apos;http://thecatapi.com/api/images/get?format=src&amp;type=jpg&amp;size=small&apos;)</span><br><span class=\"line\">  .then(img =&gt; document.getElementById(&apos;image-holder&apos;).appendChild(img))</span><br><span class=\"line\">  .catch(error =&gt; console.error(error));</span><br></pre></td></tr></table></figure>\n<p>äºŒã€await<br>\n<code>[rv] = await expression</code>:</p>\n<blockquote>\n<p>TL;DR returns the fulfilled value of the promise,<br>\nThe await expression causes async function execution to pause until a Promise is settled, that is fulfilled or rejected, and to resume execution of the async function after fulfillment. When resumed, the value of the await expression is that of the fulfilled Promise.<br>\nIf the Promise is rejected, the await expression throws the rejected value.<br>\nIf the value of the expression following the await operator is not a Promise, itâ€™s converted to a resolved Promise.</p>\n</blockquote>\n<h4>2019/8/23</h4>\n<p><code>String.prototype.localeCompare()</code></p>\n<blockquote>\n<p>return a number, indicating whether the reference string comes before, after or is the same as the compareString in sort order. Returns one of three values:<br>\n-1: if the reference string is sorted before the compareString<br>\n0: if the two strings are equal<br>\n1: if the reference string is sorted after the compareString</p>\n</blockquote>\n<p><code>Array.prototype.sort()</code></p>\n<blockquote>\n<p>sorts the elements of an array in place and returns the sorted array.</p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">items.sort((a,b) =&gt; a.localeCompare(b))</span><br></pre></td></tr></table></figure>\n<h4>2019/8/21</h4>\n<p>ä»Šæ—¥é˜…è¯»ï¼š<br>\n<a href=\"https://stackoverflow.com/questions/52499617/what-is-the-difference-between-npm-install-and-npm-ci\" target=\"_blank\" rel=\"noopener\">What is the difference between â€œnpm installâ€ and â€œnpm ciâ€?</a><br>\n<a href=\"https://medium.com/coinmonks/everything-you-wanted-to-know-about-package-lock-json-b81911aa8ab8\" target=\"_blank\" rel=\"noopener\">Everything You Wanted To Know About package-lock.json But Were Too Afraid To Ask</a></p>\n<h4>2019/8/20</h4>\n<p>æ¨¡ä»¿ react hook <code>useState</code> çš„ç¬¬äºŒä¸ªå‚æ•°ï¼š<br>\nâ€ƒâ€ƒå› ä¸ºåœ¨ jest æµ‹è¯•ä¸­æŸä¸ªå‡½æ•°çš„å‚æ•°æ˜¯ <code>useState</code> çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œå†™äº†ä¸€ä¸ªæ›¿ä»£ï¼Œä¸è¿‡ä¸ç¡®å®šæ˜¯å¦æœ‰é”™ã€‚ğŸ˜³</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// for example</span><br><span class=\"line\">const [str,setStr] = useState&lt;string[]&gt;([]);</span><br><span class=\"line\"></span><br><span class=\"line\">// fake setStr</span><br><span class=\"line\">let str:string[] = [];</span><br><span class=\"line\">const setStr = (val: string[] | ((prev:string[]) =&gt; string[])) =&gt; &#123;</span><br><span class=\"line\">  if (typeof val === &quot;object&quot;) &#123;</span><br><span class=\"line\">    str = val;</span><br><span class=\"line\">  &#125; else if (typeof val === &quot;function&quot;) &#123;</span><br><span class=\"line\">    str = val(str)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4>2019/8/19</h4>\n<p>ä»Šæ—¥é˜…è¯»ï¼š<a href=\"https://searchenginelaws.com/seo/what-is-rel-noopener-noreferrer-tag/\" target=\"_blank\" rel=\"noopener\">What is rel=noopener noreferrer link</a><br>\nâ€ƒâ€ƒä½¿ç”¨ <code>a</code> æ ‡ç­¾ï¼Œä¸”å±æ€§ <code>target=&quot;_blank&quot;</code> æ—¶ï¼Œéœ€è¦åŠ ä¸Š <code>rel=&quot;noopener noreferrer&quot;</code> ã€‚å¯ä»¥é˜²æ­¢æ–°çª—å£åˆ©ç”¨ <code>window.opener</code> çš„ç‰¹æ€§çªƒå–åŸçª—å£ä¿¡æ¯ã€‚å…·ä½“è€Œè¨€ï¼Œå¦‚æœ window A æ‰“å¼€äº† window Bï¼Œé‚£ä¹ˆ B.opener ä¼šè¿”å› Aã€‚å¦‚æœåŠ ä¸Š <code>rel=&quot;noopener&quot;</code> ï¼Œä¼šè¿”å› null ã€‚</p>\n<h4>2019/8/12</h4>\n<p>ä¸€ã€download files using axios</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import axios from &quot;axios&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">axios.get(url,&#123;</span><br><span class=\"line\">  responseType: &apos;blob&apos;, // important</span><br><span class=\"line\">  headers: &#123;</span><br><span class=\"line\">    &apos;Authorization&apos;: AuthStr </span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;).then(resp =&gt; &#123;</span><br><span class=\"line\">  const &#123;data&#125; = resp;</span><br><span class=\"line\">  const file = new File([data],&quot;data.txt&quot;);</span><br><span class=\"line\">  const objectURL = URL.createObjectURL(file);</span><br><span class=\"line\">  const a = document.createElement(&quot;a&quot;);</span><br><span class=\"line\">  a.href = objectURL;</span><br><span class=\"line\">  a.download = &quot;data.txt&quot;;</span><br><span class=\"line\">  a.click();</span><br><span class=\"line\">  URL.revokeObjectURL(objectURL);</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p>â€ƒâ€ƒå¦‚æœæ˜¯å•æ¬¡ç‚¹å‡»ä¸‹è½½å¤šä¸ªæ–‡ä»¶ï¼ŒChrome åªä¼šå¼¹å‡ºä¸€ä¸ªå¼¹çª—ä¸‹è½½æœ€åä¸€ä¸ªæ–‡ä»¶ã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥åŠ ä¸Š <code>setTimeout</code> ï¼Œè§¦å‘å¤šæ¬¡ä¸‹è½½ï¼Œæˆ–æ˜¯åŠ ä¸Š <code>a.target = &quot;_blank&quot;</code> ï¼Œæ‰“å¼€å¤šä¸ªæ–°çª—å£ã€‚<br>\näºŒã€curl<br>\næŸ¥çœ‹å‘½ä»¤ï¼š<br>\n<code>curl --help</code><br>\n-H æŒ‡å®šHeaderï¼š<br>\n<code>curl -H &quot;Authorization: XXXXXXXX&quot; URL</code><br>\n<code>curl POST -d data -H &quot;Authorization: XXXXXXXX&quot; URL</code></p>\n<h4>2019/8/9</h4>\n<p>ä¸€ã€<a href=\"https://www.codebeast.dev/usestate-vs-useref-re-render-or-not/\" target=\"_blank\" rel=\"noopener\">useRef vs useState: Should we re-render or not?</a><br>\n<img src=\"FE_20190809.png\" alt=\"FE_20190808\"><br>\näºŒã€Hooks ç›‘å¬é”®ç›˜äº‹ä»¶<br>\nkeyCode: <a href=\"https://keycode.info/\" target=\"_blank\" rel=\"noopener\">https://keycode.info/</a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function useKeyPress(targetKey) &#123;</span><br><span class=\"line\">  const [keyPressed, setKeyPressed] = useState(false);</span><br><span class=\"line\"></span><br><span class=\"line\">  function downHandler(&#123; key &#125;) &#123;</span><br><span class=\"line\">    if (key === targetKey) &#123;</span><br><span class=\"line\">      setKeyPressed(true);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  const upHandler = (&#123; key &#125;) =&gt; &#123;</span><br><span class=\"line\">    if (key === targetKey) &#123;</span><br><span class=\"line\">      setKeyPressed(false);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">  useEffect(() =&gt; &#123;</span><br><span class=\"line\">    window.addEventListener(&apos;keydown&apos;, downHandler);</span><br><span class=\"line\">    window.addEventListener(&apos;keyup&apos;, upHandler);</span><br><span class=\"line\">    return () =&gt; &#123;</span><br><span class=\"line\">      window.removeEventListener(&apos;keydown&apos;, downHandler);</span><br><span class=\"line\">      window.removeEventListener(&apos;keyup&apos;, upHandler);</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">  &#125;, []);</span><br><span class=\"line\"></span><br><span class=\"line\">  return keyPressed;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4>2019/8/8</h4>\n<p>â€ƒâ€ƒå·¥ç¨‹ä¸­ç»å¸¸ä¼šçœ‹åˆ° CI/CD çš„æ¦‚å¿µã€‚CI æŒ‡çš„æ˜¯æŒç»­é›†æˆï¼Œä¾§é‡äºç®€åŒ–å‘å¸ƒå‡†å¤‡å·¥ä½œçš„å®è·µï¼Œæ¯”å¦‚è‡ªåŠ¨æµ‹è¯•ï¼›CD æŒ‡çš„æ˜¯æŒç»­äº¤ä»˜ï¼Œæ„å‘³ç€ä¸ä»…è®©æµ‹è¯•è‡ªåŠ¨åŒ–ï¼Œè®©å‘å¸ƒæµç¨‹ä¹Ÿè‡ªåŠ¨åŒ–äº†ã€‚æ›´å¤šæ¦‚å¿µå¯¹æ¯”å¯ä»¥å‚è€ƒï¼š<a href=\"https://www.atlassian.com/continuous-delivery/principles/continuous-integration-vs-delivery-vs-deployment\" target=\"_blank\" rel=\"noopener\">Continuous integration VS continuous delivery VS continuous deployment</a><br>\nâ€ƒâ€ƒä¸‹é¢è¿™ä¸ªå›¾å¾ˆæ¸…æ™°åœ°æè¿°äº†ä¸‰è€…çš„ä¸åŒï¼š<br>\n<img src=\"FE_20190808.png\" alt=\"FE_20190808\"><br>\nâ€ƒâ€ƒåœ¨ gitlab ä¸Šçš„å®è·µå¯ä»¥å‚è€ƒï¼š<a href=\"https://mp.weixin.qq.com/s/z2f1i2FgrVGofQR6nKTd1A\" target=\"_blank\" rel=\"noopener\">åŸºäº GitLab CI/CD çš„è‡ªåŠ¨åŒ–æ„å»ºã€å‘å¸ƒå®è·µ</a></p>\n<h4>2019/8/7</h4>\n<p>Typescript: <a href=\"https://www.typescriptlang.org/docs/handbook/advanced-types.html#discriminated-unions\" target=\"_blank\" rel=\"noopener\">Discriminated Unions</a><br>\nâ€ƒâ€ƒå½“æˆ‘ä»¬æŸä¸ªå‚æ•°å¯èƒ½æœ‰å¤šä¸ªç±»å‹ï¼Œè€Œè¿™äº›ç±»å‹ä¸­åˆæœ‰å…¬å…±çš„å±æ€§æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨è¿™ç§å½¢å¼çº¦æŸã€‚</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// Each interface has a kind property with a different string literal type. </span><br><span class=\"line\">// The kind property is called the discriminant or tag. </span><br><span class=\"line\">interface Square &#123;</span><br><span class=\"line\">    kind: &quot;square&quot;;</span><br><span class=\"line\">    size: number;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">interface Rectangle &#123;</span><br><span class=\"line\">    kind: &quot;rectangle&quot;;</span><br><span class=\"line\">    width: number;</span><br><span class=\"line\">    height: number;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">interface Circle &#123;</span><br><span class=\"line\">    kind: &quot;circle&quot;;</span><br><span class=\"line\">    radius: number;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// put the interfaces into a union</span><br><span class=\"line\">type Shape = Square | Rectangle | Circle;</span><br><span class=\"line\"></span><br><span class=\"line\">// use the discriminated union</span><br><span class=\"line\">function area(s: Shape) &#123;</span><br><span class=\"line\">    switch (s.kind) &#123;</span><br><span class=\"line\">        case &quot;square&quot;: return s.size * s.size;</span><br><span class=\"line\">        case &quot;rectangle&quot;: return s.height * s.width;</span><br><span class=\"line\">        case &quot;circle&quot;: return Math.PI * s.radius ** 2;</span><br><span class=\"line\">        default: return assertNever(s); // error here if there are missing cases</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// Exhaustiveness checking </span><br><span class=\"line\">function assertNever(x: never): never &#123;</span><br><span class=\"line\">    throw new Error(&quot;Unexpected object: &quot; + x);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4>2019/8/6</h4>\n<p>Stack Overflow: <a href=\"https://stackoverflow.com/questions/54069253/usestate-set-method-not-reflecting-change-immediately\" target=\"_blank\" rel=\"noopener\">useState set method not reflecting change immediately.</a><br>\nâ€ƒâ€ƒä»Šå¤©åœ¨å®è·µä¸­å‘ç°ï¼Œ<code>setState</code> åé©¬ä¸Šæ‰“å°ï¼Œå¹¶ä¸ä¼šå–åˆ°æ›´æ–°åçš„å€¼ã€‚æŸ¥é˜…èµ„æ–™åå‘ç°è¿™ä¸ªå‡½æ•°æ˜¯ä¸€ä¸ªå¼‚æ­¥çš„å‡½æ•°ï¼Œä¸ä¼šç«‹å³æ›´æ–°ï¼Œä½†ä¼šè§¦å‘é‡æ–°æ¸²æŸ“ã€‚å¦‚ä¸‹ï¼š<br>\n<img src=\"FE_20190806.png\" alt=\"FE_20190806\"></p>\n<h4>2019/8/1</h4>\n<p>ä¸€ã€<a href=\"https://javascript.info/fetch-api\" target=\"_blank\" rel=\"noopener\">Fetch API</a><br>\nâ€ƒâ€ƒç”¨ fetch æ¥è¯·æ±‚ç½‘ç»œèµ„æºï¼Œå¯ä»¥é…ç½®ä¸åŒçš„å‚æ•°æ¥è§£å†³ç¼“å­˜ã€è·¨åŸŸç­‰é—®é¢˜ï¼Œå¦‚ä¸‹ç¤ºä¾‹ä»£ç ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// ä¸ç¼“å­˜è¯·æ±‚ç»“æœ </span><br><span class=\"line\">// https://stackoverflow.com/questions/29246444/fetch-how-do-you-make-a-non-cached-request</span><br><span class=\"line\">const headers = new Headers();</span><br><span class=\"line\">headers.append(&quot;pragma&quot;, &quot;no-cache&quot;);</span><br><span class=\"line\">headers.append(&quot;cache-control&quot;, &quot;no-store&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">// å®Œå…¨å¿½ç•¥ http-cache ï¼Œæ¯æ¬¡éƒ½ä»æœåŠ¡å™¨è¯·æ±‚æ•°æ®</span><br><span class=\"line\">// https://developer.mozilla.org/en-US/docs/Web/API/Request/cache</span><br><span class=\"line\">const cache: RequestCache = &quot;no-store&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">// è¯·æ±‚æ¨¡å¼ï¼Œè‹¥æœ‰çš„è¯·æ±‚ä¼šå› ä¸º cors è€Œå¤±è´¥ï¼Œå¯ä»¥è®¾ç½®ä¸º &quot;no-cors&quot;</span><br><span class=\"line\">// https://developer.mozilla.org/en-US/docs/Web/API/Request/mode</span><br><span class=\"line\">const mode: RequestMode = needCors ? &quot;cors&quot; : &quot;no-cors&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">await fetch(url. &#123;headers, cache, mode&#125;)</span><br><span class=\"line\">  .then(res =&gt; res.blob())</span><br><span class=\"line\">  .then(blob =&gt; &#123;</span><br><span class=\"line\">    // doSomething with blob</span><br><span class=\"line\">    const url = URL.createObjectURL(blob)</span><br><span class=\"line\">    let a = document.createElement(&apos;a&apos;)</span><br><span class=\"line\">    a.download = &apos;example.zip&apos;</span><br><span class=\"line\">    a.href = url</span><br><span class=\"line\">    document.body.appendChild(a)</span><br><span class=\"line\">    a.click()</span><br><span class=\"line\">    document.body.removeChild(a)</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">  .catch(err =&gt; &#123;</span><br><span class=\"line\">    console.log(err)</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">  .finally(() =&gt; &#123;</span><br><span class=\"line\">    // doSomething</span><br><span class=\"line\">  &#125;)</span><br></pre></td></tr></table></figure>\n<p>â€ƒâ€ƒå…³äº <code>res.blob()</code> ï¼Œå¯ä»¥å‚è€ƒçŸ¥ä¹ä¸Š<a href=\"https://zhuanlan.zhihu.com/p/32909043\" target=\"_blank\" rel=\"noopener\">è°ˆä¸€è°ˆ Fetch API ä¸­çš„ â€œres.blob()â€</a>ï¼›ä¹Ÿå¯ä»¥å‚è€ƒ <a href=\"https://github.github.io/fetch/\" target=\"_blank\" rel=\"noopener\">fetch documentation</a> ï¼Œè¿™ä¸€ç¯‡æ¯”è¾ƒè¯¦ç»†ï¼Œä¹Ÿæä¾›äº†è¾ƒå¤šå…¶ä»–çš„ä¾‹å­ã€‚<br>\nå…³äºæµè§ˆå™¨ç¼“å­˜é—®é¢˜ï¼ŒMedium ä¸Šè¿™ç¯‡ <a href=\"https://medium.com/@codebyamir/a-web-developers-guide-to-browser-caching-cc41f3b73e7c\" target=\"_blank\" rel=\"noopener\">A Web Developerâ€™s Guide to Browser Caching</a> å†™å¾—ä¸é”™ã€‚å¦‚æœå­˜åœ¨ä»£ç†æœåŠ¡å™¨ï¼Œå³ä½¿æˆ‘ä»¬è®¾ç½®äº† <code>mode: 'no-store'</code> ï¼Œä»£ç†æœåŠ¡å™¨ä¹Ÿä¼šç¼“å­˜ã€‚ä¸ºäº†é¿å…è¿™ä¸ªæƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ¯æ¬¡å‘é€è¯·æ±‚æ—¶æ„é€ æ–°çš„ URL ï¼ŒåŠ ä¸Šæ—¶é—´æˆ³ <code>?t=Date.now()</code> ã€‚ğŸ®ğŸº<br>\näºŒã€Jest<br>\nâ€ƒâ€ƒæˆ‘ä»¬åœ¨ä½¿ç”¨ jest æµ‹è¯•æ—¶ï¼Œæœ‰æ—¶å€™éœ€è¦å¼•å…¥ä¸€äº›å¤–éƒ¨æ–‡ä»¶/å¤–éƒ¨å˜é‡ï¼Œå¦‚ä» <code>config.json</code> æ–‡ä»¶ä¸­å¼•å…¥æŸä¸ªå˜é‡ã€‚ä¸ºäº†åœ¨æµ‹è¯•æ–‡ä»¶ä¸­å¯ä»¥è®¿é—®åˆ°è¯¥å˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ <code>jest.config.js</code> ä¸­é…ç½®å…¨å±€å˜é‡ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">module.exports = &#123;</span><br><span class=\"line\">  globals: &#123;</span><br><span class=\"line\">    API_BASE: &quot;&quot;,</span><br><span class=\"line\">    DATA_API: &quot;&quot;,</span><br><span class=\"line\">    TRACK_API: &quot;&quot;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  setupFiles: [&quot;./jestSetup.ts&quot;]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>â€ƒâ€ƒç”±äº <code>globals</code> åªæ”¯æŒ JSON æ ¼å¼çš„å˜é‡ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦å®šä¹‰å…¨å±€å‡½æ•°ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ <code>setupFiles</code>ã€‚</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// jestSetup.ts</span><br><span class=\"line\">(global as any).fn= () =&gt; &#123;&#125;;</span><br><span class=\"line\">(global as any).variable = &quot;XXX&quot;;</span><br></pre></td></tr></table></figure>\n<h4>2019/7/31</h4>\n<p>1ï¼‰<code>position: fixed</code> å’Œ flex å¸ƒå±€æ˜¯ä¸èƒ½åŒæ—¶èµ·ä½œç”¨çš„ã€‚ç»å¯¹å¸ƒå±€è„±ç¦»æ–‡æ¡£æµï¼Œä¸ä¼šå‚ä¸åˆ° flex layout ä¸­ã€‚å¦‚æœæƒ³å®ç°å·¦ä¾§èœå•æ ï¼Œå³ä¾§å†…å®¹ï¼Œä¸¤è€…ä¸åŒæ—¶æ»šåŠ¨ï¼ˆèœå•æ  fixedï¼‰ï¼Œä½†èœå•æ çš„å¤§å°å¯ä»¥æ”¹å˜ï¼ˆflex çˆ¶å¸ƒå±€ï¼‰ã€‚å¯ä»¥è®©çˆ¶å®¹å™¨æ˜¯ flex å¸ƒå±€ï¼Œå·¦ä¾§èœå•æ å’Œå³ä¾§å†…å®¹åŒºåŸŸéƒ½æ˜¯ flex element ï¼Œ èœå•æ å†…éƒ¨å†æœ‰ä¸€ä¸ª <code>position: fixed</code> çš„ div ã€‚<br>\n2ï¼‰å¦‚æœæƒ³è®© <code>position: fixed</code> çš„å…ƒç´ ç›¸å¯¹çˆ¶å®¹å™¨å®šä½ï¼Œå¯ä»¥ç»™çˆ¶å®¹å™¨å¢åŠ  CSS å±æ€§ <code>transform: translate(0,0)</code> ã€‚å‚è€ƒï¼š<a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/position\" target=\"_blank\" rel=\"noopener\">MDN - position</a></p>\n<blockquote>\n<p>fixed: It is positioned relative to the initial containing block established by the viewport, except when one of its ancestors has a transform, perspective, or filter property set to something other than none.</p>\n</blockquote>\n<h4>2019/7/30</h4>\n<p><code>useEffect</code> ä¸­çš„å¼‚æ­¥è¯·æ±‚ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// é”™è¯¯å†™æ³•ï¼Œ return å¿…é¡»æ˜¯ cleanup function</span><br><span class=\"line\">useEffect(async () =&gt; &#123;</span><br><span class=\"line\">  const newVal = await asyncCall();</span><br><span class=\"line\">  setVal(newVal);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">// æ­£ç¡®å†™æ³•</span><br><span class=\"line\">useEffect(() =&gt; &#123;</span><br><span class=\"line\">  asyncCall().then(resp =&gt; setVal(resp.data));</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<p>å¥½æ–‡å…±äº«ï¼š<a href=\"https://www.robinwieruch.de/react-hooks-fetch-data/\" target=\"_blank\" rel=\"noopener\">How to fetch data with React Hooks?</a>ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">useEffect(() =&gt; &#123;</span><br><span class=\"line\">  async function fetchMyAPI() &#123;</span><br><span class=\"line\">    let url = &apos;http://something/&apos; + productId;</span><br><span class=\"line\">    let config = &#123;&#125;;</span><br><span class=\"line\">    const response = await myFetch(url);</span><br><span class=\"line\">    console.log(response);</span><br><span class=\"line\">  &#125;  </span><br><span class=\"line\"></span><br><span class=\"line\">  fetchMyAPI();</span><br><span class=\"line\">&#125;, [productId]);</span><br></pre></td></tr></table></figure>\n<p>å¦‚æœè¦ä¿è¯è¯·æ±‚æŒ‰é¡ºåºå‘å‡ºï¼Œå¯ä»¥é‡‡ç”¨å¦‚ä¸‹å†™æ³•ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">useEffect(() =&gt; &#123;</span><br><span class=\"line\">  let didCancel = false;</span><br><span class=\"line\"></span><br><span class=\"line\">  async function fetchMyAPI() &#123;</span><br><span class=\"line\">    let url = &apos;http://something/&apos; + productId;</span><br><span class=\"line\">    let config = &#123;&#125;;</span><br><span class=\"line\">    const response = await myFetch(url);</span><br><span class=\"line\">    if (!didCancel) &#123; // Ignore if we started fetching something else</span><br><span class=\"line\">      console.log(response);</span><br><span class=\"line\">    &#125; </span><br><span class=\"line\">  &#125;  </span><br><span class=\"line\"></span><br><span class=\"line\">  fetchMyAPI();</span><br><span class=\"line\">  return () =&gt; &#123; didCancel = true; &#125;; // Remember if we start fetching something else</span><br><span class=\"line\">&#125;, [productId]);</span><br></pre></td></tr></table></figure>\n<h4>2019/7/29</h4>\n<p>ä¸€ã€<a href=\"https://stackoverflow.com/questions/30795525/performance-now-vs-date-now\" target=\"_blank\" rel=\"noopener\">performance.now() vs Date.now()</a><br>\nâ€ƒâ€ƒåœ¨ç¨‹åºä¸­æ‰“å°æ‰§è¡Œæ—¶é—´æ—¶ï¼Œä½¿ç”¨ <code>performance.now(ï¼‰</code> æ›´å‡†ç¡®ã€‚</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const start = performance.now();</span><br><span class=\"line\">doSomething();</span><br><span class=\"line\">const end = performance.now();</span><br><span class=\"line\">console.log(&quot;Call to doSomething took &quot; + (start - end) + &quot; milliseconds.&quot;);</span><br></pre></td></tr></table></figure>\n<p>äºŒã€<a href=\"https://stackoverflow.com/questions/47738344/does-javascript-slice-method-return-a-shallow-copy\" target=\"_blank\" rel=\"noopener\">Does javascript slice method return a shallow copy?</a><br>\nâ€ƒâ€ƒmdn ä¸Šå¯¹ <code>slice()</code> æ–¹æ³•çš„ä»‹ç»ï¼š</p>\n<blockquote>\n<p>The slice() method returns a shallow copy of a portion of an array into a new array object selected from begin to end (end not included) where begin and end represent the index of items in that array. The original array will not be modified.</p>\n</blockquote>\n<p>â€ƒâ€ƒæ³¨æ„è¿™é‡Œçš„æµ…å¤åˆ¶æŒ‡çš„æ˜¯å¯¹æ•°ç»„ä¸­å€¼çš„æµ…å¤åˆ¶ï¼Œè€Œä¸æ˜¯å¯¹æ•´ä¸ªæ•°ç»„çš„æµ…å¤åˆ¶ã€‚å¦‚æœæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œåˆ™ä¿®æ”¹æ–°æ•°ç»„æ—¶ï¼ŒåŸæ•°ç»„ä¸ä¼šæ”¹å˜ï¼›å¦‚æœæ˜¯å¯¹è±¡æ•°ç»„ï¼Œä¿®æ”¹æ–°æ•°ç»„å¯¹è±¡å€¼æ—¶ï¼ŒåŸæ•°ç»„ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ã€‚</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const animals = [&#123;name: &apos;ant&apos;&#125;, &#123;name: &apos;bison&apos;&#125;, &#123;name: &apos;camel&apos;&#125;];</span><br><span class=\"line\">const newAnimals = animals.slice(2);</span><br><span class=\"line\"></span><br><span class=\"line\">newAnimals[0].name = &apos;aaa&apos;;</span><br><span class=\"line\">console.log(newAnimals); // [&#123;name: &apos;aaa&apos;&#125;]</span><br><span class=\"line\">console.log(animals);    // [&#123;name: &apos;ant&apos;&#125;, &#123;name: &apos;bison&apos;&#125;, &#123;name: &apos;aaa&apos;&#125;]</span><br></pre></td></tr></table></figure>\n<p>â€ƒâ€ƒæ³¨æ„å¦‚æœæ˜¯é‡æ–°èµ‹å€¼ï¼Œåˆ™ç­‰äºé‡æ–°åˆ†é…ç©ºé—´ï¼Œä¸ä¼šæ”¹å˜åŸæ•°ç»„ã€‚</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const animals = [&#123;name: &apos;ant&apos;&#125;, &#123;name: &apos;bison&apos;&#125;, &#123;name: &apos;camel&apos;&#125;];</span><br><span class=\"line\">const newAnimals = animals.slice(2);</span><br><span class=\"line\"></span><br><span class=\"line\">newAnimals[0] = &#123;name: &apos;aaa&apos;&#125;;</span><br><span class=\"line\">console.log(newAnimals); // [&#123;name: &apos;aaa&apos;&#125;]</span><br><span class=\"line\">console.log(animals);    // [&#123;name: &apos;ant&apos;&#125;, &#123;name: &apos;bison&apos;&#125;, &#123;name: &apos;camel&apos;&#125;]</span><br></pre></td></tr></table></figure>\n<h4>2019/7/26</h4>\n<p>â€ƒâ€ƒåº”ç”¨åœºæ™¯ï¼šæˆ‘ä»¬éœ€è¦è¯·æ±‚å¹¶æ›´æ–°èœå•æ ä¸­ä»»åŠ¡çš„çŠ¶æ€ï¼Œå¦‚æœä¸€ä¸ªè¯·æ±‚å®Œæˆç«‹é©¬æ›´æ–°ä¼šå¯¼è‡´ React é¢‘ç¹åˆ·æ–°ï¼Œéœ€è¦ç¼“å†²æ‰¹å¤„ç†ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import &#123; runInAction &#125; from &quot;mobx&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">let handlers: Array&lt;() =&gt; void&gt; = [];</span><br><span class=\"line\">const runHandlers = () =&gt; &#123;</span><br><span class=\"line\">  runInAction(() =&gt; &#123;</span><br><span class=\"line\">    handlers.forEach(f =&gt; f());</span><br><span class=\"line\">    handlers = [];</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">for (const task of tasks) &#123;</span><br><span class=\"line\">  const &#123;data&#125; = await requestFn();</span><br><span class=\"line\">  </span><br><span class=\"line\">  handlers.push(() =&gt; &#123;</span><br><span class=\"line\">    // deal with data, update state</span><br><span class=\"line\">    ...</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">  if(handlers.length &gt; 30) &#123;</span><br><span class=\"line\">    runHandlers();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">runHandlers();</span><br></pre></td></tr></table></figure>\n<p>â€ƒâ€ƒä¸Šè¿°ä»£ç ä¸»è¦æ˜¯åˆ©ç”¨äº†è‡ªå®šä¹‰çš„ <code>handlers</code> æ¥æš‚å­˜çŠ¶æ€æ›´æ–°å‡½æ•°ï¼Œä¹‹åä½¿ç”¨ mobx æä¾›çš„ <code>runInAction</code> æ‰§è¡Œå‡½æ•°å¹¶æ›´æ–°çŠ¶æ€ï¼Œæ›´æ–°çŠ¶æ€éƒ½éœ€è¦ä½¿ç”¨ <code>action</code> å‡½æ•°ï¼Œ <code>runInAction</code> æ¥å—ä¸€ä¸ªä»£ç å—å¹¶åœ¨ä¸€ä¸ª(åŒ¿å)æ“ä½œä¸­æ‰§è¡Œï¼Œæœ‰åˆ©äºåŠ¨æ€åˆ›å»ºå’Œæ‰§è¡Œæ“ä½œï¼Œ<code>runInAction(f) = action(f)()</code>ã€‚æ­¤å¤–ï¼Œå¿…è¦æ—¶è¿˜å¯åŠ ä¸Š <code>lodash.memoize(func,[resolver])</code>ï¼Œè®°å½•ä¸»å‡½æ•°è¯·æ±‚ç»“æœã€‚</p>\n<blockquote>\n<p>For one-time-actions runInAction(name?, fn) can be used, which is sugar for action(name, fn)()</p>\n</blockquote>\n<h4>2019/7/18</h4>\n<p>ä¸€ã€ç¼–ç¨‹æ¨¡å¼ï¼š<br>\nâ€ƒâ€ƒ é¦–å…ˆå…ˆè®°ä½è¿™å‡ ç§ç¼–ç¨‹æ¨¡å¼çš„ä¸­æ–‡ï¼šImperative Programming æ˜¯å‘½ä»¤å¼ç¼–ç¨‹ï¼ŒDeclarative Programming æ˜¯å£°æ˜å¼ç¼–ç¨‹ï¼ŒReactive Programming æ˜¯å“åº”å¼ç¼–ç¨‹ã€‚ï¼ˆæµä¸‹äº†è‹±æ–‡ä¸å¥½çš„æ³ªæ°´ï¼‰<br>\n1ï¼‰å…ˆçœ‹å‘½ä»¤å¼ç¼–ç¨‹å’Œå£°æ˜å¼ç¼–ç¨‹çš„åŒºåˆ«ï¼Œç›´æ¥ä¸Šä»£ç ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// å‘½ä»¤å¼ç¼–ç¨‹ imperative programming</span><br><span class=\"line\">const array = [0,1,2,3,4,5];</span><br><span class=\"line\">const output = [];</span><br><span class=\"line\">for (let i = 0; i &lt; array.length; i++) &#123;</span><br><span class=\"line\">  const tmp = array[i] * 2;</span><br><span class=\"line\">  output.push(tmp)</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">console.log(output) // =&gt; [0,2,4,6,8,10]</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// å£°æ˜å¼ç¼–ç¨‹ declarative programming</span><br><span class=\"line\">const array = [0,1,2,3,4,5];</span><br><span class=\"line\">const output = array.map(item =&gt; item * 2);</span><br><span class=\"line\">console.log(output) // =&gt; [0,2,3,6,8,10]</span><br></pre></td></tr></table></figure>\n<p>â€ƒâ€ƒå¾ˆæ˜æ˜¾å¯ä»¥çœ‹åˆ°ï¼Œå‘½ä»¤å¼ç¼–ç¨‹çš„å…³æ³¨ç‚¹åœ¨äº how ï¼Œæˆ‘ä»¬éœ€è¦ä¸€æ­¥æ­¥å‘Šè¯‰æœºå™¨æ¥ä¸‹æ¥è¦åšä»€ä¹ˆï¼Œå‘Šè¯‰ä»–æ€ä¹ˆå»éå†ä¸€ä¸ªæ•°ç»„ï¼Œæ€ä¹ˆå»è¿ç®—å¾—åˆ°æœ€åçš„ç»“æœï¼Œæ€ä¹ˆå»è¾“å‡ºï¼›å£°æ˜å¼ç¼–ç¨‹çš„å…³æ³¨ç‚¹åœ¨äº what ï¼Œæˆ‘ä»¬åªå…³æ³¨æœ€åçš„ç»“æœï¼Œç”±æœºå™¨è‡ªå·±å»æ‘¸ç´¢è¿‡ç¨‹ï¼Œå¦‚ç›´æ¥è°ƒç”¨ <code>map</code> å‡½æ•°ï¼Œåªå‘Šè¯‰ç¨‹åºæˆ‘ä»¬éœ€è¦ä¸€ä¸ª2å€è¾“å‡ºã€‚<br>\n2ï¼‰æ¥ç€çœ‹å£°æ˜å¼ç¼–ç¨‹å’Œå“åº”å¼ç¼–ç¨‹çš„å¯¹æ¯”<br>\nâ€ƒâ€ƒå¯ä»¥é˜…è¯»ï¼š<a href=\"https://codepen.io/HunorMarton/post/imperative-vs-reactive\" target=\"_blank\" rel=\"noopener\">Imperative vs Reactive</a>ï¼Œè§£é‡Šå¾ˆæ¸…æ™°ï¼Œæ¯”å–»ä¹Ÿå¾ˆå½¢è±¡ï¼Œä½†æˆ‘è§‰å¾—æ–‡ç« é‡Œçš„ Imperative åº”è¯¥æ”¹æˆ Declarative æ¯”è¾ƒå‡†ç¡®ã€‚ç»§ç»­æ²¿ç”¨ä¸Šé¢çš„ä¾‹å­ï¼Œä¿®æ”¹ä¸€ä¸‹å£°æ˜å¼ç¼–ç¨‹çš„ä¾‹å­ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// å£°æ˜å¼ç¼–ç¨‹ declarative programming</span><br><span class=\"line\">const array = [1,2];</span><br><span class=\"line\">const output = array.map(item =&gt; item * 2);</span><br><span class=\"line\">output.forEach(item =&gt; console.log(item)) // =&gt; 2 4</span><br><span class=\"line\">array.push(3);  // =&gt; no output </span><br><span class=\"line\">array.push(4);  // =&gt; no output</span><br></pre></td></tr></table></figure>\n<p>å“åº”å¼ç¼–ç¨‹çš„ä¾‹å­ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import &#123; Subject &#125; from `rxjs`;</span><br><span class=\"line\">let array = new Subject();</span><br><span class=\"line\">array.next(1);</span><br><span class=\"line\">array.next(2);</span><br><span class=\"line\"></span><br><span class=\"line\">const output = array.map(item =&gt; item * 2);</span><br><span class=\"line\">output.forEach(item =&gt; console.log(item)); // =&gt; 2 4</span><br><span class=\"line\"></span><br><span class=\"line\">array.next(3); // =&gt; 6</span><br><span class=\"line\">array.next(4); // =&gt; 8</span><br></pre></td></tr></table></figure>\n<p>â€ƒâ€ƒé¦–å…ˆè¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸¤ç§æ–¹å¼ä¸­çš„ <code>map</code> ï¼Œ <code>forEach</code> ç­‰å‡½æ•°å¹¶ä¸æ˜¯ä¸€æ ·çš„ï¼Œå†…éƒ¨å®ç°æœºåˆ¶æ˜¯ä¸åŒçš„ã€‚æˆ‘ä»¬å¯ä»¥å‘ç°åŒºåˆ«ï¼šåœ¨å£°æ˜å¼ç¼–ç¨‹ä¸­ï¼Œå¦‚æœåœ¨æœ€åå‘åŸæ•°ç»„æ·»åŠ å€¼ï¼Œå¹¶ä¸ä¼šæ‰“å°å‡ºæ¥ï¼Œå› ä¸ºè¿™æ˜¯åœ¨ <code>console.log</code> è¯­å¥æ‰§è¡Œåå‘ç”Ÿçš„ã€‚ä½†åœ¨å“åº”å¼ç¼–ç¨‹é‡Œï¼Œä»»ä½•å˜åŒ–éƒ½å¯ä»¥è¢«ååº”å‡ºæ¥ï¼Œå®ƒå¼•å…¥äº†ä¸€ä¸ª<strong>å¼‚æ­¥æ•°æ®æµ</strong>ï¼ˆasynchronous data streamsï¼‰çš„æ¦‚å¿µï¼Œå¯ä»¥éšæ—¶åˆ›å»ºã€æ›´æ”¹æˆ–ç»„åˆè¿™äº›æ•°æ®æµï¼Œæ‰€ä»¥æ‰“å°äº‹ä»¶æ˜¯ä¸€ä¸ª continuous observation caseã€‚<br>\näºŒã€ç±»åº“<br>\n<a href=\"https://github.com/bvaughn/react-virtualized\" target=\"_blank\" rel=\"noopener\">react-virtualized</a> çš„è½»é‡çº§ç‰ˆ <a href=\"https://github.com/bvaughn/react-window\" target=\"_blank\" rel=\"noopener\">react-window</a>ï¼Œç”¨äºé«˜æ•ˆæ¸²æŸ“é•¿åˆ—è¡¨ã€‚</p>\n<h4>2019/7/17</h4>\n<p>â€ƒâ€ƒå¦‚æœæˆ‘ä»¬åœ¨é¡¹ç›®ä¸­éœ€è¦è¯·æ±‚å¾ˆå¤šå›¾ç‰‡ï¼Œæƒ³è¦å®ç°è¯·æ±‚å‡ºé”™æ—¶ç»§ç»­å‘é€è¯·æ±‚ï¼ŒæˆåŠŸæ—¶è¿”å›æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ <code>Promise</code> ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function fetchURL(url: string):Promise&lt;Blob&gt; &#123;</span><br><span class=\"line\">  return Axios.get(url, &#123;responeType: &quot;blob&quot;&#125;)</span><br><span class=\"line\">              .then( resp =&gt; Promise.resolve(resp.data) )</span><br><span class=\"line\">              .catch( () =&gt; fetchURL(url) )</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ä¹‹åå¯ä»¥ä½¿ç”¨ <code>rxjs</code> ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import &#123; mergeMap, bufferTime, takeUntil &#125; from &quot;rxjs/operators&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">[url1,...,url10]</span><br><span class=\"line\">  .pipe(</span><br><span class=\"line\">    mergeMap( url =&gt; fetchURL(url).then( val =&gt; val )),</span><br><span class=\"line\">    bufferTime(10000)</span><br><span class=\"line\">  )</span><br><span class=\"line\">  .subscribe(&#123;</span><br><span class=\"line\">    next: resps =&gt; &#123;</span><br><span class=\"line\">      // do sth with resps:Blob[]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;)</span><br></pre></td></tr></table></figure>\n<p>â€ƒâ€ƒæ¯æ¬¡é‡åˆ° <code>rxjs</code> éƒ½å¾ˆå¤´å¤§ï¼Œç°åœ¨ä¹Ÿæ²¡æœ‰å‘ç°ä¸€ä¸ªæ¯”è¾ƒå®Œå–„æ¸…æ™°çš„æ•™ç¨‹ï¼Œä½†å®ƒåˆçœŸçš„å¾ˆå¼ºå¤§ï¼Œåç»­è¦å¼€ä¸“é¢˜å¥½å¥½å­¦ä¹ è®°å½•è¿™ä¸ªä¸œè¥¿ã€‚</p>\n<h4>2019/7/16</h4>\n<p>ä¸€ã€ä»Šæ—¥é˜…è¯»ï¼š<a href=\"https://reactjs.org/docs/hooks-faq.html#how-to-read-an-often-changing-value-from-usecallback\" target=\"_blank\" rel=\"noopener\">How to read an often-changing value from useCallback?</a><br>\nç›´æ¥ä¸Šå®˜ç½‘ä»£ç ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function Form() &#123;</span><br><span class=\"line\">  const [text, updateText] = useState(&apos;&apos;);</span><br><span class=\"line\">  const textRef = useRef();</span><br><span class=\"line\"></span><br><span class=\"line\">  useEffect(() =&gt; &#123;</span><br><span class=\"line\">    textRef.current = text; // Write it to the ref</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">  const handleSubmit = useCallback(() =&gt; &#123;</span><br><span class=\"line\">    const currentText = textRef.current; // Read it from the ref</span><br><span class=\"line\">    alert(currentText);</span><br><span class=\"line\">  &#125;, [textRef]); // Don&apos;t recreate handleSubmit like [text] would do</span><br><span class=\"line\"></span><br><span class=\"line\">  return (</span><br><span class=\"line\">    &lt;&gt;</span><br><span class=\"line\">      &lt;input value=&#123;text&#125; onChange=&#123;e =&gt; updateText(e.target.value)&#125; /&gt;</span><br><span class=\"line\">      &lt;ExpensiveTree onSubmit=&#123;handleSubmit&#125; /&gt;</span><br><span class=\"line\">    &lt;/&gt;</span><br><span class=\"line\">  );</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>â€ƒâ€ƒ ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ <code>text</code> çš„å€¼ç»å¸¸å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå³ä½¿ <code>handleSubmit</code> ç”¨ <code>useCallback</code> åŒ…è£¹äº†ï¼Œè¿˜æ˜¯ä¼šé‡æ–°å£°æ˜ã€‚è§£å†³åŠæ³•æ˜¯ä¼ å…¥ä¸€ä¸ª <code>ref</code> å¯¹è±¡ä»£æ›¿åŸå§‹å€¼ã€‚ä¹Ÿå¯ä»¥å†™ä¸€ä¸ª custom hook ï¼š<br>\n1ï¼‰å®˜ç½‘çš„ç‰ˆæœ¬ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function useEventCallback(fn, dependencies) &#123;</span><br><span class=\"line\">  const ref = useRef(() =&gt; &#123;</span><br><span class=\"line\">    throw new Error(&apos;Cannot call an event handler while rendering.&apos;);</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">  useEffect(() =&gt; &#123;</span><br><span class=\"line\">    ref.current = fn;</span><br><span class=\"line\">  &#125;, [fn, ...dependencies]);</span><br><span class=\"line\"></span><br><span class=\"line\">  return useCallback(() =&gt; &#123;</span><br><span class=\"line\">    const fn = ref.current;</span><br><span class=\"line\">    return fn();</span><br><span class=\"line\">  &#125;, [ref]);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>å®é™…ä½¿ç”¨ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function Form() &#123;</span><br><span class=\"line\">  const [text, updateText] = useState(&apos;&apos;);</span><br><span class=\"line\">  // Will be memoized even if `text` changes:</span><br><span class=\"line\">  const handleSubmit = useEventCallback(() =&gt; &#123;</span><br><span class=\"line\">    alert(text);</span><br><span class=\"line\">  &#125;, [text]);</span><br><span class=\"line\"></span><br><span class=\"line\">  return (</span><br><span class=\"line\">    &lt;&gt;</span><br><span class=\"line\">      &lt;input value=&#123;text&#125; onChange=&#123;e =&gt; updateText(e.target.value)&#125; /&gt;</span><br><span class=\"line\">      &lt;ExpensiveTree onSubmit=&#123;handleSubmit&#125; /&gt;</span><br><span class=\"line\">    &lt;/&gt;</span><br><span class=\"line\">  );</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>2ï¼‰å¯¼å¸ˆçš„ç‰ˆæœ¬ï¼šï¼ˆä»–æ¥äº†ï¼Œä»–å¸¦ç€ä»£ç åˆæ¥äº†ï¼‰</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/**</span><br><span class=\"line\"> * @param callback</span><br><span class=\"line\"> * @param oRefs</span><br><span class=\"line\"> */</span><br><span class=\"line\">export function useCallbackWithRefs&lt;</span><br><span class=\"line\">  Refs,</span><br><span class=\"line\">  Callback extends (...args: any[]) =&gt; void</span><br><span class=\"line\">&gt;(callback: (refs: Refs) =&gt; Callback, oRefs: Refs) &#123;</span><br><span class=\"line\">  const refs = useRef(oRefs);</span><br><span class=\"line\">  useEffect(</span><br><span class=\"line\">    () =&gt; &#123;</span><br><span class=\"line\">      refs.current = oRefs;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    [oRefs]</span><br><span class=\"line\">  );</span><br><span class=\"line\"></span><br><span class=\"line\">  return useCallback(</span><br><span class=\"line\">    (...args: any[]) =&gt; callback(refs.current)(...args),</span><br><span class=\"line\">    []</span><br><span class=\"line\">  ) as Callback;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>å®é™…ä½¿ç”¨ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function Form() &#123;</span><br><span class=\"line\">  const [text, updateText] = useState(&apos;&apos;);</span><br><span class=\"line\">  </span><br><span class=\"line\">  // åŸå…ˆçš„ callback ä¹Ÿå¯ä»¥æœ‰å‚æ•°</span><br><span class=\"line\">  const handleSubmit = useCallbackWithRefs(</span><br><span class=\"line\">    refs =&gt; (params: any) =&gt; &#123;</span><br><span class=\"line\">      // è¦æ³¨æ„åœ¨å‡½æ•°å†…å¿…é¡»ä½¿ç”¨ `refs.xxx`ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨å‡½æ•°å¤–éƒ¨çš„ä»»ä½•å˜é‡ `xxx`</span><br><span class=\"line\">      console.log(refs.text);</span><br><span class=\"line\">  &#125;, &#123;text&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">  return (</span><br><span class=\"line\">    &lt;&gt;</span><br><span class=\"line\">      &lt;input value=&#123;text&#125; onChange=&#123;e =&gt; updateText(e.target.value)&#125; /&gt;</span><br><span class=\"line\">      &lt;ExpensiveTree onSubmit=&#123;handleSubmit&#125; /&gt;</span><br><span class=\"line\">    &lt;/&gt;</span><br><span class=\"line\">  );</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>â€ƒâ€ƒæ€»çš„æ¥è¯´ï¼Œå®˜ç½‘çš„å®ç°æ˜¯å°† <code>callback</code> ä½œä¸º <code>ref</code> å¯¹è±¡ï¼Œå¹¶ä½œä¸º <code>useCallback</code> çš„ä¾èµ–ï¼Œä¸ä¼šé¢‘ç¹æ”¹å˜ï¼›å¦‚æœåœ¨å‡½æ•° <code>handleSubmit</code> ä¸­è¦è®¿é—®å¤–éƒ¨å˜é‡ <code>text</code> ï¼Œç›´æ¥ä½¿ç”¨ <code>test</code> å³å¯ã€‚ç¬¬äºŒç§å®ç°æ–¹å¼æ˜¯æŠŠç»å¸¸å˜åŒ–çš„å€¼ä½œä¸º <code>ref</code> å¯¹è±¡ï¼Œè¿”å›å€¼ <code>useCallback</code> ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ <code>refs =&gt; callback</code> ï¼Œä¾èµ–æ˜¯ç©ºæ•°ç»„ï¼›è¿™æ—¶å¦‚æœè¦åœ¨å‡½æ•° <code>handleSubmit</code> ä¸­è¦è®¿é—®å¤–éƒ¨å˜é‡ <code>text</code> ï¼Œå¿…é¡»ä½¿ç”¨ <code>refs.test</code> ï¼Œå¦åˆ™è®¿é—®çš„åªæ˜¯ <code>test</code> çš„åˆå§‹å€¼ã€‚<br>\nâ€ƒâ€ƒReact åšå¤§ç²¾æ·±ï¼Œæ¥ä¸‹æ¥è¦å¥½å¥½ç ”è¯»ä¸€ä¸‹è¿™ä¸ª <a href=\"https://reactjs.org/docs/hooks-faq.html\" target=\"_blank\" rel=\"noopener\">FAQ</a>ã€‚<br>\näºŒã€ä»Šæ—¥ç½‘å€<br>\nâ€ƒâ€ƒä¸€ä¸ª <a href=\"https://www.emojicopy.com/\" target=\"_blank\" rel=\"noopener\">emoji copy</a> ç½‘ç«™ï¼Œæˆ‘ä»¬ ğŸ‘§ å°±æ˜¯å–œæ¬¢è¿™äº›èŠ±é‡Œèƒ¡å“¨çš„ä¸œè¥¿ã€‚</p>\n<h4>2019/7/15</h4>\n<p>â€ƒâ€ƒä»Šå¤©åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ React Hooks åˆè¸©å‘äº†ï¼Œçœ‹æ¥è‡ªå·±å¯¹è¿™éƒ¨åˆ†è¿˜æ˜¯æ²¡æœ‰ç†è§£é€å½»ã€‚åœ¨ä½¿ç”¨ <code>useCallback</code> å’Œ <code>useEffect</code> æ—¶ï¼Œè¦æ³¨æ„ç¬¬äºŒä¸ªå‚æ•°ï¼Œä¹Ÿå°±æ˜¯ä¼ å…¥çš„ <code>[deps]</code>ã€‚å¦‚æœä½¿ç”¨ <code>useCallback(fn,[deps])</code> ï¼Œ <code>[deps]</code> åº”è¯¥åŒ…å«å‡½æ•° <code>fn</code> æ‰€æ¶‰åŠçš„æ‰€æœ‰å˜é‡ï¼›å¦‚æœä½¿ç”¨ <code>useEffect(fn,[deps])</code> ï¼Œ å½“ <code>deps</code> çš„å€¼å˜åŒ–æ—¶ï¼Œå°±ä¼šæ‰§è¡Œ <code>fn</code>ï¼Œå› æ­¤<code>[deps]</code> ä¸ä¸€å®šè¦åŒ…å«å‡½æ•° <code>fn</code> æ‰€æ¶‰åŠçš„æ‰€æœ‰å˜é‡ï¼Œè€Œæ˜¯åº”è¯¥ä¼ å…¥ä¼šå¼•èµ·è¯¥å‡½æ•°æ‰§è¡Œçš„é‚£äº›å‚æ•°ã€‚<br>\nâ€ƒâ€ƒä»Šæ—¥è¸©å‘è®°å½•ï¼šä¸ºäº†ä¼˜åŒ–å­ç»„ä»¶ï¼Œä½œä¸º <code>props</code> çš„å‡½æ•°éƒ½ä½¿ç”¨ <code>useCallback</code> åŒ…è£¹äº†ï¼Œå¹¶ä¼ å…¥äº†ç©ºæ•°ç»„ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ï¼Œè¡¨ç¤ºæ²¡æœ‰ä¾èµ–ã€‚ä½†æ˜¯å‡½æ•°ä¸­çš„è¿ç®—éœ€è¦ç”¨åˆ°ç»„ä»¶ä¸­ä¸€ä¸ªå˜é‡ï¼Œå¦‚æœæ²¡æœ‰å°†è¯¥å˜é‡ä½œä¸º <code>deps</code> ï¼Œè¿™ä¸ªå˜é‡å°±ä¼šä¸€ç›´ä¿æŒåˆå§‹å€¼ï¼Œå€¼å¹¶ä¸ä¼šæ”¹å˜ï¼Œè¿è¡Œç»“æœå°±ä¼šä¸é¢„æœŸä¸ç¬¦ã€‚ï¼ˆçœŸçš„å¤ªè ¢äº†ï¼Œç¼“ç¼“èººå€’ï¼‰</p>\n<h4>2019/7/14</h4>\n<p>å‘¨æœ«å½“ç„¶æ˜¯çº¦ä¼šå•¦ã€‚ğŸ˜</p>\n<h4>2019/7/13</h4>\n<p>ä¸€ã€ä»Šæ—¥é˜…è¯»ï¼š<a href=\"https://stackoverflow.com/questions/53446020/how-to-compare-oldvalues-and-newvalues-on-react-hooks-useeffect\" target=\"_blank\" rel=\"noopener\">How to compare oldValues and newValues on React Hooks useEffect?</a><br>\nâ€ƒâ€ƒ React class ç»„ä»¶æä¾›äº† <code>ComponentDidUpdate</code> ä¹‹ç±»çš„æ–¹æ³•æ¥è·å–åˆ°å½“å‰ <code>props</code> å’Œå‰ä¸€ä¸ª <code>props</code> ï¼Œå¹¶è¿›è¡Œæ¯”è¾ƒï¼Œå†³å®šæ˜¯å¦è¿›è¡Œæ›´æ–°ã€‚å‡½æ•°å¼ç»„ä»¶åªæœ‰ <code>useEffect</code> å‡½æ•°æ¥æ¨¡ä»¿ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œå½“æˆ‘ä»¬éœ€è¦è·å–ç»„ä»¶å…ˆå‰çš„ <code>props</code> æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ custom hook ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function usePrevious(value) &#123;</span><br><span class=\"line\">  const ref = useRef();</span><br><span class=\"line\">  useEffect(() =&gt; &#123;</span><br><span class=\"line\">    ref.current = value;</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">  return ref.current;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>â€ƒâ€ƒä¹‹ååœ¨ <code>useEffect</code> ä¸­ä½¿ç”¨ä¸Šé¢çš„å‡½æ•°æ¥æ¨¡æ‹Ÿ <code>ComponentDidUpdate</code> ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const Component = (props) =&gt; &#123;</span><br><span class=\"line\">    const &#123;receiveAmount, sendAmount &#125; = props</span><br><span class=\"line\">    const prevAmount = usePrevious(&#123;receiveAmount, sendAmount&#125;);</span><br><span class=\"line\">    useEffect(() =&gt; &#123;</span><br><span class=\"line\">        if(prevAmount.receiveAmount !== receiveAmount) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">         // process here</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        if(prevAmount.sendAmount !== sendAmount) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">         // process here</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;, [receiveAmount, sendAmount])</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>â€ƒâ€ƒæœ‰æ—¶å€™åœ¨ debug æ—¶ï¼Œæˆ‘ä»¬æƒ³çŸ¥é“ç»„ä»¶ä¸ºä»€ä¹ˆä¼šé‡æ–°æ¸²æŸ“ï¼Œæ˜¯é‚£äº› <code>props</code> æ›´æ–°äº†ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸Šé¢çš„æ–¹æ³•æ¥è·å– <code>prevProps</code>ï¼Œå¹¶åœ¨å‡½æ•°ç»„ä»¶æœ€å¼€å§‹æ—¶å†™ä¸€ä¸ª <code>useEffect</code> å°†å‚æ•°éƒ½æ‰“å°å‡ºæ¥ï¼Œä½¿ç”¨ <code>===</code> æ¯”è¾ƒã€‚</p>\n<h4>2019/7/12</h4>\n<p>ä¸€ã€ä»Šæ—¥æŠ€èƒ½<br>\nâ€ƒâ€ƒé¡¹ç›®ä¸­ç»å¸¸ä¼šæ¶‰åŠåˆ° JSON å­—ç¬¦ä¸²çš„è§£æï¼Œè§£æå‡ºé”™å°±æ‰‘è¡—äº†ï¼Œä¸€èˆ¬æ˜¯ç”¨ <code>try {...} catch {...}</code> åŒ…è£¹ã€‚ä»Šå¤©å¯¼å¸ˆåœ¨ code review æ—¶å»ºè®®æˆ‘ä½¿ç”¨å¦‚ä¸‹å‡½æ•°ï¼Œè¯¥å‡½æ•°ä¹Ÿå¯ä»¥è¦†ç›–ç©ºå­—ç¬¦ä¸²çš„æ£€æµ‹ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function safeJsonParse&lt;T&gt;(str): &#123; ok: true, value: T &#125; | &#123; ok: false &#125; &#123;</span><br><span class=\"line\">  try &#123;</span><br><span class=\"line\">    return &#123;</span><br><span class=\"line\">      ok: true,</span><br><span class=\"line\">      value: JSON.parse(str)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125; catch &#123;</span><br><span class=\"line\">    return &#123;</span><br><span class=\"line\">      ok: false</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>äºŒã€ä»Šæ—¥é˜…è¯»ï¼š<a href=\"https://imweb.io/topic/5b72d4ef15554e6d3409f817\" target=\"_blank\" rel=\"noopener\">ä»æµè§ˆå™¨å¤šè¿›ç¨‹åˆ°JSå•çº¿ç¨‹ï¼ŒJSè¿è¡Œæœºåˆ¶æœ€å…¨é¢çš„ä¸€æ¬¡æ¢³ç†</a>ã€‚<br>\nâ€ƒâ€ƒè¿™ä¸€ç¯‡å¾ˆå¥½åœ°æ¢³ç†äº†è¿›ç¨‹ã€çº¿ç¨‹ã€æµè§ˆå™¨<strong>å¤šè¿›ç¨‹</strong>ã€æµè§ˆå™¨å†…æ ¸<strong>å¤šçº¿ç¨‹</strong>ã€JSå•çº¿ç¨‹ã€JSè¿è¡Œæœºåˆ¶çš„ç›¸å…³çŸ¥è¯†ï¼Œå¾ˆè¿è´¯ï¼Œå»ºè®®æ—¶ä¸æ—¶å›é¡¾ã€‚ç®€å•è®°å½•å‡ ä¸ªçŸ¥è¯†ç‚¹ï¼š<br>\n1ï¼‰è¿›ç¨‹æ˜¯CPUèµ„æºåˆ†é…çš„æœ€å°å•ä½ï¼Œçº¿ç¨‹æ˜¯CPUè°ƒåº¦çš„æœ€å°å•ä½ã€‚ï¼ˆæƒ³å½“å¹´è€ƒæ“ä½œç³»ç»Ÿçš„æ—¶å€™è¿˜èƒŒå¾—æ»šç“œçƒ‚ç†Ÿï¼‰<br>\n2ï¼‰<strong>æµè§ˆå™¨æ˜¯å¤šè¿›ç¨‹çš„</strong>ï¼ŒåŒ…æ‹¬çš„ä¸»è¦è¿›ç¨‹æœ‰ï¼š</p>\n<ul>\n<li>Browserè¿›ç¨‹ï¼ˆæµè§ˆå™¨çš„ä¸»è¿›ç¨‹ï¼Œåªæœ‰ä¸€ä¸ªï¼‰</li>\n<li>æµè§ˆå™¨æ¸²æŸ“è¿›ç¨‹ï¼ˆæµè§ˆå™¨å†…æ ¸ï¼ŒRendererè¿›ç¨‹ï¼Œæ¸²æŸ“è¿›ç¨‹ï¼Œå†…éƒ¨æ˜¯å¤šçº¿ç¨‹çš„ï¼‰ï¼šé»˜è®¤æ¯ä¸ªTabä¸€ä¸ªè¿›ç¨‹</li>\n<li>ç¬¬ä¸‰æ–¹æ’ä»¶è¿›ç¨‹</li>\n<li>GPUè¿›ç¨‹ï¼š3Dç»˜åˆ¶</li>\n</ul>\n<p>3ï¼‰é‡ç‚¹æ˜¯æµè§ˆå™¨å†…æ ¸ï¼Œå®ƒæ˜¯å¤šçº¿ç¨‹çš„ï¼Œä¸»è¦å¸¸é©»çº¿ç¨‹æœ‰ï¼š</p>\n<ul>\n<li>GUIæ¸²æŸ“çº¿ç¨‹ï¼šæ¸²æŸ“é¡µé¢ï¼Œè§£æHTMLï¼ŒCSSï¼Œæ„å»ºDOMæ ‘å’ŒRenderObjectæ ‘ï¼Œå¸ƒå±€å’Œç»˜åˆ¶ï¼Œrepaint å’Œ reflow ç­‰ã€‚</li>\n<li>JSå¼•æ“çº¿ç¨‹ï¼šå¤„ç†ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼Œä¸ GUI æ¸²æŸ“çº¿ç¨‹æ˜¯äº’æ–¥çš„ã€‚</li>\n<li>äº‹ä»¶è§¦å‘çº¿ç¨‹ï¼šæ§åˆ¶äº‹ä»¶å¾ªç¯ï¼ŒæŠŠäº‹ä»¶æ·»åŠ åˆ°ä»»åŠ¡é˜Ÿåˆ—çš„æœ«å°¾ã€‚</li>\n<li>å®šæ—¶è§¦å‘çº¿ç¨‹ï¼š<code>setTimeout</code> å’Œ <code>setInterval</code>ï¼ŒåŒæ ·ä¹Ÿæ˜¯è®¡æ—¶å®Œæ¯•åæ·»åŠ åˆ°é˜Ÿåˆ—æœ«å°¾ã€‚</li>\n<li>å¼‚æ­¥ http è¯·æ±‚çº¿ç¨‹</li>\n</ul>\n<p>4ï¼‰Browserè¿›ç¨‹å’Œæµè§ˆå™¨å†…æ ¸ä¹‹é—´æ˜¯éœ€è¦é€šä¿¡çš„<br>\n5ï¼‰æ—¶é—´å¾ªç¯æœºåˆ¶ <code>Event Loop</code> ï¼šJSåˆ†ä¸ºåŒæ­¥ä»»åŠ¡å’Œå¼‚æ­¥ä»»åŠ¡ï¼ŒåŒæ­¥ä»»åŠ¡éƒ½ä¼šåœ¨ä¸»çº¿ç¨‹ä¸Šè¿è¡Œï¼Œå½¢æˆä¸€ä¸ªæ‰§è¡Œæ ˆï¼›ä¸»çº¿ç¨‹ä¹‹å¤–ï¼Œç”±äº‹ä»¶è§¦å‘çº¿ç¨‹ç®¡ç†ä¸€ä¸ª<strong>ä»»åŠ¡é˜Ÿåˆ—/äº‹ä»¶é˜Ÿåˆ—</strong>ï¼Œå¼‚æ­¥ä»»åŠ¡çš„è¿è¡Œç»“æœä¼šè¢«æ·»åŠ åˆ°ä»»åŠ¡é˜Ÿåˆ—ä¸­ã€‚ä¸€æ—¦æ‰§è¡Œæ ˆä¸­æ‰€æœ‰åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œç³»ç»Ÿå°±ä¼šè¯»å–ä»»åŠ¡é˜Ÿåˆ—ï¼Œå°†å¯è¿è¡Œçš„å¼‚æ­¥ä»»åŠ¡æ·»åŠ åˆ°æ‰§è¡Œæ ˆä¸­å¼€å§‹æ‰§è¡Œã€‚<br>\n6ï¼‰è¿›é˜¶ï¼šmacrotask / task å’Œ microtask/ jobã€‚ES6ä¸­çš„ <code>Promise</code> å°±å±äº microtask å¾®ä»»åŠ¡ ï¼Œè€Œä¸»ä»£ç å—ï¼Œäº‹ä»¶é˜Ÿåˆ—ä¸­çš„æ—¶é—´å¦‚ <code>setTimeout</code> å’Œ <code>setInterval</code> å°±å±äº macrotask å®ä»»åŠ¡ã€‚æ€»ç»“çš„è¿è¡Œæœºåˆ¶å°±æ˜¯ï¼š</p>\n<ul>\n<li>æ‰§è¡Œå®ä»»åŠ¡ã€‚ï¼ˆä»æ‰§è¡Œæ ˆä¸­è·å–ï¼Œå¦‚æœæ²¡æœ‰å°±ä»äº‹ä»¶é˜Ÿåˆ—ä¸­è·å–ï¼‰</li>\n<li>æ‰§è¡Œè¿‡ç¨‹ä¸­å¦‚æœé‡åˆ°å¾®ä»»åŠ¡ï¼Œå°±æ·»åŠ åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ— Job Queues ä¸­ã€‚ï¼ˆä½œè€…çŒœæµ‹è¿™ä¸ªé˜Ÿåˆ—ç”±JSå¼•æ“çº¿ç¨‹ç»´æŠ¤ï¼Œå› ä¸ºæ˜¯åœ¨ä¸»çº¿ç¨‹ä¸‹æ— ç¼æ‰§è¡Œçš„ï¼‰</li>\n<li>å®ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åï¼Œç«‹å³ä¾æ¬¡æ‰§è¡Œå½“å‰å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­æ‰€æœ‰å¾®ä»»åŠ¡ã€‚</li>\n<li>æ£€æŸ¥æ¸²æŸ“ï¼Œç”± GUI çº¿ç¨‹æ¥ç®¡ã€‚</li>\n<li>æ¸²æŸ“å®Œæ¯•åï¼Œç”± JS å¼•æ“çº¿ç¨‹æ¥ç®¡ï¼Œä»æ—¶é—´é˜Ÿåˆ—ä¸­è·å–å¹¶æ‰§è¡Œä¸‹ä¸€ä¸ªå®ä»»åŠ¡ã€‚</li>\n</ul>\n<p>7ï¼‰åœ¨ç¬¬å…­ç‚¹ä¸­æåˆ°çš„æ˜¯ä¸€ä¸ªè¿›é˜¶çš„æ¦‚å¿µï¼Œå¯¹åº”ä¸€é“é¢˜ç›®ï¼Œå¦‚æœä»£ç ä¸­ä¾æ¬¡æœ‰ <code>setTimeout</code> å’Œ <code>Promise</code> ï¼Œæ˜¯ä¼šå…ˆæ‰“å°å‡º <code>Promise</code> çš„æ‰§è¡Œç»“æœçš„ã€‚</p>\n<h4>2019/7/11</h4>\n<p>â€ƒâ€ƒ React 16.8 æå‡ºäº† <code>hook</code> çš„æ¦‚å¿µï¼Œå‡½æ•°å¼ç»„ä»¶ä¹Ÿå¯ä»¥æ‹¥æœ‰è‡ªå·±çš„çŠ¶æ€ã€‚ç°åœ¨çš„å·¥ä½œé¡¹ç›®å·²ç»æ‘’å¼ƒäº† <code>class</code> ï¼Œæ”¹ç”¨å‡½æ•°å¼ç»„ä»¶ï¼Œæ­£åœ¨æ…¢æ…¢æ‘¸ç´¢ä¸­ã€‚ä»Šå¤©åœ¨è…¾è®¯<a href=\"http://imweb.io/\" target=\"_blank\" rel=\"noopener\">IMWebå‰ç«¯åšå®¢</a>ä¸­çœ‹åˆ°äº†ä¸¤ç¯‡ä»‹ç» <code>React hook</code> çš„æ–‡ç« ï¼Œå—ç›ŠåŒªæµ…ï¼Œç®€å•è®°å½•ä¸€ä¸‹ã€‚<br>\nä¸€ã€<a href=\"https://imweb.io/topic/5cd845cadcd62f86299fcd76\" target=\"_blank\" rel=\"noopener\">react hookâ€”â€”ä½ å¯èƒ½ä¸æ˜¯â€œæˆ‘â€æ‰€è®¤è¯†çš„useEffect</a><br>\nâ€ƒâ€ƒè¿™ç¯‡ä»‹ç»äº† <code>useEffect</code> è¿™ä¸ªAPIï¼Œç”¨å®ƒæ¨¡æ‹Ÿäº†classç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ã€‚<code>useEffect</code> ç”¨äºæ‰§è¡Œå‰¯ä½œç”¨ï¼Œç›¸å½“äº <code>ComponentDidMount</code> å’Œ <code>ComponentDidUpdate</code>ã€‚è¯¥APIæœ‰ä¸¤ä¸ªå‚æ•°å’Œä¸€ä¸ªè¿”å›å€¼ã€‚ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå‰¯ä½œç”¨å‡½æ•°ï¼Œè¿”å›å€¼æ˜¯æ¸…é™¤å‡½æ•°ï¼Œç›¸å½“äº <code>ComponentWillUnmount</code>ï¼Œæ¯ä¸€æ¬¡ <code>render</code> éƒ½ä¼šæ‰§è¡Œå‰¯ä½œç”¨å’Œæ¸…é™¤ä¸Šä¸€æ¬¡å‰¯ä½œç”¨ã€‚<strong>ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä¼ å…¥çš„æ˜¯å‰¯ä½œç”¨å‡½æ•°æ‰€éœ€è¦çš„ä¾èµ–ï¼Œå½“ä»»ä¸€ä¾èµ–æ›´æ–°æ—¶ï¼Œä¼šé‡æ–°ç”Ÿæˆä¸€ä¸ªæ–°çš„å‰¯ä½œç”¨å¹¶æ‰§è¡Œï¼›å¦‚æœä¼ å…¥ä¸€ä¸ªç©ºæ•°ç»„ï¼Œæ²¡æœ‰ä¾èµ–ï¼Œåªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œç›¸å½“äº <code>ComponentDidMount</code>ï¼›å¦‚æœä¸ä¼ ï¼Œå°±æ˜¯æ²¡æœ‰è¯´æ˜è‡ªå·±æœ‰æ²¡æœ‰ä¾èµ–ï¼ˆæ³¨æ„æ˜¯ä¸çŸ¥é“æœ‰æ²¡æœ‰ï¼Œä¸æ˜¯æ²¡æœ‰ï¼ï¼‰ï¼Œæ¯æ¬¡ <code>render</code> æ—¶å°±æ‰§è¡Œï¼Œç›¸å½“äº <code>ComponentDidUpdate</code> ã€‚</strong><br>\nâ€ƒâ€ƒ æœ€åè¿˜è®²äº† <code>useEffect</code> å’Œ <code>useLayoutEffect</code> çš„åŒºåˆ«ï¼Œç®€å•æ¥è¯´å‰è€…æ˜¯å¼‚æ­¥çš„ï¼Œåè€…æ˜¯åŒæ­¥çš„ã€‚è¿˜æ²¡å¥½å¥½æ·±å…¥è¿™éƒ¨åˆ†ï¼ŒTODOã€‚<br>\näºŒã€<a href=\"https://imweb.io/topic/5d1e3657f7b5692b080f2651\" target=\"_blank\" rel=\"noopener\">å¯èƒ½ä½ çš„reactå‡½æ•°ç»„ä»¶ä»æ¥æ²¡æœ‰ä¼˜åŒ–è¿‡</a><br>\nâ€ƒâ€ƒä¼˜åŒ–é—®é¢˜çœŸæ˜¯æˆ‘ä¸€ä¸ªç—›ç‚¹ã€‚è¿™ç¯‡æ–‡ç« å¾ˆæ¸…æ¥šåœ°è§£é‡Šäº† <code>Hooks</code> ä¸€äº›å¯ç”¨äºç»„ä»¶ä¼˜åŒ–çš„APIã€‚å¼ºæ¨ï¼<br>\nâ€ƒâ€ƒ ç‰¹åˆ«åœ°ï¼Œæ–‡ç« ä»‹ç»äº†å½“å‡½æ•°ç»„ä»¶ä¸­ä¼ å…¥çš„ <code>props</code> å€¼ä¸ºå‡½æ•°æ—¶ï¼Œç”±äºæ¯ä¸€æ¬¡æ‰§è¡Œæˆ–é‡æ–°æ‰§è¡Œï¼Œä½œç”¨åŸŸé‡Œé¢ä¸€åˆ‡éƒ½æ˜¯é‡æ–°å¼€å§‹ï¼Œå‡½æ•°ä¸æ˜¯ç®€å•æ•°æ®ç±»å‹ï¼Œä¸èƒ½ç”»ä¸Šç­‰å·ï¼Œå­ç»„ä»¶éƒ½ä¼šé‡æ–°æ¸²æŸ“ã€‚é’ˆå¯¹è¿™ä¸ªé—®é¢˜æ–‡ç« æå‡ºäº†å‡ ç§è§£å†³åŠæ³•ï¼š<br>\n1ï¼‰ ä½œä¸º <code>props</code> çš„å‡½æ•°åœ¨å‡½æ•°ç»„ä»¶å¤–å®šä¹‰ï¼Œå‡½æ•°ç»„ä»¶ç”¨ <code>React.memo()</code> åŒ…è£¹ã€‚<br>\nâ€ƒâ€ƒ <code>React.memo()</code> ç±»ä¼¼äº <code>PureComponent</code> å’Œ <code>ComponentDidUpdate</code> ï¼Œå¦‚æœå‡½æ•°ç»„ä»¶çš„ <code>props</code> å€¼éƒ½ä¸€æ ·ï¼Œå°±ä¼šè·³è¿‡è¯¥ç»„ä»¶çš„æ‰§è¡Œï¼Œå‡å°‘ä¸å¿…è¦çš„æ¸²æŸ“ï¼Œå®ç°æ€§èƒ½ä¼˜åŒ–ã€‚<br>\n2ï¼‰ ä½œä¸º <code>props</code> çš„å‡½æ•°åœ¨å‡½æ•°ç»„ä»¶å†…å®šä¹‰ï¼Œä½¿ç”¨<code>useCallBack</code> æˆ– <code>useMemo</code>åŒ…è£¹ï¼Œå‡½æ•°ç»„ä»¶ç”¨ <code>React.memo()</code> åŒ…è£¹ã€‚<br>\nâ€ƒâ€ƒ <code>useCallback(() =&gt; {}, [deps])</code> è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œå½“ <code>deps</code> ä¸å˜æ—¶ï¼ˆå¦‚ä¼ å…¥ç©ºæ•°ç»„ï¼Œè¡¨ç¤ºæ²¡æœ‰ä¾èµ–ï¼‰ï¼Œéƒ½æ˜¯åŒä¸€ä¸ªå‡½æ•°ã€‚<code>const a = useMemo(() =&gt; memorizeValue, [deps])</code>ï¼Œå½“ <code>deps</code> ä¸å˜æ—¶ï¼Œ<code>a</code> çš„å€¼è¿˜æ˜¯ä¸Šæ¬¡çš„ <code>memorizeValue</code>ï¼Œçœå»äº†é‡æ–°è®¡ç®—çš„è¿‡ç¨‹ã€‚<br>\nâ€ƒâ€ƒ æ³¨æ„å½“ <code>memorizeValue</code> æ˜¯ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œ<code>useCallback(fn, inputs) &lt;=&gt; useMemo(() =&gt; fn, inputs)</code>ã€‚</p>\n<h4>2019/7/10</h4>\n<p>â€ƒâ€ƒä»Šå¤©åœ¨é¡¹ç›®ä¸­æ¥è§¦åˆ°äº† <code>symbol</code>ï¼Œé‰´äºä¹‹å‰ä¸€ç›´æ²¡æœ‰æ³¨æ„è¿™ä¸ªæ•°æ®ç±»å‹ï¼Œåœ¨ä»Šå¤©è¡¥ä¸Šã€‚ <code>symbol</code> æ˜¯ ES6 æ–°å¢çš„<strong>åŸºæœ¬</strong>æ•°æ®ç±»å‹ã€‚å®ƒçš„ä½¿ç”¨å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const s1 = Symbol();</span><br><span class=\"line\">const s2 = Symbol();</span><br><span class=\"line\">console.log(s1 === s2); // false</span><br><span class=\"line\"></span><br><span class=\"line\">const s3 = new Symbol() // TypeError: Symbol is not a constructor</span><br><span class=\"line\">Symbol(&quot;foo&quot;) === Symbol(&quot;foo&quot;); // false</span><br></pre></td></tr></table></figure>\n<p><code>Symbol()</code> è¿”å›çš„æ¯ä¸ª <code>symbol</code> å€¼éƒ½æ˜¯å”¯ä¸€çš„ï¼Œå¯ä»¥æ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ã€‚å®ƒæœ€å¸¸è¢«ç”¨äºå¯¹è±¡å±æ€§çš„æ ‡è¯†ç¬¦ï¼Œå¦‚ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const obj = &#123;&#125;</span><br><span class=\"line\">const foo = Symbol(&quot;foo&quot;)</span><br><span class=\"line\">obj[foo] = &quot;foo&quot;</span><br><span class=\"line\">obj.bar = &quot;bar&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">console.log(obj); // &#123; bar: &quot;bar&quot; , Symbol(foo): &quot;foo&quot;&#125;</span><br><span class=\"line\">console.log(foo in obj); // true</span><br><span class=\"line\">console.log(obj[foo]); // foo</span><br><span class=\"line\">console.log(Object.keys(obj)); // [&quot;bar&quot;]</span><br><span class=\"line\">console.log(Object.getOwnPropertySymbols(obj)) // [Symbol(foo)]</span><br></pre></td></tr></table></figure>\n<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œ <code>Object.key()</code> ä¸ä¼šè¿”å› <code>symbol</code> å€¼ï¼ŒåŒç†ï¼Œ<code>Object.getOwnPropertyNames()</code>ã€<code>for..in</code>ã€<code>for...of</code> ä¹Ÿä¸ä¼šè¿”å›ã€‚<code>JSON.stringify()</code> ä¹Ÿä¼šå¿½ç•¥ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">JSON.stringify(&#123;[Symbol(&apos;foo&apos;)]: &apos;foo&apos;&#125;);                 </span><br><span class=\"line\">// &apos;&#123;&#125;&apos;</span><br></pre></td></tr></table></figure>\n<p><code>Symbol</code> è¿˜æœ‰ä¸¤ä¸ªæ–¹æ³•ã€‚ <code>Symbol.for(key)</code> æ˜¯æ ¹æ®æŒ‡å®šçš„ <code>key</code> æœç´¢ç°æœ‰çš„ <code>symbol</code> å¹¶è¿”å›, å¦‚æœæ‰¾ä¸åˆ°ï¼Œä¼šä½¿ç”¨ <code>key</code> åœ¨å…¨å±€çš„ <code>symbol</code> æ³¨å†Œè¡¨ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„ <code>symbol</code> ã€‚<code>Symbol.keyFor(sym)</code> æ˜¯åœ¨å…¨å±€æ³¨å†Œè¡¨ä¸­æ£€ç´¢ï¼Œè¿”å›å…±äº«çš„ <code>symbol key</code> ã€‚</p>\n<h4>2019/7/9</h4>\n<p>ä¸€ä¸ªä¸å¥½çš„ç¼–ç¨‹ä¹ æƒ¯ï¼šè®©å‡½æ•°åœ¨å†…éƒ¨è·å–è‡ªå·±æ‰€éœ€çš„ä¾èµ–ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// ä¸€ä¸ªå¯å¤ç”¨å‡½æ•°</span><br><span class=\"line\">function doSomething(key: string) &#123;</span><br><span class=\"line\">    return (</span><br><span class=\"line\">        &lt;Button</span><br><span class=\"line\">            loading = &#123;key===&quot;str1&quot;? Compoment1 : Compoment2&#125;</span><br><span class=\"line\">        &gt;</span><br><span class=\"line\">            button</span><br><span class=\"line\">        &lt;/Button&gt;</span><br><span class=\"line\">    )</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>lodaing</code> æ‰€éœ€çš„ç»„ä»¶åº”è¯¥æ˜¯ä½œä¸ºå‡½æ•°å‚æ•°ä¼ å…¥çš„ï¼Œä¸ç„¶å¦‚æœæˆ‘ä»¬æ–°å¢äº†ä¸€ä¸ª <code>key</code>ï¼Œå¾ˆå®¹æ˜“å¿½ç•¥äº†è¯¥åœ°æ–¹çš„ä¿®æ”¹ã€‚è¿™ä¸ªè§‚ç‚¹ç±»ä¼¼äºä¾èµ–åè½¬ã€‚</p>\n"},{"title":"FrontEnd Notes [2019.12]","catalog":true,"date":"2019-12-09T15:33:36.000Z","subtitle":null,"header-img":null,"_content":"\n#### About\n\nğŸ“… 2019 å¹´ 12 æœˆçš„é›¶æ•£å­¦ä¹ è®°å½•ã€‚\n\n#### 2019/12/26\nä»Šæ—¥é˜…è¯»ï¼š[When to useMemo and useCallback](https://kentcdodds.com/blog/usememo-and-usecallback)\nèµ·å› æ˜¯åˆ· reddit æ—¶çœ‹åˆ°äº†è¿™ç¯‡ [å¸–å­](https://www.reddit.com/r/reactjs/comments/efjgfc/should_i_use_usecallback_in_every_function/)ï¼Œæé—®è€…çš„é—®é¢˜æ˜¯ \"Should I use useCallback in every function declared inside a functional component?\"ï¼Œè¯„è®ºä¸­æœ‰äººè´´å‡ºäº†è¿™ä¸ªé“¾æ¥ï¼Œæ›´æ­£äº†æˆ‘å¯¹æ€§èƒ½ä¼˜åŒ–çš„ä¸€äº›é”™è¯¯è®¤çŸ¥ã€‚\nä½œè€…åœ¨æ–‡ç« ä¸­ä¸¾äº†ä¸€ä¸ªä¾‹å­ï¼Œåœ¨æŸä¸ªå‡½æ•°ç»„ä»¶ä¸­æœ‰è¿™æ ·ä¸€ä¸ªå‡½æ•°ï¼š\n```\nconst dispense = candy => {\n  setCandies(allCandies => allCandies.filter(c => c !== candy))\n}\n```\né—®é¢˜ï¼šå¦‚æœç”¨ `useCallback` åŒ…è£¹ï¼Œé‚£ä¹ˆæ€§èƒ½ä¼šä¸ä¼šæ›´å¥½å‘¢ï¼Ÿ\n```\nconst dispense = React.useCallback(candy => {\n  setCandies(allCandies => allCandies.filter(c => c !== candy))\n}, [])\n```\næˆ‘åˆšå¼€å§‹çš„ç­”æ¡ˆæ˜¯ä½¿ç”¨ `useCallback` ä¼šæ›´å¥½ï¼Œæ¯«æ— ç–‘é—®æ˜¯é”™çš„ã€‚ä¸Šé¢çš„å‡½æ•°ä¹Ÿå¯è¢«å†™æˆï¼š\n```\nconst dispense = candy => {\n    setCandies(allCandies => allCandies.filter(c => c !== candy))\n  }\n+ const dispenseCallback = React.useCallback(dispense, [])\n```\ndiff ä¹‹åä¼šå‘ç°åªæ˜¯å¤šäº†ä¸€è¡Œï¼Œè¯¥æœ‰çš„å£°æ˜è¿˜æ˜¯æœ‰ï¼Œè¿˜éœ€è¦åšæ›´å¤šçš„å·¥ä½œã€‚ç°åœ¨ä¸ä»…ä»…è¦å®šä¹‰å‡½æ•°ï¼Œè¿˜è¦å®šä¹‰ä¾èµ–æ•°ç»„ï¼Œè°ƒç”¨ `useCallback` è¿›è¡Œèµ‹å€¼åˆ†é…ç­‰å·¥ä½œã€‚ä¹‹å‰æˆ‘ä¸€ç›´è¯¯ä»¥ä¸ºï¼Œä½¿ç”¨ `useCallback` åï¼Œå‡½æ•°åªä¼šåœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶å®šä¹‰å¹¶èµ‹å€¼ï¼Œç¬¬äºŒæ¬¡æ¸²æŸ“ä¸ä¼šåšé¢å¤–çš„æ“ä½œã€‚å…¶å®ä¸æ˜¯çš„ï¼Œè¿™é‡Œçš„ç›¸ç­‰å¯ä»¥ç†è§£ä¸ºæ˜¯ â€œæŒ‡å‘çš„ä½ç½®â€ ç›¸ç­‰ï¼Œç±»ä¼¼ `ref` å’Œ `ref.current`ï¼Œé‡æ–°æ¸²æŸ“æ—¶å°±ç›¸å½“äºæ‰§è¡Œ `ref.current = newVal` ã€‚\né‚£ä»€ä¹ˆæ—¶å€™éœ€è¦ç”¨åˆ° `useCallback` å‘¢ï¼Ÿå®˜æ–¹æ–‡æ¡£æ˜¯è¿™æ ·å†™çš„ï¼š\n> This is useful when passing callbacks to optimized child components that rely on reference equality to prevent unnecessary renders (e.g. shouldComponentUpdate).\n\næœ€ç®€å•ç²—æš´çš„ç»éªŒï¼Œæ˜¯å½“ä½ éœ€è¦å°†è¿™ä¸ªå‡½æ•°ä¼ é€’ç»™å­ç»„ä»¶æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ `useCallback` æ¥é¿å…å­ç»„ä»¶ä¸å¿…è¦çš„æ¸²æŸ“ï¼ˆå­ç»„ä»¶ä½¿ç”¨ `useMemo`ï¼‰ï¼›æ›´å‡†ç¡®çš„è¯´æ³•ï¼Œæ˜¯å½“ä½ éœ€è¦ä¾èµ–å¼•ç”¨ç›¸ç­‰æ€§æ—¶ï¼Œå°±åº”ä½¿ç”¨ `useCallback` ã€‚  \n\n#### 2019/12/17\nä¿ç•™å››ä½æœ‰æ•ˆæ•°å­—ï¼š\n```\nx.toPrecise(4) // return string\n```\n\n#### 2019/12/9\n\nä½¿ç”¨åŸç”Ÿæ–¹æ³•å®ç°æ–‡ä»¶ç‚¹å‡»/æ‹–æ‹½ä¸Šä¼ ï¼Œå¹¶é™åˆ¶åªèƒ½ä¸Šä¼ å•ä¸ª JSON æ–‡ä»¶ï¼š\nä¸»è¦æ€æƒ³æ˜¯ç›‘å¬ `onClick` å’Œ `onDrop` äº‹ä»¶ï¼Œæ³¨æ„åœ¨ React ä¸­ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦æ³¨å†Œæ•è·é˜¶æ®µçš„äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œåˆ™åº”ä¸ºäº‹ä»¶åæ·»åŠ  `Capture`ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨å¤„ç†æ•è·é˜¶æ®µçš„ç‚¹å‡»äº‹ä»¶ `onClickCapture`ï¼Œè€Œä¸æ˜¯ `onClick`ã€‚è¯¦æƒ…å¯å‚è€ƒå®˜æ–¹æ–‡æ¡£ [Supported Events](https://reactjs.org/docs/events.html#supported-events) ã€‚\n\n```\n// upload.tsx\n  ...\n  const handleUploadClick = () => {\n    const input = document.createElement(\"input\");\n    input.type = \"file\";\n    input.accept = \".json,application/json\";\n    input.onchange = ev => {\n      // double-checked\n      if (\n        input.files &&\n        input.files.length === 1 &&\n        input.files[0].type === \"application/json\"\n      ) {\n        // deal with input.files\n      }\n    };\n    input.click();\n  };\n\n  const handleUploadDrop = (ev:       React.DragEvent<HTMLDivElement>) => {\n    if (ev.dataTransfer.files.length > 1) {\n      console.error(\"åªå…è®¸ä¸Šä¼ å•ä¸ªæ–‡ä»¶\");\n    } else if (ev.dataTransfer.files[0].type !== \"application/json\") {\n      console.error(\"åªå…è®¸ä¸Šä¼ jsonæ–‡ä»¶\");\n    } else {\n      // deal with ev.dataTransfer.files[0]\n    }\n  };\n\n  ...\n\n  render() {\n    return (\n      <div\n        onClickCapture={ev => {\n          ev.preventDefault();\n          ev.stopPropagation();\n          handleUploadClick();\n        }}\n        onDropCapture={ev => {\n          ev.preventDefault();\n          ev.stopPropagation();\n          handleUploadDrop(ev);\n        }}\n      >\n        Click or drag file to this area to upload\n      </div>\n    )\n  }\n\n```\n","source":"_posts/FrontEnd-Notes-2019-12.md","raw":"---\ntitle: \"FrontEnd Notes [2019.12]\"\ncatalog: true\ndate: 2019-12-09 23:33:36\nsubtitle:\nheader-img:\ntags: FE\n---\n\n#### About\n\nğŸ“… 2019 å¹´ 12 æœˆçš„é›¶æ•£å­¦ä¹ è®°å½•ã€‚\n\n#### 2019/12/26\nä»Šæ—¥é˜…è¯»ï¼š[When to useMemo and useCallback](https://kentcdodds.com/blog/usememo-and-usecallback)\nèµ·å› æ˜¯åˆ· reddit æ—¶çœ‹åˆ°äº†è¿™ç¯‡ [å¸–å­](https://www.reddit.com/r/reactjs/comments/efjgfc/should_i_use_usecallback_in_every_function/)ï¼Œæé—®è€…çš„é—®é¢˜æ˜¯ \"Should I use useCallback in every function declared inside a functional component?\"ï¼Œè¯„è®ºä¸­æœ‰äººè´´å‡ºäº†è¿™ä¸ªé“¾æ¥ï¼Œæ›´æ­£äº†æˆ‘å¯¹æ€§èƒ½ä¼˜åŒ–çš„ä¸€äº›é”™è¯¯è®¤çŸ¥ã€‚\nä½œè€…åœ¨æ–‡ç« ä¸­ä¸¾äº†ä¸€ä¸ªä¾‹å­ï¼Œåœ¨æŸä¸ªå‡½æ•°ç»„ä»¶ä¸­æœ‰è¿™æ ·ä¸€ä¸ªå‡½æ•°ï¼š\n```\nconst dispense = candy => {\n  setCandies(allCandies => allCandies.filter(c => c !== candy))\n}\n```\né—®é¢˜ï¼šå¦‚æœç”¨ `useCallback` åŒ…è£¹ï¼Œé‚£ä¹ˆæ€§èƒ½ä¼šä¸ä¼šæ›´å¥½å‘¢ï¼Ÿ\n```\nconst dispense = React.useCallback(candy => {\n  setCandies(allCandies => allCandies.filter(c => c !== candy))\n}, [])\n```\næˆ‘åˆšå¼€å§‹çš„ç­”æ¡ˆæ˜¯ä½¿ç”¨ `useCallback` ä¼šæ›´å¥½ï¼Œæ¯«æ— ç–‘é—®æ˜¯é”™çš„ã€‚ä¸Šé¢çš„å‡½æ•°ä¹Ÿå¯è¢«å†™æˆï¼š\n```\nconst dispense = candy => {\n    setCandies(allCandies => allCandies.filter(c => c !== candy))\n  }\n+ const dispenseCallback = React.useCallback(dispense, [])\n```\ndiff ä¹‹åä¼šå‘ç°åªæ˜¯å¤šäº†ä¸€è¡Œï¼Œè¯¥æœ‰çš„å£°æ˜è¿˜æ˜¯æœ‰ï¼Œè¿˜éœ€è¦åšæ›´å¤šçš„å·¥ä½œã€‚ç°åœ¨ä¸ä»…ä»…è¦å®šä¹‰å‡½æ•°ï¼Œè¿˜è¦å®šä¹‰ä¾èµ–æ•°ç»„ï¼Œè°ƒç”¨ `useCallback` è¿›è¡Œèµ‹å€¼åˆ†é…ç­‰å·¥ä½œã€‚ä¹‹å‰æˆ‘ä¸€ç›´è¯¯ä»¥ä¸ºï¼Œä½¿ç”¨ `useCallback` åï¼Œå‡½æ•°åªä¼šåœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶å®šä¹‰å¹¶èµ‹å€¼ï¼Œç¬¬äºŒæ¬¡æ¸²æŸ“ä¸ä¼šåšé¢å¤–çš„æ“ä½œã€‚å…¶å®ä¸æ˜¯çš„ï¼Œè¿™é‡Œçš„ç›¸ç­‰å¯ä»¥ç†è§£ä¸ºæ˜¯ â€œæŒ‡å‘çš„ä½ç½®â€ ç›¸ç­‰ï¼Œç±»ä¼¼ `ref` å’Œ `ref.current`ï¼Œé‡æ–°æ¸²æŸ“æ—¶å°±ç›¸å½“äºæ‰§è¡Œ `ref.current = newVal` ã€‚\né‚£ä»€ä¹ˆæ—¶å€™éœ€è¦ç”¨åˆ° `useCallback` å‘¢ï¼Ÿå®˜æ–¹æ–‡æ¡£æ˜¯è¿™æ ·å†™çš„ï¼š\n> This is useful when passing callbacks to optimized child components that rely on reference equality to prevent unnecessary renders (e.g. shouldComponentUpdate).\n\næœ€ç®€å•ç²—æš´çš„ç»éªŒï¼Œæ˜¯å½“ä½ éœ€è¦å°†è¿™ä¸ªå‡½æ•°ä¼ é€’ç»™å­ç»„ä»¶æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ `useCallback` æ¥é¿å…å­ç»„ä»¶ä¸å¿…è¦çš„æ¸²æŸ“ï¼ˆå­ç»„ä»¶ä½¿ç”¨ `useMemo`ï¼‰ï¼›æ›´å‡†ç¡®çš„è¯´æ³•ï¼Œæ˜¯å½“ä½ éœ€è¦ä¾èµ–å¼•ç”¨ç›¸ç­‰æ€§æ—¶ï¼Œå°±åº”ä½¿ç”¨ `useCallback` ã€‚  \n\n#### 2019/12/17\nä¿ç•™å››ä½æœ‰æ•ˆæ•°å­—ï¼š\n```\nx.toPrecise(4) // return string\n```\n\n#### 2019/12/9\n\nä½¿ç”¨åŸç”Ÿæ–¹æ³•å®ç°æ–‡ä»¶ç‚¹å‡»/æ‹–æ‹½ä¸Šä¼ ï¼Œå¹¶é™åˆ¶åªèƒ½ä¸Šä¼ å•ä¸ª JSON æ–‡ä»¶ï¼š\nä¸»è¦æ€æƒ³æ˜¯ç›‘å¬ `onClick` å’Œ `onDrop` äº‹ä»¶ï¼Œæ³¨æ„åœ¨ React ä¸­ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦æ³¨å†Œæ•è·é˜¶æ®µçš„äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œåˆ™åº”ä¸ºäº‹ä»¶åæ·»åŠ  `Capture`ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨å¤„ç†æ•è·é˜¶æ®µçš„ç‚¹å‡»äº‹ä»¶ `onClickCapture`ï¼Œè€Œä¸æ˜¯ `onClick`ã€‚è¯¦æƒ…å¯å‚è€ƒå®˜æ–¹æ–‡æ¡£ [Supported Events](https://reactjs.org/docs/events.html#supported-events) ã€‚\n\n```\n// upload.tsx\n  ...\n  const handleUploadClick = () => {\n    const input = document.createElement(\"input\");\n    input.type = \"file\";\n    input.accept = \".json,application/json\";\n    input.onchange = ev => {\n      // double-checked\n      if (\n        input.files &&\n        input.files.length === 1 &&\n        input.files[0].type === \"application/json\"\n      ) {\n        // deal with input.files\n      }\n    };\n    input.click();\n  };\n\n  const handleUploadDrop = (ev:       React.DragEvent<HTMLDivElement>) => {\n    if (ev.dataTransfer.files.length > 1) {\n      console.error(\"åªå…è®¸ä¸Šä¼ å•ä¸ªæ–‡ä»¶\");\n    } else if (ev.dataTransfer.files[0].type !== \"application/json\") {\n      console.error(\"åªå…è®¸ä¸Šä¼ jsonæ–‡ä»¶\");\n    } else {\n      // deal with ev.dataTransfer.files[0]\n    }\n  };\n\n  ...\n\n  render() {\n    return (\n      <div\n        onClickCapture={ev => {\n          ev.preventDefault();\n          ev.stopPropagation();\n          handleUploadClick();\n        }}\n        onDropCapture={ev => {\n          ev.preventDefault();\n          ev.stopPropagation();\n          handleUploadDrop(ev);\n        }}\n      >\n        Click or drag file to this area to upload\n      </div>\n    )\n  }\n\n```\n","slug":"FrontEnd-Notes-2019-12","published":1,"updated":"2020-01-02T01:57:48.925Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck6vknhek0003osuewhpciwkn","content":"<h4 id=\"about\">About</h4>\n<p>ğŸ“… 2019 å¹´ 12 æœˆçš„é›¶æ•£å­¦ä¹ è®°å½•ã€‚</p>\n<h4 id=\"20191226\">2019/12/26</h4>\n<p>ä»Šæ—¥é˜…è¯»ï¼š<a href=\"https://kentcdodds.com/blog/usememo-and-usecallback\" target=\"_blank\" rel=\"noopener\">When to useMemo and useCallback</a><br>\nèµ·å› æ˜¯åˆ· reddit æ—¶çœ‹åˆ°äº†è¿™ç¯‡ <a href=\"https://www.reddit.com/r/reactjs/comments/efjgfc/should_i_use_usecallback_in_every_function/\" target=\"_blank\" rel=\"noopener\">å¸–å­</a>ï¼Œæé—®è€…çš„é—®é¢˜æ˜¯ â€œShould I use useCallback in every function declared inside a functional component?â€ï¼Œè¯„è®ºä¸­æœ‰äººè´´å‡ºäº†è¿™ä¸ªé“¾æ¥ï¼Œæ›´æ­£äº†æˆ‘å¯¹æ€§èƒ½ä¼˜åŒ–çš„ä¸€äº›é”™è¯¯è®¤çŸ¥ã€‚<br>\nä½œè€…åœ¨æ–‡ç« ä¸­ä¸¾äº†ä¸€ä¸ªä¾‹å­ï¼Œåœ¨æŸä¸ªå‡½æ•°ç»„ä»¶ä¸­æœ‰è¿™æ ·ä¸€ä¸ªå‡½æ•°ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const dispense = candy =&gt; &#123;</span><br><span class=\"line\">  setCandies(allCandies =&gt; allCandies.filter(c =&gt; c !== candy))</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>é—®é¢˜ï¼šå¦‚æœç”¨ <code>useCallback</code> åŒ…è£¹ï¼Œé‚£ä¹ˆæ€§èƒ½ä¼šä¸ä¼šæ›´å¥½å‘¢ï¼Ÿ</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const dispense = React.useCallback(candy =&gt; &#123;</span><br><span class=\"line\">  setCandies(allCandies =&gt; allCandies.filter(c =&gt; c !== candy))</span><br><span class=\"line\">&#125;, [])</span><br></pre></td></tr></table></figure>\n<p>æˆ‘åˆšå¼€å§‹çš„ç­”æ¡ˆæ˜¯ä½¿ç”¨ <code>useCallback</code> ä¼šæ›´å¥½ï¼Œæ¯«æ— ç–‘é—®æ˜¯é”™çš„ã€‚ä¸Šé¢çš„å‡½æ•°ä¹Ÿå¯è¢«å†™æˆï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const dispense = candy =&gt; &#123;</span><br><span class=\"line\">    setCandies(allCandies =&gt; allCandies.filter(c =&gt; c !== candy))</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">+ const dispenseCallback = React.useCallback(dispense, [])</span><br></pre></td></tr></table></figure>\n<p>diff ä¹‹åä¼šå‘ç°åªæ˜¯å¤šäº†ä¸€è¡Œï¼Œè¯¥æœ‰çš„å£°æ˜è¿˜æ˜¯æœ‰ï¼Œè¿˜éœ€è¦åšæ›´å¤šçš„å·¥ä½œã€‚ç°åœ¨ä¸ä»…ä»…è¦å®šä¹‰å‡½æ•°ï¼Œè¿˜è¦å®šä¹‰ä¾èµ–æ•°ç»„ï¼Œè°ƒç”¨ <code>useCallback</code> è¿›è¡Œèµ‹å€¼åˆ†é…ç­‰å·¥ä½œã€‚ä¹‹å‰æˆ‘ä¸€ç›´è¯¯ä»¥ä¸ºï¼Œä½¿ç”¨ <code>useCallback</code> åï¼Œå‡½æ•°åªä¼šåœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶å®šä¹‰å¹¶èµ‹å€¼ï¼Œç¬¬äºŒæ¬¡æ¸²æŸ“ä¸ä¼šåšé¢å¤–çš„æ“ä½œã€‚å…¶å®ä¸æ˜¯çš„ï¼Œè¿™é‡Œçš„ç›¸ç­‰å¯ä»¥ç†è§£ä¸ºæ˜¯ â€œæŒ‡å‘çš„ä½ç½®â€ ç›¸ç­‰ï¼Œç±»ä¼¼ <code>ref</code> å’Œ <code>ref.current</code>ï¼Œé‡æ–°æ¸²æŸ“æ—¶å°±ç›¸å½“äºæ‰§è¡Œ <code>ref.current = newVal</code> ã€‚<br>\né‚£ä»€ä¹ˆæ—¶å€™éœ€è¦ç”¨åˆ° <code>useCallback</code> å‘¢ï¼Ÿå®˜æ–¹æ–‡æ¡£æ˜¯è¿™æ ·å†™çš„ï¼š</p>\n<blockquote>\n<p>This is useful when passing callbacks to optimized child components that rely on reference equality to prevent unnecessary renders (e.g. shouldComponentUpdate).</p>\n</blockquote>\n<p>æœ€ç®€å•ç²—æš´çš„ç»éªŒï¼Œæ˜¯å½“ä½ éœ€è¦å°†è¿™ä¸ªå‡½æ•°ä¼ é€’ç»™å­ç»„ä»¶æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ <code>useCallback</code> æ¥é¿å…å­ç»„ä»¶ä¸å¿…è¦çš„æ¸²æŸ“ï¼ˆå­ç»„ä»¶ä½¿ç”¨ <code>useMemo</code>ï¼‰ï¼›æ›´å‡†ç¡®çš„è¯´æ³•ï¼Œæ˜¯å½“ä½ éœ€è¦ä¾èµ–å¼•ç”¨ç›¸ç­‰æ€§æ—¶ï¼Œå°±åº”ä½¿ç”¨ <code>useCallback</code> ã€‚</p>\n<h4 id=\"20191217\">2019/12/17</h4>\n<p>ä¿ç•™å››ä½æœ‰æ•ˆæ•°å­—ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">x.toPrecise(4) // return string</span><br></pre></td></tr></table></figure>\n<h4 id=\"2019129\">2019/12/9</h4>\n<p>ä½¿ç”¨åŸç”Ÿæ–¹æ³•å®ç°æ–‡ä»¶ç‚¹å‡»/æ‹–æ‹½ä¸Šä¼ ï¼Œå¹¶é™åˆ¶åªèƒ½ä¸Šä¼ å•ä¸ª JSON æ–‡ä»¶ï¼š<br>\nä¸»è¦æ€æƒ³æ˜¯ç›‘å¬ <code>onClick</code> å’Œ <code>onDrop</code> äº‹ä»¶ï¼Œæ³¨æ„åœ¨ React ä¸­ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦æ³¨å†Œæ•è·é˜¶æ®µçš„äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œåˆ™åº”ä¸ºäº‹ä»¶åæ·»åŠ  <code>Capture</code>ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨å¤„ç†æ•è·é˜¶æ®µçš„ç‚¹å‡»äº‹ä»¶ <code>onClickCapture</code>ï¼Œè€Œä¸æ˜¯ <code>onClick</code>ã€‚è¯¦æƒ…å¯å‚è€ƒå®˜æ–¹æ–‡æ¡£ <a href=\"https://reactjs.org/docs/events.html#supported-events\" target=\"_blank\" rel=\"noopener\">Supported Events</a> ã€‚</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// upload.tsx</span><br><span class=\"line\">  ...</span><br><span class=\"line\">  const handleUploadClick = () =&gt; &#123;</span><br><span class=\"line\">    const input = document.createElement(&quot;input&quot;);</span><br><span class=\"line\">    input.type = &quot;file&quot;;</span><br><span class=\"line\">    input.accept = &quot;.json,application/json&quot;;</span><br><span class=\"line\">    input.onchange = ev =&gt; &#123;</span><br><span class=\"line\">      // double-checked</span><br><span class=\"line\">      if (</span><br><span class=\"line\">        input.files &amp;&amp;</span><br><span class=\"line\">        input.files.length === 1 &amp;&amp;</span><br><span class=\"line\">        input.files[0].type === &quot;application/json&quot;</span><br><span class=\"line\">      ) &#123;</span><br><span class=\"line\">        // deal with input.files</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    input.click();</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">  const handleUploadDrop = (ev:       React.DragEvent&lt;HTMLDivElement&gt;) =&gt; &#123;</span><br><span class=\"line\">    if (ev.dataTransfer.files.length &gt; 1) &#123;</span><br><span class=\"line\">      console.error(&quot;åªå…è®¸ä¸Šä¼ å•ä¸ªæ–‡ä»¶&quot;);</span><br><span class=\"line\">    &#125; else if (ev.dataTransfer.files[0].type !== &quot;application/json&quot;) &#123;</span><br><span class=\"line\">      console.error(&quot;åªå…è®¸ä¸Šä¼ jsonæ–‡ä»¶&quot;);</span><br><span class=\"line\">    &#125; else &#123;</span><br><span class=\"line\">      // deal with ev.dataTransfer.files[0]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">  ...</span><br><span class=\"line\"></span><br><span class=\"line\">  render() &#123;</span><br><span class=\"line\">    return (</span><br><span class=\"line\">      &lt;div</span><br><span class=\"line\">        onClickCapture=&#123;ev =&gt; &#123;</span><br><span class=\"line\">          ev.preventDefault();</span><br><span class=\"line\">          ev.stopPropagation();</span><br><span class=\"line\">          handleUploadClick();</span><br><span class=\"line\">        &#125;&#125;</span><br><span class=\"line\">        onDropCapture=&#123;ev =&gt; &#123;</span><br><span class=\"line\">          ev.preventDefault();</span><br><span class=\"line\">          ev.stopPropagation();</span><br><span class=\"line\">          handleUploadDrop(ev);</span><br><span class=\"line\">        &#125;&#125;</span><br><span class=\"line\">      &gt;</span><br><span class=\"line\">        Click or drag file to this area to upload</span><br><span class=\"line\">      &lt;/div&gt;</span><br><span class=\"line\">    )</span><br><span class=\"line\">  &#125;</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h4>About</h4>\n<p>ğŸ“… 2019 å¹´ 12 æœˆçš„é›¶æ•£å­¦ä¹ è®°å½•ã€‚</p>\n<h4>2019/12/26</h4>\n<p>ä»Šæ—¥é˜…è¯»ï¼š<a href=\"https://kentcdodds.com/blog/usememo-and-usecallback\" target=\"_blank\" rel=\"noopener\">When to useMemo and useCallback</a><br>\nèµ·å› æ˜¯åˆ· reddit æ—¶çœ‹åˆ°äº†è¿™ç¯‡ <a href=\"https://www.reddit.com/r/reactjs/comments/efjgfc/should_i_use_usecallback_in_every_function/\" target=\"_blank\" rel=\"noopener\">å¸–å­</a>ï¼Œæé—®è€…çš„é—®é¢˜æ˜¯ â€œShould I use useCallback in every function declared inside a functional component?â€ï¼Œè¯„è®ºä¸­æœ‰äººè´´å‡ºäº†è¿™ä¸ªé“¾æ¥ï¼Œæ›´æ­£äº†æˆ‘å¯¹æ€§èƒ½ä¼˜åŒ–çš„ä¸€äº›é”™è¯¯è®¤çŸ¥ã€‚<br>\nä½œè€…åœ¨æ–‡ç« ä¸­ä¸¾äº†ä¸€ä¸ªä¾‹å­ï¼Œåœ¨æŸä¸ªå‡½æ•°ç»„ä»¶ä¸­æœ‰è¿™æ ·ä¸€ä¸ªå‡½æ•°ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const dispense = candy =&gt; &#123;</span><br><span class=\"line\">  setCandies(allCandies =&gt; allCandies.filter(c =&gt; c !== candy))</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>é—®é¢˜ï¼šå¦‚æœç”¨ <code>useCallback</code> åŒ…è£¹ï¼Œé‚£ä¹ˆæ€§èƒ½ä¼šä¸ä¼šæ›´å¥½å‘¢ï¼Ÿ</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const dispense = React.useCallback(candy =&gt; &#123;</span><br><span class=\"line\">  setCandies(allCandies =&gt; allCandies.filter(c =&gt; c !== candy))</span><br><span class=\"line\">&#125;, [])</span><br></pre></td></tr></table></figure>\n<p>æˆ‘åˆšå¼€å§‹çš„ç­”æ¡ˆæ˜¯ä½¿ç”¨ <code>useCallback</code> ä¼šæ›´å¥½ï¼Œæ¯«æ— ç–‘é—®æ˜¯é”™çš„ã€‚ä¸Šé¢çš„å‡½æ•°ä¹Ÿå¯è¢«å†™æˆï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const dispense = candy =&gt; &#123;</span><br><span class=\"line\">    setCandies(allCandies =&gt; allCandies.filter(c =&gt; c !== candy))</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">+ const dispenseCallback = React.useCallback(dispense, [])</span><br></pre></td></tr></table></figure>\n<p>diff ä¹‹åä¼šå‘ç°åªæ˜¯å¤šäº†ä¸€è¡Œï¼Œè¯¥æœ‰çš„å£°æ˜è¿˜æ˜¯æœ‰ï¼Œè¿˜éœ€è¦åšæ›´å¤šçš„å·¥ä½œã€‚ç°åœ¨ä¸ä»…ä»…è¦å®šä¹‰å‡½æ•°ï¼Œè¿˜è¦å®šä¹‰ä¾èµ–æ•°ç»„ï¼Œè°ƒç”¨ <code>useCallback</code> è¿›è¡Œèµ‹å€¼åˆ†é…ç­‰å·¥ä½œã€‚ä¹‹å‰æˆ‘ä¸€ç›´è¯¯ä»¥ä¸ºï¼Œä½¿ç”¨ <code>useCallback</code> åï¼Œå‡½æ•°åªä¼šåœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶å®šä¹‰å¹¶èµ‹å€¼ï¼Œç¬¬äºŒæ¬¡æ¸²æŸ“ä¸ä¼šåšé¢å¤–çš„æ“ä½œã€‚å…¶å®ä¸æ˜¯çš„ï¼Œè¿™é‡Œçš„ç›¸ç­‰å¯ä»¥ç†è§£ä¸ºæ˜¯ â€œæŒ‡å‘çš„ä½ç½®â€ ç›¸ç­‰ï¼Œç±»ä¼¼ <code>ref</code> å’Œ <code>ref.current</code>ï¼Œé‡æ–°æ¸²æŸ“æ—¶å°±ç›¸å½“äºæ‰§è¡Œ <code>ref.current = newVal</code> ã€‚<br>\né‚£ä»€ä¹ˆæ—¶å€™éœ€è¦ç”¨åˆ° <code>useCallback</code> å‘¢ï¼Ÿå®˜æ–¹æ–‡æ¡£æ˜¯è¿™æ ·å†™çš„ï¼š</p>\n<blockquote>\n<p>This is useful when passing callbacks to optimized child components that rely on reference equality to prevent unnecessary renders (e.g. shouldComponentUpdate).</p>\n</blockquote>\n<p>æœ€ç®€å•ç²—æš´çš„ç»éªŒï¼Œæ˜¯å½“ä½ éœ€è¦å°†è¿™ä¸ªå‡½æ•°ä¼ é€’ç»™å­ç»„ä»¶æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ <code>useCallback</code> æ¥é¿å…å­ç»„ä»¶ä¸å¿…è¦çš„æ¸²æŸ“ï¼ˆå­ç»„ä»¶ä½¿ç”¨ <code>useMemo</code>ï¼‰ï¼›æ›´å‡†ç¡®çš„è¯´æ³•ï¼Œæ˜¯å½“ä½ éœ€è¦ä¾èµ–å¼•ç”¨ç›¸ç­‰æ€§æ—¶ï¼Œå°±åº”ä½¿ç”¨ <code>useCallback</code> ã€‚</p>\n<h4>2019/12/17</h4>\n<p>ä¿ç•™å››ä½æœ‰æ•ˆæ•°å­—ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">x.toPrecise(4) // return string</span><br></pre></td></tr></table></figure>\n<h4>2019/12/9</h4>\n<p>ä½¿ç”¨åŸç”Ÿæ–¹æ³•å®ç°æ–‡ä»¶ç‚¹å‡»/æ‹–æ‹½ä¸Šä¼ ï¼Œå¹¶é™åˆ¶åªèƒ½ä¸Šä¼ å•ä¸ª JSON æ–‡ä»¶ï¼š<br>\nä¸»è¦æ€æƒ³æ˜¯ç›‘å¬ <code>onClick</code> å’Œ <code>onDrop</code> äº‹ä»¶ï¼Œæ³¨æ„åœ¨ React ä¸­ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦æ³¨å†Œæ•è·é˜¶æ®µçš„äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œåˆ™åº”ä¸ºäº‹ä»¶åæ·»åŠ  <code>Capture</code>ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨å¤„ç†æ•è·é˜¶æ®µçš„ç‚¹å‡»äº‹ä»¶ <code>onClickCapture</code>ï¼Œè€Œä¸æ˜¯ <code>onClick</code>ã€‚è¯¦æƒ…å¯å‚è€ƒå®˜æ–¹æ–‡æ¡£ <a href=\"https://reactjs.org/docs/events.html#supported-events\" target=\"_blank\" rel=\"noopener\">Supported Events</a> ã€‚</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// upload.tsx</span><br><span class=\"line\">  ...</span><br><span class=\"line\">  const handleUploadClick = () =&gt; &#123;</span><br><span class=\"line\">    const input = document.createElement(&quot;input&quot;);</span><br><span class=\"line\">    input.type = &quot;file&quot;;</span><br><span class=\"line\">    input.accept = &quot;.json,application/json&quot;;</span><br><span class=\"line\">    input.onchange = ev =&gt; &#123;</span><br><span class=\"line\">      // double-checked</span><br><span class=\"line\">      if (</span><br><span class=\"line\">        input.files &amp;&amp;</span><br><span class=\"line\">        input.files.length === 1 &amp;&amp;</span><br><span class=\"line\">        input.files[0].type === &quot;application/json&quot;</span><br><span class=\"line\">      ) &#123;</span><br><span class=\"line\">        // deal with input.files</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    input.click();</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">  const handleUploadDrop = (ev:       React.DragEvent&lt;HTMLDivElement&gt;) =&gt; &#123;</span><br><span class=\"line\">    if (ev.dataTransfer.files.length &gt; 1) &#123;</span><br><span class=\"line\">      console.error(&quot;åªå…è®¸ä¸Šä¼ å•ä¸ªæ–‡ä»¶&quot;);</span><br><span class=\"line\">    &#125; else if (ev.dataTransfer.files[0].type !== &quot;application/json&quot;) &#123;</span><br><span class=\"line\">      console.error(&quot;åªå…è®¸ä¸Šä¼ jsonæ–‡ä»¶&quot;);</span><br><span class=\"line\">    &#125; else &#123;</span><br><span class=\"line\">      // deal with ev.dataTransfer.files[0]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">  ...</span><br><span class=\"line\"></span><br><span class=\"line\">  render() &#123;</span><br><span class=\"line\">    return (</span><br><span class=\"line\">      &lt;div</span><br><span class=\"line\">        onClickCapture=&#123;ev =&gt; &#123;</span><br><span class=\"line\">          ev.preventDefault();</span><br><span class=\"line\">          ev.stopPropagation();</span><br><span class=\"line\">          handleUploadClick();</span><br><span class=\"line\">        &#125;&#125;</span><br><span class=\"line\">        onDropCapture=&#123;ev =&gt; &#123;</span><br><span class=\"line\">          ev.preventDefault();</span><br><span class=\"line\">          ev.stopPropagation();</span><br><span class=\"line\">          handleUploadDrop(ev);</span><br><span class=\"line\">        &#125;&#125;</span><br><span class=\"line\">      &gt;</span><br><span class=\"line\">        Click or drag file to this area to upload</span><br><span class=\"line\">      &lt;/div&gt;</span><br><span class=\"line\">    )</span><br><span class=\"line\">  &#125;</span><br></pre></td></tr></table></figure>\n"},{"title":"React å®˜æ–¹æ–‡æ¡£é˜…è¯»ç¬”è®°","catalog":true,"date":"2020-02-05T06:52:05.000Z","subtitle":null,"header-img":null,"_content":"\n## ADVANCED GUIDES\n### Accessibility\n[link](https://reactjs.org/docs/accessibility.html)\n1. è¡¨å•æ§ä»¶å¦‚ `<input/>` ã€ `<textarea/>` ç­‰ï¼Œé€šå¸¸éœ€è¦ `<label/>` æ ‡ç­¾æé«˜å¯è®¿é—®æ€§ã€‚åœ¨ react ä¸­ï¼Œå±æ€§ `for` è¢«æ›¿ä»£ä¸º `htmlFor` ï¼š\n```\n<label htmlFor=\"namedInput\">Name:</label>\n<input id=\"namedInput\" type=\"text\" name=\"name\"/>\n```\n\n2. èšç„¦ input ç»„ä»¶çš„æ–¹æ³•ï¼šref ä¹Ÿå¯ä»¥åœ¨çˆ¶ç»„ä»¶åˆ›å»ºï¼Œé€šè¿‡ props è½¬å‘ç»™å­ç»„ä»¶ã€‚\n```\nclass CustomTextInput extends React.Component {\n  constructor(props) {\n    super(props);\n    // Create a ref to store the textInput DOM element\n    this.textInput = React.createRef();\n  }\n  render() {\n  // Use the `ref` callback to store a reference to the text input DOM\n  // element in an instance field (for example, this.textInput).\n    return (\n      <input\n        type=\"text\"\n        ref={this.textInput}\n      />\n    );\n  }\n}\n\n// focus it elsewhere in our component when needed:\nfocus() {\n  // Explicitly focus the text input using the raw DOM API\n  // Note: we're accessing \"current\" to get the DOM node\n  this.textInput.current.focus();\n}\n```\n3. HTMLELement ä¸Šæœ‰ `onBlur` åŠ `onFocus` ä¸¤ä¸ªå±æ€§ï¼Œå¯ç”¨äºåˆ¤æ–­å½“å‰å…ƒç´ æ˜¯å¦è·å¾—ç„¦ç‚¹ã€‚å®é™…åº”ç”¨ä¸­ï¼Œå¯ä»¥ç”¨äºæ§åˆ¶ popover çš„æ˜¾ç¤ºï¼šå½“ç¦»å¼€æŸå…ƒç´ æ—¶ï¼Œ éšè— popover ã€‚\n\n### Code-Splitting\n[link](https://reactjs.org/docs/code-splitting.html)\n1. **Dynamic import**\n```\n// before\nimport { add } from './math';\nconsole.log(add(16, 26));\n\n// after\nimport(\"./math\").then(math => {\n  console.log(math.add(16, 26));\n});\n```\n2. **React.lazy**\nå¯ä»¥å°†åŠ¨æ€å¯¼å…¥å˜æˆä¸€ä¸ªç»„ä»¶ï¼Œè¿”å›å€¼å¿…é¡»åŒ…è£¹åœ¨ `<Suspense></Suspense>` å†…éƒ¨ï¼ˆå¯åŒ…è£¹å¤šä¸ª lazy compomentsï¼‰ï¼š\n```\n// before\nimport OtherComponent from './OtherComponent';\n\n// after\nconst OtherComponent = React.lazy(() => import('./OtherComponent'));\n\nfunction MyComponent() {\n  return (\n    <div>\n      <Suspense fallback={<div>Loading...</div>}>\n        <OtherComponent />\n      </Suspense>\n    </div>\n  );\n}\n```\n3. **Error boundaries**\nä¹‹åæœ‰ä¸“é—¨çš„ç« èŠ‚ä»‹ç»è¿™éƒ¨åˆ†ã€‚\n4. **Route-based code splitting**\nåŸºäºè·¯ç”±çš„åŠ¨æ€å¼•å…¥ï¼Œä¸ React Router é…åˆä½¿ç”¨ï¼š\n```\nimport { BrowserRouter as Router, Route, Switch } from 'react-router-dom';\nimport React, { Suspense, lazy } from 'react';\n\nconst Home = lazy(() => import('./routes/Home'));\nconst About = lazy(() => import('./routes/About'));\n\nconst App = () => (\n  <Router>\n    <Suspense fallback={<div>Loading...</div>}>\n      <Switch>\n        <Route exact path=\"/\" component={Home}/>\n        <Route path=\"/about\" component={About}/>\n      </Switch>\n    </Suspense>\n  </Router>\n);\n```\n5. **Named Exports**\nè‹¥éœ€è¦åŠ¨æ€å¯¼å…¥çš„æ¨¡å—ä¸æ˜¯é»˜è®¤å¯¼å‡ºï¼Œé‚£æˆ‘ä»¬å¯ä»¥åˆ›å»ºå¤šä¸€ä¸ªæ–‡ä»¶ï¼Œå°†éœ€è¦å¯¼å…¥çš„æ¨¡å—è½¬ä¸ºé»˜è®¤å¯¼å‡ºï¼š\n```\n// ManyComponents.js\nexport const MyComponent = /* ... */;\nexport const MyUnusedComponent = /* ... */;\n\n// MyComponent.js\nexport { MyComponent as default } from \"./ManyComponents.js\";\n\n// MyApp.js\nimport React, { lazy } from 'react';\nconst MyComponent = lazy(() => import(\"./MyComponent.js\"));\n```\n\n### Context\n[link](https://reactjs.org/docs/context.html)\nä¸Šä¸‹æ–‡æä¾›äº†ä¸€ç§é€šè¿‡ç»„ä»¶æ ‘ä¼ é€’æ•°æ®çš„æ–¹æ³•ï¼Œè€Œä¸å¿…é€å±‚ä¼ é€’ props ã€‚\n1. åœ¨ç±»ä¸­ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š\n```\n// Context lets us pass a value deep into the component tree\n// without explicitly threading it through every component.\n// Create a context for the current theme (with \"light\" as the default).\nconst ThemeContext = React.createContext('light');\n\nclass App extends React.Component {\n  render() {\n    // Use a Provider to pass the current theme to the tree below.\n    // Any component can read it, no matter how deep it is.\n    // In this example, we're passing \"dark\" as the current value.\n    return (\n      <ThemeContext.Provider value=\"dark\">\n        <Toolbar />\n      </ThemeContext.Provider>\n    );\n  }\n}\n\n// A component in the middle doesn't have to\n// pass the theme down explicitly anymore.\nfunction Toolbar(props) {\n  return (\n    <div>\n      <ThemedButton />\n    </div>\n  );\n}\n\nclass ThemedButton extends React.Component {\n  // Assign a contextType to read the current theme context.\n  // React will find the closest theme Provider above and use its value.\n  // In this example, the current theme is \"dark\".\n  static contextType = ThemeContext;\n  render() {\n    return <Button theme={this.context} />;\n  }\n}\n```\n2. **API**\n(1) React.creatContext : `const MyContext = React.createContext(defaultValue);`\né»˜è®¤å€¼åªä¼šåœ¨æœªæ‰¾åˆ° `Provider` çš„æ—¶å€™ä½¿ç”¨ã€‚\n(2) Context.Provider : `<MyContext.Provider value={/* some value */}>`\nå½“ `Provider` ä¿®æ”¹äº† value å€¼æ—¶ï¼Œæ‰€æœ‰æ¶ˆè´¹è€…å­å­™éƒ½ä¼šé‡æ–°æ¸²æŸ“ã€‚å­ç»„ä»¶çš„ `shouldComponentUpdate` æ— æ³•æ•è·åˆ°è¿™ç§æ›´æ–°ï¼Œå› æ­¤å³ä½¿çˆ¶ç»„ä»¶å–æ¶ˆæ›´æ–°ï¼Œå­ç»„ä»¶ä¹Ÿä¼šç…§å¸¸æ›´æ–°ã€‚\n(3) Class.contentType : åœ¨ç±»å¤– `ClassName.contentType = MyContent`ï¼Œåœ¨ç±»ä¸­ `static contextType = MyContext;`\nç±»ä¸­æœ‰ `contentType` å±æ€§ï¼Œ context èµ‹å€¼ç»™è¿™ä¸ªå±æ€§ï¼ˆè®¢é˜…ï¼‰ï¼Œé€šè¿‡ `this.content` å–åˆ°å€¼ã€‚\n(4) Context.Consumer : `<MyContext.Consumer>{alue => /* render something based on the context value */}</MyContext.Consumer>`\n(5) Context.displayName : `MyContext.displayName = 'MyDisplayName';`\nç”¨äº React DevTools ã€‚\n3. **ä»åµŒå¥—ç»„ä»¶æ›´æ–° context**\nåˆå§‹å€¼é™¤äº†åŒ…å«é»˜è®¤å€¼ï¼Œè¿˜å¯ä»¥åŒ…å«ä¸€ä¸ª `onChange` å‡½æ•°ã€‚\n```\n// Make sure the shape of the default value passed to\n// createContext matches the shape that the consumers expect!\nexport const ThemeContext = React.createContext({\n  theme: themes.dark,\n  toggleTheme: () => {},\n});\n```\n\n### Error Boundaries\n[link](https://reactjs.org/docs/error-boundaries.html)\né”™è¯¯è¾¹ç•Œæ˜¯ React 16 å¼•å…¥çš„æ–°æ¦‚å¿µï¼Œå¯ä»¥åœ¨ render è¿‡ç¨‹ã€ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€ä»¥åŠç»„ä»¶æ ‘çš„æ„é€ ä¸­æ•è·**å­ç»„ä»¶**çš„é”™è¯¯ï¼Œæ˜¾ç¤ºå¤‡ç”¨çš„ UI è€Œä¸æ˜¯å´©æºƒç•Œé¢ã€‚æ³¨æ„ï¼Œå®ƒæ— æ³•æ•è·äº‹ä»¶å¤„ç†ã€å¼‚æ­¥ä»£ç ã€æœåŠ¡ç«¯æ¸²æŸ“åŠå®ƒæœ¬èº«çš„é”™è¯¯ã€‚\nå°†ä¸€ä¸ªç±»ç»„ä»¶è½¬æ¢ä¸ºä¸€ä¸ªé”™è¯¯è¾¹ç•Œç»„ä»¶ä¸»è¦æ˜¯å®ç°ä¸¤ä¸ªæ–¹æ³•ï¼šåœ¨ `static getDerivedStateFromError()` ä¸­æ•è·å­ç»„ä»¶é”™è¯¯å¹¶è§¦å‘å¤‡ç”¨ UI çš„æ¸²æŸ“ï¼›åœ¨ `componentDidCatch()` ä¸­æ‰“å°é”™è¯¯ä¿¡æ¯ã€‚\n```\nclass ErrorBoundary extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { hasError: false };\n  }\n\n  static getDerivedStateFromError(error) {\n    // Update state so the next render will show the fallback UI.\n    return { hasError: true };\n  }\n\n  componentDidCatch(error, errorInfo) {\n    // You can also log the error to an error reporting service\n    logErrorToMyService(error, errorInfo);\n  }\n\n  render() {\n    if (this.state.hasError) {\n      // You can render any custom fallback UI\n      return <h1>Something went wrong.</h1>;\n    }\n\n    return this.props.children; \n  }\n}\n\n// use it as a regular component\n<ErrorBoundary>\n  <MyWidget />\n</ErrorBoundary>\n```\n\n### Forwarding Refs\n[link](https://reactjs.org/docs/forwarding-refs.html)\nReact æä¾›äº†ä¸€ä¸ªå‘ä¸‹è½¬å‘å­ç»„ä»¶ ref çš„æ–¹æ³• `React.forwardRef`ï¼Œç”¨æ³•å¦‚ä¸‹ï¼š\n```\nconst FancyButton = React.forwardRef((props, ref) => (\n  <button ref={ref} className=\"FancyButton\">\n    {props.children}\n  </button>\n));\n\n// You can now get a ref directly to the DOM button:\nconst ref = React.createRef();\n<FancyButton ref={ref}>Click me!</FancyButton>;\n```\n`React.forwardRef` æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ props ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ ref ï¼Œä½œä¸ºå­ç»„ä»¶å¼•ç”¨çš„èµ‹å€¼å¯¹è±¡ã€‚å¦‚æœæ˜¯æ™®é€šçš„ç±»ç»„ä»¶å’Œå‡½æ•°ç»„ä»¶ï¼Œä¸ä¼šæ¥å— ref ä½œä¸ºå‚æ•°ï¼Œä¹Ÿä¸èƒ½åœ¨ props ä¸­è®¿é—®åˆ°ã€‚\næ–‡æ¡£æ¥ä¸‹æ¥è¿˜ä¸¾äº†ä¸€ä¸ªåœ¨é«˜é˜¶ç»„ä»¶ä¸­è½¬å‘ ref çš„ä¾‹å­ï¼Œç›®å‰è¿˜æ²¡å®Œå…¨çœ‹æ‡‚ã€‚ğŸ§\n\n### Fragments\n[link](https://reactjs.org/docs/fragments.html)\nå½“æˆ‘ä»¬éœ€è¦å¯¹ä¸€ç»„å­å…ƒç´ è¿›è¡Œåˆ†ç»„ï¼Œåˆä¸å¸Œæœ›æ·»åŠ é¢å¤–çš„ DOM èŠ‚ç‚¹æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ fragments ï¼Œæœ‰ä¸¤ç§å†™æ³•ï¼š`<></>` å’Œ `<React.Fragment></React.Fragment>` ï¼Œç¬¬äºŒç§å†™æ³•å¯ä»¥æ·»åŠ  `key` å±æ€§ã€‚\n```\nrender() {\n  return (\n    <React.Fragment>\n      <ChildA />\n      <ChildB />\n      <ChildC />\n    </React.Fragment>\n  );\n}\n\n// or\nrender() {\n  return (\n    <>\n      <ChildA />\n      <ChildB />\n      <ChildC />\n    </>\n  );\n}\n```\n\n### Higher-Order Components\n[link](https://reactjs.org/docs/higher-order-components.html)\nå®šä¹‰ï¼šé«˜é˜¶ç»„ä»¶æ˜¯ä¸€ä¸ªæ¥å—ç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œè¿”å›æ–°ç»„ä»¶çš„å‡½æ•°ã€‚\n```\nconst EnhancedComponent = higherOrderComponent(WrappedComponent);\n```\næ—¢ç„¶æ˜¯å‡½æ•°ç»„ä»¶ï¼Œé‚£å°±åº”è¯¥æ˜¯ pure fuction ï¼Œä¸”ä¸èƒ½æœ‰ä»»ä½•çš„å‰¯ä½œç”¨ã€‚å®ƒæ˜¯é€šè¿‡å°†åŸå§‹ç»„ä»¶åŒ…è£¹åœ¨ä¸€ä¸ªæ–°çš„ç±»ç»„ä»¶ï¼Œå¹¶è¿”å›è¿™ä¸ªç±»ç»„ä»¶æ¥å®ç°åŠŸèƒ½çš„ï¼š\n```\n// This function takes a component...\nfunction withSubscription(WrappedComponent, selectData) {\n  // ...and returns another component...\n  return class extends React.Component {\n    constructor(props) {\n      super(props);\n      this.handleChange = this.handleChange.bind(this);\n      this.state = {\n        data: selectData(DataSource, props)\n      };\n    }\n\n    componentDidMount() {\n      // ... that takes care of the subscription...\n      DataSource.addChangeListener(this.handleChange);\n    }\n\n    componentWillUnmount() {\n      DataSource.removeChangeListener(this.handleChange);\n    }\n\n    handleChange() {\n      this.setState({\n        data: selectData(DataSource, this.props)\n      });\n    }\n\n    render() {\n      // ... and renders the wrapped component with the fresh data!\n      // Notice that we pass through any additional props\n      return <WrappedComponent data={this.state.data} {...this.props} />;\n    }\n  };\n}\n```\næ³¨æ„åŒºåˆ† HOCs å’Œ container components ã€‚HOCs ä½¿ç”¨äº† å®¹å™¨ç»„ä»¶ä½œä¸ºå…¶å®ç°çš„ä¸€éƒ¨åˆ†ã€‚\næ­¤å¤–ï¼Œæ³¨æ„ä¸èƒ½åœ¨ render å‡½æ•°ä¸­ä½¿ç”¨ HOCs ï¼Œå¦åˆ™ä¼šå¯¼è‡´æ¯æ¬¡ render æ—¶æ•´ä¸ªå­ç»„ä»¶ç†Ÿ4éƒ½ä¼šå¸è½½å†è£…è½½ï¼Œä¸¢å¤±çŠ¶æ€ã€‚\n```\nrender() {\n  // A new version of EnhancedComponent is created on every render\n  // EnhancedComponent1 !== EnhancedComponent2\n  const EnhancedComponent = enhance(MyComponent);\n  // That causes the entire subtree to unmount/remount each time!\n  return <EnhancedComponent />;\n}\n```\n\n### JSX In Depth\n[link](https://reactjs.org/docs/jsx-in-depth.html)\nJSX æ˜¯ `React.createElement(component, props, ...children)` çš„è¯­æ³•ç³–ï¼Œç¼–è¯‘ç¤ºä¾‹å¦‚ä¸‹ï¼š\n```\n<MyButton color=\"blue\" shadowSize={2}>\n  Click Me\n</MyButton>\n\n// compiles into:\nReact.createElement(\n  MyButton,\n  {color: 'blue', shadowSize: 2},\n  'Click Me'\n)\n```\nè‹¥æ˜¯ self-closing tag å¦‚ `<div/>` ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ `null` ã€‚æ³¨æ„ç»„ä»¶çš„é¦–å­—æ¯ä¸€å®šè¦å¤§å†™ï¼Œå¦åˆ™ä¼šè¢«å½“æˆæ™®é€šçš„å†…ç½®ç»„ä»¶ã€‚\nå¯ä»¥åœ¨ JSX ä¸­ä½¿ç”¨ç‚¹è¿ç®—ç¬¦å¼•ç”¨ React ç»„ä»¶ï¼š\n```\nimport React from 'react';\n\nconst MyComponents = {\n  DatePicker: function DatePicker(props) {\n    return <div>Imagine a {props.color} datepicker here.</div>;\n  }\n}\n\n// use dot-notation\nfunction BlueDatePicker() {\n  return <MyComponents.DatePicker color=\"blue\" />;\n}\n```\nä½†æ™®é€šçš„è¡¨è¾¾å¼ä¸èƒ½æŒ‡ç¤º React å…ƒç´ ç±»å‹ï¼Œå¦‚æœæƒ³è¦åŠ¨æ€æ˜¾ç¤ºç»„ä»¶ï¼Œéœ€è¦å…ˆèµ‹å€¼ç»™ä¸€ä¸ªå¤§å†™å­—æ¯å¼€å¤´çš„å˜é‡ï¼š\n```\nimport React from 'react';\nimport { PhotoStory, VideoStory } from './stories';\n\nconst components = {\n  photo: PhotoStory,\n  video: VideoStory\n};\n\nfunction Story(props) {\n  // you can't write `return <components[props.storyType] story={props.story} />;`\n  // Correct! JSX type can be a capitalized variable.\n  const SpecificStory = components[props.storyType];\n  return <SpecificStory story={props.story} />;\n}\n```\nåœ¨åŒæ—¶åŒ…å«å¼€å§‹æ ‡ç­¾å’Œç»“æŸæ ‡ç­¾çš„JSXè¡¨è¾¾å¼ä¸­ï¼Œtag ä¹‹é—´çš„å†…å®¹ä½œä¸ºç‰¹æ®Šçš„ propsï¼š`props.children` ä¼ é€’ã€‚\nå¸ƒå°”å€¼ã€null å’Œ undefined ä¼šè¢« React å¿½ç•¥ï¼Œä¸‹è¿°è¡¨è¾¾å¼æ¸²æŸ“ç»“æœç›¸åŒï¼š\n```\n<div />\n<div></div>\n<div>{false}</div>\n<div>{null}</div>\n<div>{undefined}</div>\n<div>{true}</div>\n```","source":"_posts/React-å®˜æ–¹æ–‡æ¡£é˜…è¯»ç¬”è®°.md","raw":"---\ntitle: React å®˜æ–¹æ–‡æ¡£é˜…è¯»ç¬”è®°\ncatalog: true\ndate: 2020-02-05 14:52:05\nsubtitle:\nheader-img:\ntags: FE \n---\n\n## ADVANCED GUIDES\n### Accessibility\n[link](https://reactjs.org/docs/accessibility.html)\n1. è¡¨å•æ§ä»¶å¦‚ `<input/>` ã€ `<textarea/>` ç­‰ï¼Œé€šå¸¸éœ€è¦ `<label/>` æ ‡ç­¾æé«˜å¯è®¿é—®æ€§ã€‚åœ¨ react ä¸­ï¼Œå±æ€§ `for` è¢«æ›¿ä»£ä¸º `htmlFor` ï¼š\n```\n<label htmlFor=\"namedInput\">Name:</label>\n<input id=\"namedInput\" type=\"text\" name=\"name\"/>\n```\n\n2. èšç„¦ input ç»„ä»¶çš„æ–¹æ³•ï¼šref ä¹Ÿå¯ä»¥åœ¨çˆ¶ç»„ä»¶åˆ›å»ºï¼Œé€šè¿‡ props è½¬å‘ç»™å­ç»„ä»¶ã€‚\n```\nclass CustomTextInput extends React.Component {\n  constructor(props) {\n    super(props);\n    // Create a ref to store the textInput DOM element\n    this.textInput = React.createRef();\n  }\n  render() {\n  // Use the `ref` callback to store a reference to the text input DOM\n  // element in an instance field (for example, this.textInput).\n    return (\n      <input\n        type=\"text\"\n        ref={this.textInput}\n      />\n    );\n  }\n}\n\n// focus it elsewhere in our component when needed:\nfocus() {\n  // Explicitly focus the text input using the raw DOM API\n  // Note: we're accessing \"current\" to get the DOM node\n  this.textInput.current.focus();\n}\n```\n3. HTMLELement ä¸Šæœ‰ `onBlur` åŠ `onFocus` ä¸¤ä¸ªå±æ€§ï¼Œå¯ç”¨äºåˆ¤æ–­å½“å‰å…ƒç´ æ˜¯å¦è·å¾—ç„¦ç‚¹ã€‚å®é™…åº”ç”¨ä¸­ï¼Œå¯ä»¥ç”¨äºæ§åˆ¶ popover çš„æ˜¾ç¤ºï¼šå½“ç¦»å¼€æŸå…ƒç´ æ—¶ï¼Œ éšè— popover ã€‚\n\n### Code-Splitting\n[link](https://reactjs.org/docs/code-splitting.html)\n1. **Dynamic import**\n```\n// before\nimport { add } from './math';\nconsole.log(add(16, 26));\n\n// after\nimport(\"./math\").then(math => {\n  console.log(math.add(16, 26));\n});\n```\n2. **React.lazy**\nå¯ä»¥å°†åŠ¨æ€å¯¼å…¥å˜æˆä¸€ä¸ªç»„ä»¶ï¼Œè¿”å›å€¼å¿…é¡»åŒ…è£¹åœ¨ `<Suspense></Suspense>` å†…éƒ¨ï¼ˆå¯åŒ…è£¹å¤šä¸ª lazy compomentsï¼‰ï¼š\n```\n// before\nimport OtherComponent from './OtherComponent';\n\n// after\nconst OtherComponent = React.lazy(() => import('./OtherComponent'));\n\nfunction MyComponent() {\n  return (\n    <div>\n      <Suspense fallback={<div>Loading...</div>}>\n        <OtherComponent />\n      </Suspense>\n    </div>\n  );\n}\n```\n3. **Error boundaries**\nä¹‹åæœ‰ä¸“é—¨çš„ç« èŠ‚ä»‹ç»è¿™éƒ¨åˆ†ã€‚\n4. **Route-based code splitting**\nåŸºäºè·¯ç”±çš„åŠ¨æ€å¼•å…¥ï¼Œä¸ React Router é…åˆä½¿ç”¨ï¼š\n```\nimport { BrowserRouter as Router, Route, Switch } from 'react-router-dom';\nimport React, { Suspense, lazy } from 'react';\n\nconst Home = lazy(() => import('./routes/Home'));\nconst About = lazy(() => import('./routes/About'));\n\nconst App = () => (\n  <Router>\n    <Suspense fallback={<div>Loading...</div>}>\n      <Switch>\n        <Route exact path=\"/\" component={Home}/>\n        <Route path=\"/about\" component={About}/>\n      </Switch>\n    </Suspense>\n  </Router>\n);\n```\n5. **Named Exports**\nè‹¥éœ€è¦åŠ¨æ€å¯¼å…¥çš„æ¨¡å—ä¸æ˜¯é»˜è®¤å¯¼å‡ºï¼Œé‚£æˆ‘ä»¬å¯ä»¥åˆ›å»ºå¤šä¸€ä¸ªæ–‡ä»¶ï¼Œå°†éœ€è¦å¯¼å…¥çš„æ¨¡å—è½¬ä¸ºé»˜è®¤å¯¼å‡ºï¼š\n```\n// ManyComponents.js\nexport const MyComponent = /* ... */;\nexport const MyUnusedComponent = /* ... */;\n\n// MyComponent.js\nexport { MyComponent as default } from \"./ManyComponents.js\";\n\n// MyApp.js\nimport React, { lazy } from 'react';\nconst MyComponent = lazy(() => import(\"./MyComponent.js\"));\n```\n\n### Context\n[link](https://reactjs.org/docs/context.html)\nä¸Šä¸‹æ–‡æä¾›äº†ä¸€ç§é€šè¿‡ç»„ä»¶æ ‘ä¼ é€’æ•°æ®çš„æ–¹æ³•ï¼Œè€Œä¸å¿…é€å±‚ä¼ é€’ props ã€‚\n1. åœ¨ç±»ä¸­ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š\n```\n// Context lets us pass a value deep into the component tree\n// without explicitly threading it through every component.\n// Create a context for the current theme (with \"light\" as the default).\nconst ThemeContext = React.createContext('light');\n\nclass App extends React.Component {\n  render() {\n    // Use a Provider to pass the current theme to the tree below.\n    // Any component can read it, no matter how deep it is.\n    // In this example, we're passing \"dark\" as the current value.\n    return (\n      <ThemeContext.Provider value=\"dark\">\n        <Toolbar />\n      </ThemeContext.Provider>\n    );\n  }\n}\n\n// A component in the middle doesn't have to\n// pass the theme down explicitly anymore.\nfunction Toolbar(props) {\n  return (\n    <div>\n      <ThemedButton />\n    </div>\n  );\n}\n\nclass ThemedButton extends React.Component {\n  // Assign a contextType to read the current theme context.\n  // React will find the closest theme Provider above and use its value.\n  // In this example, the current theme is \"dark\".\n  static contextType = ThemeContext;\n  render() {\n    return <Button theme={this.context} />;\n  }\n}\n```\n2. **API**\n(1) React.creatContext : `const MyContext = React.createContext(defaultValue);`\né»˜è®¤å€¼åªä¼šåœ¨æœªæ‰¾åˆ° `Provider` çš„æ—¶å€™ä½¿ç”¨ã€‚\n(2) Context.Provider : `<MyContext.Provider value={/* some value */}>`\nå½“ `Provider` ä¿®æ”¹äº† value å€¼æ—¶ï¼Œæ‰€æœ‰æ¶ˆè´¹è€…å­å­™éƒ½ä¼šé‡æ–°æ¸²æŸ“ã€‚å­ç»„ä»¶çš„ `shouldComponentUpdate` æ— æ³•æ•è·åˆ°è¿™ç§æ›´æ–°ï¼Œå› æ­¤å³ä½¿çˆ¶ç»„ä»¶å–æ¶ˆæ›´æ–°ï¼Œå­ç»„ä»¶ä¹Ÿä¼šç…§å¸¸æ›´æ–°ã€‚\n(3) Class.contentType : åœ¨ç±»å¤– `ClassName.contentType = MyContent`ï¼Œåœ¨ç±»ä¸­ `static contextType = MyContext;`\nç±»ä¸­æœ‰ `contentType` å±æ€§ï¼Œ context èµ‹å€¼ç»™è¿™ä¸ªå±æ€§ï¼ˆè®¢é˜…ï¼‰ï¼Œé€šè¿‡ `this.content` å–åˆ°å€¼ã€‚\n(4) Context.Consumer : `<MyContext.Consumer>{alue => /* render something based on the context value */}</MyContext.Consumer>`\n(5) Context.displayName : `MyContext.displayName = 'MyDisplayName';`\nç”¨äº React DevTools ã€‚\n3. **ä»åµŒå¥—ç»„ä»¶æ›´æ–° context**\nåˆå§‹å€¼é™¤äº†åŒ…å«é»˜è®¤å€¼ï¼Œè¿˜å¯ä»¥åŒ…å«ä¸€ä¸ª `onChange` å‡½æ•°ã€‚\n```\n// Make sure the shape of the default value passed to\n// createContext matches the shape that the consumers expect!\nexport const ThemeContext = React.createContext({\n  theme: themes.dark,\n  toggleTheme: () => {},\n});\n```\n\n### Error Boundaries\n[link](https://reactjs.org/docs/error-boundaries.html)\né”™è¯¯è¾¹ç•Œæ˜¯ React 16 å¼•å…¥çš„æ–°æ¦‚å¿µï¼Œå¯ä»¥åœ¨ render è¿‡ç¨‹ã€ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€ä»¥åŠç»„ä»¶æ ‘çš„æ„é€ ä¸­æ•è·**å­ç»„ä»¶**çš„é”™è¯¯ï¼Œæ˜¾ç¤ºå¤‡ç”¨çš„ UI è€Œä¸æ˜¯å´©æºƒç•Œé¢ã€‚æ³¨æ„ï¼Œå®ƒæ— æ³•æ•è·äº‹ä»¶å¤„ç†ã€å¼‚æ­¥ä»£ç ã€æœåŠ¡ç«¯æ¸²æŸ“åŠå®ƒæœ¬èº«çš„é”™è¯¯ã€‚\nå°†ä¸€ä¸ªç±»ç»„ä»¶è½¬æ¢ä¸ºä¸€ä¸ªé”™è¯¯è¾¹ç•Œç»„ä»¶ä¸»è¦æ˜¯å®ç°ä¸¤ä¸ªæ–¹æ³•ï¼šåœ¨ `static getDerivedStateFromError()` ä¸­æ•è·å­ç»„ä»¶é”™è¯¯å¹¶è§¦å‘å¤‡ç”¨ UI çš„æ¸²æŸ“ï¼›åœ¨ `componentDidCatch()` ä¸­æ‰“å°é”™è¯¯ä¿¡æ¯ã€‚\n```\nclass ErrorBoundary extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { hasError: false };\n  }\n\n  static getDerivedStateFromError(error) {\n    // Update state so the next render will show the fallback UI.\n    return { hasError: true };\n  }\n\n  componentDidCatch(error, errorInfo) {\n    // You can also log the error to an error reporting service\n    logErrorToMyService(error, errorInfo);\n  }\n\n  render() {\n    if (this.state.hasError) {\n      // You can render any custom fallback UI\n      return <h1>Something went wrong.</h1>;\n    }\n\n    return this.props.children; \n  }\n}\n\n// use it as a regular component\n<ErrorBoundary>\n  <MyWidget />\n</ErrorBoundary>\n```\n\n### Forwarding Refs\n[link](https://reactjs.org/docs/forwarding-refs.html)\nReact æä¾›äº†ä¸€ä¸ªå‘ä¸‹è½¬å‘å­ç»„ä»¶ ref çš„æ–¹æ³• `React.forwardRef`ï¼Œç”¨æ³•å¦‚ä¸‹ï¼š\n```\nconst FancyButton = React.forwardRef((props, ref) => (\n  <button ref={ref} className=\"FancyButton\">\n    {props.children}\n  </button>\n));\n\n// You can now get a ref directly to the DOM button:\nconst ref = React.createRef();\n<FancyButton ref={ref}>Click me!</FancyButton>;\n```\n`React.forwardRef` æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ props ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ ref ï¼Œä½œä¸ºå­ç»„ä»¶å¼•ç”¨çš„èµ‹å€¼å¯¹è±¡ã€‚å¦‚æœæ˜¯æ™®é€šçš„ç±»ç»„ä»¶å’Œå‡½æ•°ç»„ä»¶ï¼Œä¸ä¼šæ¥å— ref ä½œä¸ºå‚æ•°ï¼Œä¹Ÿä¸èƒ½åœ¨ props ä¸­è®¿é—®åˆ°ã€‚\næ–‡æ¡£æ¥ä¸‹æ¥è¿˜ä¸¾äº†ä¸€ä¸ªåœ¨é«˜é˜¶ç»„ä»¶ä¸­è½¬å‘ ref çš„ä¾‹å­ï¼Œç›®å‰è¿˜æ²¡å®Œå…¨çœ‹æ‡‚ã€‚ğŸ§\n\n### Fragments\n[link](https://reactjs.org/docs/fragments.html)\nå½“æˆ‘ä»¬éœ€è¦å¯¹ä¸€ç»„å­å…ƒç´ è¿›è¡Œåˆ†ç»„ï¼Œåˆä¸å¸Œæœ›æ·»åŠ é¢å¤–çš„ DOM èŠ‚ç‚¹æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ fragments ï¼Œæœ‰ä¸¤ç§å†™æ³•ï¼š`<></>` å’Œ `<React.Fragment></React.Fragment>` ï¼Œç¬¬äºŒç§å†™æ³•å¯ä»¥æ·»åŠ  `key` å±æ€§ã€‚\n```\nrender() {\n  return (\n    <React.Fragment>\n      <ChildA />\n      <ChildB />\n      <ChildC />\n    </React.Fragment>\n  );\n}\n\n// or\nrender() {\n  return (\n    <>\n      <ChildA />\n      <ChildB />\n      <ChildC />\n    </>\n  );\n}\n```\n\n### Higher-Order Components\n[link](https://reactjs.org/docs/higher-order-components.html)\nå®šä¹‰ï¼šé«˜é˜¶ç»„ä»¶æ˜¯ä¸€ä¸ªæ¥å—ç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œè¿”å›æ–°ç»„ä»¶çš„å‡½æ•°ã€‚\n```\nconst EnhancedComponent = higherOrderComponent(WrappedComponent);\n```\næ—¢ç„¶æ˜¯å‡½æ•°ç»„ä»¶ï¼Œé‚£å°±åº”è¯¥æ˜¯ pure fuction ï¼Œä¸”ä¸èƒ½æœ‰ä»»ä½•çš„å‰¯ä½œç”¨ã€‚å®ƒæ˜¯é€šè¿‡å°†åŸå§‹ç»„ä»¶åŒ…è£¹åœ¨ä¸€ä¸ªæ–°çš„ç±»ç»„ä»¶ï¼Œå¹¶è¿”å›è¿™ä¸ªç±»ç»„ä»¶æ¥å®ç°åŠŸèƒ½çš„ï¼š\n```\n// This function takes a component...\nfunction withSubscription(WrappedComponent, selectData) {\n  // ...and returns another component...\n  return class extends React.Component {\n    constructor(props) {\n      super(props);\n      this.handleChange = this.handleChange.bind(this);\n      this.state = {\n        data: selectData(DataSource, props)\n      };\n    }\n\n    componentDidMount() {\n      // ... that takes care of the subscription...\n      DataSource.addChangeListener(this.handleChange);\n    }\n\n    componentWillUnmount() {\n      DataSource.removeChangeListener(this.handleChange);\n    }\n\n    handleChange() {\n      this.setState({\n        data: selectData(DataSource, this.props)\n      });\n    }\n\n    render() {\n      // ... and renders the wrapped component with the fresh data!\n      // Notice that we pass through any additional props\n      return <WrappedComponent data={this.state.data} {...this.props} />;\n    }\n  };\n}\n```\næ³¨æ„åŒºåˆ† HOCs å’Œ container components ã€‚HOCs ä½¿ç”¨äº† å®¹å™¨ç»„ä»¶ä½œä¸ºå…¶å®ç°çš„ä¸€éƒ¨åˆ†ã€‚\næ­¤å¤–ï¼Œæ³¨æ„ä¸èƒ½åœ¨ render å‡½æ•°ä¸­ä½¿ç”¨ HOCs ï¼Œå¦åˆ™ä¼šå¯¼è‡´æ¯æ¬¡ render æ—¶æ•´ä¸ªå­ç»„ä»¶ç†Ÿ4éƒ½ä¼šå¸è½½å†è£…è½½ï¼Œä¸¢å¤±çŠ¶æ€ã€‚\n```\nrender() {\n  // A new version of EnhancedComponent is created on every render\n  // EnhancedComponent1 !== EnhancedComponent2\n  const EnhancedComponent = enhance(MyComponent);\n  // That causes the entire subtree to unmount/remount each time!\n  return <EnhancedComponent />;\n}\n```\n\n### JSX In Depth\n[link](https://reactjs.org/docs/jsx-in-depth.html)\nJSX æ˜¯ `React.createElement(component, props, ...children)` çš„è¯­æ³•ç³–ï¼Œç¼–è¯‘ç¤ºä¾‹å¦‚ä¸‹ï¼š\n```\n<MyButton color=\"blue\" shadowSize={2}>\n  Click Me\n</MyButton>\n\n// compiles into:\nReact.createElement(\n  MyButton,\n  {color: 'blue', shadowSize: 2},\n  'Click Me'\n)\n```\nè‹¥æ˜¯ self-closing tag å¦‚ `<div/>` ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ `null` ã€‚æ³¨æ„ç»„ä»¶çš„é¦–å­—æ¯ä¸€å®šè¦å¤§å†™ï¼Œå¦åˆ™ä¼šè¢«å½“æˆæ™®é€šçš„å†…ç½®ç»„ä»¶ã€‚\nå¯ä»¥åœ¨ JSX ä¸­ä½¿ç”¨ç‚¹è¿ç®—ç¬¦å¼•ç”¨ React ç»„ä»¶ï¼š\n```\nimport React from 'react';\n\nconst MyComponents = {\n  DatePicker: function DatePicker(props) {\n    return <div>Imagine a {props.color} datepicker here.</div>;\n  }\n}\n\n// use dot-notation\nfunction BlueDatePicker() {\n  return <MyComponents.DatePicker color=\"blue\" />;\n}\n```\nä½†æ™®é€šçš„è¡¨è¾¾å¼ä¸èƒ½æŒ‡ç¤º React å…ƒç´ ç±»å‹ï¼Œå¦‚æœæƒ³è¦åŠ¨æ€æ˜¾ç¤ºç»„ä»¶ï¼Œéœ€è¦å…ˆèµ‹å€¼ç»™ä¸€ä¸ªå¤§å†™å­—æ¯å¼€å¤´çš„å˜é‡ï¼š\n```\nimport React from 'react';\nimport { PhotoStory, VideoStory } from './stories';\n\nconst components = {\n  photo: PhotoStory,\n  video: VideoStory\n};\n\nfunction Story(props) {\n  // you can't write `return <components[props.storyType] story={props.story} />;`\n  // Correct! JSX type can be a capitalized variable.\n  const SpecificStory = components[props.storyType];\n  return <SpecificStory story={props.story} />;\n}\n```\nåœ¨åŒæ—¶åŒ…å«å¼€å§‹æ ‡ç­¾å’Œç»“æŸæ ‡ç­¾çš„JSXè¡¨è¾¾å¼ä¸­ï¼Œtag ä¹‹é—´çš„å†…å®¹ä½œä¸ºç‰¹æ®Šçš„ propsï¼š`props.children` ä¼ é€’ã€‚\nå¸ƒå°”å€¼ã€null å’Œ undefined ä¼šè¢« React å¿½ç•¥ï¼Œä¸‹è¿°è¡¨è¾¾å¼æ¸²æŸ“ç»“æœç›¸åŒï¼š\n```\n<div />\n<div></div>\n<div>{false}</div>\n<div>{null}</div>\n<div>{undefined}</div>\n<div>{true}</div>\n```","slug":"React-å®˜æ–¹æ–‡æ¡£é˜…è¯»ç¬”è®°","published":1,"updated":"2020-02-07T07:53:11.044Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck6vknheu0006osue2be75k6s","content":"<h2 id=\"advanced-guides\">ADVANCED GUIDES</h2>\n<h3 id=\"accessibility\">Accessibility</h3>\n<p><a href=\"https://reactjs.org/docs/accessibility.html\" target=\"_blank\" rel=\"noopener\">link</a></p>\n<ol>\n<li>è¡¨å•æ§ä»¶å¦‚ <code>&lt;input/&gt;</code> ã€ <code>&lt;textarea/&gt;</code> ç­‰ï¼Œé€šå¸¸éœ€è¦ <code>&lt;label/&gt;</code> æ ‡ç­¾æé«˜å¯è®¿é—®æ€§ã€‚åœ¨ react ä¸­ï¼Œå±æ€§ <code>for</code> è¢«æ›¿ä»£ä¸º <code>htmlFor</code> ï¼š</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;label htmlFor=&quot;namedInput&quot;&gt;Name:&lt;/label&gt;</span><br><span class=\"line\">&lt;input id=&quot;namedInput&quot; type=&quot;text&quot; name=&quot;name&quot;/&gt;</span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li>èšç„¦ input ç»„ä»¶çš„æ–¹æ³•ï¼šref ä¹Ÿå¯ä»¥åœ¨çˆ¶ç»„ä»¶åˆ›å»ºï¼Œé€šè¿‡ props è½¬å‘ç»™å­ç»„ä»¶ã€‚</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">class CustomTextInput extends React.Component &#123;</span><br><span class=\"line\">  constructor(props) &#123;</span><br><span class=\"line\">    super(props);</span><br><span class=\"line\">    // Create a ref to store the textInput DOM element</span><br><span class=\"line\">    this.textInput = React.createRef();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  render() &#123;</span><br><span class=\"line\">  // Use the `ref` callback to store a reference to the text input DOM</span><br><span class=\"line\">  // element in an instance field (for example, this.textInput).</span><br><span class=\"line\">    return (</span><br><span class=\"line\">      &lt;input</span><br><span class=\"line\">        type=&quot;text&quot;</span><br><span class=\"line\">        ref=&#123;this.textInput&#125;</span><br><span class=\"line\">      /&gt;</span><br><span class=\"line\">    );</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// focus it elsewhere in our component when needed:</span><br><span class=\"line\">focus() &#123;</span><br><span class=\"line\">  // Explicitly focus the text input using the raw DOM API</span><br><span class=\"line\">  // Note: we&apos;re accessing &quot;current&quot; to get the DOM node</span><br><span class=\"line\">  this.textInput.current.focus();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li>HTMLELement ä¸Šæœ‰ <code>onBlur</code> åŠ <code>onFocus</code> ä¸¤ä¸ªå±æ€§ï¼Œå¯ç”¨äºåˆ¤æ–­å½“å‰å…ƒç´ æ˜¯å¦è·å¾—ç„¦ç‚¹ã€‚å®é™…åº”ç”¨ä¸­ï¼Œå¯ä»¥ç”¨äºæ§åˆ¶ popover çš„æ˜¾ç¤ºï¼šå½“ç¦»å¼€æŸå…ƒç´ æ—¶ï¼Œ éšè— popover ã€‚</li>\n</ol>\n<h3 id=\"code-splitting\">Code-Splitting</h3>\n<p><a href=\"https://reactjs.org/docs/code-splitting.html\" target=\"_blank\" rel=\"noopener\">link</a></p>\n<ol>\n<li><strong>Dynamic import</strong></li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// before</span><br><span class=\"line\">import &#123; add &#125; from &apos;./math&apos;;</span><br><span class=\"line\">console.log(add(16, 26));</span><br><span class=\"line\"></span><br><span class=\"line\">// after</span><br><span class=\"line\">import(&quot;./math&quot;).then(math =&gt; &#123;</span><br><span class=\"line\">  console.log(math.add(16, 26));</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li><strong>React.lazy</strong><br>\nå¯ä»¥å°†åŠ¨æ€å¯¼å…¥å˜æˆä¸€ä¸ªç»„ä»¶ï¼Œè¿”å›å€¼å¿…é¡»åŒ…è£¹åœ¨ <code>&lt;Suspense&gt;&lt;/Suspense&gt;</code> å†…éƒ¨ï¼ˆå¯åŒ…è£¹å¤šä¸ª lazy compomentsï¼‰ï¼š</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// before</span><br><span class=\"line\">import OtherComponent from &apos;./OtherComponent&apos;;</span><br><span class=\"line\"></span><br><span class=\"line\">// after</span><br><span class=\"line\">const OtherComponent = React.lazy(() =&gt; import(&apos;./OtherComponent&apos;));</span><br><span class=\"line\"></span><br><span class=\"line\">function MyComponent() &#123;</span><br><span class=\"line\">  return (</span><br><span class=\"line\">    &lt;div&gt;</span><br><span class=\"line\">      &lt;Suspense fallback=&#123;&lt;div&gt;Loading...&lt;/div&gt;&#125;&gt;</span><br><span class=\"line\">        &lt;OtherComponent /&gt;</span><br><span class=\"line\">      &lt;/Suspense&gt;</span><br><span class=\"line\">    &lt;/div&gt;</span><br><span class=\"line\">  );</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li><strong>Error boundaries</strong><br>\nä¹‹åæœ‰ä¸“é—¨çš„ç« èŠ‚ä»‹ç»è¿™éƒ¨åˆ†ã€‚</li>\n<li><strong>Route-based code splitting</strong><br>\nåŸºäºè·¯ç”±çš„åŠ¨æ€å¼•å…¥ï¼Œä¸ React Router é…åˆä½¿ç”¨ï¼š</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import &#123; BrowserRouter as Router, Route, Switch &#125; from &apos;react-router-dom&apos;;</span><br><span class=\"line\">import React, &#123; Suspense, lazy &#125; from &apos;react&apos;;</span><br><span class=\"line\"></span><br><span class=\"line\">const Home = lazy(() =&gt; import(&apos;./routes/Home&apos;));</span><br><span class=\"line\">const About = lazy(() =&gt; import(&apos;./routes/About&apos;));</span><br><span class=\"line\"></span><br><span class=\"line\">const App = () =&gt; (</span><br><span class=\"line\">  &lt;Router&gt;</span><br><span class=\"line\">    &lt;Suspense fallback=&#123;&lt;div&gt;Loading...&lt;/div&gt;&#125;&gt;</span><br><span class=\"line\">      &lt;Switch&gt;</span><br><span class=\"line\">        &lt;Route exact path=&quot;/&quot; component=&#123;Home&#125;/&gt;</span><br><span class=\"line\">        &lt;Route path=&quot;/about&quot; component=&#123;About&#125;/&gt;</span><br><span class=\"line\">      &lt;/Switch&gt;</span><br><span class=\"line\">    &lt;/Suspense&gt;</span><br><span class=\"line\">  &lt;/Router&gt;</span><br><span class=\"line\">);</span><br></pre></td></tr></table></figure>\n<ol start=\"5\">\n<li><strong>Named Exports</strong><br>\nè‹¥éœ€è¦åŠ¨æ€å¯¼å…¥çš„æ¨¡å—ä¸æ˜¯é»˜è®¤å¯¼å‡ºï¼Œé‚£æˆ‘ä»¬å¯ä»¥åˆ›å»ºå¤šä¸€ä¸ªæ–‡ä»¶ï¼Œå°†éœ€è¦å¯¼å…¥çš„æ¨¡å—è½¬ä¸ºé»˜è®¤å¯¼å‡ºï¼š</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// ManyComponents.js</span><br><span class=\"line\">export const MyComponent = /* ... */;</span><br><span class=\"line\">export const MyUnusedComponent = /* ... */;</span><br><span class=\"line\"></span><br><span class=\"line\">// MyComponent.js</span><br><span class=\"line\">export &#123; MyComponent as default &#125; from &quot;./ManyComponents.js&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">// MyApp.js</span><br><span class=\"line\">import React, &#123; lazy &#125; from &apos;react&apos;;</span><br><span class=\"line\">const MyComponent = lazy(() =&gt; import(&quot;./MyComponent.js&quot;));</span><br></pre></td></tr></table></figure>\n<h3 id=\"context\">Context</h3>\n<p><a href=\"https://reactjs.org/docs/context.html\" target=\"_blank\" rel=\"noopener\">link</a><br>\nä¸Šä¸‹æ–‡æä¾›äº†ä¸€ç§é€šè¿‡ç»„ä»¶æ ‘ä¼ é€’æ•°æ®çš„æ–¹æ³•ï¼Œè€Œä¸å¿…é€å±‚ä¼ é€’ props ã€‚</p>\n<ol>\n<li>åœ¨ç±»ä¸­ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// Context lets us pass a value deep into the component tree</span><br><span class=\"line\">// without explicitly threading it through every component.</span><br><span class=\"line\">// Create a context for the current theme (with &quot;light&quot; as the default).</span><br><span class=\"line\">const ThemeContext = React.createContext(&apos;light&apos;);</span><br><span class=\"line\"></span><br><span class=\"line\">class App extends React.Component &#123;</span><br><span class=\"line\">  render() &#123;</span><br><span class=\"line\">    // Use a Provider to pass the current theme to the tree below.</span><br><span class=\"line\">    // Any component can read it, no matter how deep it is.</span><br><span class=\"line\">    // In this example, we&apos;re passing &quot;dark&quot; as the current value.</span><br><span class=\"line\">    return (</span><br><span class=\"line\">      &lt;ThemeContext.Provider value=&quot;dark&quot;&gt;</span><br><span class=\"line\">        &lt;Toolbar /&gt;</span><br><span class=\"line\">      &lt;/ThemeContext.Provider&gt;</span><br><span class=\"line\">    );</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// A component in the middle doesn&apos;t have to</span><br><span class=\"line\">// pass the theme down explicitly anymore.</span><br><span class=\"line\">function Toolbar(props) &#123;</span><br><span class=\"line\">  return (</span><br><span class=\"line\">    &lt;div&gt;</span><br><span class=\"line\">      &lt;ThemedButton /&gt;</span><br><span class=\"line\">    &lt;/div&gt;</span><br><span class=\"line\">  );</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class ThemedButton extends React.Component &#123;</span><br><span class=\"line\">  // Assign a contextType to read the current theme context.</span><br><span class=\"line\">  // React will find the closest theme Provider above and use its value.</span><br><span class=\"line\">  // In this example, the current theme is &quot;dark&quot;.</span><br><span class=\"line\">  static contextType = ThemeContext;</span><br><span class=\"line\">  render() &#123;</span><br><span class=\"line\">    return &lt;Button theme=&#123;this.context&#125; /&gt;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li><strong>API</strong><br>\n(1) React.creatContext : <code>const MyContext = React.createContext(defaultValue);</code><br>\né»˜è®¤å€¼åªä¼šåœ¨æœªæ‰¾åˆ° <code>Provider</code> çš„æ—¶å€™ä½¿ç”¨ã€‚<br>\n(2) Context.Provider : <code>&lt;MyContext.Provider value={/* some value */}&gt;</code><br>\nå½“ <code>Provider</code> ä¿®æ”¹äº† value å€¼æ—¶ï¼Œæ‰€æœ‰æ¶ˆè´¹è€…å­å­™éƒ½ä¼šé‡æ–°æ¸²æŸ“ã€‚å­ç»„ä»¶çš„ <code>shouldComponentUpdate</code> æ— æ³•æ•è·åˆ°è¿™ç§æ›´æ–°ï¼Œå› æ­¤å³ä½¿çˆ¶ç»„ä»¶å–æ¶ˆæ›´æ–°ï¼Œå­ç»„ä»¶ä¹Ÿä¼šç…§å¸¸æ›´æ–°ã€‚<br>\n(3) Class.contentType : åœ¨ç±»å¤– <code>ClassName.contentType = MyContent</code>ï¼Œåœ¨ç±»ä¸­ <code>static contextType = MyContext;</code><br>\nç±»ä¸­æœ‰ <code>contentType</code> å±æ€§ï¼Œ context èµ‹å€¼ç»™è¿™ä¸ªå±æ€§ï¼ˆè®¢é˜…ï¼‰ï¼Œé€šè¿‡ <code>this.content</code> å–åˆ°å€¼ã€‚<br>\n(4) Context.Consumer : <code>&lt;MyContext.Consumer&gt;{alue =&gt; /* render something based on the context value */}&lt;/MyContext.Consumer&gt;</code><br>\n(5) Context.displayName : <code>MyContext.displayName = 'MyDisplayName';</code><br>\nç”¨äº React DevTools ã€‚</li>\n<li><strong>ä»åµŒå¥—ç»„ä»¶æ›´æ–° context</strong><br>\nåˆå§‹å€¼é™¤äº†åŒ…å«é»˜è®¤å€¼ï¼Œè¿˜å¯ä»¥åŒ…å«ä¸€ä¸ª <code>onChange</code> å‡½æ•°ã€‚</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// Make sure the shape of the default value passed to</span><br><span class=\"line\">// createContext matches the shape that the consumers expect!</span><br><span class=\"line\">export const ThemeContext = React.createContext(&#123;</span><br><span class=\"line\">  theme: themes.dark,</span><br><span class=\"line\">  toggleTheme: () =&gt; &#123;&#125;,</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<h3 id=\"error-boundaries\">Error Boundaries</h3>\n<p><a href=\"https://reactjs.org/docs/error-boundaries.html\" target=\"_blank\" rel=\"noopener\">link</a><br>\né”™è¯¯è¾¹ç•Œæ˜¯ React 16 å¼•å…¥çš„æ–°æ¦‚å¿µï¼Œå¯ä»¥åœ¨ render è¿‡ç¨‹ã€ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€ä»¥åŠç»„ä»¶æ ‘çš„æ„é€ ä¸­æ•è·<strong>å­ç»„ä»¶</strong>çš„é”™è¯¯ï¼Œæ˜¾ç¤ºå¤‡ç”¨çš„ UI è€Œä¸æ˜¯å´©æºƒç•Œé¢ã€‚æ³¨æ„ï¼Œå®ƒæ— æ³•æ•è·äº‹ä»¶å¤„ç†ã€å¼‚æ­¥ä»£ç ã€æœåŠ¡ç«¯æ¸²æŸ“åŠå®ƒæœ¬èº«çš„é”™è¯¯ã€‚<br>\nå°†ä¸€ä¸ªç±»ç»„ä»¶è½¬æ¢ä¸ºä¸€ä¸ªé”™è¯¯è¾¹ç•Œç»„ä»¶ä¸»è¦æ˜¯å®ç°ä¸¤ä¸ªæ–¹æ³•ï¼šåœ¨ <code>static getDerivedStateFromError()</code> ä¸­æ•è·å­ç»„ä»¶é”™è¯¯å¹¶è§¦å‘å¤‡ç”¨ UI çš„æ¸²æŸ“ï¼›åœ¨ <code>componentDidCatch()</code> ä¸­æ‰“å°é”™è¯¯ä¿¡æ¯ã€‚</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">class ErrorBoundary extends React.Component &#123;</span><br><span class=\"line\">  constructor(props) &#123;</span><br><span class=\"line\">    super(props);</span><br><span class=\"line\">    this.state = &#123; hasError: false &#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  static getDerivedStateFromError(error) &#123;</span><br><span class=\"line\">    // Update state so the next render will show the fallback UI.</span><br><span class=\"line\">    return &#123; hasError: true &#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  componentDidCatch(error, errorInfo) &#123;</span><br><span class=\"line\">    // You can also log the error to an error reporting service</span><br><span class=\"line\">    logErrorToMyService(error, errorInfo);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  render() &#123;</span><br><span class=\"line\">    if (this.state.hasError) &#123;</span><br><span class=\"line\">      // You can render any custom fallback UI</span><br><span class=\"line\">      return &lt;h1&gt;Something went wrong.&lt;/h1&gt;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    return this.props.children; </span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// use it as a regular component</span><br><span class=\"line\">&lt;ErrorBoundary&gt;</span><br><span class=\"line\">  &lt;MyWidget /&gt;</span><br><span class=\"line\">&lt;/ErrorBoundary&gt;</span><br></pre></td></tr></table></figure>\n<h3 id=\"forwarding-refs\">Forwarding Refs</h3>\n<p><a href=\"https://reactjs.org/docs/forwarding-refs.html\" target=\"_blank\" rel=\"noopener\">link</a><br>\nReact æä¾›äº†ä¸€ä¸ªå‘ä¸‹è½¬å‘å­ç»„ä»¶ ref çš„æ–¹æ³• <code>React.forwardRef</code>ï¼Œç”¨æ³•å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const FancyButton = React.forwardRef((props, ref) =&gt; (</span><br><span class=\"line\">  &lt;button ref=&#123;ref&#125; className=&quot;FancyButton&quot;&gt;</span><br><span class=\"line\">    &#123;props.children&#125;</span><br><span class=\"line\">  &lt;/button&gt;</span><br><span class=\"line\">));</span><br><span class=\"line\"></span><br><span class=\"line\">// You can now get a ref directly to the DOM button:</span><br><span class=\"line\">const ref = React.createRef();</span><br><span class=\"line\">&lt;FancyButton ref=&#123;ref&#125;&gt;Click me!&lt;/FancyButton&gt;;</span><br></pre></td></tr></table></figure>\n<p><code>React.forwardRef</code> æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ props ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ ref ï¼Œä½œä¸ºå­ç»„ä»¶å¼•ç”¨çš„èµ‹å€¼å¯¹è±¡ã€‚å¦‚æœæ˜¯æ™®é€šçš„ç±»ç»„ä»¶å’Œå‡½æ•°ç»„ä»¶ï¼Œä¸ä¼šæ¥å— ref ä½œä¸ºå‚æ•°ï¼Œä¹Ÿä¸èƒ½åœ¨ props ä¸­è®¿é—®åˆ°ã€‚<br>\næ–‡æ¡£æ¥ä¸‹æ¥è¿˜ä¸¾äº†ä¸€ä¸ªåœ¨é«˜é˜¶ç»„ä»¶ä¸­è½¬å‘ ref çš„ä¾‹å­ï¼Œç›®å‰è¿˜æ²¡å®Œå…¨çœ‹æ‡‚ã€‚ğŸ§</p>\n<h3 id=\"fragments\">Fragments</h3>\n<p><a href=\"https://reactjs.org/docs/fragments.html\" target=\"_blank\" rel=\"noopener\">link</a><br>\nå½“æˆ‘ä»¬éœ€è¦å¯¹ä¸€ç»„å­å…ƒç´ è¿›è¡Œåˆ†ç»„ï¼Œåˆä¸å¸Œæœ›æ·»åŠ é¢å¤–çš„ DOM èŠ‚ç‚¹æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ fragments ï¼Œæœ‰ä¸¤ç§å†™æ³•ï¼š<code>&lt;&gt;&lt;/&gt;</code> å’Œ <code>&lt;React.Fragment&gt;&lt;/React.Fragment&gt;</code> ï¼Œç¬¬äºŒç§å†™æ³•å¯ä»¥æ·»åŠ  <code>key</code> å±æ€§ã€‚</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">render() &#123;</span><br><span class=\"line\">  return (</span><br><span class=\"line\">    &lt;React.Fragment&gt;</span><br><span class=\"line\">      &lt;ChildA /&gt;</span><br><span class=\"line\">      &lt;ChildB /&gt;</span><br><span class=\"line\">      &lt;ChildC /&gt;</span><br><span class=\"line\">    &lt;/React.Fragment&gt;</span><br><span class=\"line\">  );</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// or</span><br><span class=\"line\">render() &#123;</span><br><span class=\"line\">  return (</span><br><span class=\"line\">    &lt;&gt;</span><br><span class=\"line\">      &lt;ChildA /&gt;</span><br><span class=\"line\">      &lt;ChildB /&gt;</span><br><span class=\"line\">      &lt;ChildC /&gt;</span><br><span class=\"line\">    &lt;/&gt;</span><br><span class=\"line\">  );</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"higher-order-components\">Higher-Order Components</h3>\n<p><a href=\"https://reactjs.org/docs/higher-order-components.html\" target=\"_blank\" rel=\"noopener\">link</a><br>\nå®šä¹‰ï¼šé«˜é˜¶ç»„ä»¶æ˜¯ä¸€ä¸ªæ¥å—ç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œè¿”å›æ–°ç»„ä»¶çš„å‡½æ•°ã€‚</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const EnhancedComponent = higherOrderComponent(WrappedComponent);</span><br></pre></td></tr></table></figure>\n<p>æ—¢ç„¶æ˜¯å‡½æ•°ç»„ä»¶ï¼Œé‚£å°±åº”è¯¥æ˜¯ pure fuction ï¼Œä¸”ä¸èƒ½æœ‰ä»»ä½•çš„å‰¯ä½œç”¨ã€‚å®ƒæ˜¯é€šè¿‡å°†åŸå§‹ç»„ä»¶åŒ…è£¹åœ¨ä¸€ä¸ªæ–°çš„ç±»ç»„ä»¶ï¼Œå¹¶è¿”å›è¿™ä¸ªç±»ç»„ä»¶æ¥å®ç°åŠŸèƒ½çš„ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// This function takes a component...</span><br><span class=\"line\">function withSubscription(WrappedComponent, selectData) &#123;</span><br><span class=\"line\">  // ...and returns another component...</span><br><span class=\"line\">  return class extends React.Component &#123;</span><br><span class=\"line\">    constructor(props) &#123;</span><br><span class=\"line\">      super(props);</span><br><span class=\"line\">      this.handleChange = this.handleChange.bind(this);</span><br><span class=\"line\">      this.state = &#123;</span><br><span class=\"line\">        data: selectData(DataSource, props)</span><br><span class=\"line\">      &#125;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    componentDidMount() &#123;</span><br><span class=\"line\">      // ... that takes care of the subscription...</span><br><span class=\"line\">      DataSource.addChangeListener(this.handleChange);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    componentWillUnmount() &#123;</span><br><span class=\"line\">      DataSource.removeChangeListener(this.handleChange);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    handleChange() &#123;</span><br><span class=\"line\">      this.setState(&#123;</span><br><span class=\"line\">        data: selectData(DataSource, this.props)</span><br><span class=\"line\">      &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    render() &#123;</span><br><span class=\"line\">      // ... and renders the wrapped component with the fresh data!</span><br><span class=\"line\">      // Notice that we pass through any additional props</span><br><span class=\"line\">      return &lt;WrappedComponent data=&#123;this.state.data&#125; &#123;...this.props&#125; /&gt;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>æ³¨æ„åŒºåˆ† HOCs å’Œ container components ã€‚HOCs ä½¿ç”¨äº† å®¹å™¨ç»„ä»¶ä½œä¸ºå…¶å®ç°çš„ä¸€éƒ¨åˆ†ã€‚<br>\næ­¤å¤–ï¼Œæ³¨æ„ä¸èƒ½åœ¨ render å‡½æ•°ä¸­ä½¿ç”¨ HOCs ï¼Œå¦åˆ™ä¼šå¯¼è‡´æ¯æ¬¡ render æ—¶æ•´ä¸ªå­ç»„ä»¶ç†Ÿ4éƒ½ä¼šå¸è½½å†è£…è½½ï¼Œä¸¢å¤±çŠ¶æ€ã€‚</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">render() &#123;</span><br><span class=\"line\">  // A new version of EnhancedComponent is created on every render</span><br><span class=\"line\">  // EnhancedComponent1 !== EnhancedComponent2</span><br><span class=\"line\">  const EnhancedComponent = enhance(MyComponent);</span><br><span class=\"line\">  // That causes the entire subtree to unmount/remount each time!</span><br><span class=\"line\">  return &lt;EnhancedComponent /&gt;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"jsx-in-depth\">JSX In Depth</h3>\n<p><a href=\"https://reactjs.org/docs/jsx-in-depth.html\" target=\"_blank\" rel=\"noopener\">link</a><br>\nJSX æ˜¯ <code>React.createElement(component, props, ...children)</code> çš„è¯­æ³•ç³–ï¼Œç¼–è¯‘ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;MyButton color=&quot;blue&quot; shadowSize=&#123;2&#125;&gt;</span><br><span class=\"line\">  Click Me</span><br><span class=\"line\">&lt;/MyButton&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">// compiles into:</span><br><span class=\"line\">React.createElement(</span><br><span class=\"line\">  MyButton,</span><br><span class=\"line\">  &#123;color: &apos;blue&apos;, shadowSize: 2&#125;,</span><br><span class=\"line\">  &apos;Click Me&apos;</span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n<p>è‹¥æ˜¯ self-closing tag å¦‚ <code>&lt;div/&gt;</code> ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ <code>null</code> ã€‚æ³¨æ„ç»„ä»¶çš„é¦–å­—æ¯ä¸€å®šè¦å¤§å†™ï¼Œå¦åˆ™ä¼šè¢«å½“æˆæ™®é€šçš„å†…ç½®ç»„ä»¶ã€‚<br>\nå¯ä»¥åœ¨ JSX ä¸­ä½¿ç”¨ç‚¹è¿ç®—ç¬¦å¼•ç”¨ React ç»„ä»¶ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import React from &apos;react&apos;;</span><br><span class=\"line\"></span><br><span class=\"line\">const MyComponents = &#123;</span><br><span class=\"line\">  DatePicker: function DatePicker(props) &#123;</span><br><span class=\"line\">    return &lt;div&gt;Imagine a &#123;props.color&#125; datepicker here.&lt;/div&gt;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// use dot-notation</span><br><span class=\"line\">function BlueDatePicker() &#123;</span><br><span class=\"line\">  return &lt;MyComponents.DatePicker color=&quot;blue&quot; /&gt;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ä½†æ™®é€šçš„è¡¨è¾¾å¼ä¸èƒ½æŒ‡ç¤º React å…ƒç´ ç±»å‹ï¼Œå¦‚æœæƒ³è¦åŠ¨æ€æ˜¾ç¤ºç»„ä»¶ï¼Œéœ€è¦å…ˆèµ‹å€¼ç»™ä¸€ä¸ªå¤§å†™å­—æ¯å¼€å¤´çš„å˜é‡ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import React from &apos;react&apos;;</span><br><span class=\"line\">import &#123; PhotoStory, VideoStory &#125; from &apos;./stories&apos;;</span><br><span class=\"line\"></span><br><span class=\"line\">const components = &#123;</span><br><span class=\"line\">  photo: PhotoStory,</span><br><span class=\"line\">  video: VideoStory</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">function Story(props) &#123;</span><br><span class=\"line\">  // you can&apos;t write `return &lt;components[props.storyType] story=&#123;props.story&#125; /&gt;;`</span><br><span class=\"line\">  // Correct! JSX type can be a capitalized variable.</span><br><span class=\"line\">  const SpecificStory = components[props.storyType];</span><br><span class=\"line\">  return &lt;SpecificStory story=&#123;props.story&#125; /&gt;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>åœ¨åŒæ—¶åŒ…å«å¼€å§‹æ ‡ç­¾å’Œç»“æŸæ ‡ç­¾çš„JSXè¡¨è¾¾å¼ä¸­ï¼Œtag ä¹‹é—´çš„å†…å®¹ä½œä¸ºç‰¹æ®Šçš„ propsï¼š<code>props.children</code> ä¼ é€’ã€‚<br>\nå¸ƒå°”å€¼ã€null å’Œ undefined ä¼šè¢« React å¿½ç•¥ï¼Œä¸‹è¿°è¡¨è¾¾å¼æ¸²æŸ“ç»“æœç›¸åŒï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;div /&gt;</span><br><span class=\"line\">&lt;div&gt;&lt;/div&gt;</span><br><span class=\"line\">&lt;div&gt;&#123;false&#125;&lt;/div&gt;</span><br><span class=\"line\">&lt;div&gt;&#123;null&#125;&lt;/div&gt;</span><br><span class=\"line\">&lt;div&gt;&#123;undefined&#125;&lt;/div&gt;</span><br><span class=\"line\">&lt;div&gt;&#123;true&#125;&lt;/div&gt;</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h2>ADVANCED GUIDES</h2>\n<h3>Accessibility</h3>\n<p><a href=\"https://reactjs.org/docs/accessibility.html\" target=\"_blank\" rel=\"noopener\">link</a></p>\n<ol>\n<li>è¡¨å•æ§ä»¶å¦‚ <code>&lt;input/&gt;</code> ã€ <code>&lt;textarea/&gt;</code> ç­‰ï¼Œé€šå¸¸éœ€è¦ <code>&lt;label/&gt;</code> æ ‡ç­¾æé«˜å¯è®¿é—®æ€§ã€‚åœ¨ react ä¸­ï¼Œå±æ€§ <code>for</code> è¢«æ›¿ä»£ä¸º <code>htmlFor</code> ï¼š</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;label htmlFor=&quot;namedInput&quot;&gt;Name:&lt;/label&gt;</span><br><span class=\"line\">&lt;input id=&quot;namedInput&quot; type=&quot;text&quot; name=&quot;name&quot;/&gt;</span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li>èšç„¦ input ç»„ä»¶çš„æ–¹æ³•ï¼šref ä¹Ÿå¯ä»¥åœ¨çˆ¶ç»„ä»¶åˆ›å»ºï¼Œé€šè¿‡ props è½¬å‘ç»™å­ç»„ä»¶ã€‚</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">class CustomTextInput extends React.Component &#123;</span><br><span class=\"line\">  constructor(props) &#123;</span><br><span class=\"line\">    super(props);</span><br><span class=\"line\">    // Create a ref to store the textInput DOM element</span><br><span class=\"line\">    this.textInput = React.createRef();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  render() &#123;</span><br><span class=\"line\">  // Use the `ref` callback to store a reference to the text input DOM</span><br><span class=\"line\">  // element in an instance field (for example, this.textInput).</span><br><span class=\"line\">    return (</span><br><span class=\"line\">      &lt;input</span><br><span class=\"line\">        type=&quot;text&quot;</span><br><span class=\"line\">        ref=&#123;this.textInput&#125;</span><br><span class=\"line\">      /&gt;</span><br><span class=\"line\">    );</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// focus it elsewhere in our component when needed:</span><br><span class=\"line\">focus() &#123;</span><br><span class=\"line\">  // Explicitly focus the text input using the raw DOM API</span><br><span class=\"line\">  // Note: we&apos;re accessing &quot;current&quot; to get the DOM node</span><br><span class=\"line\">  this.textInput.current.focus();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li>HTMLELement ä¸Šæœ‰ <code>onBlur</code> åŠ <code>onFocus</code> ä¸¤ä¸ªå±æ€§ï¼Œå¯ç”¨äºåˆ¤æ–­å½“å‰å…ƒç´ æ˜¯å¦è·å¾—ç„¦ç‚¹ã€‚å®é™…åº”ç”¨ä¸­ï¼Œå¯ä»¥ç”¨äºæ§åˆ¶ popover çš„æ˜¾ç¤ºï¼šå½“ç¦»å¼€æŸå…ƒç´ æ—¶ï¼Œ éšè— popover ã€‚</li>\n</ol>\n<h3>Code-Splitting</h3>\n<p><a href=\"https://reactjs.org/docs/code-splitting.html\" target=\"_blank\" rel=\"noopener\">link</a></p>\n<ol>\n<li><strong>Dynamic import</strong></li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// before</span><br><span class=\"line\">import &#123; add &#125; from &apos;./math&apos;;</span><br><span class=\"line\">console.log(add(16, 26));</span><br><span class=\"line\"></span><br><span class=\"line\">// after</span><br><span class=\"line\">import(&quot;./math&quot;).then(math =&gt; &#123;</span><br><span class=\"line\">  console.log(math.add(16, 26));</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li><strong>React.lazy</strong><br>\nå¯ä»¥å°†åŠ¨æ€å¯¼å…¥å˜æˆä¸€ä¸ªç»„ä»¶ï¼Œè¿”å›å€¼å¿…é¡»åŒ…è£¹åœ¨ <code>&lt;Suspense&gt;&lt;/Suspense&gt;</code> å†…éƒ¨ï¼ˆå¯åŒ…è£¹å¤šä¸ª lazy compomentsï¼‰ï¼š</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// before</span><br><span class=\"line\">import OtherComponent from &apos;./OtherComponent&apos;;</span><br><span class=\"line\"></span><br><span class=\"line\">// after</span><br><span class=\"line\">const OtherComponent = React.lazy(() =&gt; import(&apos;./OtherComponent&apos;));</span><br><span class=\"line\"></span><br><span class=\"line\">function MyComponent() &#123;</span><br><span class=\"line\">  return (</span><br><span class=\"line\">    &lt;div&gt;</span><br><span class=\"line\">      &lt;Suspense fallback=&#123;&lt;div&gt;Loading...&lt;/div&gt;&#125;&gt;</span><br><span class=\"line\">        &lt;OtherComponent /&gt;</span><br><span class=\"line\">      &lt;/Suspense&gt;</span><br><span class=\"line\">    &lt;/div&gt;</span><br><span class=\"line\">  );</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li><strong>Error boundaries</strong><br>\nä¹‹åæœ‰ä¸“é—¨çš„ç« èŠ‚ä»‹ç»è¿™éƒ¨åˆ†ã€‚</li>\n<li><strong>Route-based code splitting</strong><br>\nåŸºäºè·¯ç”±çš„åŠ¨æ€å¼•å…¥ï¼Œä¸ React Router é…åˆä½¿ç”¨ï¼š</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import &#123; BrowserRouter as Router, Route, Switch &#125; from &apos;react-router-dom&apos;;</span><br><span class=\"line\">import React, &#123; Suspense, lazy &#125; from &apos;react&apos;;</span><br><span class=\"line\"></span><br><span class=\"line\">const Home = lazy(() =&gt; import(&apos;./routes/Home&apos;));</span><br><span class=\"line\">const About = lazy(() =&gt; import(&apos;./routes/About&apos;));</span><br><span class=\"line\"></span><br><span class=\"line\">const App = () =&gt; (</span><br><span class=\"line\">  &lt;Router&gt;</span><br><span class=\"line\">    &lt;Suspense fallback=&#123;&lt;div&gt;Loading...&lt;/div&gt;&#125;&gt;</span><br><span class=\"line\">      &lt;Switch&gt;</span><br><span class=\"line\">        &lt;Route exact path=&quot;/&quot; component=&#123;Home&#125;/&gt;</span><br><span class=\"line\">        &lt;Route path=&quot;/about&quot; component=&#123;About&#125;/&gt;</span><br><span class=\"line\">      &lt;/Switch&gt;</span><br><span class=\"line\">    &lt;/Suspense&gt;</span><br><span class=\"line\">  &lt;/Router&gt;</span><br><span class=\"line\">);</span><br></pre></td></tr></table></figure>\n<ol start=\"5\">\n<li><strong>Named Exports</strong><br>\nè‹¥éœ€è¦åŠ¨æ€å¯¼å…¥çš„æ¨¡å—ä¸æ˜¯é»˜è®¤å¯¼å‡ºï¼Œé‚£æˆ‘ä»¬å¯ä»¥åˆ›å»ºå¤šä¸€ä¸ªæ–‡ä»¶ï¼Œå°†éœ€è¦å¯¼å…¥çš„æ¨¡å—è½¬ä¸ºé»˜è®¤å¯¼å‡ºï¼š</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// ManyComponents.js</span><br><span class=\"line\">export const MyComponent = /* ... */;</span><br><span class=\"line\">export const MyUnusedComponent = /* ... */;</span><br><span class=\"line\"></span><br><span class=\"line\">// MyComponent.js</span><br><span class=\"line\">export &#123; MyComponent as default &#125; from &quot;./ManyComponents.js&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">// MyApp.js</span><br><span class=\"line\">import React, &#123; lazy &#125; from &apos;react&apos;;</span><br><span class=\"line\">const MyComponent = lazy(() =&gt; import(&quot;./MyComponent.js&quot;));</span><br></pre></td></tr></table></figure>\n<h3>Context</h3>\n<p><a href=\"https://reactjs.org/docs/context.html\" target=\"_blank\" rel=\"noopener\">link</a><br>\nä¸Šä¸‹æ–‡æä¾›äº†ä¸€ç§é€šè¿‡ç»„ä»¶æ ‘ä¼ é€’æ•°æ®çš„æ–¹æ³•ï¼Œè€Œä¸å¿…é€å±‚ä¼ é€’ props ã€‚</p>\n<ol>\n<li>åœ¨ç±»ä¸­ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// Context lets us pass a value deep into the component tree</span><br><span class=\"line\">// without explicitly threading it through every component.</span><br><span class=\"line\">// Create a context for the current theme (with &quot;light&quot; as the default).</span><br><span class=\"line\">const ThemeContext = React.createContext(&apos;light&apos;);</span><br><span class=\"line\"></span><br><span class=\"line\">class App extends React.Component &#123;</span><br><span class=\"line\">  render() &#123;</span><br><span class=\"line\">    // Use a Provider to pass the current theme to the tree below.</span><br><span class=\"line\">    // Any component can read it, no matter how deep it is.</span><br><span class=\"line\">    // In this example, we&apos;re passing &quot;dark&quot; as the current value.</span><br><span class=\"line\">    return (</span><br><span class=\"line\">      &lt;ThemeContext.Provider value=&quot;dark&quot;&gt;</span><br><span class=\"line\">        &lt;Toolbar /&gt;</span><br><span class=\"line\">      &lt;/ThemeContext.Provider&gt;</span><br><span class=\"line\">    );</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// A component in the middle doesn&apos;t have to</span><br><span class=\"line\">// pass the theme down explicitly anymore.</span><br><span class=\"line\">function Toolbar(props) &#123;</span><br><span class=\"line\">  return (</span><br><span class=\"line\">    &lt;div&gt;</span><br><span class=\"line\">      &lt;ThemedButton /&gt;</span><br><span class=\"line\">    &lt;/div&gt;</span><br><span class=\"line\">  );</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class ThemedButton extends React.Component &#123;</span><br><span class=\"line\">  // Assign a contextType to read the current theme context.</span><br><span class=\"line\">  // React will find the closest theme Provider above and use its value.</span><br><span class=\"line\">  // In this example, the current theme is &quot;dark&quot;.</span><br><span class=\"line\">  static contextType = ThemeContext;</span><br><span class=\"line\">  render() &#123;</span><br><span class=\"line\">    return &lt;Button theme=&#123;this.context&#125; /&gt;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li><strong>API</strong><br>\n(1) React.creatContext : <code>const MyContext = React.createContext(defaultValue);</code><br>\né»˜è®¤å€¼åªä¼šåœ¨æœªæ‰¾åˆ° <code>Provider</code> çš„æ—¶å€™ä½¿ç”¨ã€‚<br>\n(2) Context.Provider : <code>&lt;MyContext.Provider value={/* some value */}&gt;</code><br>\nå½“ <code>Provider</code> ä¿®æ”¹äº† value å€¼æ—¶ï¼Œæ‰€æœ‰æ¶ˆè´¹è€…å­å­™éƒ½ä¼šé‡æ–°æ¸²æŸ“ã€‚å­ç»„ä»¶çš„ <code>shouldComponentUpdate</code> æ— æ³•æ•è·åˆ°è¿™ç§æ›´æ–°ï¼Œå› æ­¤å³ä½¿çˆ¶ç»„ä»¶å–æ¶ˆæ›´æ–°ï¼Œå­ç»„ä»¶ä¹Ÿä¼šç…§å¸¸æ›´æ–°ã€‚<br>\n(3) Class.contentType : åœ¨ç±»å¤– <code>ClassName.contentType = MyContent</code>ï¼Œåœ¨ç±»ä¸­ <code>static contextType = MyContext;</code><br>\nç±»ä¸­æœ‰ <code>contentType</code> å±æ€§ï¼Œ context èµ‹å€¼ç»™è¿™ä¸ªå±æ€§ï¼ˆè®¢é˜…ï¼‰ï¼Œé€šè¿‡ <code>this.content</code> å–åˆ°å€¼ã€‚<br>\n(4) Context.Consumer : <code>&lt;MyContext.Consumer&gt;{alue =&gt; /* render something based on the context value */}&lt;/MyContext.Consumer&gt;</code><br>\n(5) Context.displayName : <code>MyContext.displayName = 'MyDisplayName';</code><br>\nç”¨äº React DevTools ã€‚</li>\n<li><strong>ä»åµŒå¥—ç»„ä»¶æ›´æ–° context</strong><br>\nåˆå§‹å€¼é™¤äº†åŒ…å«é»˜è®¤å€¼ï¼Œè¿˜å¯ä»¥åŒ…å«ä¸€ä¸ª <code>onChange</code> å‡½æ•°ã€‚</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// Make sure the shape of the default value passed to</span><br><span class=\"line\">// createContext matches the shape that the consumers expect!</span><br><span class=\"line\">export const ThemeContext = React.createContext(&#123;</span><br><span class=\"line\">  theme: themes.dark,</span><br><span class=\"line\">  toggleTheme: () =&gt; &#123;&#125;,</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<h3>Error Boundaries</h3>\n<p><a href=\"https://reactjs.org/docs/error-boundaries.html\" target=\"_blank\" rel=\"noopener\">link</a><br>\né”™è¯¯è¾¹ç•Œæ˜¯ React 16 å¼•å…¥çš„æ–°æ¦‚å¿µï¼Œå¯ä»¥åœ¨ render è¿‡ç¨‹ã€ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€ä»¥åŠç»„ä»¶æ ‘çš„æ„é€ ä¸­æ•è·<strong>å­ç»„ä»¶</strong>çš„é”™è¯¯ï¼Œæ˜¾ç¤ºå¤‡ç”¨çš„ UI è€Œä¸æ˜¯å´©æºƒç•Œé¢ã€‚æ³¨æ„ï¼Œå®ƒæ— æ³•æ•è·äº‹ä»¶å¤„ç†ã€å¼‚æ­¥ä»£ç ã€æœåŠ¡ç«¯æ¸²æŸ“åŠå®ƒæœ¬èº«çš„é”™è¯¯ã€‚<br>\nå°†ä¸€ä¸ªç±»ç»„ä»¶è½¬æ¢ä¸ºä¸€ä¸ªé”™è¯¯è¾¹ç•Œç»„ä»¶ä¸»è¦æ˜¯å®ç°ä¸¤ä¸ªæ–¹æ³•ï¼šåœ¨ <code>static getDerivedStateFromError()</code> ä¸­æ•è·å­ç»„ä»¶é”™è¯¯å¹¶è§¦å‘å¤‡ç”¨ UI çš„æ¸²æŸ“ï¼›åœ¨ <code>componentDidCatch()</code> ä¸­æ‰“å°é”™è¯¯ä¿¡æ¯ã€‚</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">class ErrorBoundary extends React.Component &#123;</span><br><span class=\"line\">  constructor(props) &#123;</span><br><span class=\"line\">    super(props);</span><br><span class=\"line\">    this.state = &#123; hasError: false &#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  static getDerivedStateFromError(error) &#123;</span><br><span class=\"line\">    // Update state so the next render will show the fallback UI.</span><br><span class=\"line\">    return &#123; hasError: true &#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  componentDidCatch(error, errorInfo) &#123;</span><br><span class=\"line\">    // You can also log the error to an error reporting service</span><br><span class=\"line\">    logErrorToMyService(error, errorInfo);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  render() &#123;</span><br><span class=\"line\">    if (this.state.hasError) &#123;</span><br><span class=\"line\">      // You can render any custom fallback UI</span><br><span class=\"line\">      return &lt;h1&gt;Something went wrong.&lt;/h1&gt;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    return this.props.children; </span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// use it as a regular component</span><br><span class=\"line\">&lt;ErrorBoundary&gt;</span><br><span class=\"line\">  &lt;MyWidget /&gt;</span><br><span class=\"line\">&lt;/ErrorBoundary&gt;</span><br></pre></td></tr></table></figure>\n<h3>Forwarding Refs</h3>\n<p><a href=\"https://reactjs.org/docs/forwarding-refs.html\" target=\"_blank\" rel=\"noopener\">link</a><br>\nReact æä¾›äº†ä¸€ä¸ªå‘ä¸‹è½¬å‘å­ç»„ä»¶ ref çš„æ–¹æ³• <code>React.forwardRef</code>ï¼Œç”¨æ³•å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const FancyButton = React.forwardRef((props, ref) =&gt; (</span><br><span class=\"line\">  &lt;button ref=&#123;ref&#125; className=&quot;FancyButton&quot;&gt;</span><br><span class=\"line\">    &#123;props.children&#125;</span><br><span class=\"line\">  &lt;/button&gt;</span><br><span class=\"line\">));</span><br><span class=\"line\"></span><br><span class=\"line\">// You can now get a ref directly to the DOM button:</span><br><span class=\"line\">const ref = React.createRef();</span><br><span class=\"line\">&lt;FancyButton ref=&#123;ref&#125;&gt;Click me!&lt;/FancyButton&gt;;</span><br></pre></td></tr></table></figure>\n<p><code>React.forwardRef</code> æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ props ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ ref ï¼Œä½œä¸ºå­ç»„ä»¶å¼•ç”¨çš„èµ‹å€¼å¯¹è±¡ã€‚å¦‚æœæ˜¯æ™®é€šçš„ç±»ç»„ä»¶å’Œå‡½æ•°ç»„ä»¶ï¼Œä¸ä¼šæ¥å— ref ä½œä¸ºå‚æ•°ï¼Œä¹Ÿä¸èƒ½åœ¨ props ä¸­è®¿é—®åˆ°ã€‚<br>\næ–‡æ¡£æ¥ä¸‹æ¥è¿˜ä¸¾äº†ä¸€ä¸ªåœ¨é«˜é˜¶ç»„ä»¶ä¸­è½¬å‘ ref çš„ä¾‹å­ï¼Œç›®å‰è¿˜æ²¡å®Œå…¨çœ‹æ‡‚ã€‚ğŸ§</p>\n<h3>Fragments</h3>\n<p><a href=\"https://reactjs.org/docs/fragments.html\" target=\"_blank\" rel=\"noopener\">link</a><br>\nå½“æˆ‘ä»¬éœ€è¦å¯¹ä¸€ç»„å­å…ƒç´ è¿›è¡Œåˆ†ç»„ï¼Œåˆä¸å¸Œæœ›æ·»åŠ é¢å¤–çš„ DOM èŠ‚ç‚¹æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ fragments ï¼Œæœ‰ä¸¤ç§å†™æ³•ï¼š<code>&lt;&gt;&lt;/&gt;</code> å’Œ <code>&lt;React.Fragment&gt;&lt;/React.Fragment&gt;</code> ï¼Œç¬¬äºŒç§å†™æ³•å¯ä»¥æ·»åŠ  <code>key</code> å±æ€§ã€‚</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">render() &#123;</span><br><span class=\"line\">  return (</span><br><span class=\"line\">    &lt;React.Fragment&gt;</span><br><span class=\"line\">      &lt;ChildA /&gt;</span><br><span class=\"line\">      &lt;ChildB /&gt;</span><br><span class=\"line\">      &lt;ChildC /&gt;</span><br><span class=\"line\">    &lt;/React.Fragment&gt;</span><br><span class=\"line\">  );</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// or</span><br><span class=\"line\">render() &#123;</span><br><span class=\"line\">  return (</span><br><span class=\"line\">    &lt;&gt;</span><br><span class=\"line\">      &lt;ChildA /&gt;</span><br><span class=\"line\">      &lt;ChildB /&gt;</span><br><span class=\"line\">      &lt;ChildC /&gt;</span><br><span class=\"line\">    &lt;/&gt;</span><br><span class=\"line\">  );</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3>Higher-Order Components</h3>\n<p><a href=\"https://reactjs.org/docs/higher-order-components.html\" target=\"_blank\" rel=\"noopener\">link</a><br>\nå®šä¹‰ï¼šé«˜é˜¶ç»„ä»¶æ˜¯ä¸€ä¸ªæ¥å—ç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œè¿”å›æ–°ç»„ä»¶çš„å‡½æ•°ã€‚</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const EnhancedComponent = higherOrderComponent(WrappedComponent);</span><br></pre></td></tr></table></figure>\n<p>æ—¢ç„¶æ˜¯å‡½æ•°ç»„ä»¶ï¼Œé‚£å°±åº”è¯¥æ˜¯ pure fuction ï¼Œä¸”ä¸èƒ½æœ‰ä»»ä½•çš„å‰¯ä½œç”¨ã€‚å®ƒæ˜¯é€šè¿‡å°†åŸå§‹ç»„ä»¶åŒ…è£¹åœ¨ä¸€ä¸ªæ–°çš„ç±»ç»„ä»¶ï¼Œå¹¶è¿”å›è¿™ä¸ªç±»ç»„ä»¶æ¥å®ç°åŠŸèƒ½çš„ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// This function takes a component...</span><br><span class=\"line\">function withSubscription(WrappedComponent, selectData) &#123;</span><br><span class=\"line\">  // ...and returns another component...</span><br><span class=\"line\">  return class extends React.Component &#123;</span><br><span class=\"line\">    constructor(props) &#123;</span><br><span class=\"line\">      super(props);</span><br><span class=\"line\">      this.handleChange = this.handleChange.bind(this);</span><br><span class=\"line\">      this.state = &#123;</span><br><span class=\"line\">        data: selectData(DataSource, props)</span><br><span class=\"line\">      &#125;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    componentDidMount() &#123;</span><br><span class=\"line\">      // ... that takes care of the subscription...</span><br><span class=\"line\">      DataSource.addChangeListener(this.handleChange);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    componentWillUnmount() &#123;</span><br><span class=\"line\">      DataSource.removeChangeListener(this.handleChange);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    handleChange() &#123;</span><br><span class=\"line\">      this.setState(&#123;</span><br><span class=\"line\">        data: selectData(DataSource, this.props)</span><br><span class=\"line\">      &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    render() &#123;</span><br><span class=\"line\">      // ... and renders the wrapped component with the fresh data!</span><br><span class=\"line\">      // Notice that we pass through any additional props</span><br><span class=\"line\">      return &lt;WrappedComponent data=&#123;this.state.data&#125; &#123;...this.props&#125; /&gt;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>æ³¨æ„åŒºåˆ† HOCs å’Œ container components ã€‚HOCs ä½¿ç”¨äº† å®¹å™¨ç»„ä»¶ä½œä¸ºå…¶å®ç°çš„ä¸€éƒ¨åˆ†ã€‚<br>\næ­¤å¤–ï¼Œæ³¨æ„ä¸èƒ½åœ¨ render å‡½æ•°ä¸­ä½¿ç”¨ HOCs ï¼Œå¦åˆ™ä¼šå¯¼è‡´æ¯æ¬¡ render æ—¶æ•´ä¸ªå­ç»„ä»¶ç†Ÿ4éƒ½ä¼šå¸è½½å†è£…è½½ï¼Œä¸¢å¤±çŠ¶æ€ã€‚</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">render() &#123;</span><br><span class=\"line\">  // A new version of EnhancedComponent is created on every render</span><br><span class=\"line\">  // EnhancedComponent1 !== EnhancedComponent2</span><br><span class=\"line\">  const EnhancedComponent = enhance(MyComponent);</span><br><span class=\"line\">  // That causes the entire subtree to unmount/remount each time!</span><br><span class=\"line\">  return &lt;EnhancedComponent /&gt;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3>JSX In Depth</h3>\n<p><a href=\"https://reactjs.org/docs/jsx-in-depth.html\" target=\"_blank\" rel=\"noopener\">link</a><br>\nJSX æ˜¯ <code>React.createElement(component, props, ...children)</code> çš„è¯­æ³•ç³–ï¼Œç¼–è¯‘ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;MyButton color=&quot;blue&quot; shadowSize=&#123;2&#125;&gt;</span><br><span class=\"line\">  Click Me</span><br><span class=\"line\">&lt;/MyButton&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">// compiles into:</span><br><span class=\"line\">React.createElement(</span><br><span class=\"line\">  MyButton,</span><br><span class=\"line\">  &#123;color: &apos;blue&apos;, shadowSize: 2&#125;,</span><br><span class=\"line\">  &apos;Click Me&apos;</span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n<p>è‹¥æ˜¯ self-closing tag å¦‚ <code>&lt;div/&gt;</code> ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ <code>null</code> ã€‚æ³¨æ„ç»„ä»¶çš„é¦–å­—æ¯ä¸€å®šè¦å¤§å†™ï¼Œå¦åˆ™ä¼šè¢«å½“æˆæ™®é€šçš„å†…ç½®ç»„ä»¶ã€‚<br>\nå¯ä»¥åœ¨ JSX ä¸­ä½¿ç”¨ç‚¹è¿ç®—ç¬¦å¼•ç”¨ React ç»„ä»¶ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import React from &apos;react&apos;;</span><br><span class=\"line\"></span><br><span class=\"line\">const MyComponents = &#123;</span><br><span class=\"line\">  DatePicker: function DatePicker(props) &#123;</span><br><span class=\"line\">    return &lt;div&gt;Imagine a &#123;props.color&#125; datepicker here.&lt;/div&gt;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// use dot-notation</span><br><span class=\"line\">function BlueDatePicker() &#123;</span><br><span class=\"line\">  return &lt;MyComponents.DatePicker color=&quot;blue&quot; /&gt;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ä½†æ™®é€šçš„è¡¨è¾¾å¼ä¸èƒ½æŒ‡ç¤º React å…ƒç´ ç±»å‹ï¼Œå¦‚æœæƒ³è¦åŠ¨æ€æ˜¾ç¤ºç»„ä»¶ï¼Œéœ€è¦å…ˆèµ‹å€¼ç»™ä¸€ä¸ªå¤§å†™å­—æ¯å¼€å¤´çš„å˜é‡ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import React from &apos;react&apos;;</span><br><span class=\"line\">import &#123; PhotoStory, VideoStory &#125; from &apos;./stories&apos;;</span><br><span class=\"line\"></span><br><span class=\"line\">const components = &#123;</span><br><span class=\"line\">  photo: PhotoStory,</span><br><span class=\"line\">  video: VideoStory</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">function Story(props) &#123;</span><br><span class=\"line\">  // you can&apos;t write `return &lt;components[props.storyType] story=&#123;props.story&#125; /&gt;;`</span><br><span class=\"line\">  // Correct! JSX type can be a capitalized variable.</span><br><span class=\"line\">  const SpecificStory = components[props.storyType];</span><br><span class=\"line\">  return &lt;SpecificStory story=&#123;props.story&#125; /&gt;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>åœ¨åŒæ—¶åŒ…å«å¼€å§‹æ ‡ç­¾å’Œç»“æŸæ ‡ç­¾çš„JSXè¡¨è¾¾å¼ä¸­ï¼Œtag ä¹‹é—´çš„å†…å®¹ä½œä¸ºç‰¹æ®Šçš„ propsï¼š<code>props.children</code> ä¼ é€’ã€‚<br>\nå¸ƒå°”å€¼ã€null å’Œ undefined ä¼šè¢« React å¿½ç•¥ï¼Œä¸‹è¿°è¡¨è¾¾å¼æ¸²æŸ“ç»“æœç›¸åŒï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;div /&gt;</span><br><span class=\"line\">&lt;div&gt;&lt;/div&gt;</span><br><span class=\"line\">&lt;div&gt;&#123;false&#125;&lt;/div&gt;</span><br><span class=\"line\">&lt;div&gt;&#123;null&#125;&lt;/div&gt;</span><br><span class=\"line\">&lt;div&gt;&#123;undefined&#125;&lt;/div&gt;</span><br><span class=\"line\">&lt;div&gt;&#123;true&#125;&lt;/div&gt;</span><br></pre></td></tr></table></figure>"},{"title":"FrontEnd Notes [2020.01]","catalog":true,"date":"2020-01-02T01:57:13.000Z","subtitle":null,"header-img":null,"_content":"#### About\n\nğŸ“… 2020 å¹´ 1 æœˆçš„é›¶æ•£å­¦ä¹ è®°å½•ã€‚\n\næ–°å¹´å¿«ä¹ï¼å¸Œæœ›æ–°çš„ä¸€å¹´èƒ½åšæŒè®°ç¬”è®°ï¼\n\n#### 2020/01/29\nä»Šæ—¥é˜…è¯»ï¼š[Hereâ€™s Why Mapping a Constructed Array in JavaScript Doesnâ€™t Work](https://itnext.io/heres-why-mapping-a-constructed-array-doesn-t-work-in-javascript-f1195138615a)\nå½“æˆ‘ä»¬æƒ³è¦ç”Ÿæˆä¸€ä¸ª 0 ~ 99 çš„æ•°ç»„æ—¶ï¼Œé™¤äº†æœ€åŸºç¡€çš„éå†èµ‹å€¼ï¼Œè¿˜å¯ä»¥åˆ©ç”¨ [Array()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Array) æ–¹æ³•ã€‚\nä½†ä½¿ç”¨ `Array.map()` ï¼Œå¹¶ä¸ä¼šæ­£ç¡®èµ‹å€¼ï¼š\n```\nconst arr = Array(100).map((_, i) => i);\nconsole.log(arr[0] === undefined);  // true\n```\né€ æˆè¿™ä¸ªé—®é¢˜çš„åŸå› æ˜¯ï¼Œåœ¨ JS ä¸­ æ•°ç»„å…¶å®æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç´¢å¼•æ˜¯ `key` ï¼Œæ•°ç»„å…ƒç´ æ˜¯ `value` ï¼Œå¦‚ï¼š\n```\n['a', 'b', 'c']\n=> \n{\n  0: 'a',\n  1: 'b',\n  2: 'c',\n  length: 3\n}\n```\nå½“ä½¿ç”¨ `Array()` æ„é€ å‡½æ•°æ—¶ï¼Œåªä¼šç”Ÿæˆä¸€ä¸ªâ€œçœŸç©ºâ€å¯¹è±¡ï¼š\n```\n{\n  //no index keys!\n  length: 100\n}\n```\nç”±äºå¯¹è±¡ä¸Šå¹¶ä¸å­˜åœ¨ `key` ï¼Œ`map` å‡½æ•°å¹¶ä¸ä¼šè¿›è¡Œéå†ï¼Œ`reduce` ã€`filter` ã€`forEach` ç­‰è¿­ä»£å‡½æ•°ä¹Ÿæœ‰åŒæ ·çš„è¡¨ç°ã€‚è§£å†³åŠæ³•æ˜¯ä½¿ç”¨å±•å¼€æ“ä½œç¬¦ï¼š\n```\nconst arr = [...Array(100)].map((_, i) => i);\nconsole.log(arr[0]); // 0\n```\n\n#### 2020/01/28\nä»Šæ—¥é˜…è¯»ï¼š[How to Deep Copy Objects and Arrays in JavaScript](https://medium.com/javascript-in-plain-english/how-to-deep-copy-objects-and-arrays-in-javascript-7c911359b089)\nå¦‚æœæ•°ç»„/å¯¹è±¡ä¸­éƒ½æ˜¯ `primitive value` ï¼Œè¦å®ç°æ·±å¤åˆ¶ï¼Œå¸¸ç”¨çš„æœ‰ä¸‹é¢ä¸‰ç§æ–¹æ³•ï¼š\n1. spread operator ...\n```\nconst array = ['ğŸ˜‰','ğŸ˜Š','ğŸ˜‡']\n\nconst copyWithEquals = array // Changes to array will change copyWithEquals\nconsole.log(copyWithEquals === array) // true (The assignment operator did not make a copy)\n\nconst copyWithSpread = [...array] // Changes to array will not change copyWithSpread\nconsole.log(copyWithSpread === array) // false (The spread operator made a shallow copy)\n\narray[0] = 'ğŸ˜¡' // Whoops, a bug\n\nconsole.log(...array) // ğŸ˜¡ ğŸ˜Š ğŸ˜‡\nconsole.log(...copyWithEquals) // ğŸ˜¡ ğŸ˜Š ğŸ˜‡\nconsole.log(...copyWithSpread) // ğŸ˜‰ ğŸ˜Š ğŸ˜‡\n```\n2. .slice()\n```\nconst array = ['ğŸ˜‰','ğŸ˜Š','ğŸ˜‡']\n\nconst copyWithEquals = array // Changes to array will change copyWithEquals\nconsole.log(copyWithEquals === array) // true (The assignment operator did not make a copy)\n\nconst copyWithSlice = array.slice() // Changes to array will not change copyWithSlice\nconsole.log(copyWithSlice === array) // false (Using .slice() made a shallow copy of the array)\n\narray[0] = 'ğŸ˜¡' // Whoops, a bug\n\nconsole.log(...array) // ğŸ˜¡ ğŸ˜Š ğŸ˜‡\nconsole.log(...copyWithEquals) // ğŸ˜¡ ğŸ˜Š ğŸ˜‡\nconsole.log(...copyWithSlice) // ğŸ˜‰ ğŸ˜Š ğŸ˜‡\n```\n3. .assign()\n```\nconst array = ['ğŸ˜‰','ğŸ˜Š','ğŸ˜‡']\n\nconst copyWithEquals = array // Changes to array will change copyWithEquals\nconst copyWithAssign = [] // Changes to array will not change copyWithAssign\nObject.assign(copyWithAssign, array) // Object.assign(target, source)\n\narray[0] = 'ğŸ˜¡' // Whoops, a bug\n\nconsole.log(...array) // ğŸ˜¡ ğŸ˜Š ğŸ˜‡\nconsole.log(...copyWithEquals) // ğŸ˜¡ ğŸ˜Š ğŸ˜‡\nconsole.log(...copyWithAssign) // ğŸ˜‰ ğŸ˜Š ğŸ˜‡\n```\n\nå¦‚æœæ•°ç»„ä¸­çš„å…ƒç´ ä¹Ÿæ˜¯æ•°ç»„/å¯¹è±¡ï¼Œä¸Šè¿°æ–¹æ³•åªèƒ½å®ç°ç¬¬ä¸€å±‚æ¬¡ä½†æ·±å¤åˆ¶ï¼Œæ²¡æ³•å¯¹å…ƒç´ ä¹Ÿè¿›è¡Œæ·±å¤åˆ¶ã€‚ä½œè€…æä¾›äº†5ç§æ–¹æ³•ï¼š\n1. [lodash](https://lodash.com/)\n`lodash` æä¾›äº† `_.clone()` ä»¥åŠ `_.cloneDeep()` ä¸¤ä¸ªæ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªæ–¹æ³•å®ç°çš„æ˜¯ç¬¬ä¸€å±‚é¢çš„æ·±å¤åˆ¶ï¼Œç¬¬äºŒä¸ªæ–¹æ³•å¯ä»¥å®ç°å®Œå…¨çš„æ·±å¤åˆ¶ã€‚\n2. [Ramda](https://ramdajs.com/)\næä¾›äº† `R.clone()` æ–¹æ³•å®ç°å®Œå…¨çš„æ·±å¤åˆ¶ï¼Œç›¸å½“äº `lodash.cloneDeep()` ã€‚\n3. custom function\nå¯ä»¥è‡ªå·±å®ç°ä¸€ä¸ªæ·±å¤åˆ¶å‡½æ•°ï¼ŒåŸºæœ¬æ€æƒ³æ˜¯åˆ¤æ–­è¾“å…¥æ˜¯å¦ä¸ºæ•°ç»„/å¯¹è±¡ï¼Œå¦‚æœæ˜¯åˆ™ç»§ç»­é€å±‚éå†èµ‹å€¼ï¼Œå¦åˆ™è¿”å›åŸå§‹å€¼ã€‚è¿˜éœ€è€ƒè™‘å€¼ä¸º `null` çš„ç‰¹æ®Šæƒ…å†µï¼Œå› ä¸º `typeof null = \"object\"`\n```\nconst deepCopyFunction = inObject => {\n  let outObject, value, key;\n\n  if(typeof inObject !== \"object\" || inObject === null) {\n    return inObject;\n  };\n\n  outObject = Array.isArray(inObject) ? [] : {};\n\n  for(key in inObject) {\n    value = inObject[key];\n\n    outObject[key] = (typeof value === \"object\" && value !== null) ? deepCopyFunction(value) : value\n  };\n\n  return outObject;\n}\n```\n4. `JSON.parse(JSON.stringify(object))`\nè¯¥æ–¹æ³•å¯¹å…ƒç´ æœ‰ä¸€å®šçš„è¦æ±‚ï¼Œè¯¦è§ stackoverflow ä¸Š[è¿™ä¸ªå›ç­”](https://stackoverflow.com/questions/122102/what-is-the-most-efficient-way-to-deep-clone-an-object-in-javascript/122704#122704)ã€‚æ€»ç»“è€Œè¨€ï¼Œå¦‚æœå…ƒç´ åªæ˜¯æ™®é€šçš„æ•°ç»„å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ã€‚\n5. [rfdc](https://www.npmjs.com/package/rfdc)\nä½œè€…æƒ³è¦æ¨å¹¿çš„ä¸€ä¸ªåº“ï¼Œä¼˜ç‚¹æ˜¯é€Ÿåº¦å¾ˆå¿«ã€‚\n\n#### 2020/01/17\n[TypeScript: Conditional Types](https://www.typescriptlang.org/docs/handbook/advanced-types.html#conditional-types)\nè€ƒè™‘ä»¥ä¸‹åœºæ™¯ï¼šæˆ‘ä»¬æœ‰ä¸€ä¸ªè·å–èµ„æºçš„æ¥å£ï¼Œæ ¹æ®èµ„æºç±»å‹è¿”å›ä¸åŒçš„æ•°æ®ç±»å‹çš„æ•°æ®ï¼Œä»£ç å¤§è‡´å¦‚ä¸‹ï¼š  \n```\ngetResources<T>(type: \"tasks\"|\"jobs\"|\"queues\") {\n  return axios.get<T>('http://.......')\n}\n\n// use\nconst tasks = await getResources<TaskList>(\"tasks\")\nconst jobs = await getResources<JobList>(\"jobs\")\n```\nå¦‚æœæˆ‘ä»¬æƒ³è¦å¹¶è¡Œå‘é€è¯·æ±‚ï¼Œå¯ä»¥ä½¿ç”¨ `Promise.all()` ï¼š\n```\nconst [tasks, jobs] = await Promise.all([\"tasks\",\"jobs\"].map(type => {\n  return getResources<TaskList|JobList>(type)\n}))\n```\nä¸Šè¿°ä»£ç å¼•èµ·çš„é—®é¢˜æ˜¯ï¼Œ`tasks` å’Œ `jobs` çš„ç±»å‹ä¼šæ˜¯ `TaskList|JobList` ï¼Œå¦‚æœæˆ‘ä»¬ä¹‹åè¦è®¿é—®ä»–ä»¬çš„å±æ€§ï¼Œé¿å…ä¸äº† `as TaskList` ï¼Œ`as JobList` è¿™ç§å†™æ³•ã€‚ä¼˜åŒ–åšæ³•æ˜¯ï¼Œä½¿ç”¨ ts çš„ conditional typesï¼Œå¯ä»¥ä»è¾“å…¥ç±»å‹æ¨æ–­å‡ºè¾“å‡ºç±»å‹ï¼š\n```\nexport type ResType = \"tasks\" | \"jobs\" | \"queues\" ;\nexport type ResData<T extends ResType> = \n  T extends \"tasks\" ? TaskList: \n  T extends \"jobs\"  ? JobList : \n  T extends \"queues\" ? QueueList :\n  never;\n\ngetResources<T extends ResType>(type: T) {\n  return axios.get<ResData<T>>('http://.......')\n}\n```\nè¿™æ ·ï¼Œåœ¨è°ƒç”¨ `getResources` å°±ä¸ç”¨æ˜¾å¼ä¼ å…¥ `T` ã€‚æ¥ä¸‹æ¥ï¼Œä¸ºäº†è§£å†³ç±»å‹åœ¨ `Promise.all()` ç”¨ `map` å¯èƒ½æ¨æ–­ä¸å‡ºæ¥çš„é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ tuple ï¼š\n```\n// or just `getResources(\"tasks\")` if RV of getResources is already a promise\nconst taskPromise = Promise.resolve(getResources(\"tasks\"));\nconst jobPromise = Promise.resolve(getResources(\"jobs\"));\nconst [tasks, jobs] = await Promise.all([taskPromise,jobPromise])\n```\nä¸€é¡¿æ“ä½œä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å‡†ç¡®å¾—åˆ° `tasks` å’Œ `jobs` çš„ç±»å‹äº†ã€‚ğŸ˜ \næ‰©å±•é˜…è¯»ï¼š[Promise.resolve()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/resolve) ã€ [Promise.all()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/all)\n\n#### 2020/01/16\nä»Šæ—¥è¸©å‘è®°å½•ã€‚è€ƒè™‘ä»¥ä¸‹ä»£ç ï¼š\n```\nconst [state, setState] = useState<string[]>([]);\n\nuseEffect(() => {\n  const loadData = async () => {\n    const lists = [\"list1\", \"list2\", \"list3\"];\n    for(const list of lists) {\n      const {data} = await thisIsPromise(list);\n      setState([...state, ...data])\n    }\n  };\n  // call async function \n  loadData(); \n},[])\n```\nè¿è¡Œä¸Šé¢çš„ä»£ç ï¼Œ`state` å¹¶ä¸ä¼šè¿”å›æ‰€æœ‰ `list` çš„é›†åˆã€‚åŸå› æ˜¯ `setState` æ˜¯å¼‚æ­¥æ›´æ–°çš„ï¼Œæ¯æ¬¡å¾ªç¯è°ƒç”¨ `setState([...state, ...data])` æ—¶ï¼Œ `state` éƒ½æ˜¯åˆå§‹å€¼ï¼Œä¹Ÿå°±æ˜¯ç©ºæ•°ç»„ã€‚å¦‚æœæˆ‘ä»¬æƒ³è¦å¾—åˆ°ä¸Šä¸€ä¸ª `state` çš„å€¼ï¼Œåªèƒ½ä½¿ç”¨ä¸‹é¢è¿™ç§å†™æ³•ï¼š\n```\nconst [state, setState] = useState<string[]>([]);\n\nuseEffect(() => {\n  const loadData = async () => {\n    const lists = [\"list1\", \"list2\", \"list3\"];\n    for(const list of lists) {\n      const {data} = await thisIsPromise(list);\n      // HERE!\n      setState(prev => [...prev,...data])\n    }\n  };\n  // call async function \n  loadData(); \n},[])\n```\nReact æ–‡æ¡£ [è¿™éƒ¨åˆ†](https://reactjs.org/docs/hooks-reference.html#functional-updates) ä¹Ÿç‰¹åˆ«è¯´æ˜äº†è¿™ä¸€ç‚¹:\n> If the new state is computed using the previous state, you can pass a function to setState. The function will receive the previous value, and return an updated value.\n\n#### 2020/01/15\nä¸€ã€[ä¸€æ­¥ä¸€æ­¥è§£ç  PNG å›¾ç‰‡](https://vivaxyblog.github.io/2019/12/07/decode-a-png-image-with-javascript-cn.html)\nå¯ä»¥å½“æˆä¸€ä»½æ‰©å±•é˜…è¯»ï¼Œè®²äº†æ€ä¹ˆä»ä¸€å¼ äºŒè¿›åˆ¶ PNG å›¾ç‰‡è½¬æˆåŒ…å«åƒç´ æ•°æ®çš„ ImageData ã€‚\nä¹‹å‰åœ¨å·¥ä½œä¸­ï¼Œä¸»è¦æ˜¯åˆ©ç”¨ `canvas` å¾—åˆ° `imageData` ï¼š\n```\nexport function getImageData(url: string): Promise<ImageData> {\n  const img = document.createElement(\"img\");\n  return new Promise((resolve, reject) => {\n    img.onload = () => {\n      try {\n        const canvas = document.createElement(\"canvas\");\n        canvas.width = img.naturalWidth;\n        canvas.height = img.naturalHeight;\n        const ctx = canvas.getContext(\"2d\");\n        ctx.drawImage(img, 0, 0);\n        resolve(ctx.getImageData(0, 0, canvas.width, canvas.height));\n      } catch (err) {\n        reject(err);\n      }\n    };\n    img.onerror = err => {\n      reject(err);\n    };\n    img.crossOrigin = \"Anonymous\";\n    img.src = url;\n  });\n}\n```\n`imageData` æ˜¯ä¸èƒ½ç›´æ¥å­˜è¿›åå°æ•°æ®åº“çš„ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œ PNG ç¼–ç è½¬æ¢ä¸ºäºŒè¿›åˆ¶æ•°æ®ï¼Œç”¨åˆ°çš„æ˜¯ [UPNG.js](https://github.com/photopea/UPNG.js/) è¿™ä¸ªåº“ï¼š\n```\nimport UPNG from \"upng-js\";\nconst buffer: ArrayBuffer = UPNG.encode(\n  [imageData.buffer as ArrayBuffer],\n  image.width,\n  image.height,\n  0\n);\n```\n\n#### 2020/01/13\nä¸€ã€[3 things you didnâ€™t know about the forEach loop in JS](https://medium.com/front-end-weekly/3-things-you-didnt-know-about-the-foreach-loop-in-js-ff02cec465b1)\næ€»ç»“ä¸€ä¸‹ï¼Œå°±æ˜¯åœ¨ `forEach` ä¸­ï¼Œä½¿ç”¨ `return` ã€ `break` ã€ `continute` éƒ½æ˜¯æ— æ•ˆçš„ã€‚ `return` ä¸ä¼šé€€å‡ºå‡½æ•°ï¼Œ`break` å’Œ `continute` ä¸å…è®¸åœ¨ `forEach` ä¸­ä½¿ç”¨ã€‚å¦‚æœéœ€è¦èƒ½é€€å‡ºå¾ªç¯ï¼Œä½¿ç”¨ç®€å•çš„ `for` loop å³å¯ã€‚MDN ä¸Šå·²ç»å†™æ˜ï¼š\n> There is no way to stop or break a forEach() loop other than by throwing an exception. If you need such behavior, the forEach() method is the wrong tool.\n\näºŒã€[under_scores, camelCase and PascalCase - The three naming conventions every programmer should be aware of](https://dev.to/prahladyeri/underscores-camelcasing-and-pascalcasing-the-three-naming-conventions-every-programmer-should-be-aware-of-3aed)\nç®€å•ä»‹ç»äº†ç¼–ç¨‹ä¸­ä¸‰ç§å‘½åè§„åˆ™ï¼Œå¯ä»¥å­¦ä¸€ä¸‹æ­£ç¡®çš„åè¯è¡¨è¾¾ï¼š\n![image.png](https://i.loli.net/2020/01/13/kAnN3GvZBiWDPRu.png)\n`camelCase` å¤§å®¶éƒ½ä¸é™Œç”Ÿï¼Œå°±æ˜¯æœ€å¸¸è§çš„é¦–å­—æ¯å°å†™é©¼å³°æ ·å¼ï¼›`under_scores` å°±æ˜¯ä»¥ä¸‹åˆ’çº¿éš”å¼€å¤šä¸ªå°å†™å­—æ¯ï¼ŒJS ä¸­è¿™äº›å‘½åæ–¹å¼æ¯”è¾ƒå°‘ç”¨ï¼›`PascalCase` å°±æ˜¯é¦–å­—æ¯å¤§å†™é©¼å³°æ ·å¼ã€‚æ­¤å¤–ï¼Œå‡½æ•°ã€å˜é‡ã€ç±»ã€å‘½åç©ºé—´è¿™äº›å¯ä»¥ç»Ÿç§°ä¸º `tokens` ã€‚\n\n#### 2020/01/12\nä¸€ã€[Why ['1', '7', '11'].map(parseInt) returns [1, NaN, 3] in Javascript](https://medium.com/dailyjs/parseint-mystery-7c4368ef7b21)\nä¸€ç¯‡éå¸¸æœ‰è¶£çš„æ–‡ç« ï¼Œå¼€ç¯‡ä¸€å¼ å›¾ï¼š\n![image.png](https://i.loli.net/2020/01/12/grShLvH28RDXtYM.png)\nå‡ºç°è¿™ç§ç»“æœçš„åŸå› ï¼Œåœ¨äº `map` å‡½æ•°é»˜è®¤ä¼šä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼šcurrentValueã€currentIndex ä»¥åŠ full array ã€‚è€Œå¯¹äº `parseInt` è€Œè¨€ï¼Œç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºåŸºæ•°ï¼Œç”¨æ­¤æ¥è§£ææ•°ç»„ä¸­çš„æ¯ä¸ªå­—ç¬¦ä¸²ï¼Œå–å€¼æ˜¯ 2 ~ 36 çš„æ•´æ•°ã€‚'1' ä»¥ 0 ä¸ºåŸºæ•°è¿›è¡Œè§£æï¼Œ0 çš„å¸ƒå°”å€¼ä¸º `false`ï¼Œç­‰äºæ²¡æœ‰ä¼ å…¥ç¬¬äºŒä¸ªå‚æ•°ï¼Œå› æ­¤ä¼šä»¥é»˜è®¤åŸºæ•° 10 è¿›è¡Œè§£æï¼Œè¾“å‡º 1 ï¼›'7' ä»¥ 1 ä¸ºåŸºæ•° è¿›è¡Œè§£æï¼Œä¼šè¾“å‡º `NaN` ï¼›'11' ä»¥ 2 ä¸ºåŸºæ•°è§£æï¼Œä¼šè¾“å‡º 3ã€‚\n\näºŒã€[The Power of the Observer Pattern in JavaScript](https://medium.com/better-programming/the-observer-pattern-in-javascript-4f4e0b908d5e)\nä»‹ç»äº† Observer Pattenï¼Œå¹¶ç”¨ JS å†™äº†ä¸€ä»½ç®€å•å®ç°ã€‚æœ¬è´¨å°±æ˜¯ç»´æŠ¤ä¸€ä¸ªè§‚å¯Ÿè€…åˆ—è¡¨ï¼Œæ¯æ¬¡æœ‰å˜åŒ–æ—¶éå†é€šçŸ¥ã€‚\n\n#### 2020/01/09\nä¸€ã€[How to handle errors in Promise.all](https://stackoverflow.com/questions/30362733/handling-errors-in-promise-all/30378082)\nç®€å•æ¥è¯´å°±æ˜¯ï¼š\n```\nawait Promise.all(vals.map(val => \n  promise(val)\n  .catch(err => {\n    // handle here\n    return err\n  })\n))\n```\n\näºŒã€[New ES2018 Features](https://css-tricks.com/new-es2018-features-every-javascript-developer-should-know/)\n\n#### 2020/01/05\nä»Šå¤©éœ€è¦å¯¹æŸä¸ªæ•°å€¼è¿›è¡Œç±»å‹æ ¡éªŒï¼Œé¿å…å‡ºç° `NaN`ï¼Œæœ¬æ¥æ˜¯ç”¨ `!typeof value === 'number'`ï¼Œåæ¥å‘ç°ï¼š\n```\ntypeof NaN === 'number'\n```\nå…³äºä¸ºä»€ä¹ˆæ˜¯è¿™ç§è¾“å‡ºï¼Œå¯ä»¥çœ‹ medium ä¸Šè¿™ç¯‡æ–‡ç« ï¼š[NaN and typeof](https://javascriptrefined.io/nan-and-typeof-36cd6e2a4e43)ã€‚\nå¦‚æœéœ€è¦åˆ¤æ–­æŸä¸ªæ•°æ˜¯å¦ä¸º `NaN`ï¼Œå¯ç”¨ `isNaN(value)` åˆ¤æ–­ã€‚\n\n#### 2020/01/04\nä»Šå¤©åœ¨å¤„ç†æ­£åˆ™è¡¨è¾¾å¼æ—¶é‡åˆ°è¿™æ ·çš„ç–‘æƒ‘ï¼š\n```\nconst str = '\\abc';\nconst reg = /\\\\abc/;\nreg.test(str); // false\n```\næˆ‘ä»¬éƒ½çŸ¥é“åæ–œæ  `\\` æ˜¯è½¬ä¹‰çš„ä½œç”¨ï¼Œå¦‚æœè¦è¾“å‡ºæ–œæ ï¼Œé‚£ä¹ˆå¿…é¡»ä½¿ç”¨ `\\\\` ï¼›åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ`reg` åŒ¹é…æ˜¯æ˜¯ `\\abc` ï¼Œä¸ºä»€ä¹ˆè¾“å‡ºç»“æœä¼šæ˜¯ `false` å‘¢ï¼Ÿ\nç»è¿‡æŸ¥é˜…ï¼Œå‘ç°åœ¨å­—ç¬¦ä¸²ä¸­ï¼Œ'\\' ä¹Ÿæœ‰è½¬ä¹‰çš„ä½œç”¨ã€‚å¦‚æœåæ–œæ å‡ºç°åœ¨å­—ç¬¦çš„å‰é¢ï¼Œé‚£ä¹ˆä»–ä»¬å°±æ˜¯ä¸€ä¸ªæ•´ä½“ï¼Œæ¯”å¦‚è¯´ '\\n' è¡¨ç¤ºæ¢è¡Œï¼Œå­—ç¬¦ä¸² '\\abc' ä¹Ÿæ¶‰åŠè½¬ä¹‰æ“ä½œï¼Œç”±äº a ä¸æ˜¯æœ‰æ•ˆçš„è½¬ä¹‰ç¬¦ï¼Œæ‰€ä»¥å°±ç›´æ¥è½¬æˆ 'abc' ã€‚ä¸‹é¢çš„ä»£ç å¯ä»¥éªŒè¯è¿™ä¸ªè¯´æ³•ï¼š\n```\nconst str = \"\\abc\";\nconsole.info(str.length); // 3\n\"\\abc\" === \"abc\" //true\n```\nå› æ­¤ï¼Œä¸Šé¢çš„ä»£ç åº”è¯¥æ”¹æˆï¼š\n```\nconst str = '\\\\abc';\nconst reg = /\\\\abc/;\nreg.test(str); // true\n```\n\n#### 2020/01/02\næ”¾å¤§é¢„è§ˆå›¾ç‰‡çš„æŸä¸ªéƒ¨åˆ†ï¼šæ€è·¯æ˜¯è®¡ç®— bbox çš„ scale æ•°å€¼ï¼Œä½¿ä¹‹èƒ½å¡«å……æ»¡æ•´ä¸ª container ï¼›å†è®¡ç®—åŸå§‹å›¾ç‰‡çš„åç§»é‡ï¼Œä½¿ä¹‹åªæ˜¾ç¤º bbox éƒ¨åˆ†ã€‚    \n```\nfunction Preview(props: {\n  imgSrc: string;\n  imgSize: { width: number; height: number };\n  box: {\n    x: number;\n    y: number;\n    width: number;\n    height: number;\n  };\n}) {\n  const [containerSize] = useState({ width: 350, height: 400 });\n\n  const scale = Math.min(\n    containerSize.width / props.box.width,\n    containerSize.height / props.box.height\n  );\n  const boxCenter = {\n    x: props.box.x + props.box.width / 2,\n    y: props.box.y + props.box.height / 2\n  };\n  const containerCenter = {\n    x: containerSize.width / 2,\n    y: containerSize.height / 2\n  };\n  const tr = {\n    x: containerCenter.x - boxCenter.x * scale,\n    y: containerCenter.y - boxCenter.y * scale\n  };\n\n  return (\n    <div style={{ position: \"relative\", ...containerSize, overflow: \"hidden\" }}>\n      <img\n        src={props.imgSrc}\n        style={{\n          ...props.imgSize,\n          objectFit: \"contain\",\n          position: \"absolute\",\n          left: 0,\n          top: 0,\n          transform: `translate(${tr.x}px, ${tr.y}px) scale(${scale})`,\n          transformOrigin: \"top left\",\n          transition: \"all 0.3s\"\n        }}\n      />\n    </div>\n  );\n}\n```","source":"_posts/FrontEnd-Notes-2020-01.md","raw":"---\ntitle: 'FrontEnd Notes [2020.01]'\ncatalog: true\ndate: 2020-01-02 09:57:13\nsubtitle:\nheader-img:\ntags: FE\n---\n#### About\n\nğŸ“… 2020 å¹´ 1 æœˆçš„é›¶æ•£å­¦ä¹ è®°å½•ã€‚\n\næ–°å¹´å¿«ä¹ï¼å¸Œæœ›æ–°çš„ä¸€å¹´èƒ½åšæŒè®°ç¬”è®°ï¼\n\n#### 2020/01/29\nä»Šæ—¥é˜…è¯»ï¼š[Hereâ€™s Why Mapping a Constructed Array in JavaScript Doesnâ€™t Work](https://itnext.io/heres-why-mapping-a-constructed-array-doesn-t-work-in-javascript-f1195138615a)\nå½“æˆ‘ä»¬æƒ³è¦ç”Ÿæˆä¸€ä¸ª 0 ~ 99 çš„æ•°ç»„æ—¶ï¼Œé™¤äº†æœ€åŸºç¡€çš„éå†èµ‹å€¼ï¼Œè¿˜å¯ä»¥åˆ©ç”¨ [Array()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Array) æ–¹æ³•ã€‚\nä½†ä½¿ç”¨ `Array.map()` ï¼Œå¹¶ä¸ä¼šæ­£ç¡®èµ‹å€¼ï¼š\n```\nconst arr = Array(100).map((_, i) => i);\nconsole.log(arr[0] === undefined);  // true\n```\né€ æˆè¿™ä¸ªé—®é¢˜çš„åŸå› æ˜¯ï¼Œåœ¨ JS ä¸­ æ•°ç»„å…¶å®æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç´¢å¼•æ˜¯ `key` ï¼Œæ•°ç»„å…ƒç´ æ˜¯ `value` ï¼Œå¦‚ï¼š\n```\n['a', 'b', 'c']\n=> \n{\n  0: 'a',\n  1: 'b',\n  2: 'c',\n  length: 3\n}\n```\nå½“ä½¿ç”¨ `Array()` æ„é€ å‡½æ•°æ—¶ï¼Œåªä¼šç”Ÿæˆä¸€ä¸ªâ€œçœŸç©ºâ€å¯¹è±¡ï¼š\n```\n{\n  //no index keys!\n  length: 100\n}\n```\nç”±äºå¯¹è±¡ä¸Šå¹¶ä¸å­˜åœ¨ `key` ï¼Œ`map` å‡½æ•°å¹¶ä¸ä¼šè¿›è¡Œéå†ï¼Œ`reduce` ã€`filter` ã€`forEach` ç­‰è¿­ä»£å‡½æ•°ä¹Ÿæœ‰åŒæ ·çš„è¡¨ç°ã€‚è§£å†³åŠæ³•æ˜¯ä½¿ç”¨å±•å¼€æ“ä½œç¬¦ï¼š\n```\nconst arr = [...Array(100)].map((_, i) => i);\nconsole.log(arr[0]); // 0\n```\n\n#### 2020/01/28\nä»Šæ—¥é˜…è¯»ï¼š[How to Deep Copy Objects and Arrays in JavaScript](https://medium.com/javascript-in-plain-english/how-to-deep-copy-objects-and-arrays-in-javascript-7c911359b089)\nå¦‚æœæ•°ç»„/å¯¹è±¡ä¸­éƒ½æ˜¯ `primitive value` ï¼Œè¦å®ç°æ·±å¤åˆ¶ï¼Œå¸¸ç”¨çš„æœ‰ä¸‹é¢ä¸‰ç§æ–¹æ³•ï¼š\n1. spread operator ...\n```\nconst array = ['ğŸ˜‰','ğŸ˜Š','ğŸ˜‡']\n\nconst copyWithEquals = array // Changes to array will change copyWithEquals\nconsole.log(copyWithEquals === array) // true (The assignment operator did not make a copy)\n\nconst copyWithSpread = [...array] // Changes to array will not change copyWithSpread\nconsole.log(copyWithSpread === array) // false (The spread operator made a shallow copy)\n\narray[0] = 'ğŸ˜¡' // Whoops, a bug\n\nconsole.log(...array) // ğŸ˜¡ ğŸ˜Š ğŸ˜‡\nconsole.log(...copyWithEquals) // ğŸ˜¡ ğŸ˜Š ğŸ˜‡\nconsole.log(...copyWithSpread) // ğŸ˜‰ ğŸ˜Š ğŸ˜‡\n```\n2. .slice()\n```\nconst array = ['ğŸ˜‰','ğŸ˜Š','ğŸ˜‡']\n\nconst copyWithEquals = array // Changes to array will change copyWithEquals\nconsole.log(copyWithEquals === array) // true (The assignment operator did not make a copy)\n\nconst copyWithSlice = array.slice() // Changes to array will not change copyWithSlice\nconsole.log(copyWithSlice === array) // false (Using .slice() made a shallow copy of the array)\n\narray[0] = 'ğŸ˜¡' // Whoops, a bug\n\nconsole.log(...array) // ğŸ˜¡ ğŸ˜Š ğŸ˜‡\nconsole.log(...copyWithEquals) // ğŸ˜¡ ğŸ˜Š ğŸ˜‡\nconsole.log(...copyWithSlice) // ğŸ˜‰ ğŸ˜Š ğŸ˜‡\n```\n3. .assign()\n```\nconst array = ['ğŸ˜‰','ğŸ˜Š','ğŸ˜‡']\n\nconst copyWithEquals = array // Changes to array will change copyWithEquals\nconst copyWithAssign = [] // Changes to array will not change copyWithAssign\nObject.assign(copyWithAssign, array) // Object.assign(target, source)\n\narray[0] = 'ğŸ˜¡' // Whoops, a bug\n\nconsole.log(...array) // ğŸ˜¡ ğŸ˜Š ğŸ˜‡\nconsole.log(...copyWithEquals) // ğŸ˜¡ ğŸ˜Š ğŸ˜‡\nconsole.log(...copyWithAssign) // ğŸ˜‰ ğŸ˜Š ğŸ˜‡\n```\n\nå¦‚æœæ•°ç»„ä¸­çš„å…ƒç´ ä¹Ÿæ˜¯æ•°ç»„/å¯¹è±¡ï¼Œä¸Šè¿°æ–¹æ³•åªèƒ½å®ç°ç¬¬ä¸€å±‚æ¬¡ä½†æ·±å¤åˆ¶ï¼Œæ²¡æ³•å¯¹å…ƒç´ ä¹Ÿè¿›è¡Œæ·±å¤åˆ¶ã€‚ä½œè€…æä¾›äº†5ç§æ–¹æ³•ï¼š\n1. [lodash](https://lodash.com/)\n`lodash` æä¾›äº† `_.clone()` ä»¥åŠ `_.cloneDeep()` ä¸¤ä¸ªæ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªæ–¹æ³•å®ç°çš„æ˜¯ç¬¬ä¸€å±‚é¢çš„æ·±å¤åˆ¶ï¼Œç¬¬äºŒä¸ªæ–¹æ³•å¯ä»¥å®ç°å®Œå…¨çš„æ·±å¤åˆ¶ã€‚\n2. [Ramda](https://ramdajs.com/)\næä¾›äº† `R.clone()` æ–¹æ³•å®ç°å®Œå…¨çš„æ·±å¤åˆ¶ï¼Œç›¸å½“äº `lodash.cloneDeep()` ã€‚\n3. custom function\nå¯ä»¥è‡ªå·±å®ç°ä¸€ä¸ªæ·±å¤åˆ¶å‡½æ•°ï¼ŒåŸºæœ¬æ€æƒ³æ˜¯åˆ¤æ–­è¾“å…¥æ˜¯å¦ä¸ºæ•°ç»„/å¯¹è±¡ï¼Œå¦‚æœæ˜¯åˆ™ç»§ç»­é€å±‚éå†èµ‹å€¼ï¼Œå¦åˆ™è¿”å›åŸå§‹å€¼ã€‚è¿˜éœ€è€ƒè™‘å€¼ä¸º `null` çš„ç‰¹æ®Šæƒ…å†µï¼Œå› ä¸º `typeof null = \"object\"`\n```\nconst deepCopyFunction = inObject => {\n  let outObject, value, key;\n\n  if(typeof inObject !== \"object\" || inObject === null) {\n    return inObject;\n  };\n\n  outObject = Array.isArray(inObject) ? [] : {};\n\n  for(key in inObject) {\n    value = inObject[key];\n\n    outObject[key] = (typeof value === \"object\" && value !== null) ? deepCopyFunction(value) : value\n  };\n\n  return outObject;\n}\n```\n4. `JSON.parse(JSON.stringify(object))`\nè¯¥æ–¹æ³•å¯¹å…ƒç´ æœ‰ä¸€å®šçš„è¦æ±‚ï¼Œè¯¦è§ stackoverflow ä¸Š[è¿™ä¸ªå›ç­”](https://stackoverflow.com/questions/122102/what-is-the-most-efficient-way-to-deep-clone-an-object-in-javascript/122704#122704)ã€‚æ€»ç»“è€Œè¨€ï¼Œå¦‚æœå…ƒç´ åªæ˜¯æ™®é€šçš„æ•°ç»„å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ã€‚\n5. [rfdc](https://www.npmjs.com/package/rfdc)\nä½œè€…æƒ³è¦æ¨å¹¿çš„ä¸€ä¸ªåº“ï¼Œä¼˜ç‚¹æ˜¯é€Ÿåº¦å¾ˆå¿«ã€‚\n\n#### 2020/01/17\n[TypeScript: Conditional Types](https://www.typescriptlang.org/docs/handbook/advanced-types.html#conditional-types)\nè€ƒè™‘ä»¥ä¸‹åœºæ™¯ï¼šæˆ‘ä»¬æœ‰ä¸€ä¸ªè·å–èµ„æºçš„æ¥å£ï¼Œæ ¹æ®èµ„æºç±»å‹è¿”å›ä¸åŒçš„æ•°æ®ç±»å‹çš„æ•°æ®ï¼Œä»£ç å¤§è‡´å¦‚ä¸‹ï¼š  \n```\ngetResources<T>(type: \"tasks\"|\"jobs\"|\"queues\") {\n  return axios.get<T>('http://.......')\n}\n\n// use\nconst tasks = await getResources<TaskList>(\"tasks\")\nconst jobs = await getResources<JobList>(\"jobs\")\n```\nå¦‚æœæˆ‘ä»¬æƒ³è¦å¹¶è¡Œå‘é€è¯·æ±‚ï¼Œå¯ä»¥ä½¿ç”¨ `Promise.all()` ï¼š\n```\nconst [tasks, jobs] = await Promise.all([\"tasks\",\"jobs\"].map(type => {\n  return getResources<TaskList|JobList>(type)\n}))\n```\nä¸Šè¿°ä»£ç å¼•èµ·çš„é—®é¢˜æ˜¯ï¼Œ`tasks` å’Œ `jobs` çš„ç±»å‹ä¼šæ˜¯ `TaskList|JobList` ï¼Œå¦‚æœæˆ‘ä»¬ä¹‹åè¦è®¿é—®ä»–ä»¬çš„å±æ€§ï¼Œé¿å…ä¸äº† `as TaskList` ï¼Œ`as JobList` è¿™ç§å†™æ³•ã€‚ä¼˜åŒ–åšæ³•æ˜¯ï¼Œä½¿ç”¨ ts çš„ conditional typesï¼Œå¯ä»¥ä»è¾“å…¥ç±»å‹æ¨æ–­å‡ºè¾“å‡ºç±»å‹ï¼š\n```\nexport type ResType = \"tasks\" | \"jobs\" | \"queues\" ;\nexport type ResData<T extends ResType> = \n  T extends \"tasks\" ? TaskList: \n  T extends \"jobs\"  ? JobList : \n  T extends \"queues\" ? QueueList :\n  never;\n\ngetResources<T extends ResType>(type: T) {\n  return axios.get<ResData<T>>('http://.......')\n}\n```\nè¿™æ ·ï¼Œåœ¨è°ƒç”¨ `getResources` å°±ä¸ç”¨æ˜¾å¼ä¼ å…¥ `T` ã€‚æ¥ä¸‹æ¥ï¼Œä¸ºäº†è§£å†³ç±»å‹åœ¨ `Promise.all()` ç”¨ `map` å¯èƒ½æ¨æ–­ä¸å‡ºæ¥çš„é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ tuple ï¼š\n```\n// or just `getResources(\"tasks\")` if RV of getResources is already a promise\nconst taskPromise = Promise.resolve(getResources(\"tasks\"));\nconst jobPromise = Promise.resolve(getResources(\"jobs\"));\nconst [tasks, jobs] = await Promise.all([taskPromise,jobPromise])\n```\nä¸€é¡¿æ“ä½œä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å‡†ç¡®å¾—åˆ° `tasks` å’Œ `jobs` çš„ç±»å‹äº†ã€‚ğŸ˜ \næ‰©å±•é˜…è¯»ï¼š[Promise.resolve()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/resolve) ã€ [Promise.all()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/all)\n\n#### 2020/01/16\nä»Šæ—¥è¸©å‘è®°å½•ã€‚è€ƒè™‘ä»¥ä¸‹ä»£ç ï¼š\n```\nconst [state, setState] = useState<string[]>([]);\n\nuseEffect(() => {\n  const loadData = async () => {\n    const lists = [\"list1\", \"list2\", \"list3\"];\n    for(const list of lists) {\n      const {data} = await thisIsPromise(list);\n      setState([...state, ...data])\n    }\n  };\n  // call async function \n  loadData(); \n},[])\n```\nè¿è¡Œä¸Šé¢çš„ä»£ç ï¼Œ`state` å¹¶ä¸ä¼šè¿”å›æ‰€æœ‰ `list` çš„é›†åˆã€‚åŸå› æ˜¯ `setState` æ˜¯å¼‚æ­¥æ›´æ–°çš„ï¼Œæ¯æ¬¡å¾ªç¯è°ƒç”¨ `setState([...state, ...data])` æ—¶ï¼Œ `state` éƒ½æ˜¯åˆå§‹å€¼ï¼Œä¹Ÿå°±æ˜¯ç©ºæ•°ç»„ã€‚å¦‚æœæˆ‘ä»¬æƒ³è¦å¾—åˆ°ä¸Šä¸€ä¸ª `state` çš„å€¼ï¼Œåªèƒ½ä½¿ç”¨ä¸‹é¢è¿™ç§å†™æ³•ï¼š\n```\nconst [state, setState] = useState<string[]>([]);\n\nuseEffect(() => {\n  const loadData = async () => {\n    const lists = [\"list1\", \"list2\", \"list3\"];\n    for(const list of lists) {\n      const {data} = await thisIsPromise(list);\n      // HERE!\n      setState(prev => [...prev,...data])\n    }\n  };\n  // call async function \n  loadData(); \n},[])\n```\nReact æ–‡æ¡£ [è¿™éƒ¨åˆ†](https://reactjs.org/docs/hooks-reference.html#functional-updates) ä¹Ÿç‰¹åˆ«è¯´æ˜äº†è¿™ä¸€ç‚¹:\n> If the new state is computed using the previous state, you can pass a function to setState. The function will receive the previous value, and return an updated value.\n\n#### 2020/01/15\nä¸€ã€[ä¸€æ­¥ä¸€æ­¥è§£ç  PNG å›¾ç‰‡](https://vivaxyblog.github.io/2019/12/07/decode-a-png-image-with-javascript-cn.html)\nå¯ä»¥å½“æˆä¸€ä»½æ‰©å±•é˜…è¯»ï¼Œè®²äº†æ€ä¹ˆä»ä¸€å¼ äºŒè¿›åˆ¶ PNG å›¾ç‰‡è½¬æˆåŒ…å«åƒç´ æ•°æ®çš„ ImageData ã€‚\nä¹‹å‰åœ¨å·¥ä½œä¸­ï¼Œä¸»è¦æ˜¯åˆ©ç”¨ `canvas` å¾—åˆ° `imageData` ï¼š\n```\nexport function getImageData(url: string): Promise<ImageData> {\n  const img = document.createElement(\"img\");\n  return new Promise((resolve, reject) => {\n    img.onload = () => {\n      try {\n        const canvas = document.createElement(\"canvas\");\n        canvas.width = img.naturalWidth;\n        canvas.height = img.naturalHeight;\n        const ctx = canvas.getContext(\"2d\");\n        ctx.drawImage(img, 0, 0);\n        resolve(ctx.getImageData(0, 0, canvas.width, canvas.height));\n      } catch (err) {\n        reject(err);\n      }\n    };\n    img.onerror = err => {\n      reject(err);\n    };\n    img.crossOrigin = \"Anonymous\";\n    img.src = url;\n  });\n}\n```\n`imageData` æ˜¯ä¸èƒ½ç›´æ¥å­˜è¿›åå°æ•°æ®åº“çš„ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œ PNG ç¼–ç è½¬æ¢ä¸ºäºŒè¿›åˆ¶æ•°æ®ï¼Œç”¨åˆ°çš„æ˜¯ [UPNG.js](https://github.com/photopea/UPNG.js/) è¿™ä¸ªåº“ï¼š\n```\nimport UPNG from \"upng-js\";\nconst buffer: ArrayBuffer = UPNG.encode(\n  [imageData.buffer as ArrayBuffer],\n  image.width,\n  image.height,\n  0\n);\n```\n\n#### 2020/01/13\nä¸€ã€[3 things you didnâ€™t know about the forEach loop in JS](https://medium.com/front-end-weekly/3-things-you-didnt-know-about-the-foreach-loop-in-js-ff02cec465b1)\næ€»ç»“ä¸€ä¸‹ï¼Œå°±æ˜¯åœ¨ `forEach` ä¸­ï¼Œä½¿ç”¨ `return` ã€ `break` ã€ `continute` éƒ½æ˜¯æ— æ•ˆçš„ã€‚ `return` ä¸ä¼šé€€å‡ºå‡½æ•°ï¼Œ`break` å’Œ `continute` ä¸å…è®¸åœ¨ `forEach` ä¸­ä½¿ç”¨ã€‚å¦‚æœéœ€è¦èƒ½é€€å‡ºå¾ªç¯ï¼Œä½¿ç”¨ç®€å•çš„ `for` loop å³å¯ã€‚MDN ä¸Šå·²ç»å†™æ˜ï¼š\n> There is no way to stop or break a forEach() loop other than by throwing an exception. If you need such behavior, the forEach() method is the wrong tool.\n\näºŒã€[under_scores, camelCase and PascalCase - The three naming conventions every programmer should be aware of](https://dev.to/prahladyeri/underscores-camelcasing-and-pascalcasing-the-three-naming-conventions-every-programmer-should-be-aware-of-3aed)\nç®€å•ä»‹ç»äº†ç¼–ç¨‹ä¸­ä¸‰ç§å‘½åè§„åˆ™ï¼Œå¯ä»¥å­¦ä¸€ä¸‹æ­£ç¡®çš„åè¯è¡¨è¾¾ï¼š\n![image.png](https://i.loli.net/2020/01/13/kAnN3GvZBiWDPRu.png)\n`camelCase` å¤§å®¶éƒ½ä¸é™Œç”Ÿï¼Œå°±æ˜¯æœ€å¸¸è§çš„é¦–å­—æ¯å°å†™é©¼å³°æ ·å¼ï¼›`under_scores` å°±æ˜¯ä»¥ä¸‹åˆ’çº¿éš”å¼€å¤šä¸ªå°å†™å­—æ¯ï¼ŒJS ä¸­è¿™äº›å‘½åæ–¹å¼æ¯”è¾ƒå°‘ç”¨ï¼›`PascalCase` å°±æ˜¯é¦–å­—æ¯å¤§å†™é©¼å³°æ ·å¼ã€‚æ­¤å¤–ï¼Œå‡½æ•°ã€å˜é‡ã€ç±»ã€å‘½åç©ºé—´è¿™äº›å¯ä»¥ç»Ÿç§°ä¸º `tokens` ã€‚\n\n#### 2020/01/12\nä¸€ã€[Why ['1', '7', '11'].map(parseInt) returns [1, NaN, 3] in Javascript](https://medium.com/dailyjs/parseint-mystery-7c4368ef7b21)\nä¸€ç¯‡éå¸¸æœ‰è¶£çš„æ–‡ç« ï¼Œå¼€ç¯‡ä¸€å¼ å›¾ï¼š\n![image.png](https://i.loli.net/2020/01/12/grShLvH28RDXtYM.png)\nå‡ºç°è¿™ç§ç»“æœçš„åŸå› ï¼Œåœ¨äº `map` å‡½æ•°é»˜è®¤ä¼šä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼šcurrentValueã€currentIndex ä»¥åŠ full array ã€‚è€Œå¯¹äº `parseInt` è€Œè¨€ï¼Œç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºåŸºæ•°ï¼Œç”¨æ­¤æ¥è§£ææ•°ç»„ä¸­çš„æ¯ä¸ªå­—ç¬¦ä¸²ï¼Œå–å€¼æ˜¯ 2 ~ 36 çš„æ•´æ•°ã€‚'1' ä»¥ 0 ä¸ºåŸºæ•°è¿›è¡Œè§£æï¼Œ0 çš„å¸ƒå°”å€¼ä¸º `false`ï¼Œç­‰äºæ²¡æœ‰ä¼ å…¥ç¬¬äºŒä¸ªå‚æ•°ï¼Œå› æ­¤ä¼šä»¥é»˜è®¤åŸºæ•° 10 è¿›è¡Œè§£æï¼Œè¾“å‡º 1 ï¼›'7' ä»¥ 1 ä¸ºåŸºæ•° è¿›è¡Œè§£æï¼Œä¼šè¾“å‡º `NaN` ï¼›'11' ä»¥ 2 ä¸ºåŸºæ•°è§£æï¼Œä¼šè¾“å‡º 3ã€‚\n\näºŒã€[The Power of the Observer Pattern in JavaScript](https://medium.com/better-programming/the-observer-pattern-in-javascript-4f4e0b908d5e)\nä»‹ç»äº† Observer Pattenï¼Œå¹¶ç”¨ JS å†™äº†ä¸€ä»½ç®€å•å®ç°ã€‚æœ¬è´¨å°±æ˜¯ç»´æŠ¤ä¸€ä¸ªè§‚å¯Ÿè€…åˆ—è¡¨ï¼Œæ¯æ¬¡æœ‰å˜åŒ–æ—¶éå†é€šçŸ¥ã€‚\n\n#### 2020/01/09\nä¸€ã€[How to handle errors in Promise.all](https://stackoverflow.com/questions/30362733/handling-errors-in-promise-all/30378082)\nç®€å•æ¥è¯´å°±æ˜¯ï¼š\n```\nawait Promise.all(vals.map(val => \n  promise(val)\n  .catch(err => {\n    // handle here\n    return err\n  })\n))\n```\n\näºŒã€[New ES2018 Features](https://css-tricks.com/new-es2018-features-every-javascript-developer-should-know/)\n\n#### 2020/01/05\nä»Šå¤©éœ€è¦å¯¹æŸä¸ªæ•°å€¼è¿›è¡Œç±»å‹æ ¡éªŒï¼Œé¿å…å‡ºç° `NaN`ï¼Œæœ¬æ¥æ˜¯ç”¨ `!typeof value === 'number'`ï¼Œåæ¥å‘ç°ï¼š\n```\ntypeof NaN === 'number'\n```\nå…³äºä¸ºä»€ä¹ˆæ˜¯è¿™ç§è¾“å‡ºï¼Œå¯ä»¥çœ‹ medium ä¸Šè¿™ç¯‡æ–‡ç« ï¼š[NaN and typeof](https://javascriptrefined.io/nan-and-typeof-36cd6e2a4e43)ã€‚\nå¦‚æœéœ€è¦åˆ¤æ–­æŸä¸ªæ•°æ˜¯å¦ä¸º `NaN`ï¼Œå¯ç”¨ `isNaN(value)` åˆ¤æ–­ã€‚\n\n#### 2020/01/04\nä»Šå¤©åœ¨å¤„ç†æ­£åˆ™è¡¨è¾¾å¼æ—¶é‡åˆ°è¿™æ ·çš„ç–‘æƒ‘ï¼š\n```\nconst str = '\\abc';\nconst reg = /\\\\abc/;\nreg.test(str); // false\n```\næˆ‘ä»¬éƒ½çŸ¥é“åæ–œæ  `\\` æ˜¯è½¬ä¹‰çš„ä½œç”¨ï¼Œå¦‚æœè¦è¾“å‡ºæ–œæ ï¼Œé‚£ä¹ˆå¿…é¡»ä½¿ç”¨ `\\\\` ï¼›åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ`reg` åŒ¹é…æ˜¯æ˜¯ `\\abc` ï¼Œä¸ºä»€ä¹ˆè¾“å‡ºç»“æœä¼šæ˜¯ `false` å‘¢ï¼Ÿ\nç»è¿‡æŸ¥é˜…ï¼Œå‘ç°åœ¨å­—ç¬¦ä¸²ä¸­ï¼Œ'\\' ä¹Ÿæœ‰è½¬ä¹‰çš„ä½œç”¨ã€‚å¦‚æœåæ–œæ å‡ºç°åœ¨å­—ç¬¦çš„å‰é¢ï¼Œé‚£ä¹ˆä»–ä»¬å°±æ˜¯ä¸€ä¸ªæ•´ä½“ï¼Œæ¯”å¦‚è¯´ '\\n' è¡¨ç¤ºæ¢è¡Œï¼Œå­—ç¬¦ä¸² '\\abc' ä¹Ÿæ¶‰åŠè½¬ä¹‰æ“ä½œï¼Œç”±äº a ä¸æ˜¯æœ‰æ•ˆçš„è½¬ä¹‰ç¬¦ï¼Œæ‰€ä»¥å°±ç›´æ¥è½¬æˆ 'abc' ã€‚ä¸‹é¢çš„ä»£ç å¯ä»¥éªŒè¯è¿™ä¸ªè¯´æ³•ï¼š\n```\nconst str = \"\\abc\";\nconsole.info(str.length); // 3\n\"\\abc\" === \"abc\" //true\n```\nå› æ­¤ï¼Œä¸Šé¢çš„ä»£ç åº”è¯¥æ”¹æˆï¼š\n```\nconst str = '\\\\abc';\nconst reg = /\\\\abc/;\nreg.test(str); // true\n```\n\n#### 2020/01/02\næ”¾å¤§é¢„è§ˆå›¾ç‰‡çš„æŸä¸ªéƒ¨åˆ†ï¼šæ€è·¯æ˜¯è®¡ç®— bbox çš„ scale æ•°å€¼ï¼Œä½¿ä¹‹èƒ½å¡«å……æ»¡æ•´ä¸ª container ï¼›å†è®¡ç®—åŸå§‹å›¾ç‰‡çš„åç§»é‡ï¼Œä½¿ä¹‹åªæ˜¾ç¤º bbox éƒ¨åˆ†ã€‚    \n```\nfunction Preview(props: {\n  imgSrc: string;\n  imgSize: { width: number; height: number };\n  box: {\n    x: number;\n    y: number;\n    width: number;\n    height: number;\n  };\n}) {\n  const [containerSize] = useState({ width: 350, height: 400 });\n\n  const scale = Math.min(\n    containerSize.width / props.box.width,\n    containerSize.height / props.box.height\n  );\n  const boxCenter = {\n    x: props.box.x + props.box.width / 2,\n    y: props.box.y + props.box.height / 2\n  };\n  const containerCenter = {\n    x: containerSize.width / 2,\n    y: containerSize.height / 2\n  };\n  const tr = {\n    x: containerCenter.x - boxCenter.x * scale,\n    y: containerCenter.y - boxCenter.y * scale\n  };\n\n  return (\n    <div style={{ position: \"relative\", ...containerSize, overflow: \"hidden\" }}>\n      <img\n        src={props.imgSrc}\n        style={{\n          ...props.imgSize,\n          objectFit: \"contain\",\n          position: \"absolute\",\n          left: 0,\n          top: 0,\n          transform: `translate(${tr.x}px, ${tr.y}px) scale(${scale})`,\n          transformOrigin: \"top left\",\n          transition: \"all 0.3s\"\n        }}\n      />\n    </div>\n  );\n}\n```","slug":"FrontEnd-Notes-2020-01","published":1,"updated":"2020-01-28T06:04:45.218Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck6vknhf20008osueik478gy2","content":"<h4 id=\"about\">About</h4>\n<p>ğŸ“… 2020 å¹´ 1 æœˆçš„é›¶æ•£å­¦ä¹ è®°å½•ã€‚</p>\n<p>æ–°å¹´å¿«ä¹ï¼å¸Œæœ›æ–°çš„ä¸€å¹´èƒ½åšæŒè®°ç¬”è®°ï¼</p>\n<h4 id=\"20200129\">2020/01/29</h4>\n<p>ä»Šæ—¥é˜…è¯»ï¼š<a href=\"https://itnext.io/heres-why-mapping-a-constructed-array-doesn-t-work-in-javascript-f1195138615a\" target=\"_blank\" rel=\"noopener\">Hereâ€™s Why Mapping a Constructed Array in JavaScript Doesnâ€™t Work</a><br>\nå½“æˆ‘ä»¬æƒ³è¦ç”Ÿæˆä¸€ä¸ª 0 ~ 99 çš„æ•°ç»„æ—¶ï¼Œé™¤äº†æœ€åŸºç¡€çš„éå†èµ‹å€¼ï¼Œè¿˜å¯ä»¥åˆ©ç”¨ <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Array\" target=\"_blank\" rel=\"noopener\">Array()</a> æ–¹æ³•ã€‚<br>\nä½†ä½¿ç”¨ <code>Array.map()</code> ï¼Œå¹¶ä¸ä¼šæ­£ç¡®èµ‹å€¼ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const arr = Array(100).map((_, i) =&gt; i);</span><br><span class=\"line\">console.log(arr[0] === undefined);  // true</span><br></pre></td></tr></table></figure>\n<p>é€ æˆè¿™ä¸ªé—®é¢˜çš„åŸå› æ˜¯ï¼Œåœ¨ JS ä¸­ æ•°ç»„å…¶å®æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç´¢å¼•æ˜¯ <code>key</code> ï¼Œæ•°ç»„å…ƒç´ æ˜¯ <code>value</code> ï¼Œå¦‚ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[&apos;a&apos;, &apos;b&apos;, &apos;c&apos;]</span><br><span class=\"line\">=&gt; </span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  0: &apos;a&apos;,</span><br><span class=\"line\">  1: &apos;b&apos;,</span><br><span class=\"line\">  2: &apos;c&apos;,</span><br><span class=\"line\">  length: 3</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>å½“ä½¿ç”¨ <code>Array()</code> æ„é€ å‡½æ•°æ—¶ï¼Œåªä¼šç”Ÿæˆä¸€ä¸ªâ€œçœŸç©ºâ€å¯¹è±¡ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  //no index keys!</span><br><span class=\"line\">  length: 100</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ç”±äºå¯¹è±¡ä¸Šå¹¶ä¸å­˜åœ¨ <code>key</code> ï¼Œ<code>map</code> å‡½æ•°å¹¶ä¸ä¼šè¿›è¡Œéå†ï¼Œ<code>reduce</code> ã€<code>filter</code> ã€<code>forEach</code> ç­‰è¿­ä»£å‡½æ•°ä¹Ÿæœ‰åŒæ ·çš„è¡¨ç°ã€‚è§£å†³åŠæ³•æ˜¯ä½¿ç”¨å±•å¼€æ“ä½œç¬¦ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const arr = [...Array(100)].map((_, i) =&gt; i);</span><br><span class=\"line\">console.log(arr[0]); // 0</span><br></pre></td></tr></table></figure>\n<h4 id=\"20200128\">2020/01/28</h4>\n<p>ä»Šæ—¥é˜…è¯»ï¼š<a href=\"https://medium.com/javascript-in-plain-english/how-to-deep-copy-objects-and-arrays-in-javascript-7c911359b089\" target=\"_blank\" rel=\"noopener\">How to Deep Copy Objects and Arrays in JavaScript</a><br>\nå¦‚æœæ•°ç»„/å¯¹è±¡ä¸­éƒ½æ˜¯ <code>primitive value</code> ï¼Œè¦å®ç°æ·±å¤åˆ¶ï¼Œå¸¸ç”¨çš„æœ‰ä¸‹é¢ä¸‰ç§æ–¹æ³•ï¼š</p>\n<ol>\n<li>spread operator â€¦</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const array = [&apos;ğŸ˜‰&apos;,&apos;ğŸ˜Š&apos;,&apos;ğŸ˜‡&apos;]</span><br><span class=\"line\"></span><br><span class=\"line\">const copyWithEquals = array // Changes to array will change copyWithEquals</span><br><span class=\"line\">console.log(copyWithEquals === array) // true (The assignment operator did not make a copy)</span><br><span class=\"line\"></span><br><span class=\"line\">const copyWithSpread = [...array] // Changes to array will not change copyWithSpread</span><br><span class=\"line\">console.log(copyWithSpread === array) // false (The spread operator made a shallow copy)</span><br><span class=\"line\"></span><br><span class=\"line\">array[0] = &apos;ğŸ˜¡&apos; // Whoops, a bug</span><br><span class=\"line\"></span><br><span class=\"line\">console.log(...array) // ğŸ˜¡ ğŸ˜Š ğŸ˜‡</span><br><span class=\"line\">console.log(...copyWithEquals) // ğŸ˜¡ ğŸ˜Š ğŸ˜‡</span><br><span class=\"line\">console.log(...copyWithSpread) // ğŸ˜‰ ğŸ˜Š ğŸ˜‡</span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li>.slice()</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const array = [&apos;ğŸ˜‰&apos;,&apos;ğŸ˜Š&apos;,&apos;ğŸ˜‡&apos;]</span><br><span class=\"line\"></span><br><span class=\"line\">const copyWithEquals = array // Changes to array will change copyWithEquals</span><br><span class=\"line\">console.log(copyWithEquals === array) // true (The assignment operator did not make a copy)</span><br><span class=\"line\"></span><br><span class=\"line\">const copyWithSlice = array.slice() // Changes to array will not change copyWithSlice</span><br><span class=\"line\">console.log(copyWithSlice === array) // false (Using .slice() made a shallow copy of the array)</span><br><span class=\"line\"></span><br><span class=\"line\">array[0] = &apos;ğŸ˜¡&apos; // Whoops, a bug</span><br><span class=\"line\"></span><br><span class=\"line\">console.log(...array) // ğŸ˜¡ ğŸ˜Š ğŸ˜‡</span><br><span class=\"line\">console.log(...copyWithEquals) // ğŸ˜¡ ğŸ˜Š ğŸ˜‡</span><br><span class=\"line\">console.log(...copyWithSlice) // ğŸ˜‰ ğŸ˜Š ğŸ˜‡</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li>.assign()</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const array = [&apos;ğŸ˜‰&apos;,&apos;ğŸ˜Š&apos;,&apos;ğŸ˜‡&apos;]</span><br><span class=\"line\"></span><br><span class=\"line\">const copyWithEquals = array // Changes to array will change copyWithEquals</span><br><span class=\"line\">const copyWithAssign = [] // Changes to array will not change copyWithAssign</span><br><span class=\"line\">Object.assign(copyWithAssign, array) // Object.assign(target, source)</span><br><span class=\"line\"></span><br><span class=\"line\">array[0] = &apos;ğŸ˜¡&apos; // Whoops, a bug</span><br><span class=\"line\"></span><br><span class=\"line\">console.log(...array) // ğŸ˜¡ ğŸ˜Š ğŸ˜‡</span><br><span class=\"line\">console.log(...copyWithEquals) // ğŸ˜¡ ğŸ˜Š ğŸ˜‡</span><br><span class=\"line\">console.log(...copyWithAssign) // ğŸ˜‰ ğŸ˜Š ğŸ˜‡</span><br></pre></td></tr></table></figure>\n<p>å¦‚æœæ•°ç»„ä¸­çš„å…ƒç´ ä¹Ÿæ˜¯æ•°ç»„/å¯¹è±¡ï¼Œä¸Šè¿°æ–¹æ³•åªèƒ½å®ç°ç¬¬ä¸€å±‚æ¬¡ä½†æ·±å¤åˆ¶ï¼Œæ²¡æ³•å¯¹å…ƒç´ ä¹Ÿè¿›è¡Œæ·±å¤åˆ¶ã€‚ä½œè€…æä¾›äº†5ç§æ–¹æ³•ï¼š</p>\n<ol>\n<li><a href=\"https://lodash.com/\" target=\"_blank\" rel=\"noopener\">lodash</a><br>\n<code>lodash</code> æä¾›äº† <code>_.clone()</code> ä»¥åŠ <code>_.cloneDeep()</code> ä¸¤ä¸ªæ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªæ–¹æ³•å®ç°çš„æ˜¯ç¬¬ä¸€å±‚é¢çš„æ·±å¤åˆ¶ï¼Œç¬¬äºŒä¸ªæ–¹æ³•å¯ä»¥å®ç°å®Œå…¨çš„æ·±å¤åˆ¶ã€‚</li>\n<li><a href=\"https://ramdajs.com/\" target=\"_blank\" rel=\"noopener\">Ramda</a><br>\næä¾›äº† <code>R.clone()</code> æ–¹æ³•å®ç°å®Œå…¨çš„æ·±å¤åˆ¶ï¼Œç›¸å½“äº <code>lodash.cloneDeep()</code> ã€‚</li>\n<li>custom function<br>\nå¯ä»¥è‡ªå·±å®ç°ä¸€ä¸ªæ·±å¤åˆ¶å‡½æ•°ï¼ŒåŸºæœ¬æ€æƒ³æ˜¯åˆ¤æ–­è¾“å…¥æ˜¯å¦ä¸ºæ•°ç»„/å¯¹è±¡ï¼Œå¦‚æœæ˜¯åˆ™ç»§ç»­é€å±‚éå†èµ‹å€¼ï¼Œå¦åˆ™è¿”å›åŸå§‹å€¼ã€‚è¿˜éœ€è€ƒè™‘å€¼ä¸º <code>null</code> çš„ç‰¹æ®Šæƒ…å†µï¼Œå› ä¸º <code>typeof null = &quot;object&quot;</code></li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const deepCopyFunction = inObject =&gt; &#123;</span><br><span class=\"line\">  let outObject, value, key;</span><br><span class=\"line\"></span><br><span class=\"line\">  if(typeof inObject !== &quot;object&quot; || inObject === null) &#123;</span><br><span class=\"line\">    return inObject;</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">  outObject = Array.isArray(inObject) ? [] : &#123;&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">  for(key in inObject) &#123;</span><br><span class=\"line\">    value = inObject[key];</span><br><span class=\"line\"></span><br><span class=\"line\">    outObject[key] = (typeof value === &quot;object&quot; &amp;&amp; value !== null) ? deepCopyFunction(value) : value</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">  return outObject;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ol start=\"4\">\n<li><code>JSON.parse(JSON.stringify(object))</code><br>\nè¯¥æ–¹æ³•å¯¹å…ƒç´ æœ‰ä¸€å®šçš„è¦æ±‚ï¼Œè¯¦è§ stackoverflow ä¸Š<a href=\"https://stackoverflow.com/questions/122102/what-is-the-most-efficient-way-to-deep-clone-an-object-in-javascript/122704#122704\" target=\"_blank\" rel=\"noopener\">è¿™ä¸ªå›ç­”</a>ã€‚æ€»ç»“è€Œè¨€ï¼Œå¦‚æœå…ƒç´ åªæ˜¯æ™®é€šçš„æ•°ç»„å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ã€‚</li>\n<li><a href=\"https://www.npmjs.com/package/rfdc\" target=\"_blank\" rel=\"noopener\">rfdc</a><br>\nä½œè€…æƒ³è¦æ¨å¹¿çš„ä¸€ä¸ªåº“ï¼Œä¼˜ç‚¹æ˜¯é€Ÿåº¦å¾ˆå¿«ã€‚</li>\n</ol>\n<h4 id=\"20200117\">2020/01/17</h4>\n<p><a href=\"https://www.typescriptlang.org/docs/handbook/advanced-types.html#conditional-types\" target=\"_blank\" rel=\"noopener\">TypeScript: Conditional Types</a><br>\nè€ƒè™‘ä»¥ä¸‹åœºæ™¯ï¼šæˆ‘ä»¬æœ‰ä¸€ä¸ªè·å–èµ„æºçš„æ¥å£ï¼Œæ ¹æ®èµ„æºç±»å‹è¿”å›ä¸åŒçš„æ•°æ®ç±»å‹çš„æ•°æ®ï¼Œä»£ç å¤§è‡´å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">getResources&lt;T&gt;(type: &quot;tasks&quot;|&quot;jobs&quot;|&quot;queues&quot;) &#123;</span><br><span class=\"line\">  return axios.get&lt;T&gt;(&apos;http://.......&apos;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// use</span><br><span class=\"line\">const tasks = await getResources&lt;TaskList&gt;(&quot;tasks&quot;)</span><br><span class=\"line\">const jobs = await getResources&lt;JobList&gt;(&quot;jobs&quot;)</span><br></pre></td></tr></table></figure>\n<p>å¦‚æœæˆ‘ä»¬æƒ³è¦å¹¶è¡Œå‘é€è¯·æ±‚ï¼Œå¯ä»¥ä½¿ç”¨ <code>Promise.all()</code> ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const [tasks, jobs] = await Promise.all([&quot;tasks&quot;,&quot;jobs&quot;].map(type =&gt; &#123;</span><br><span class=\"line\">  return getResources&lt;TaskList|JobList&gt;(type)</span><br><span class=\"line\">&#125;))</span><br></pre></td></tr></table></figure>\n<p>ä¸Šè¿°ä»£ç å¼•èµ·çš„é—®é¢˜æ˜¯ï¼Œ<code>tasks</code> å’Œ <code>jobs</code> çš„ç±»å‹ä¼šæ˜¯ <code>TaskList|JobList</code> ï¼Œå¦‚æœæˆ‘ä»¬ä¹‹åè¦è®¿é—®ä»–ä»¬çš„å±æ€§ï¼Œé¿å…ä¸äº† <code>as TaskList</code> ï¼Œ<code>as JobList</code> è¿™ç§å†™æ³•ã€‚ä¼˜åŒ–åšæ³•æ˜¯ï¼Œä½¿ç”¨ ts çš„ conditional typesï¼Œå¯ä»¥ä»è¾“å…¥ç±»å‹æ¨æ–­å‡ºè¾“å‡ºç±»å‹ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">export type ResType = &quot;tasks&quot; | &quot;jobs&quot; | &quot;queues&quot; ;</span><br><span class=\"line\">export type ResData&lt;T extends ResType&gt; = </span><br><span class=\"line\">  T extends &quot;tasks&quot; ? TaskList: </span><br><span class=\"line\">  T extends &quot;jobs&quot;  ? JobList : </span><br><span class=\"line\">  T extends &quot;queues&quot; ? QueueList :</span><br><span class=\"line\">  never;</span><br><span class=\"line\"></span><br><span class=\"line\">getResources&lt;T extends ResType&gt;(type: T) &#123;</span><br><span class=\"line\">  return axios.get&lt;ResData&lt;T&gt;&gt;(&apos;http://.......&apos;)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>è¿™æ ·ï¼Œåœ¨è°ƒç”¨ <code>getResources</code> å°±ä¸ç”¨æ˜¾å¼ä¼ å…¥ <code>T</code> ã€‚æ¥ä¸‹æ¥ï¼Œä¸ºäº†è§£å†³ç±»å‹åœ¨ <code>Promise.all()</code> ç”¨ <code>map</code> å¯èƒ½æ¨æ–­ä¸å‡ºæ¥çš„é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ tuple ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// or just `getResources(&quot;tasks&quot;)` if RV of getResources is already a promise</span><br><span class=\"line\">const taskPromise = Promise.resolve(getResources(&quot;tasks&quot;));</span><br><span class=\"line\">const jobPromise = Promise.resolve(getResources(&quot;jobs&quot;));</span><br><span class=\"line\">const [tasks, jobs] = await Promise.all([taskPromise,jobPromise])</span><br></pre></td></tr></table></figure>\n<p>ä¸€é¡¿æ“ä½œä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å‡†ç¡®å¾—åˆ° <code>tasks</code> å’Œ <code>jobs</code> çš„ç±»å‹äº†ã€‚ğŸ˜<br>\næ‰©å±•é˜…è¯»ï¼š<a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/resolve\" target=\"_blank\" rel=\"noopener\">Promise.resolve()</a> ã€ <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/all\" target=\"_blank\" rel=\"noopener\">Promise.all()</a></p>\n<h4 id=\"20200116\">2020/01/16</h4>\n<p>ä»Šæ—¥è¸©å‘è®°å½•ã€‚è€ƒè™‘ä»¥ä¸‹ä»£ç ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const [state, setState] = useState&lt;string[]&gt;([]);</span><br><span class=\"line\"></span><br><span class=\"line\">useEffect(() =&gt; &#123;</span><br><span class=\"line\">  const loadData = async () =&gt; &#123;</span><br><span class=\"line\">    const lists = [&quot;list1&quot;, &quot;list2&quot;, &quot;list3&quot;];</span><br><span class=\"line\">    for(const list of lists) &#123;</span><br><span class=\"line\">      const &#123;data&#125; = await thisIsPromise(list);</span><br><span class=\"line\">      setState([...state, ...data])</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">  // call async function </span><br><span class=\"line\">  loadData(); </span><br><span class=\"line\">&#125;,[])</span><br></pre></td></tr></table></figure>\n<p>è¿è¡Œä¸Šé¢çš„ä»£ç ï¼Œ<code>state</code> å¹¶ä¸ä¼šè¿”å›æ‰€æœ‰ <code>list</code> çš„é›†åˆã€‚åŸå› æ˜¯ <code>setState</code> æ˜¯å¼‚æ­¥æ›´æ–°çš„ï¼Œæ¯æ¬¡å¾ªç¯è°ƒç”¨ <code>setState([...state, ...data])</code> æ—¶ï¼Œ <code>state</code> éƒ½æ˜¯åˆå§‹å€¼ï¼Œä¹Ÿå°±æ˜¯ç©ºæ•°ç»„ã€‚å¦‚æœæˆ‘ä»¬æƒ³è¦å¾—åˆ°ä¸Šä¸€ä¸ª <code>state</code> çš„å€¼ï¼Œåªèƒ½ä½¿ç”¨ä¸‹é¢è¿™ç§å†™æ³•ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const [state, setState] = useState&lt;string[]&gt;([]);</span><br><span class=\"line\"></span><br><span class=\"line\">useEffect(() =&gt; &#123;</span><br><span class=\"line\">  const loadData = async () =&gt; &#123;</span><br><span class=\"line\">    const lists = [&quot;list1&quot;, &quot;list2&quot;, &quot;list3&quot;];</span><br><span class=\"line\">    for(const list of lists) &#123;</span><br><span class=\"line\">      const &#123;data&#125; = await thisIsPromise(list);</span><br><span class=\"line\">      // HERE!</span><br><span class=\"line\">      setState(prev =&gt; [...prev,...data])</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">  // call async function </span><br><span class=\"line\">  loadData(); </span><br><span class=\"line\">&#125;,[])</span><br></pre></td></tr></table></figure>\n<p>React æ–‡æ¡£ <a href=\"https://reactjs.org/docs/hooks-reference.html#functional-updates\" target=\"_blank\" rel=\"noopener\">è¿™éƒ¨åˆ†</a> ä¹Ÿç‰¹åˆ«è¯´æ˜äº†è¿™ä¸€ç‚¹:</p>\n<blockquote>\n<p>If the new state is computed using the previous state, you can pass a function to setState. The function will receive the previous value, and return an updated value.</p>\n</blockquote>\n<h4 id=\"20200115\">2020/01/15</h4>\n<p>ä¸€ã€<a href=\"https://vivaxyblog.github.io/2019/12/07/decode-a-png-image-with-javascript-cn.html\" target=\"_blank\" rel=\"noopener\">ä¸€æ­¥ä¸€æ­¥è§£ç  PNG å›¾ç‰‡</a><br>\nå¯ä»¥å½“æˆä¸€ä»½æ‰©å±•é˜…è¯»ï¼Œè®²äº†æ€ä¹ˆä»ä¸€å¼ äºŒè¿›åˆ¶ PNG å›¾ç‰‡è½¬æˆåŒ…å«åƒç´ æ•°æ®çš„ ImageData ã€‚<br>\nä¹‹å‰åœ¨å·¥ä½œä¸­ï¼Œä¸»è¦æ˜¯åˆ©ç”¨ <code>canvas</code> å¾—åˆ° <code>imageData</code> ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">export function getImageData(url: string): Promise&lt;ImageData&gt; &#123;</span><br><span class=\"line\">  const img = document.createElement(&quot;img&quot;);</span><br><span class=\"line\">  return new Promise((resolve, reject) =&gt; &#123;</span><br><span class=\"line\">    img.onload = () =&gt; &#123;</span><br><span class=\"line\">      try &#123;</span><br><span class=\"line\">        const canvas = document.createElement(&quot;canvas&quot;);</span><br><span class=\"line\">        canvas.width = img.naturalWidth;</span><br><span class=\"line\">        canvas.height = img.naturalHeight;</span><br><span class=\"line\">        const ctx = canvas.getContext(&quot;2d&quot;);</span><br><span class=\"line\">        ctx.drawImage(img, 0, 0);</span><br><span class=\"line\">        resolve(ctx.getImageData(0, 0, canvas.width, canvas.height));</span><br><span class=\"line\">      &#125; catch (err) &#123;</span><br><span class=\"line\">        reject(err);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    img.onerror = err =&gt; &#123;</span><br><span class=\"line\">      reject(err);</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    img.crossOrigin = &quot;Anonymous&quot;;</span><br><span class=\"line\">    img.src = url;</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>imageData</code> æ˜¯ä¸èƒ½ç›´æ¥å­˜è¿›åå°æ•°æ®åº“çš„ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œ PNG ç¼–ç è½¬æ¢ä¸ºäºŒè¿›åˆ¶æ•°æ®ï¼Œç”¨åˆ°çš„æ˜¯ <a href=\"https://github.com/photopea/UPNG.js/\" target=\"_blank\" rel=\"noopener\">UPNG.js</a> è¿™ä¸ªåº“ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import UPNG from &quot;upng-js&quot;;</span><br><span class=\"line\">const buffer: ArrayBuffer = UPNG.encode(</span><br><span class=\"line\">  [imageData.buffer as ArrayBuffer],</span><br><span class=\"line\">  image.width,</span><br><span class=\"line\">  image.height,</span><br><span class=\"line\">  0</span><br><span class=\"line\">);</span><br></pre></td></tr></table></figure>\n<h4 id=\"20200113\">2020/01/13</h4>\n<p>ä¸€ã€<a href=\"https://medium.com/front-end-weekly/3-things-you-didnt-know-about-the-foreach-loop-in-js-ff02cec465b1\" target=\"_blank\" rel=\"noopener\">3 things you didnâ€™t know about the forEach loop in JS</a><br>\næ€»ç»“ä¸€ä¸‹ï¼Œå°±æ˜¯åœ¨ <code>forEach</code> ä¸­ï¼Œä½¿ç”¨ <code>return</code> ã€ <code>break</code> ã€ <code>continute</code> éƒ½æ˜¯æ— æ•ˆçš„ã€‚ <code>return</code> ä¸ä¼šé€€å‡ºå‡½æ•°ï¼Œ<code>break</code> å’Œ <code>continute</code> ä¸å…è®¸åœ¨ <code>forEach</code> ä¸­ä½¿ç”¨ã€‚å¦‚æœéœ€è¦èƒ½é€€å‡ºå¾ªç¯ï¼Œä½¿ç”¨ç®€å•çš„ <code>for</code> loop å³å¯ã€‚MDN ä¸Šå·²ç»å†™æ˜ï¼š</p>\n<blockquote>\n<p>There is no way to stop or break a forEach() loop other than by throwing an exception. If you need such behavior, the forEach() method is the wrong tool.</p>\n</blockquote>\n<p>äºŒã€<a href=\"https://dev.to/prahladyeri/underscores-camelcasing-and-pascalcasing-the-three-naming-conventions-every-programmer-should-be-aware-of-3aed\" target=\"_blank\" rel=\"noopener\">under_scores, camelCase and PascalCase - The three naming conventions every programmer should be aware of</a><br>\nç®€å•ä»‹ç»äº†ç¼–ç¨‹ä¸­ä¸‰ç§å‘½åè§„åˆ™ï¼Œå¯ä»¥å­¦ä¸€ä¸‹æ­£ç¡®çš„åè¯è¡¨è¾¾ï¼š<br>\n<img src=\"https://i.loli.net/2020/01/13/kAnN3GvZBiWDPRu.png\" alt=\"image.png\"><br>\n<code>camelCase</code> å¤§å®¶éƒ½ä¸é™Œç”Ÿï¼Œå°±æ˜¯æœ€å¸¸è§çš„é¦–å­—æ¯å°å†™é©¼å³°æ ·å¼ï¼›<code>under_scores</code> å°±æ˜¯ä»¥ä¸‹åˆ’çº¿éš”å¼€å¤šä¸ªå°å†™å­—æ¯ï¼ŒJS ä¸­è¿™äº›å‘½åæ–¹å¼æ¯”è¾ƒå°‘ç”¨ï¼›<code>PascalCase</code> å°±æ˜¯é¦–å­—æ¯å¤§å†™é©¼å³°æ ·å¼ã€‚æ­¤å¤–ï¼Œå‡½æ•°ã€å˜é‡ã€ç±»ã€å‘½åç©ºé—´è¿™äº›å¯ä»¥ç»Ÿç§°ä¸º <code>tokens</code> ã€‚</p>\n<h4 id=\"20200112\">2020/01/12</h4>\n<p>ä¸€ã€<a href=\"https://medium.com/dailyjs/parseint-mystery-7c4368ef7b21\" target=\"_blank\" rel=\"noopener\">Why [â€˜1â€™, â€˜7â€™, â€˜11â€™].map(parseInt) returns [1, NaN, 3] in Javascript</a><br>\nä¸€ç¯‡éå¸¸æœ‰è¶£çš„æ–‡ç« ï¼Œå¼€ç¯‡ä¸€å¼ å›¾ï¼š<br>\n<img src=\"https://i.loli.net/2020/01/12/grShLvH28RDXtYM.png\" alt=\"image.png\"><br>\nå‡ºç°è¿™ç§ç»“æœçš„åŸå› ï¼Œåœ¨äº <code>map</code> å‡½æ•°é»˜è®¤ä¼šä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼šcurrentValueã€currentIndex ä»¥åŠ full array ã€‚è€Œå¯¹äº <code>parseInt</code> è€Œè¨€ï¼Œç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºåŸºæ•°ï¼Œç”¨æ­¤æ¥è§£ææ•°ç»„ä¸­çš„æ¯ä¸ªå­—ç¬¦ä¸²ï¼Œå–å€¼æ˜¯ 2 ~ 36 çš„æ•´æ•°ã€‚â€˜1â€™ ä»¥ 0 ä¸ºåŸºæ•°è¿›è¡Œè§£æï¼Œ0 çš„å¸ƒå°”å€¼ä¸º <code>false</code>ï¼Œç­‰äºæ²¡æœ‰ä¼ å…¥ç¬¬äºŒä¸ªå‚æ•°ï¼Œå› æ­¤ä¼šä»¥é»˜è®¤åŸºæ•° 10 è¿›è¡Œè§£æï¼Œè¾“å‡º 1 ï¼›â€˜7â€™ ä»¥ 1 ä¸ºåŸºæ•° è¿›è¡Œè§£æï¼Œä¼šè¾“å‡º <code>NaN</code> ï¼›â€˜11â€™ ä»¥ 2 ä¸ºåŸºæ•°è§£æï¼Œä¼šè¾“å‡º 3ã€‚</p>\n<p>äºŒã€<a href=\"https://medium.com/better-programming/the-observer-pattern-in-javascript-4f4e0b908d5e\" target=\"_blank\" rel=\"noopener\">The Power of the Observer Pattern in JavaScript</a><br>\nä»‹ç»äº† Observer Pattenï¼Œå¹¶ç”¨ JS å†™äº†ä¸€ä»½ç®€å•å®ç°ã€‚æœ¬è´¨å°±æ˜¯ç»´æŠ¤ä¸€ä¸ªè§‚å¯Ÿè€…åˆ—è¡¨ï¼Œæ¯æ¬¡æœ‰å˜åŒ–æ—¶éå†é€šçŸ¥ã€‚</p>\n<h4 id=\"20200109\">2020/01/09</h4>\n<p>ä¸€ã€<a href=\"https://stackoverflow.com/questions/30362733/handling-errors-in-promise-all/30378082\" target=\"_blank\" rel=\"noopener\">How to handle errors in Promise.all</a><br>\nç®€å•æ¥è¯´å°±æ˜¯ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">await Promise.all(vals.map(val =&gt; </span><br><span class=\"line\">  promise(val)</span><br><span class=\"line\">  .catch(err =&gt; &#123;</span><br><span class=\"line\">    // handle here</span><br><span class=\"line\">    return err</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">))</span><br></pre></td></tr></table></figure>\n<p>äºŒã€<a href=\"https://css-tricks.com/new-es2018-features-every-javascript-developer-should-know/\" target=\"_blank\" rel=\"noopener\">New ES2018 Features</a></p>\n<h4 id=\"20200105\">2020/01/05</h4>\n<p>ä»Šå¤©éœ€è¦å¯¹æŸä¸ªæ•°å€¼è¿›è¡Œç±»å‹æ ¡éªŒï¼Œé¿å…å‡ºç° <code>NaN</code>ï¼Œæœ¬æ¥æ˜¯ç”¨ <code>!typeof value === 'number'</code>ï¼Œåæ¥å‘ç°ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">typeof NaN === &apos;number&apos;</span><br></pre></td></tr></table></figure>\n<p>å…³äºä¸ºä»€ä¹ˆæ˜¯è¿™ç§è¾“å‡ºï¼Œå¯ä»¥çœ‹ medium ä¸Šè¿™ç¯‡æ–‡ç« ï¼š<a href=\"https://javascriptrefined.io/nan-and-typeof-36cd6e2a4e43\" target=\"_blank\" rel=\"noopener\">NaN and typeof</a>ã€‚<br>\nå¦‚æœéœ€è¦åˆ¤æ–­æŸä¸ªæ•°æ˜¯å¦ä¸º <code>NaN</code>ï¼Œå¯ç”¨ <code>isNaN(value)</code> åˆ¤æ–­ã€‚</p>\n<h4 id=\"20200104\">2020/01/04</h4>\n<p>ä»Šå¤©åœ¨å¤„ç†æ­£åˆ™è¡¨è¾¾å¼æ—¶é‡åˆ°è¿™æ ·çš„ç–‘æƒ‘ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const str = &apos;\\abc&apos;;</span><br><span class=\"line\">const reg = /\\\\abc/;</span><br><span class=\"line\">reg.test(str); // false</span><br></pre></td></tr></table></figure>\n<p>æˆ‘ä»¬éƒ½çŸ¥é“åæ–œæ  <code>\\</code> æ˜¯è½¬ä¹‰çš„ä½œç”¨ï¼Œå¦‚æœè¦è¾“å‡ºæ–œæ ï¼Œé‚£ä¹ˆå¿…é¡»ä½¿ç”¨ <code>\\\\</code> ï¼›åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ<code>reg</code> åŒ¹é…æ˜¯æ˜¯ <code>\\abc</code> ï¼Œä¸ºä»€ä¹ˆè¾“å‡ºç»“æœä¼šæ˜¯ <code>false</code> å‘¢ï¼Ÿ<br>\nç»è¿‡æŸ¥é˜…ï¼Œå‘ç°åœ¨å­—ç¬¦ä¸²ä¸­ï¼Œâ€™â€™ ä¹Ÿæœ‰è½¬ä¹‰çš„ä½œç”¨ã€‚å¦‚æœåæ–œæ å‡ºç°åœ¨å­—ç¬¦çš„å‰é¢ï¼Œé‚£ä¹ˆä»–ä»¬å°±æ˜¯ä¸€ä¸ªæ•´ä½“ï¼Œæ¯”å¦‚è¯´ â€˜\\nâ€™ è¡¨ç¤ºæ¢è¡Œï¼Œå­—ç¬¦ä¸² â€˜\\abcâ€™ ä¹Ÿæ¶‰åŠè½¬ä¹‰æ“ä½œï¼Œç”±äº a ä¸æ˜¯æœ‰æ•ˆçš„è½¬ä¹‰ç¬¦ï¼Œæ‰€ä»¥å°±ç›´æ¥è½¬æˆ â€˜abcâ€™ ã€‚ä¸‹é¢çš„ä»£ç å¯ä»¥éªŒè¯è¿™ä¸ªè¯´æ³•ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const str = &quot;\\abc&quot;;</span><br><span class=\"line\">console.info(str.length); // 3</span><br><span class=\"line\">&quot;\\abc&quot; === &quot;abc&quot; //true</span><br></pre></td></tr></table></figure>\n<p>å› æ­¤ï¼Œä¸Šé¢çš„ä»£ç åº”è¯¥æ”¹æˆï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const str = &apos;\\\\abc&apos;;</span><br><span class=\"line\">const reg = /\\\\abc/;</span><br><span class=\"line\">reg.test(str); // true</span><br></pre></td></tr></table></figure>\n<h4 id=\"20200102\">2020/01/02</h4>\n<p>æ”¾å¤§é¢„è§ˆå›¾ç‰‡çš„æŸä¸ªéƒ¨åˆ†ï¼šæ€è·¯æ˜¯è®¡ç®— bbox çš„ scale æ•°å€¼ï¼Œä½¿ä¹‹èƒ½å¡«å……æ»¡æ•´ä¸ª container ï¼›å†è®¡ç®—åŸå§‹å›¾ç‰‡çš„åç§»é‡ï¼Œä½¿ä¹‹åªæ˜¾ç¤º bbox éƒ¨åˆ†ã€‚</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function Preview(props: &#123;</span><br><span class=\"line\">  imgSrc: string;</span><br><span class=\"line\">  imgSize: &#123; width: number; height: number &#125;;</span><br><span class=\"line\">  box: &#123;</span><br><span class=\"line\">    x: number;</span><br><span class=\"line\">    y: number;</span><br><span class=\"line\">    width: number;</span><br><span class=\"line\">    height: number;</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">&#125;) &#123;</span><br><span class=\"line\">  const [containerSize] = useState(&#123; width: 350, height: 400 &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">  const scale = Math.min(</span><br><span class=\"line\">    containerSize.width / props.box.width,</span><br><span class=\"line\">    containerSize.height / props.box.height</span><br><span class=\"line\">  );</span><br><span class=\"line\">  const boxCenter = &#123;</span><br><span class=\"line\">    x: props.box.x + props.box.width / 2,</span><br><span class=\"line\">    y: props.box.y + props.box.height / 2</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">  const containerCenter = &#123;</span><br><span class=\"line\">    x: containerSize.width / 2,</span><br><span class=\"line\">    y: containerSize.height / 2</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">  const tr = &#123;</span><br><span class=\"line\">    x: containerCenter.x - boxCenter.x * scale,</span><br><span class=\"line\">    y: containerCenter.y - boxCenter.y * scale</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">  return (</span><br><span class=\"line\">    &lt;div style=&#123;&#123; position: &quot;relative&quot;, ...containerSize, overflow: &quot;hidden&quot; &#125;&#125;&gt;</span><br><span class=\"line\">      &lt;img</span><br><span class=\"line\">        src=&#123;props.imgSrc&#125;</span><br><span class=\"line\">        style=&#123;&#123;</span><br><span class=\"line\">          ...props.imgSize,</span><br><span class=\"line\">          objectFit: &quot;contain&quot;,</span><br><span class=\"line\">          position: &quot;absolute&quot;,</span><br><span class=\"line\">          left: 0,</span><br><span class=\"line\">          top: 0,</span><br><span class=\"line\">          transform: `translate($&#123;tr.x&#125;px, $&#123;tr.y&#125;px) scale($&#123;scale&#125;)`,</span><br><span class=\"line\">          transformOrigin: &quot;top left&quot;,</span><br><span class=\"line\">          transition: &quot;all 0.3s&quot;</span><br><span class=\"line\">        &#125;&#125;</span><br><span class=\"line\">      /&gt;</span><br><span class=\"line\">    &lt;/div&gt;</span><br><span class=\"line\">  );</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h4>About</h4>\n<p>ğŸ“… 2020 å¹´ 1 æœˆçš„é›¶æ•£å­¦ä¹ è®°å½•ã€‚</p>\n<p>æ–°å¹´å¿«ä¹ï¼å¸Œæœ›æ–°çš„ä¸€å¹´èƒ½åšæŒè®°ç¬”è®°ï¼</p>\n<h4>2020/01/29</h4>\n<p>ä»Šæ—¥é˜…è¯»ï¼š<a href=\"https://itnext.io/heres-why-mapping-a-constructed-array-doesn-t-work-in-javascript-f1195138615a\" target=\"_blank\" rel=\"noopener\">Hereâ€™s Why Mapping a Constructed Array in JavaScript Doesnâ€™t Work</a><br>\nå½“æˆ‘ä»¬æƒ³è¦ç”Ÿæˆä¸€ä¸ª 0 ~ 99 çš„æ•°ç»„æ—¶ï¼Œé™¤äº†æœ€åŸºç¡€çš„éå†èµ‹å€¼ï¼Œè¿˜å¯ä»¥åˆ©ç”¨ <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Array\" target=\"_blank\" rel=\"noopener\">Array()</a> æ–¹æ³•ã€‚<br>\nä½†ä½¿ç”¨ <code>Array.map()</code> ï¼Œå¹¶ä¸ä¼šæ­£ç¡®èµ‹å€¼ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const arr = Array(100).map((_, i) =&gt; i);</span><br><span class=\"line\">console.log(arr[0] === undefined);  // true</span><br></pre></td></tr></table></figure>\n<p>é€ æˆè¿™ä¸ªé—®é¢˜çš„åŸå› æ˜¯ï¼Œåœ¨ JS ä¸­ æ•°ç»„å…¶å®æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç´¢å¼•æ˜¯ <code>key</code> ï¼Œæ•°ç»„å…ƒç´ æ˜¯ <code>value</code> ï¼Œå¦‚ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[&apos;a&apos;, &apos;b&apos;, &apos;c&apos;]</span><br><span class=\"line\">=&gt; </span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  0: &apos;a&apos;,</span><br><span class=\"line\">  1: &apos;b&apos;,</span><br><span class=\"line\">  2: &apos;c&apos;,</span><br><span class=\"line\">  length: 3</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>å½“ä½¿ç”¨ <code>Array()</code> æ„é€ å‡½æ•°æ—¶ï¼Œåªä¼šç”Ÿæˆä¸€ä¸ªâ€œçœŸç©ºâ€å¯¹è±¡ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  //no index keys!</span><br><span class=\"line\">  length: 100</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ç”±äºå¯¹è±¡ä¸Šå¹¶ä¸å­˜åœ¨ <code>key</code> ï¼Œ<code>map</code> å‡½æ•°å¹¶ä¸ä¼šè¿›è¡Œéå†ï¼Œ<code>reduce</code> ã€<code>filter</code> ã€<code>forEach</code> ç­‰è¿­ä»£å‡½æ•°ä¹Ÿæœ‰åŒæ ·çš„è¡¨ç°ã€‚è§£å†³åŠæ³•æ˜¯ä½¿ç”¨å±•å¼€æ“ä½œç¬¦ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const arr = [...Array(100)].map((_, i) =&gt; i);</span><br><span class=\"line\">console.log(arr[0]); // 0</span><br></pre></td></tr></table></figure>\n<h4>2020/01/28</h4>\n<p>ä»Šæ—¥é˜…è¯»ï¼š<a href=\"https://medium.com/javascript-in-plain-english/how-to-deep-copy-objects-and-arrays-in-javascript-7c911359b089\" target=\"_blank\" rel=\"noopener\">How to Deep Copy Objects and Arrays in JavaScript</a><br>\nå¦‚æœæ•°ç»„/å¯¹è±¡ä¸­éƒ½æ˜¯ <code>primitive value</code> ï¼Œè¦å®ç°æ·±å¤åˆ¶ï¼Œå¸¸ç”¨çš„æœ‰ä¸‹é¢ä¸‰ç§æ–¹æ³•ï¼š</p>\n<ol>\n<li>spread operator â€¦</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const array = [&apos;ğŸ˜‰&apos;,&apos;ğŸ˜Š&apos;,&apos;ğŸ˜‡&apos;]</span><br><span class=\"line\"></span><br><span class=\"line\">const copyWithEquals = array // Changes to array will change copyWithEquals</span><br><span class=\"line\">console.log(copyWithEquals === array) // true (The assignment operator did not make a copy)</span><br><span class=\"line\"></span><br><span class=\"line\">const copyWithSpread = [...array] // Changes to array will not change copyWithSpread</span><br><span class=\"line\">console.log(copyWithSpread === array) // false (The spread operator made a shallow copy)</span><br><span class=\"line\"></span><br><span class=\"line\">array[0] = &apos;ğŸ˜¡&apos; // Whoops, a bug</span><br><span class=\"line\"></span><br><span class=\"line\">console.log(...array) // ğŸ˜¡ ğŸ˜Š ğŸ˜‡</span><br><span class=\"line\">console.log(...copyWithEquals) // ğŸ˜¡ ğŸ˜Š ğŸ˜‡</span><br><span class=\"line\">console.log(...copyWithSpread) // ğŸ˜‰ ğŸ˜Š ğŸ˜‡</span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li>.slice()</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const array = [&apos;ğŸ˜‰&apos;,&apos;ğŸ˜Š&apos;,&apos;ğŸ˜‡&apos;]</span><br><span class=\"line\"></span><br><span class=\"line\">const copyWithEquals = array // Changes to array will change copyWithEquals</span><br><span class=\"line\">console.log(copyWithEquals === array) // true (The assignment operator did not make a copy)</span><br><span class=\"line\"></span><br><span class=\"line\">const copyWithSlice = array.slice() // Changes to array will not change copyWithSlice</span><br><span class=\"line\">console.log(copyWithSlice === array) // false (Using .slice() made a shallow copy of the array)</span><br><span class=\"line\"></span><br><span class=\"line\">array[0] = &apos;ğŸ˜¡&apos; // Whoops, a bug</span><br><span class=\"line\"></span><br><span class=\"line\">console.log(...array) // ğŸ˜¡ ğŸ˜Š ğŸ˜‡</span><br><span class=\"line\">console.log(...copyWithEquals) // ğŸ˜¡ ğŸ˜Š ğŸ˜‡</span><br><span class=\"line\">console.log(...copyWithSlice) // ğŸ˜‰ ğŸ˜Š ğŸ˜‡</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li>.assign()</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const array = [&apos;ğŸ˜‰&apos;,&apos;ğŸ˜Š&apos;,&apos;ğŸ˜‡&apos;]</span><br><span class=\"line\"></span><br><span class=\"line\">const copyWithEquals = array // Changes to array will change copyWithEquals</span><br><span class=\"line\">const copyWithAssign = [] // Changes to array will not change copyWithAssign</span><br><span class=\"line\">Object.assign(copyWithAssign, array) // Object.assign(target, source)</span><br><span class=\"line\"></span><br><span class=\"line\">array[0] = &apos;ğŸ˜¡&apos; // Whoops, a bug</span><br><span class=\"line\"></span><br><span class=\"line\">console.log(...array) // ğŸ˜¡ ğŸ˜Š ğŸ˜‡</span><br><span class=\"line\">console.log(...copyWithEquals) // ğŸ˜¡ ğŸ˜Š ğŸ˜‡</span><br><span class=\"line\">console.log(...copyWithAssign) // ğŸ˜‰ ğŸ˜Š ğŸ˜‡</span><br></pre></td></tr></table></figure>\n<p>å¦‚æœæ•°ç»„ä¸­çš„å…ƒç´ ä¹Ÿæ˜¯æ•°ç»„/å¯¹è±¡ï¼Œä¸Šè¿°æ–¹æ³•åªèƒ½å®ç°ç¬¬ä¸€å±‚æ¬¡ä½†æ·±å¤åˆ¶ï¼Œæ²¡æ³•å¯¹å…ƒç´ ä¹Ÿè¿›è¡Œæ·±å¤åˆ¶ã€‚ä½œè€…æä¾›äº†5ç§æ–¹æ³•ï¼š</p>\n<ol>\n<li><a href=\"https://lodash.com/\" target=\"_blank\" rel=\"noopener\">lodash</a><br>\n<code>lodash</code> æä¾›äº† <code>_.clone()</code> ä»¥åŠ <code>_.cloneDeep()</code> ä¸¤ä¸ªæ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªæ–¹æ³•å®ç°çš„æ˜¯ç¬¬ä¸€å±‚é¢çš„æ·±å¤åˆ¶ï¼Œç¬¬äºŒä¸ªæ–¹æ³•å¯ä»¥å®ç°å®Œå…¨çš„æ·±å¤åˆ¶ã€‚</li>\n<li><a href=\"https://ramdajs.com/\" target=\"_blank\" rel=\"noopener\">Ramda</a><br>\næä¾›äº† <code>R.clone()</code> æ–¹æ³•å®ç°å®Œå…¨çš„æ·±å¤åˆ¶ï¼Œç›¸å½“äº <code>lodash.cloneDeep()</code> ã€‚</li>\n<li>custom function<br>\nå¯ä»¥è‡ªå·±å®ç°ä¸€ä¸ªæ·±å¤åˆ¶å‡½æ•°ï¼ŒåŸºæœ¬æ€æƒ³æ˜¯åˆ¤æ–­è¾“å…¥æ˜¯å¦ä¸ºæ•°ç»„/å¯¹è±¡ï¼Œå¦‚æœæ˜¯åˆ™ç»§ç»­é€å±‚éå†èµ‹å€¼ï¼Œå¦åˆ™è¿”å›åŸå§‹å€¼ã€‚è¿˜éœ€è€ƒè™‘å€¼ä¸º <code>null</code> çš„ç‰¹æ®Šæƒ…å†µï¼Œå› ä¸º <code>typeof null = &quot;object&quot;</code></li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const deepCopyFunction = inObject =&gt; &#123;</span><br><span class=\"line\">  let outObject, value, key;</span><br><span class=\"line\"></span><br><span class=\"line\">  if(typeof inObject !== &quot;object&quot; || inObject === null) &#123;</span><br><span class=\"line\">    return inObject;</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">  outObject = Array.isArray(inObject) ? [] : &#123;&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">  for(key in inObject) &#123;</span><br><span class=\"line\">    value = inObject[key];</span><br><span class=\"line\"></span><br><span class=\"line\">    outObject[key] = (typeof value === &quot;object&quot; &amp;&amp; value !== null) ? deepCopyFunction(value) : value</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">  return outObject;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ol start=\"4\">\n<li><code>JSON.parse(JSON.stringify(object))</code><br>\nè¯¥æ–¹æ³•å¯¹å…ƒç´ æœ‰ä¸€å®šçš„è¦æ±‚ï¼Œè¯¦è§ stackoverflow ä¸Š<a href=\"https://stackoverflow.com/questions/122102/what-is-the-most-efficient-way-to-deep-clone-an-object-in-javascript/122704#122704\" target=\"_blank\" rel=\"noopener\">è¿™ä¸ªå›ç­”</a>ã€‚æ€»ç»“è€Œè¨€ï¼Œå¦‚æœå…ƒç´ åªæ˜¯æ™®é€šçš„æ•°ç»„å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ã€‚</li>\n<li><a href=\"https://www.npmjs.com/package/rfdc\" target=\"_blank\" rel=\"noopener\">rfdc</a><br>\nä½œè€…æƒ³è¦æ¨å¹¿çš„ä¸€ä¸ªåº“ï¼Œä¼˜ç‚¹æ˜¯é€Ÿåº¦å¾ˆå¿«ã€‚</li>\n</ol>\n<h4>2020/01/17</h4>\n<p><a href=\"https://www.typescriptlang.org/docs/handbook/advanced-types.html#conditional-types\" target=\"_blank\" rel=\"noopener\">TypeScript: Conditional Types</a><br>\nè€ƒè™‘ä»¥ä¸‹åœºæ™¯ï¼šæˆ‘ä»¬æœ‰ä¸€ä¸ªè·å–èµ„æºçš„æ¥å£ï¼Œæ ¹æ®èµ„æºç±»å‹è¿”å›ä¸åŒçš„æ•°æ®ç±»å‹çš„æ•°æ®ï¼Œä»£ç å¤§è‡´å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">getResources&lt;T&gt;(type: &quot;tasks&quot;|&quot;jobs&quot;|&quot;queues&quot;) &#123;</span><br><span class=\"line\">  return axios.get&lt;T&gt;(&apos;http://.......&apos;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// use</span><br><span class=\"line\">const tasks = await getResources&lt;TaskList&gt;(&quot;tasks&quot;)</span><br><span class=\"line\">const jobs = await getResources&lt;JobList&gt;(&quot;jobs&quot;)</span><br></pre></td></tr></table></figure>\n<p>å¦‚æœæˆ‘ä»¬æƒ³è¦å¹¶è¡Œå‘é€è¯·æ±‚ï¼Œå¯ä»¥ä½¿ç”¨ <code>Promise.all()</code> ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const [tasks, jobs] = await Promise.all([&quot;tasks&quot;,&quot;jobs&quot;].map(type =&gt; &#123;</span><br><span class=\"line\">  return getResources&lt;TaskList|JobList&gt;(type)</span><br><span class=\"line\">&#125;))</span><br></pre></td></tr></table></figure>\n<p>ä¸Šè¿°ä»£ç å¼•èµ·çš„é—®é¢˜æ˜¯ï¼Œ<code>tasks</code> å’Œ <code>jobs</code> çš„ç±»å‹ä¼šæ˜¯ <code>TaskList|JobList</code> ï¼Œå¦‚æœæˆ‘ä»¬ä¹‹åè¦è®¿é—®ä»–ä»¬çš„å±æ€§ï¼Œé¿å…ä¸äº† <code>as TaskList</code> ï¼Œ<code>as JobList</code> è¿™ç§å†™æ³•ã€‚ä¼˜åŒ–åšæ³•æ˜¯ï¼Œä½¿ç”¨ ts çš„ conditional typesï¼Œå¯ä»¥ä»è¾“å…¥ç±»å‹æ¨æ–­å‡ºè¾“å‡ºç±»å‹ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">export type ResType = &quot;tasks&quot; | &quot;jobs&quot; | &quot;queues&quot; ;</span><br><span class=\"line\">export type ResData&lt;T extends ResType&gt; = </span><br><span class=\"line\">  T extends &quot;tasks&quot; ? TaskList: </span><br><span class=\"line\">  T extends &quot;jobs&quot;  ? JobList : </span><br><span class=\"line\">  T extends &quot;queues&quot; ? QueueList :</span><br><span class=\"line\">  never;</span><br><span class=\"line\"></span><br><span class=\"line\">getResources&lt;T extends ResType&gt;(type: T) &#123;</span><br><span class=\"line\">  return axios.get&lt;ResData&lt;T&gt;&gt;(&apos;http://.......&apos;)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>è¿™æ ·ï¼Œåœ¨è°ƒç”¨ <code>getResources</code> å°±ä¸ç”¨æ˜¾å¼ä¼ å…¥ <code>T</code> ã€‚æ¥ä¸‹æ¥ï¼Œä¸ºäº†è§£å†³ç±»å‹åœ¨ <code>Promise.all()</code> ç”¨ <code>map</code> å¯èƒ½æ¨æ–­ä¸å‡ºæ¥çš„é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ tuple ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// or just `getResources(&quot;tasks&quot;)` if RV of getResources is already a promise</span><br><span class=\"line\">const taskPromise = Promise.resolve(getResources(&quot;tasks&quot;));</span><br><span class=\"line\">const jobPromise = Promise.resolve(getResources(&quot;jobs&quot;));</span><br><span class=\"line\">const [tasks, jobs] = await Promise.all([taskPromise,jobPromise])</span><br></pre></td></tr></table></figure>\n<p>ä¸€é¡¿æ“ä½œä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å‡†ç¡®å¾—åˆ° <code>tasks</code> å’Œ <code>jobs</code> çš„ç±»å‹äº†ã€‚ğŸ˜<br>\næ‰©å±•é˜…è¯»ï¼š<a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/resolve\" target=\"_blank\" rel=\"noopener\">Promise.resolve()</a> ã€ <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/all\" target=\"_blank\" rel=\"noopener\">Promise.all()</a></p>\n<h4>2020/01/16</h4>\n<p>ä»Šæ—¥è¸©å‘è®°å½•ã€‚è€ƒè™‘ä»¥ä¸‹ä»£ç ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const [state, setState] = useState&lt;string[]&gt;([]);</span><br><span class=\"line\"></span><br><span class=\"line\">useEffect(() =&gt; &#123;</span><br><span class=\"line\">  const loadData = async () =&gt; &#123;</span><br><span class=\"line\">    const lists = [&quot;list1&quot;, &quot;list2&quot;, &quot;list3&quot;];</span><br><span class=\"line\">    for(const list of lists) &#123;</span><br><span class=\"line\">      const &#123;data&#125; = await thisIsPromise(list);</span><br><span class=\"line\">      setState([...state, ...data])</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">  // call async function </span><br><span class=\"line\">  loadData(); </span><br><span class=\"line\">&#125;,[])</span><br></pre></td></tr></table></figure>\n<p>è¿è¡Œä¸Šé¢çš„ä»£ç ï¼Œ<code>state</code> å¹¶ä¸ä¼šè¿”å›æ‰€æœ‰ <code>list</code> çš„é›†åˆã€‚åŸå› æ˜¯ <code>setState</code> æ˜¯å¼‚æ­¥æ›´æ–°çš„ï¼Œæ¯æ¬¡å¾ªç¯è°ƒç”¨ <code>setState([...state, ...data])</code> æ—¶ï¼Œ <code>state</code> éƒ½æ˜¯åˆå§‹å€¼ï¼Œä¹Ÿå°±æ˜¯ç©ºæ•°ç»„ã€‚å¦‚æœæˆ‘ä»¬æƒ³è¦å¾—åˆ°ä¸Šä¸€ä¸ª <code>state</code> çš„å€¼ï¼Œåªèƒ½ä½¿ç”¨ä¸‹é¢è¿™ç§å†™æ³•ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const [state, setState] = useState&lt;string[]&gt;([]);</span><br><span class=\"line\"></span><br><span class=\"line\">useEffect(() =&gt; &#123;</span><br><span class=\"line\">  const loadData = async () =&gt; &#123;</span><br><span class=\"line\">    const lists = [&quot;list1&quot;, &quot;list2&quot;, &quot;list3&quot;];</span><br><span class=\"line\">    for(const list of lists) &#123;</span><br><span class=\"line\">      const &#123;data&#125; = await thisIsPromise(list);</span><br><span class=\"line\">      // HERE!</span><br><span class=\"line\">      setState(prev =&gt; [...prev,...data])</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">  // call async function </span><br><span class=\"line\">  loadData(); </span><br><span class=\"line\">&#125;,[])</span><br></pre></td></tr></table></figure>\n<p>React æ–‡æ¡£ <a href=\"https://reactjs.org/docs/hooks-reference.html#functional-updates\" target=\"_blank\" rel=\"noopener\">è¿™éƒ¨åˆ†</a> ä¹Ÿç‰¹åˆ«è¯´æ˜äº†è¿™ä¸€ç‚¹:</p>\n<blockquote>\n<p>If the new state is computed using the previous state, you can pass a function to setState. The function will receive the previous value, and return an updated value.</p>\n</blockquote>\n<h4>2020/01/15</h4>\n<p>ä¸€ã€<a href=\"https://vivaxyblog.github.io/2019/12/07/decode-a-png-image-with-javascript-cn.html\" target=\"_blank\" rel=\"noopener\">ä¸€æ­¥ä¸€æ­¥è§£ç  PNG å›¾ç‰‡</a><br>\nå¯ä»¥å½“æˆä¸€ä»½æ‰©å±•é˜…è¯»ï¼Œè®²äº†æ€ä¹ˆä»ä¸€å¼ äºŒè¿›åˆ¶ PNG å›¾ç‰‡è½¬æˆåŒ…å«åƒç´ æ•°æ®çš„ ImageData ã€‚<br>\nä¹‹å‰åœ¨å·¥ä½œä¸­ï¼Œä¸»è¦æ˜¯åˆ©ç”¨ <code>canvas</code> å¾—åˆ° <code>imageData</code> ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">export function getImageData(url: string): Promise&lt;ImageData&gt; &#123;</span><br><span class=\"line\">  const img = document.createElement(&quot;img&quot;);</span><br><span class=\"line\">  return new Promise((resolve, reject) =&gt; &#123;</span><br><span class=\"line\">    img.onload = () =&gt; &#123;</span><br><span class=\"line\">      try &#123;</span><br><span class=\"line\">        const canvas = document.createElement(&quot;canvas&quot;);</span><br><span class=\"line\">        canvas.width = img.naturalWidth;</span><br><span class=\"line\">        canvas.height = img.naturalHeight;</span><br><span class=\"line\">        const ctx = canvas.getContext(&quot;2d&quot;);</span><br><span class=\"line\">        ctx.drawImage(img, 0, 0);</span><br><span class=\"line\">        resolve(ctx.getImageData(0, 0, canvas.width, canvas.height));</span><br><span class=\"line\">      &#125; catch (err) &#123;</span><br><span class=\"line\">        reject(err);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    img.onerror = err =&gt; &#123;</span><br><span class=\"line\">      reject(err);</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    img.crossOrigin = &quot;Anonymous&quot;;</span><br><span class=\"line\">    img.src = url;</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>imageData</code> æ˜¯ä¸èƒ½ç›´æ¥å­˜è¿›åå°æ•°æ®åº“çš„ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œ PNG ç¼–ç è½¬æ¢ä¸ºäºŒè¿›åˆ¶æ•°æ®ï¼Œç”¨åˆ°çš„æ˜¯ <a href=\"https://github.com/photopea/UPNG.js/\" target=\"_blank\" rel=\"noopener\">UPNG.js</a> è¿™ä¸ªåº“ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import UPNG from &quot;upng-js&quot;;</span><br><span class=\"line\">const buffer: ArrayBuffer = UPNG.encode(</span><br><span class=\"line\">  [imageData.buffer as ArrayBuffer],</span><br><span class=\"line\">  image.width,</span><br><span class=\"line\">  image.height,</span><br><span class=\"line\">  0</span><br><span class=\"line\">);</span><br></pre></td></tr></table></figure>\n<h4>2020/01/13</h4>\n<p>ä¸€ã€<a href=\"https://medium.com/front-end-weekly/3-things-you-didnt-know-about-the-foreach-loop-in-js-ff02cec465b1\" target=\"_blank\" rel=\"noopener\">3 things you didnâ€™t know about the forEach loop in JS</a><br>\næ€»ç»“ä¸€ä¸‹ï¼Œå°±æ˜¯åœ¨ <code>forEach</code> ä¸­ï¼Œä½¿ç”¨ <code>return</code> ã€ <code>break</code> ã€ <code>continute</code> éƒ½æ˜¯æ— æ•ˆçš„ã€‚ <code>return</code> ä¸ä¼šé€€å‡ºå‡½æ•°ï¼Œ<code>break</code> å’Œ <code>continute</code> ä¸å…è®¸åœ¨ <code>forEach</code> ä¸­ä½¿ç”¨ã€‚å¦‚æœéœ€è¦èƒ½é€€å‡ºå¾ªç¯ï¼Œä½¿ç”¨ç®€å•çš„ <code>for</code> loop å³å¯ã€‚MDN ä¸Šå·²ç»å†™æ˜ï¼š</p>\n<blockquote>\n<p>There is no way to stop or break a forEach() loop other than by throwing an exception. If you need such behavior, the forEach() method is the wrong tool.</p>\n</blockquote>\n<p>äºŒã€<a href=\"https://dev.to/prahladyeri/underscores-camelcasing-and-pascalcasing-the-three-naming-conventions-every-programmer-should-be-aware-of-3aed\" target=\"_blank\" rel=\"noopener\">under_scores, camelCase and PascalCase - The three naming conventions every programmer should be aware of</a><br>\nç®€å•ä»‹ç»äº†ç¼–ç¨‹ä¸­ä¸‰ç§å‘½åè§„åˆ™ï¼Œå¯ä»¥å­¦ä¸€ä¸‹æ­£ç¡®çš„åè¯è¡¨è¾¾ï¼š<br>\n<img src=\"https://i.loli.net/2020/01/13/kAnN3GvZBiWDPRu.png\" alt=\"image.png\"><br>\n<code>camelCase</code> å¤§å®¶éƒ½ä¸é™Œç”Ÿï¼Œå°±æ˜¯æœ€å¸¸è§çš„é¦–å­—æ¯å°å†™é©¼å³°æ ·å¼ï¼›<code>under_scores</code> å°±æ˜¯ä»¥ä¸‹åˆ’çº¿éš”å¼€å¤šä¸ªå°å†™å­—æ¯ï¼ŒJS ä¸­è¿™äº›å‘½åæ–¹å¼æ¯”è¾ƒå°‘ç”¨ï¼›<code>PascalCase</code> å°±æ˜¯é¦–å­—æ¯å¤§å†™é©¼å³°æ ·å¼ã€‚æ­¤å¤–ï¼Œå‡½æ•°ã€å˜é‡ã€ç±»ã€å‘½åç©ºé—´è¿™äº›å¯ä»¥ç»Ÿç§°ä¸º <code>tokens</code> ã€‚</p>\n<h4>2020/01/12</h4>\n<p>ä¸€ã€<a href=\"https://medium.com/dailyjs/parseint-mystery-7c4368ef7b21\" target=\"_blank\" rel=\"noopener\">Why [â€˜1â€™, â€˜7â€™, â€˜11â€™].map(parseInt) returns [1, NaN, 3] in Javascript</a><br>\nä¸€ç¯‡éå¸¸æœ‰è¶£çš„æ–‡ç« ï¼Œå¼€ç¯‡ä¸€å¼ å›¾ï¼š<br>\n<img src=\"https://i.loli.net/2020/01/12/grShLvH28RDXtYM.png\" alt=\"image.png\"><br>\nå‡ºç°è¿™ç§ç»“æœçš„åŸå› ï¼Œåœ¨äº <code>map</code> å‡½æ•°é»˜è®¤ä¼šä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼šcurrentValueã€currentIndex ä»¥åŠ full array ã€‚è€Œå¯¹äº <code>parseInt</code> è€Œè¨€ï¼Œç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºåŸºæ•°ï¼Œç”¨æ­¤æ¥è§£ææ•°ç»„ä¸­çš„æ¯ä¸ªå­—ç¬¦ä¸²ï¼Œå–å€¼æ˜¯ 2 ~ 36 çš„æ•´æ•°ã€‚â€˜1â€™ ä»¥ 0 ä¸ºåŸºæ•°è¿›è¡Œè§£æï¼Œ0 çš„å¸ƒå°”å€¼ä¸º <code>false</code>ï¼Œç­‰äºæ²¡æœ‰ä¼ å…¥ç¬¬äºŒä¸ªå‚æ•°ï¼Œå› æ­¤ä¼šä»¥é»˜è®¤åŸºæ•° 10 è¿›è¡Œè§£æï¼Œè¾“å‡º 1 ï¼›â€˜7â€™ ä»¥ 1 ä¸ºåŸºæ•° è¿›è¡Œè§£æï¼Œä¼šè¾“å‡º <code>NaN</code> ï¼›â€˜11â€™ ä»¥ 2 ä¸ºåŸºæ•°è§£æï¼Œä¼šè¾“å‡º 3ã€‚</p>\n<p>äºŒã€<a href=\"https://medium.com/better-programming/the-observer-pattern-in-javascript-4f4e0b908d5e\" target=\"_blank\" rel=\"noopener\">The Power of the Observer Pattern in JavaScript</a><br>\nä»‹ç»äº† Observer Pattenï¼Œå¹¶ç”¨ JS å†™äº†ä¸€ä»½ç®€å•å®ç°ã€‚æœ¬è´¨å°±æ˜¯ç»´æŠ¤ä¸€ä¸ªè§‚å¯Ÿè€…åˆ—è¡¨ï¼Œæ¯æ¬¡æœ‰å˜åŒ–æ—¶éå†é€šçŸ¥ã€‚</p>\n<h4>2020/01/09</h4>\n<p>ä¸€ã€<a href=\"https://stackoverflow.com/questions/30362733/handling-errors-in-promise-all/30378082\" target=\"_blank\" rel=\"noopener\">How to handle errors in Promise.all</a><br>\nç®€å•æ¥è¯´å°±æ˜¯ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">await Promise.all(vals.map(val =&gt; </span><br><span class=\"line\">  promise(val)</span><br><span class=\"line\">  .catch(err =&gt; &#123;</span><br><span class=\"line\">    // handle here</span><br><span class=\"line\">    return err</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">))</span><br></pre></td></tr></table></figure>\n<p>äºŒã€<a href=\"https://css-tricks.com/new-es2018-features-every-javascript-developer-should-know/\" target=\"_blank\" rel=\"noopener\">New ES2018 Features</a></p>\n<h4>2020/01/05</h4>\n<p>ä»Šå¤©éœ€è¦å¯¹æŸä¸ªæ•°å€¼è¿›è¡Œç±»å‹æ ¡éªŒï¼Œé¿å…å‡ºç° <code>NaN</code>ï¼Œæœ¬æ¥æ˜¯ç”¨ <code>!typeof value === 'number'</code>ï¼Œåæ¥å‘ç°ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">typeof NaN === &apos;number&apos;</span><br></pre></td></tr></table></figure>\n<p>å…³äºä¸ºä»€ä¹ˆæ˜¯è¿™ç§è¾“å‡ºï¼Œå¯ä»¥çœ‹ medium ä¸Šè¿™ç¯‡æ–‡ç« ï¼š<a href=\"https://javascriptrefined.io/nan-and-typeof-36cd6e2a4e43\" target=\"_blank\" rel=\"noopener\">NaN and typeof</a>ã€‚<br>\nå¦‚æœéœ€è¦åˆ¤æ–­æŸä¸ªæ•°æ˜¯å¦ä¸º <code>NaN</code>ï¼Œå¯ç”¨ <code>isNaN(value)</code> åˆ¤æ–­ã€‚</p>\n<h4>2020/01/04</h4>\n<p>ä»Šå¤©åœ¨å¤„ç†æ­£åˆ™è¡¨è¾¾å¼æ—¶é‡åˆ°è¿™æ ·çš„ç–‘æƒ‘ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const str = &apos;\\abc&apos;;</span><br><span class=\"line\">const reg = /\\\\abc/;</span><br><span class=\"line\">reg.test(str); // false</span><br></pre></td></tr></table></figure>\n<p>æˆ‘ä»¬éƒ½çŸ¥é“åæ–œæ  <code>\\</code> æ˜¯è½¬ä¹‰çš„ä½œç”¨ï¼Œå¦‚æœè¦è¾“å‡ºæ–œæ ï¼Œé‚£ä¹ˆå¿…é¡»ä½¿ç”¨ <code>\\\\</code> ï¼›åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ<code>reg</code> åŒ¹é…æ˜¯æ˜¯ <code>\\abc</code> ï¼Œä¸ºä»€ä¹ˆè¾“å‡ºç»“æœä¼šæ˜¯ <code>false</code> å‘¢ï¼Ÿ<br>\nç»è¿‡æŸ¥é˜…ï¼Œå‘ç°åœ¨å­—ç¬¦ä¸²ä¸­ï¼Œâ€™â€™ ä¹Ÿæœ‰è½¬ä¹‰çš„ä½œç”¨ã€‚å¦‚æœåæ–œæ å‡ºç°åœ¨å­—ç¬¦çš„å‰é¢ï¼Œé‚£ä¹ˆä»–ä»¬å°±æ˜¯ä¸€ä¸ªæ•´ä½“ï¼Œæ¯”å¦‚è¯´ â€˜\\nâ€™ è¡¨ç¤ºæ¢è¡Œï¼Œå­—ç¬¦ä¸² â€˜\\abcâ€™ ä¹Ÿæ¶‰åŠè½¬ä¹‰æ“ä½œï¼Œç”±äº a ä¸æ˜¯æœ‰æ•ˆçš„è½¬ä¹‰ç¬¦ï¼Œæ‰€ä»¥å°±ç›´æ¥è½¬æˆ â€˜abcâ€™ ã€‚ä¸‹é¢çš„ä»£ç å¯ä»¥éªŒè¯è¿™ä¸ªè¯´æ³•ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const str = &quot;\\abc&quot;;</span><br><span class=\"line\">console.info(str.length); // 3</span><br><span class=\"line\">&quot;\\abc&quot; === &quot;abc&quot; //true</span><br></pre></td></tr></table></figure>\n<p>å› æ­¤ï¼Œä¸Šé¢çš„ä»£ç åº”è¯¥æ”¹æˆï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const str = &apos;\\\\abc&apos;;</span><br><span class=\"line\">const reg = /\\\\abc/;</span><br><span class=\"line\">reg.test(str); // true</span><br></pre></td></tr></table></figure>\n<h4>2020/01/02</h4>\n<p>æ”¾å¤§é¢„è§ˆå›¾ç‰‡çš„æŸä¸ªéƒ¨åˆ†ï¼šæ€è·¯æ˜¯è®¡ç®— bbox çš„ scale æ•°å€¼ï¼Œä½¿ä¹‹èƒ½å¡«å……æ»¡æ•´ä¸ª container ï¼›å†è®¡ç®—åŸå§‹å›¾ç‰‡çš„åç§»é‡ï¼Œä½¿ä¹‹åªæ˜¾ç¤º bbox éƒ¨åˆ†ã€‚</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function Preview(props: &#123;</span><br><span class=\"line\">  imgSrc: string;</span><br><span class=\"line\">  imgSize: &#123; width: number; height: number &#125;;</span><br><span class=\"line\">  box: &#123;</span><br><span class=\"line\">    x: number;</span><br><span class=\"line\">    y: number;</span><br><span class=\"line\">    width: number;</span><br><span class=\"line\">    height: number;</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">&#125;) &#123;</span><br><span class=\"line\">  const [containerSize] = useState(&#123; width: 350, height: 400 &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">  const scale = Math.min(</span><br><span class=\"line\">    containerSize.width / props.box.width,</span><br><span class=\"line\">    containerSize.height / props.box.height</span><br><span class=\"line\">  );</span><br><span class=\"line\">  const boxCenter = &#123;</span><br><span class=\"line\">    x: props.box.x + props.box.width / 2,</span><br><span class=\"line\">    y: props.box.y + props.box.height / 2</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">  const containerCenter = &#123;</span><br><span class=\"line\">    x: containerSize.width / 2,</span><br><span class=\"line\">    y: containerSize.height / 2</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">  const tr = &#123;</span><br><span class=\"line\">    x: containerCenter.x - boxCenter.x * scale,</span><br><span class=\"line\">    y: containerCenter.y - boxCenter.y * scale</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">  return (</span><br><span class=\"line\">    &lt;div style=&#123;&#123; position: &quot;relative&quot;, ...containerSize, overflow: &quot;hidden&quot; &#125;&#125;&gt;</span><br><span class=\"line\">      &lt;img</span><br><span class=\"line\">        src=&#123;props.imgSrc&#125;</span><br><span class=\"line\">        style=&#123;&#123;</span><br><span class=\"line\">          ...props.imgSize,</span><br><span class=\"line\">          objectFit: &quot;contain&quot;,</span><br><span class=\"line\">          position: &quot;absolute&quot;,</span><br><span class=\"line\">          left: 0,</span><br><span class=\"line\">          top: 0,</span><br><span class=\"line\">          transform: `translate($&#123;tr.x&#125;px, $&#123;tr.y&#125;px) scale($&#123;scale&#125;)`,</span><br><span class=\"line\">          transformOrigin: &quot;top left&quot;,</span><br><span class=\"line\">          transition: &quot;all 0.3s&quot;</span><br><span class=\"line\">        &#125;&#125;</span><br><span class=\"line\">      /&gt;</span><br><span class=\"line\">    &lt;/div&gt;</span><br><span class=\"line\">  );</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"FE Resources Collection","catalog":true,"date":"2020-01-02T02:23:08.000Z","subtitle":null,"header-img":null,"_content":"ğŸ‘·ğŸš§ å‰ç«¯å­¦ä¹ èµ„æºæ•´åˆï¼ŒæŒç»­æ›´æ–°ä¸­ã€‚\n\n### åšå®¢/ç¤¾åŒº/è®ºå›\n- [Dev Community](https://dev.to/)\n- [Github](https://github.com/)\n- [Medium](https://medium.com/)\n- [Reddit](https://www.reddit.com/)\n- [è…¾è®¯ IMWeb å›¢é˜Ÿå‰ç«¯ç¤¾åŒº](https://imweb.io/topic/tab/all)\n- [è…¾è®¯ AlloyTeam å…¨ç«¯åšå®¢](http://www.alloyteam.com/page/0/)\n- [React å›¢é˜Ÿæˆå‘˜ Dan Abramov ä¸ªäººåšå®¢](https://overreacted.io/)\n- [æ·˜å®å‰ç«¯å›¢é˜Ÿå†´ç¾½ä¸ªäººåšå®¢](https://github.com/mqyqingfeng/Blog)ï¼šåŒ…å«JavaScriptæ·±å…¥ç³»åˆ—ã€JavaScriptä¸“é¢˜ç³»åˆ—ã€ES6ç³»åˆ—ã€Reactç³»åˆ—\n\n### èµ„è®¯ç±»\n- [æ¯æ—¥æ—¶æŠ¥](https://github.com/wubaiqing/zaobao)\n- [å‰ç«¯é¢è¯•æ¯æ—¥ä¸‰é—®](https://github.com/haizlin/fe-interview)\n- [Github Daily](https://github.com/GitHubDaily/GitHubDaily)\n\n### æŠ€èƒ½å›¾è°±/æŠ€æœ¯æ¸…å•\n- [Frontend Developer](https://roadmap.sh/frontend)\n- [React Developer Roadmap](https://github.com/adam-golab/react-developer-roadmap)\n- [å‰ç«¯æŠ€æœ¯æ¸…å•](https://alienzhou.github.io/frontend-tech-list/)\n\n### é¢è¯•å®å…¸\n- [å¤§å‰ç«¯é¢è¯•å®å…¸ - å›¾è§£å‰ç«¯](https://lucifer.ren/fe-interview/#/)\n- [æŠ€æœ¯é¢è¯•åŸºç¡€çŸ¥è¯†](https://cyc2018.github.io/CS-Notes/#/README)\n\n### å…¶ä»–\n- [Learn X in Y minutes](https://learnxinyminutes.com/)\n\n","source":"_posts/FE-Resources-Collection.md","raw":"---\ntitle: FE Resources Collection\ncatalog: true\ndate: 2020-01-02 10:23:08\nsubtitle:\nheader-img:\ntags: FE \n---\nğŸ‘·ğŸš§ å‰ç«¯å­¦ä¹ èµ„æºæ•´åˆï¼ŒæŒç»­æ›´æ–°ä¸­ã€‚\n\n### åšå®¢/ç¤¾åŒº/è®ºå›\n- [Dev Community](https://dev.to/)\n- [Github](https://github.com/)\n- [Medium](https://medium.com/)\n- [Reddit](https://www.reddit.com/)\n- [è…¾è®¯ IMWeb å›¢é˜Ÿå‰ç«¯ç¤¾åŒº](https://imweb.io/topic/tab/all)\n- [è…¾è®¯ AlloyTeam å…¨ç«¯åšå®¢](http://www.alloyteam.com/page/0/)\n- [React å›¢é˜Ÿæˆå‘˜ Dan Abramov ä¸ªäººåšå®¢](https://overreacted.io/)\n- [æ·˜å®å‰ç«¯å›¢é˜Ÿå†´ç¾½ä¸ªäººåšå®¢](https://github.com/mqyqingfeng/Blog)ï¼šåŒ…å«JavaScriptæ·±å…¥ç³»åˆ—ã€JavaScriptä¸“é¢˜ç³»åˆ—ã€ES6ç³»åˆ—ã€Reactç³»åˆ—\n\n### èµ„è®¯ç±»\n- [æ¯æ—¥æ—¶æŠ¥](https://github.com/wubaiqing/zaobao)\n- [å‰ç«¯é¢è¯•æ¯æ—¥ä¸‰é—®](https://github.com/haizlin/fe-interview)\n- [Github Daily](https://github.com/GitHubDaily/GitHubDaily)\n\n### æŠ€èƒ½å›¾è°±/æŠ€æœ¯æ¸…å•\n- [Frontend Developer](https://roadmap.sh/frontend)\n- [React Developer Roadmap](https://github.com/adam-golab/react-developer-roadmap)\n- [å‰ç«¯æŠ€æœ¯æ¸…å•](https://alienzhou.github.io/frontend-tech-list/)\n\n### é¢è¯•å®å…¸\n- [å¤§å‰ç«¯é¢è¯•å®å…¸ - å›¾è§£å‰ç«¯](https://lucifer.ren/fe-interview/#/)\n- [æŠ€æœ¯é¢è¯•åŸºç¡€çŸ¥è¯†](https://cyc2018.github.io/CS-Notes/#/README)\n\n### å…¶ä»–\n- [Learn X in Y minutes](https://learnxinyminutes.com/)\n\n","slug":"FE-Resources-Collection","published":1,"updated":"2020-01-15T03:25:05.415Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck6vknhf60009osue8panwanm","content":"<p>ğŸ‘·ğŸš§ å‰ç«¯å­¦ä¹ èµ„æºæ•´åˆï¼ŒæŒç»­æ›´æ–°ä¸­ã€‚</p>\n<h3 id=\"åšå®¢ç¤¾åŒºè®ºå›\">åšå®¢/ç¤¾åŒº/è®ºå›</h3>\n<ul>\n<li><a href=\"https://dev.to/\" target=\"_blank\" rel=\"noopener\">Dev Community</a></li>\n<li><a href=\"https://github.com/\" target=\"_blank\" rel=\"noopener\">Github</a></li>\n<li><a href=\"https://medium.com/\" target=\"_blank\" rel=\"noopener\">Medium</a></li>\n<li><a href=\"https://www.reddit.com/\" target=\"_blank\" rel=\"noopener\">Reddit</a></li>\n<li><a href=\"https://imweb.io/topic/tab/all\" target=\"_blank\" rel=\"noopener\">è…¾è®¯ IMWeb å›¢é˜Ÿå‰ç«¯ç¤¾åŒº</a></li>\n<li><a href=\"http://www.alloyteam.com/page/0/\" target=\"_blank\" rel=\"noopener\">è…¾è®¯ AlloyTeam å…¨ç«¯åšå®¢</a></li>\n<li><a href=\"https://overreacted.io/\" target=\"_blank\" rel=\"noopener\">React å›¢é˜Ÿæˆå‘˜ Dan Abramov ä¸ªäººåšå®¢</a></li>\n<li><a href=\"https://github.com/mqyqingfeng/Blog\" target=\"_blank\" rel=\"noopener\">æ·˜å®å‰ç«¯å›¢é˜Ÿå†´ç¾½ä¸ªäººåšå®¢</a>ï¼šåŒ…å«JavaScriptæ·±å…¥ç³»åˆ—ã€JavaScriptä¸“é¢˜ç³»åˆ—ã€ES6ç³»åˆ—ã€Reactç³»åˆ—</li>\n</ul>\n<h3 id=\"èµ„è®¯ç±»\">èµ„è®¯ç±»</h3>\n<ul>\n<li><a href=\"https://github.com/wubaiqing/zaobao\" target=\"_blank\" rel=\"noopener\">æ¯æ—¥æ—¶æŠ¥</a></li>\n<li><a href=\"https://github.com/haizlin/fe-interview\" target=\"_blank\" rel=\"noopener\">å‰ç«¯é¢è¯•æ¯æ—¥ä¸‰é—®</a></li>\n<li><a href=\"https://github.com/GitHubDaily/GitHubDaily\" target=\"_blank\" rel=\"noopener\">Github Daily</a></li>\n</ul>\n<h3 id=\"æŠ€èƒ½å›¾è°±æŠ€æœ¯æ¸…å•\">æŠ€èƒ½å›¾è°±/æŠ€æœ¯æ¸…å•</h3>\n<ul>\n<li><a href=\"https://roadmap.sh/frontend\" target=\"_blank\" rel=\"noopener\">Frontend Developer</a></li>\n<li><a href=\"https://github.com/adam-golab/react-developer-roadmap\" target=\"_blank\" rel=\"noopener\">React Developer Roadmap</a></li>\n<li><a href=\"https://alienzhou.github.io/frontend-tech-list/\" target=\"_blank\" rel=\"noopener\">å‰ç«¯æŠ€æœ¯æ¸…å•</a></li>\n</ul>\n<h3 id=\"é¢è¯•å®å…¸\">é¢è¯•å®å…¸</h3>\n<ul>\n<li><a href=\"https://lucifer.ren/fe-interview/#/\" target=\"_blank\" rel=\"noopener\">å¤§å‰ç«¯é¢è¯•å®å…¸ - å›¾è§£å‰ç«¯</a></li>\n<li><a href=\"https://cyc2018.github.io/CS-Notes/#/README\" target=\"_blank\" rel=\"noopener\">æŠ€æœ¯é¢è¯•åŸºç¡€çŸ¥è¯†</a></li>\n</ul>\n<h3 id=\"å…¶ä»–\">å…¶ä»–</h3>\n<ul>\n<li><a href=\"https://learnxinyminutes.com/\" target=\"_blank\" rel=\"noopener\">Learn X in Y minutes</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p>ğŸ‘·ğŸš§ å‰ç«¯å­¦ä¹ èµ„æºæ•´åˆï¼ŒæŒç»­æ›´æ–°ä¸­ã€‚</p>\n<h3>åšå®¢/ç¤¾åŒº/è®ºå›</h3>\n<ul>\n<li><a href=\"https://dev.to/\" target=\"_blank\" rel=\"noopener\">Dev Community</a></li>\n<li><a href=\"https://github.com/\" target=\"_blank\" rel=\"noopener\">Github</a></li>\n<li><a href=\"https://medium.com/\" target=\"_blank\" rel=\"noopener\">Medium</a></li>\n<li><a href=\"https://www.reddit.com/\" target=\"_blank\" rel=\"noopener\">Reddit</a></li>\n<li><a href=\"https://imweb.io/topic/tab/all\" target=\"_blank\" rel=\"noopener\">è…¾è®¯ IMWeb å›¢é˜Ÿå‰ç«¯ç¤¾åŒº</a></li>\n<li><a href=\"http://www.alloyteam.com/page/0/\" target=\"_blank\" rel=\"noopener\">è…¾è®¯ AlloyTeam å…¨ç«¯åšå®¢</a></li>\n<li><a href=\"https://overreacted.io/\" target=\"_blank\" rel=\"noopener\">React å›¢é˜Ÿæˆå‘˜ Dan Abramov ä¸ªäººåšå®¢</a></li>\n<li><a href=\"https://github.com/mqyqingfeng/Blog\" target=\"_blank\" rel=\"noopener\">æ·˜å®å‰ç«¯å›¢é˜Ÿå†´ç¾½ä¸ªäººåšå®¢</a>ï¼šåŒ…å«JavaScriptæ·±å…¥ç³»åˆ—ã€JavaScriptä¸“é¢˜ç³»åˆ—ã€ES6ç³»åˆ—ã€Reactç³»åˆ—</li>\n</ul>\n<h3>èµ„è®¯ç±»</h3>\n<ul>\n<li><a href=\"https://github.com/wubaiqing/zaobao\" target=\"_blank\" rel=\"noopener\">æ¯æ—¥æ—¶æŠ¥</a></li>\n<li><a href=\"https://github.com/haizlin/fe-interview\" target=\"_blank\" rel=\"noopener\">å‰ç«¯é¢è¯•æ¯æ—¥ä¸‰é—®</a></li>\n<li><a href=\"https://github.com/GitHubDaily/GitHubDaily\" target=\"_blank\" rel=\"noopener\">Github Daily</a></li>\n</ul>\n<h3>æŠ€èƒ½å›¾è°±/æŠ€æœ¯æ¸…å•</h3>\n<ul>\n<li><a href=\"https://roadmap.sh/frontend\" target=\"_blank\" rel=\"noopener\">Frontend Developer</a></li>\n<li><a href=\"https://github.com/adam-golab/react-developer-roadmap\" target=\"_blank\" rel=\"noopener\">React Developer Roadmap</a></li>\n<li><a href=\"https://alienzhou.github.io/frontend-tech-list/\" target=\"_blank\" rel=\"noopener\">å‰ç«¯æŠ€æœ¯æ¸…å•</a></li>\n</ul>\n<h3>é¢è¯•å®å…¸</h3>\n<ul>\n<li><a href=\"https://lucifer.ren/fe-interview/#/\" target=\"_blank\" rel=\"noopener\">å¤§å‰ç«¯é¢è¯•å®å…¸ - å›¾è§£å‰ç«¯</a></li>\n<li><a href=\"https://cyc2018.github.io/CS-Notes/#/README\" target=\"_blank\" rel=\"noopener\">æŠ€æœ¯é¢è¯•åŸºç¡€çŸ¥è¯†</a></li>\n</ul>\n<h3>å…¶ä»–</h3>\n<ul>\n<li><a href=\"https://learnxinyminutes.com/\" target=\"_blank\" rel=\"noopener\">Learn X in Y minutes</a></li>\n</ul>\n"},{"title":"Technical Docs Collection involved in FE work","catalog":true,"date":"2020-01-07T02:24:22.000Z","subtitle":null,"header-img":null,"_content":"ğŸ‘·ğŸš§ å·¥ä½œä¸­ç”¨åˆ°çš„ä¸€äº›æŠ€æœ¯æ–‡æ¡£é›†åˆï¼ŒæŒç»­æ›´æ–°ä¸­ã€‚\n\n#### typescript\n- [docs and handbook](https://www.typescriptlang.org/docs/home.html)\n\n#### git\n- [Oh Shit, Git!?!](http://ohshitgit.com/)\n\n#### docker\n- [å®˜æ–¹æ–‡æ¡£](https://docs.docker.com/)\n\n#### sentry\n- [å®˜æ–¹æ–‡æ¡£](https://docs.sentry.io/)\n\n#### JWT\n- [Introduction to JSON Web Tokens](https://jwt.io/introduction/)\n- [é˜®ä¸€å³° JSON Web Token å…¥é—¨æ•™ç¨‹](http://www.ruanyifeng.com/blog/2018/07/json_web_token-tutorial.html)ï¼Œæ¯”è¾ƒé€šä¿—æ˜“æ‡‚\n\n#### jest\n- [å®˜æ–¹æ–‡æ¡£](https://jestjs.io/docs/en/getting-started)\n\n#### enzyme\n- [API introduction](https://airbnb.io/enzyme/)\n\n#### rxjs\n- [å®˜æ–¹æ–‡æ¡£](https://rxjs-dev.firebaseapp.com/guide/overview)\n- [Learn RxJS](https://www.learnrxjs.io/)\n- [RxJS Marbles: Interactive diagrams of Rx Observables](https://rxmarbles.com/)\n\n#### Protocol Buffers\n- [google docs](https://developers.google.com/protocol-buffers)\n\n#### immer\n- [å®˜æ–¹æ–‡æ¡£](https://immerjs.github.io/immer/docs/introduction)\n- [Introducing Immer: Immutability the easy way](https://medium.com/hackernoon/introducing-immer-immutability-the-easy-way-9d73d8f71cb3) ï¼ˆæ³¨æ„é‡Œé¢æåˆ°çš„ `structural sharing`ï¼‰\n\n#### react-beautiful-dnd\n- [å®˜æ–¹æ–‡æ¡£](https://github.com/atlassian/react-beautiful-dnd)\n\n### Json Patch\n- [Introduction](http://jsonpatch.com/)","source":"_posts/FE-Technical-Docs-Collection.md","raw":"---\ntitle: Technical Docs Collection involved in FE work\ncatalog: true\ndate: 2020-01-07 10:24:22\nsubtitle:\nheader-img:\ntags: FE\n---\nğŸ‘·ğŸš§ å·¥ä½œä¸­ç”¨åˆ°çš„ä¸€äº›æŠ€æœ¯æ–‡æ¡£é›†åˆï¼ŒæŒç»­æ›´æ–°ä¸­ã€‚\n\n#### typescript\n- [docs and handbook](https://www.typescriptlang.org/docs/home.html)\n\n#### git\n- [Oh Shit, Git!?!](http://ohshitgit.com/)\n\n#### docker\n- [å®˜æ–¹æ–‡æ¡£](https://docs.docker.com/)\n\n#### sentry\n- [å®˜æ–¹æ–‡æ¡£](https://docs.sentry.io/)\n\n#### JWT\n- [Introduction to JSON Web Tokens](https://jwt.io/introduction/)\n- [é˜®ä¸€å³° JSON Web Token å…¥é—¨æ•™ç¨‹](http://www.ruanyifeng.com/blog/2018/07/json_web_token-tutorial.html)ï¼Œæ¯”è¾ƒé€šä¿—æ˜“æ‡‚\n\n#### jest\n- [å®˜æ–¹æ–‡æ¡£](https://jestjs.io/docs/en/getting-started)\n\n#### enzyme\n- [API introduction](https://airbnb.io/enzyme/)\n\n#### rxjs\n- [å®˜æ–¹æ–‡æ¡£](https://rxjs-dev.firebaseapp.com/guide/overview)\n- [Learn RxJS](https://www.learnrxjs.io/)\n- [RxJS Marbles: Interactive diagrams of Rx Observables](https://rxmarbles.com/)\n\n#### Protocol Buffers\n- [google docs](https://developers.google.com/protocol-buffers)\n\n#### immer\n- [å®˜æ–¹æ–‡æ¡£](https://immerjs.github.io/immer/docs/introduction)\n- [Introducing Immer: Immutability the easy way](https://medium.com/hackernoon/introducing-immer-immutability-the-easy-way-9d73d8f71cb3) ï¼ˆæ³¨æ„é‡Œé¢æåˆ°çš„ `structural sharing`ï¼‰\n\n#### react-beautiful-dnd\n- [å®˜æ–¹æ–‡æ¡£](https://github.com/atlassian/react-beautiful-dnd)\n\n### Json Patch\n- [Introduction](http://jsonpatch.com/)","slug":"FE-Technical-Docs-Collection","published":1,"updated":"2020-02-05T07:09:07.922Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck6vknhfe000cosuen4malt96","content":"<p>ğŸ‘·ğŸš§ å·¥ä½œä¸­ç”¨åˆ°çš„ä¸€äº›æŠ€æœ¯æ–‡æ¡£é›†åˆï¼ŒæŒç»­æ›´æ–°ä¸­ã€‚</p>\n<h4 id=\"typescript\">typescript</h4>\n<ul>\n<li><a href=\"https://www.typescriptlang.org/docs/home.html\" target=\"_blank\" rel=\"noopener\">docs and handbook</a></li>\n</ul>\n<h4 id=\"git\">git</h4>\n<ul>\n<li><a href=\"http://ohshitgit.com/\" target=\"_blank\" rel=\"noopener\">Oh Shit, Git!?!</a></li>\n</ul>\n<h4 id=\"docker\">docker</h4>\n<ul>\n<li><a href=\"https://docs.docker.com/\" target=\"_blank\" rel=\"noopener\">å®˜æ–¹æ–‡æ¡£</a></li>\n</ul>\n<h4 id=\"sentry\">sentry</h4>\n<ul>\n<li><a href=\"https://docs.sentry.io/\" target=\"_blank\" rel=\"noopener\">å®˜æ–¹æ–‡æ¡£</a></li>\n</ul>\n<h4 id=\"jwt\">JWT</h4>\n<ul>\n<li><a href=\"https://jwt.io/introduction/\" target=\"_blank\" rel=\"noopener\">Introduction to JSON Web Tokens</a></li>\n<li><a href=\"http://www.ruanyifeng.com/blog/2018/07/json_web_token-tutorial.html\" target=\"_blank\" rel=\"noopener\">é˜®ä¸€å³° JSON Web Token å…¥é—¨æ•™ç¨‹</a>ï¼Œæ¯”è¾ƒé€šä¿—æ˜“æ‡‚</li>\n</ul>\n<h4 id=\"jest\">jest</h4>\n<ul>\n<li><a href=\"https://jestjs.io/docs/en/getting-started\" target=\"_blank\" rel=\"noopener\">å®˜æ–¹æ–‡æ¡£</a></li>\n</ul>\n<h4 id=\"enzyme\">enzyme</h4>\n<ul>\n<li><a href=\"https://airbnb.io/enzyme/\" target=\"_blank\" rel=\"noopener\">API introduction</a></li>\n</ul>\n<h4 id=\"rxjs\">rxjs</h4>\n<ul>\n<li><a href=\"https://rxjs-dev.firebaseapp.com/guide/overview\" target=\"_blank\" rel=\"noopener\">å®˜æ–¹æ–‡æ¡£</a></li>\n<li><a href=\"https://www.learnrxjs.io/\" target=\"_blank\" rel=\"noopener\">Learn RxJS</a></li>\n<li><a href=\"https://rxmarbles.com/\" target=\"_blank\" rel=\"noopener\">RxJS Marbles: Interactive diagrams of Rx Observables</a></li>\n</ul>\n<h4 id=\"protocol-buffers\">Protocol Buffers</h4>\n<ul>\n<li><a href=\"https://developers.google.com/protocol-buffers\" target=\"_blank\" rel=\"noopener\">google docs</a></li>\n</ul>\n<h4 id=\"immer\">immer</h4>\n<ul>\n<li><a href=\"https://immerjs.github.io/immer/docs/introduction\" target=\"_blank\" rel=\"noopener\">å®˜æ–¹æ–‡æ¡£</a></li>\n<li><a href=\"https://medium.com/hackernoon/introducing-immer-immutability-the-easy-way-9d73d8f71cb3\" target=\"_blank\" rel=\"noopener\">Introducing Immer: Immutability the easy way</a> ï¼ˆæ³¨æ„é‡Œé¢æåˆ°çš„ <code>structural sharing</code>ï¼‰</li>\n</ul>\n<h4 id=\"react-beautiful-dnd\">react-beautiful-dnd</h4>\n<ul>\n<li><a href=\"https://github.com/atlassian/react-beautiful-dnd\" target=\"_blank\" rel=\"noopener\">å®˜æ–¹æ–‡æ¡£</a></li>\n</ul>\n<h3 id=\"json-patch\">Json Patch</h3>\n<ul>\n<li><a href=\"http://jsonpatch.com/\" target=\"_blank\" rel=\"noopener\">Introduction</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p>ğŸ‘·ğŸš§ å·¥ä½œä¸­ç”¨åˆ°çš„ä¸€äº›æŠ€æœ¯æ–‡æ¡£é›†åˆï¼ŒæŒç»­æ›´æ–°ä¸­ã€‚</p>\n<h4>typescript</h4>\n<ul>\n<li><a href=\"https://www.typescriptlang.org/docs/home.html\" target=\"_blank\" rel=\"noopener\">docs and handbook</a></li>\n</ul>\n<h4>git</h4>\n<ul>\n<li><a href=\"http://ohshitgit.com/\" target=\"_blank\" rel=\"noopener\">Oh Shit, Git!?!</a></li>\n</ul>\n<h4>docker</h4>\n<ul>\n<li><a href=\"https://docs.docker.com/\" target=\"_blank\" rel=\"noopener\">å®˜æ–¹æ–‡æ¡£</a></li>\n</ul>\n<h4>sentry</h4>\n<ul>\n<li><a href=\"https://docs.sentry.io/\" target=\"_blank\" rel=\"noopener\">å®˜æ–¹æ–‡æ¡£</a></li>\n</ul>\n<h4>JWT</h4>\n<ul>\n<li><a href=\"https://jwt.io/introduction/\" target=\"_blank\" rel=\"noopener\">Introduction to JSON Web Tokens</a></li>\n<li><a href=\"http://www.ruanyifeng.com/blog/2018/07/json_web_token-tutorial.html\" target=\"_blank\" rel=\"noopener\">é˜®ä¸€å³° JSON Web Token å…¥é—¨æ•™ç¨‹</a>ï¼Œæ¯”è¾ƒé€šä¿—æ˜“æ‡‚</li>\n</ul>\n<h4>jest</h4>\n<ul>\n<li><a href=\"https://jestjs.io/docs/en/getting-started\" target=\"_blank\" rel=\"noopener\">å®˜æ–¹æ–‡æ¡£</a></li>\n</ul>\n<h4>enzyme</h4>\n<ul>\n<li><a href=\"https://airbnb.io/enzyme/\" target=\"_blank\" rel=\"noopener\">API introduction</a></li>\n</ul>\n<h4>rxjs</h4>\n<ul>\n<li><a href=\"https://rxjs-dev.firebaseapp.com/guide/overview\" target=\"_blank\" rel=\"noopener\">å®˜æ–¹æ–‡æ¡£</a></li>\n<li><a href=\"https://www.learnrxjs.io/\" target=\"_blank\" rel=\"noopener\">Learn RxJS</a></li>\n<li><a href=\"https://rxmarbles.com/\" target=\"_blank\" rel=\"noopener\">RxJS Marbles: Interactive diagrams of Rx Observables</a></li>\n</ul>\n<h4>Protocol Buffers</h4>\n<ul>\n<li><a href=\"https://developers.google.com/protocol-buffers\" target=\"_blank\" rel=\"noopener\">google docs</a></li>\n</ul>\n<h4>immer</h4>\n<ul>\n<li><a href=\"https://immerjs.github.io/immer/docs/introduction\" target=\"_blank\" rel=\"noopener\">å®˜æ–¹æ–‡æ¡£</a></li>\n<li><a href=\"https://medium.com/hackernoon/introducing-immer-immutability-the-easy-way-9d73d8f71cb3\" target=\"_blank\" rel=\"noopener\">Introducing Immer: Immutability the easy way</a> ï¼ˆæ³¨æ„é‡Œé¢æåˆ°çš„ <code>structural sharing</code>ï¼‰</li>\n</ul>\n<h4>react-beautiful-dnd</h4>\n<ul>\n<li><a href=\"https://github.com/atlassian/react-beautiful-dnd\" target=\"_blank\" rel=\"noopener\">å®˜æ–¹æ–‡æ¡£</a></li>\n</ul>\n<h3>Json Patch</h3>\n<ul>\n<li><a href=\"http://jsonpatch.com/\" target=\"_blank\" rel=\"noopener\">Introduction</a></li>\n</ul>\n"},{"title":"FrontEnd Notes [2020.02]","catalog":true,"date":"2020-02-21T02:29:52.000Z","subtitle":null,"header-img":null,"_content":"\n#### About\n\nğŸ“… 2020 å¹´ 2 æœˆçš„é›¶æ•£å­¦ä¹ è®°å½•ã€‚\n\nåŠ¨ç¬”æ—¶å‘ç°å·²ç»æ˜¯2æœˆ21å·äº†ï¼Œæƒ­æ„§å•Šæƒ­æ„§ã€‚\n\n#### 2020/02/27\nä»Šå¤©åœ¨å¤„ç†å‡½æ•°å¼ç»„ä»¶æ—¶é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œå°†æŸä¸ªå‡½æ•°ä½œä¸ºå›è°ƒå‡½æ•°ä¼ åˆ°å­ç»„ä»¶ï¼Œåœ¨å›è°ƒå‡½æ•°ä¸­æ‰“å° state ï¼Œåªèƒ½å–åˆ°åˆå§‹å€¼ï¼Œæ²¡æœ‰æ‰“å°å‡ºæœ€æ–°ç»“æœã€‚æ’æŸ¥äº†å¾ˆä¹…ï¼Œåæ¥å‘ç°åœ¨å­ç»„ä»¶ä¸­ï¼Œè¯¥å‡½æ•°ç”¨äºæ³¨å†Œäº‹ä»¶ç›‘å¬å‡½æ•°ï¼Œå› æ­¤äº‹ä»¶ç›‘å¬ç»‘å®šçš„å‡½æ•°ï¼Œæ˜¯ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶ä¼ è¿›å»çš„ï¼Œåç»­å¹¶ä¸ä¼šæ›´æ–°ï¼Œæ‰€ä»¥æ°¸è¿œåªèƒ½è·å–åˆ°åˆå§‹å€¼ã€‚\nä¸è€ƒè™‘çˆ¶å­ç»„ä»¶ï¼Œç”¨æœ€ç®€å•çš„ä¾‹å­å¤ç°è¿™ä¸ªé—®é¢˜ï¼š\n```\nconst App:React.FC = () => {\n  const [state,setState] = useState(0);\n\n  useEffect(() => {\n    window.addEventListener(\"wheel\", handleWheelChange);\n    return () => {\n      window.removeEventListener(\"wheel\", handleWheelChange);\n    }\n  },[]);\n\n  const handleWheelChange = () => {\n    // å§‹ç»ˆæ‰“å°0\n    console.log(state)\n  };\n  \n  return <></>\n} \n```\nå¦‚æœè¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ ref ï¼Œå–å€¼æ—¶é€šè¿‡ `ref.current` å–ï¼š\n```\nconst App:React.FC = () => {\n  const [state,setState] = useState(0);\n  // create ref\n  const stateRef = useRef(state);\n\n  // update ref.current when state changes\n  useEffect(() => {\n    ref.current = state;\n  },[state])\n\n  useEffect(() => {\n    window.addEventListener(\"wheel\", handleWheelChange);\n    return () => {\n      window.removeEventListener(\"wheel\", handleWheelChange);\n    }\n  },[]);\n\n  const handleWheelChange = () => {\n    // access newest state correctly\n    console.log(ref.current)\n  };\n  \n  return <></>\n} \n```\nä¸Šè¿°ä»£ç åªæ˜¯ä¸€ç§æ€è·¯çš„è¡¨è¾¾ï¼Œåœ¨å®é™…é¡¹ç›®ä¸­ï¼Œç›´æ¥ä½¿ç”¨ `useRef` åˆå§‹åŒ–å˜é‡å°±å¥½äº†ï¼Œæ²¡æœ‰å¿…è¦å…ˆ `useState` ï¼Œå†å¯¹ state `useRef` ã€‚ä½†æœ‰æ—¶ä½¿ç”¨äº† `useReducer` ï¼Œå¦‚æœéœ€è¦ç”¨åˆ°å…¶ä¸­æŸä¸ªå˜é‡ï¼Œå°±å¯ä»¥ç”¨ä¸Šè¿°ä»£ç ä¸­æåˆ°çš„æ–¹æ³•ã€‚\nç¬¬äºŒç§æ–¹æ³•æ˜¯é€šè¿‡è°ƒç”¨ `setState` ï¼Œä¼ å…¥å‡½æ•°æ¥å–åˆ°æœ€æ–°çš„ state ï¼Œå¦‚ï¼š\n```\n...\nconst handleWheelChange = () => {\n    setState(prev => {\n      // prev is the newest state, do anything you need\n      // remenber to return value\n      return prev;\n    })\n  };\n...\n```\n\n#### 2020/02/24\nä»Šæ—¥é˜…è¯»ï¼š[How to use throttle or debounce with React Hook?](https://stackoverflow.com/questions/54666401/how-to-use-throttle-or-debounce-with-react-hook)\nåœ¨ä½¿ç”¨å‡½æ•°å¼ç»„ä»¶æ—¶ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦å¼•å…¥ lodash çš„ `throttle` æˆ– `debounce` ï¼Œå¾ˆå®¹æ˜“å†™å‡ºå¦‚ä¸‹é”™è¯¯ä»£ç ï¼š\n```\nconst ExComp:React.FC = () => {\n  ....\n  // call it somewhere\n  const throttle = lodash.throttle((value) => {\n    // do something\n  },2000)\n  ...\n  return <></>\n}\n```\nä¸Šè¿°ä»£ç ä¸­ï¼Œåœ¨å‡½æ•°å¼ç»„ä»¶ä¸­å¼•å…¥äº†ä¸€ä¸ª throttle å‡½æ•°ï¼ˆåº•å±‚å®ç°æ˜¯ `setTimeout`ï¼‰ï¼Œç„¶è€Œå¯¹äºå‡½æ•°å¼ç»„ä»¶è€Œè¨€ï¼Œæ¯ä¸€æ¬¡ rerender éƒ½ä¼šé‡æ–°åˆå§‹åŒ–å˜é‡ï¼Œæ‰€ä»¥ throttle å¹¶ä¸ä¼šç”Ÿæ•ˆã€‚è§£å†³è¿™ä¸ªé—®é¢˜å¯ä»¥ä½¿ç”¨ `useRef` æˆ–æ˜¯ `useCallback` ã€‚å¦‚ï¼š\n```\nconst App = () => {\n  const [value, setValue] = useState(0)ï¼›\n\n  const throttled = useRef(\n    throttle((newValue) => console.log(newValue), 1000)\n  )\n  useEffect(() => throttled.current(value), [value])\n\n  // or\n  // const throttled = useCallback(\n  //  throttle((newValue) => console.log(newValue), 1000),\n  //  []\n  // );\n  // useEffect(() => throttled(value), [value])\n\n  return (\n    <button onClick={() => setValue(value + 1)}>{value}</button>\n  )\n```\nè°ƒç”¨æ—¶ç›´æ¥ä½¿ç”¨ `throttled.current()` ï¼ˆæˆ– `throttled()` ï¼‰å³å¯ã€‚æ³¨æ„å¦‚æœåœ¨ throttle å‡½æ•°ä¸­éœ€è¦ç”¨åˆ°å‡½æ•°å¤–çš„ state å€¼ï¼Œåªèƒ½å–åˆ°åˆå§‹å€¼ï¼ˆé—­åŒ…ï¼‰ï¼Œè¿™ç§æ—¶å€™åªèƒ½å°†æ‰€éœ€å‚æ•°ä½œä¸º params ä¼ è¿›å»ã€‚æˆ–æ˜¯å°† throttle å‡½æ•°ç§»åˆ°ç»„ä»¶å¤–ã€‚\n\n#### 2020/02/21\nåœ¨ä½¿ç”¨ react hooks æ—¶ï¼Œå¦‚æœéœ€è¦åœ¨ç»„ä»¶ä¸­å®ä¾‹ä¸€ä¸ªç±»ï¼ˆå¦‚ `new stroe()`ï¼‰ï¼›ä¸ºäº†è®©è¯¥å˜é‡å˜æˆä¸€ä¸ª state ï¼Œè€Œä¸æ˜¯æ¯æ¬¡é‡æ–°æ¸²æŸ“æ—¶éƒ½ä¼šé‡æ–°åˆå§‹åŒ–ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨ `useState` ï¼š\n```\nimport { useState } from \"react\"\n\nconst XXX:React.FC = () => {\n  const [store] = useState(new Store());\n\n  return <></>;\n}\n```\nå¼•å…¥æƒ°æ€§åˆå§‹ state ï¼Œä¼ å…¥ function ï¼Œå…³äºæƒ°æ€§åˆå§‹ state å¯ä»¥å‚è€ƒæ–‡æ¡£ [Lazy initial state](https://reactjs.org/docs/hooks-reference.html#lazy-initial-state) éƒ¨åˆ†ï¼Œæ›´è¯¦ç»†çš„è§£é‡Šå¯ä»¥å‚è€ƒ StackOverflow ä¸Šè¿™ä¸ª [å›ç­”](https://stackoverflow.com/a/58539958) ï¼Œå…·ä½“è€Œè¨€ï¼Œä¼ å…¥ function æ—¶åªä¼šåœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶è°ƒç”¨ï¼›å¦‚æœä¸å¼•å…¥æƒ°æ€§åˆå§‹ state ï¼Œè™½ç„¶ initialState åªä¼šåœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶ä½¿ç”¨ï¼Œä½†ä¼ å…¥ `useState` çš„å‡½æ•°è¿˜æ˜¯ä¼šè¿›è¡Œåˆå§‹åŒ–å’Œè°ƒç”¨ã€‚\n```\nimport { useState } from \"react\"\n\nconst XXX:React.FC = () => {\n  const [store] = useState(() => new Store());\n\n  return <></>;\n}\n```\nè¿™æ ·å¸¦æ¥çš„é—®é¢˜æ˜¯ï¼Œå¦‚æœ store ä¸­çš„æˆå‘˜æ›´æ–°äº†ï¼Œå¹¶ä¸ä¼šè§¦å‘é‡æ–°æ¸²æŸ“ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å¼•å…¥ Mobx ï¼Œå‚è€ƒ mobx-react-lite ä¸­ [Lazy initialization](https://github.com/mobxjs/mobx-react-lite#lazy-initialization) è¿™ä¸€èŠ‚ï¼š\n```\nimport { observer } from \"mobx-react-lite\"\nimport { observable } from \"mobx\"\nimport { useState } from \"react\"\n\nconst XXX:React.FC = observer(() => {\n  const [store] = useState(() => observable(new Store()));\n\n  return <></>;\n})\n```","source":"_posts/FrontEnd-Notes-2020-02.md","raw":"---\ntitle: FrontEnd Notes [2020.02]\ncatalog: true\ndate: 2020-02-21 10:29:52\nsubtitle:\nheader-img:\ntags: FE\n---\n\n#### About\n\nğŸ“… 2020 å¹´ 2 æœˆçš„é›¶æ•£å­¦ä¹ è®°å½•ã€‚\n\nåŠ¨ç¬”æ—¶å‘ç°å·²ç»æ˜¯2æœˆ21å·äº†ï¼Œæƒ­æ„§å•Šæƒ­æ„§ã€‚\n\n#### 2020/02/27\nä»Šå¤©åœ¨å¤„ç†å‡½æ•°å¼ç»„ä»¶æ—¶é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œå°†æŸä¸ªå‡½æ•°ä½œä¸ºå›è°ƒå‡½æ•°ä¼ åˆ°å­ç»„ä»¶ï¼Œåœ¨å›è°ƒå‡½æ•°ä¸­æ‰“å° state ï¼Œåªèƒ½å–åˆ°åˆå§‹å€¼ï¼Œæ²¡æœ‰æ‰“å°å‡ºæœ€æ–°ç»“æœã€‚æ’æŸ¥äº†å¾ˆä¹…ï¼Œåæ¥å‘ç°åœ¨å­ç»„ä»¶ä¸­ï¼Œè¯¥å‡½æ•°ç”¨äºæ³¨å†Œäº‹ä»¶ç›‘å¬å‡½æ•°ï¼Œå› æ­¤äº‹ä»¶ç›‘å¬ç»‘å®šçš„å‡½æ•°ï¼Œæ˜¯ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶ä¼ è¿›å»çš„ï¼Œåç»­å¹¶ä¸ä¼šæ›´æ–°ï¼Œæ‰€ä»¥æ°¸è¿œåªèƒ½è·å–åˆ°åˆå§‹å€¼ã€‚\nä¸è€ƒè™‘çˆ¶å­ç»„ä»¶ï¼Œç”¨æœ€ç®€å•çš„ä¾‹å­å¤ç°è¿™ä¸ªé—®é¢˜ï¼š\n```\nconst App:React.FC = () => {\n  const [state,setState] = useState(0);\n\n  useEffect(() => {\n    window.addEventListener(\"wheel\", handleWheelChange);\n    return () => {\n      window.removeEventListener(\"wheel\", handleWheelChange);\n    }\n  },[]);\n\n  const handleWheelChange = () => {\n    // å§‹ç»ˆæ‰“å°0\n    console.log(state)\n  };\n  \n  return <></>\n} \n```\nå¦‚æœè¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ ref ï¼Œå–å€¼æ—¶é€šè¿‡ `ref.current` å–ï¼š\n```\nconst App:React.FC = () => {\n  const [state,setState] = useState(0);\n  // create ref\n  const stateRef = useRef(state);\n\n  // update ref.current when state changes\n  useEffect(() => {\n    ref.current = state;\n  },[state])\n\n  useEffect(() => {\n    window.addEventListener(\"wheel\", handleWheelChange);\n    return () => {\n      window.removeEventListener(\"wheel\", handleWheelChange);\n    }\n  },[]);\n\n  const handleWheelChange = () => {\n    // access newest state correctly\n    console.log(ref.current)\n  };\n  \n  return <></>\n} \n```\nä¸Šè¿°ä»£ç åªæ˜¯ä¸€ç§æ€è·¯çš„è¡¨è¾¾ï¼Œåœ¨å®é™…é¡¹ç›®ä¸­ï¼Œç›´æ¥ä½¿ç”¨ `useRef` åˆå§‹åŒ–å˜é‡å°±å¥½äº†ï¼Œæ²¡æœ‰å¿…è¦å…ˆ `useState` ï¼Œå†å¯¹ state `useRef` ã€‚ä½†æœ‰æ—¶ä½¿ç”¨äº† `useReducer` ï¼Œå¦‚æœéœ€è¦ç”¨åˆ°å…¶ä¸­æŸä¸ªå˜é‡ï¼Œå°±å¯ä»¥ç”¨ä¸Šè¿°ä»£ç ä¸­æåˆ°çš„æ–¹æ³•ã€‚\nç¬¬äºŒç§æ–¹æ³•æ˜¯é€šè¿‡è°ƒç”¨ `setState` ï¼Œä¼ å…¥å‡½æ•°æ¥å–åˆ°æœ€æ–°çš„ state ï¼Œå¦‚ï¼š\n```\n...\nconst handleWheelChange = () => {\n    setState(prev => {\n      // prev is the newest state, do anything you need\n      // remenber to return value\n      return prev;\n    })\n  };\n...\n```\n\n#### 2020/02/24\nä»Šæ—¥é˜…è¯»ï¼š[How to use throttle or debounce with React Hook?](https://stackoverflow.com/questions/54666401/how-to-use-throttle-or-debounce-with-react-hook)\nåœ¨ä½¿ç”¨å‡½æ•°å¼ç»„ä»¶æ—¶ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦å¼•å…¥ lodash çš„ `throttle` æˆ– `debounce` ï¼Œå¾ˆå®¹æ˜“å†™å‡ºå¦‚ä¸‹é”™è¯¯ä»£ç ï¼š\n```\nconst ExComp:React.FC = () => {\n  ....\n  // call it somewhere\n  const throttle = lodash.throttle((value) => {\n    // do something\n  },2000)\n  ...\n  return <></>\n}\n```\nä¸Šè¿°ä»£ç ä¸­ï¼Œåœ¨å‡½æ•°å¼ç»„ä»¶ä¸­å¼•å…¥äº†ä¸€ä¸ª throttle å‡½æ•°ï¼ˆåº•å±‚å®ç°æ˜¯ `setTimeout`ï¼‰ï¼Œç„¶è€Œå¯¹äºå‡½æ•°å¼ç»„ä»¶è€Œè¨€ï¼Œæ¯ä¸€æ¬¡ rerender éƒ½ä¼šé‡æ–°åˆå§‹åŒ–å˜é‡ï¼Œæ‰€ä»¥ throttle å¹¶ä¸ä¼šç”Ÿæ•ˆã€‚è§£å†³è¿™ä¸ªé—®é¢˜å¯ä»¥ä½¿ç”¨ `useRef` æˆ–æ˜¯ `useCallback` ã€‚å¦‚ï¼š\n```\nconst App = () => {\n  const [value, setValue] = useState(0)ï¼›\n\n  const throttled = useRef(\n    throttle((newValue) => console.log(newValue), 1000)\n  )\n  useEffect(() => throttled.current(value), [value])\n\n  // or\n  // const throttled = useCallback(\n  //  throttle((newValue) => console.log(newValue), 1000),\n  //  []\n  // );\n  // useEffect(() => throttled(value), [value])\n\n  return (\n    <button onClick={() => setValue(value + 1)}>{value}</button>\n  )\n```\nè°ƒç”¨æ—¶ç›´æ¥ä½¿ç”¨ `throttled.current()` ï¼ˆæˆ– `throttled()` ï¼‰å³å¯ã€‚æ³¨æ„å¦‚æœåœ¨ throttle å‡½æ•°ä¸­éœ€è¦ç”¨åˆ°å‡½æ•°å¤–çš„ state å€¼ï¼Œåªèƒ½å–åˆ°åˆå§‹å€¼ï¼ˆé—­åŒ…ï¼‰ï¼Œè¿™ç§æ—¶å€™åªèƒ½å°†æ‰€éœ€å‚æ•°ä½œä¸º params ä¼ è¿›å»ã€‚æˆ–æ˜¯å°† throttle å‡½æ•°ç§»åˆ°ç»„ä»¶å¤–ã€‚\n\n#### 2020/02/21\nåœ¨ä½¿ç”¨ react hooks æ—¶ï¼Œå¦‚æœéœ€è¦åœ¨ç»„ä»¶ä¸­å®ä¾‹ä¸€ä¸ªç±»ï¼ˆå¦‚ `new stroe()`ï¼‰ï¼›ä¸ºäº†è®©è¯¥å˜é‡å˜æˆä¸€ä¸ª state ï¼Œè€Œä¸æ˜¯æ¯æ¬¡é‡æ–°æ¸²æŸ“æ—¶éƒ½ä¼šé‡æ–°åˆå§‹åŒ–ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨ `useState` ï¼š\n```\nimport { useState } from \"react\"\n\nconst XXX:React.FC = () => {\n  const [store] = useState(new Store());\n\n  return <></>;\n}\n```\nå¼•å…¥æƒ°æ€§åˆå§‹ state ï¼Œä¼ å…¥ function ï¼Œå…³äºæƒ°æ€§åˆå§‹ state å¯ä»¥å‚è€ƒæ–‡æ¡£ [Lazy initial state](https://reactjs.org/docs/hooks-reference.html#lazy-initial-state) éƒ¨åˆ†ï¼Œæ›´è¯¦ç»†çš„è§£é‡Šå¯ä»¥å‚è€ƒ StackOverflow ä¸Šè¿™ä¸ª [å›ç­”](https://stackoverflow.com/a/58539958) ï¼Œå…·ä½“è€Œè¨€ï¼Œä¼ å…¥ function æ—¶åªä¼šåœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶è°ƒç”¨ï¼›å¦‚æœä¸å¼•å…¥æƒ°æ€§åˆå§‹ state ï¼Œè™½ç„¶ initialState åªä¼šåœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶ä½¿ç”¨ï¼Œä½†ä¼ å…¥ `useState` çš„å‡½æ•°è¿˜æ˜¯ä¼šè¿›è¡Œåˆå§‹åŒ–å’Œè°ƒç”¨ã€‚\n```\nimport { useState } from \"react\"\n\nconst XXX:React.FC = () => {\n  const [store] = useState(() => new Store());\n\n  return <></>;\n}\n```\nè¿™æ ·å¸¦æ¥çš„é—®é¢˜æ˜¯ï¼Œå¦‚æœ store ä¸­çš„æˆå‘˜æ›´æ–°äº†ï¼Œå¹¶ä¸ä¼šè§¦å‘é‡æ–°æ¸²æŸ“ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å¼•å…¥ Mobx ï¼Œå‚è€ƒ mobx-react-lite ä¸­ [Lazy initialization](https://github.com/mobxjs/mobx-react-lite#lazy-initialization) è¿™ä¸€èŠ‚ï¼š\n```\nimport { observer } from \"mobx-react-lite\"\nimport { observable } from \"mobx\"\nimport { useState } from \"react\"\n\nconst XXX:React.FC = observer(() => {\n  const [store] = useState(() => observable(new Store()));\n\n  return <></>;\n})\n```","slug":"FrontEnd-Notes-2020-02","published":1,"updated":"2020-02-27T12:26:52.607Z","_id":"ck6vknhfn000eosuekguik41s","comments":1,"layout":"post","photos":[],"link":"","content":"<h4 id=\"about\"><a href=\"#About\" class=\"headerlink\" title=\"About\"></a>About</h4><p>ğŸ“… 2020 å¹´ 2 æœˆçš„é›¶æ•£å­¦ä¹ è®°å½•ã€‚</p>\n<p>åŠ¨ç¬”æ—¶å‘ç°å·²ç»æ˜¯2æœˆ21å·äº†ï¼Œæƒ­æ„§å•Šæƒ­æ„§ã€‚</p>\n<h4 id=\"20200227\"><a href=\"#2020-02-27\" class=\"headerlink\" title=\"2020/02/27\"></a>2020/02/27</h4><p>ä»Šå¤©åœ¨å¤„ç†å‡½æ•°å¼ç»„ä»¶æ—¶é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œå°†æŸä¸ªå‡½æ•°ä½œä¸ºå›è°ƒå‡½æ•°ä¼ åˆ°å­ç»„ä»¶ï¼Œåœ¨å›è°ƒå‡½æ•°ä¸­æ‰“å° state ï¼Œåªèƒ½å–åˆ°åˆå§‹å€¼ï¼Œæ²¡æœ‰æ‰“å°å‡ºæœ€æ–°ç»“æœã€‚æ’æŸ¥äº†å¾ˆä¹…ï¼Œåæ¥å‘ç°åœ¨å­ç»„ä»¶ä¸­ï¼Œè¯¥å‡½æ•°ç”¨äºæ³¨å†Œäº‹ä»¶ç›‘å¬å‡½æ•°ï¼Œå› æ­¤äº‹ä»¶ç›‘å¬ç»‘å®šçš„å‡½æ•°ï¼Œæ˜¯ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶ä¼ è¿›å»çš„ï¼Œåç»­å¹¶ä¸ä¼šæ›´æ–°ï¼Œæ‰€ä»¥æ°¸è¿œåªèƒ½è·å–åˆ°åˆå§‹å€¼ã€‚<br>ä¸è€ƒè™‘çˆ¶å­ç»„ä»¶ï¼Œç”¨æœ€ç®€å•çš„ä¾‹å­å¤ç°è¿™ä¸ªé—®é¢˜ï¼š<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const App:React.FC = () =&gt; &#123;</span><br><span class=\"line\">  const [state,setState] = useState(0);</span><br><span class=\"line\"></span><br><span class=\"line\">  useEffect(() =&gt; &#123;</span><br><span class=\"line\">    window.addEventListener(&quot;wheel&quot;, handleWheelChange);</span><br><span class=\"line\">    return () =&gt; &#123;</span><br><span class=\"line\">      window.removeEventListener(&quot;wheel&quot;, handleWheelChange);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;,[]);</span><br><span class=\"line\"></span><br><span class=\"line\">  const handleWheelChange = () =&gt; &#123;</span><br><span class=\"line\">    // å§‹ç»ˆæ‰“å°0</span><br><span class=\"line\">    console.log(state)</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">  </span><br><span class=\"line\">  return &lt;&gt;&lt;/&gt;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>å¦‚æœè¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ ref ï¼Œå–å€¼æ—¶é€šè¿‡ <code>ref.current</code> å–ï¼š<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const App:React.FC = () =&gt; &#123;</span><br><span class=\"line\">  const [state,setState] = useState(0);</span><br><span class=\"line\">  // create ref</span><br><span class=\"line\">  const stateRef = useRef(state);</span><br><span class=\"line\"></span><br><span class=\"line\">  // update ref.current when state changes</span><br><span class=\"line\">  useEffect(() =&gt; &#123;</span><br><span class=\"line\">    ref.current = state;</span><br><span class=\"line\">  &#125;,[state])</span><br><span class=\"line\"></span><br><span class=\"line\">  useEffect(() =&gt; &#123;</span><br><span class=\"line\">    window.addEventListener(&quot;wheel&quot;, handleWheelChange);</span><br><span class=\"line\">    return () =&gt; &#123;</span><br><span class=\"line\">      window.removeEventListener(&quot;wheel&quot;, handleWheelChange);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;,[]);</span><br><span class=\"line\"></span><br><span class=\"line\">  const handleWheelChange = () =&gt; &#123;</span><br><span class=\"line\">    // access newest state correctly</span><br><span class=\"line\">    console.log(ref.current)</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">  </span><br><span class=\"line\">  return &lt;&gt;&lt;/&gt;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>ä¸Šè¿°ä»£ç åªæ˜¯ä¸€ç§æ€è·¯çš„è¡¨è¾¾ï¼Œåœ¨å®é™…é¡¹ç›®ä¸­ï¼Œç›´æ¥ä½¿ç”¨ <code>useRef</code> åˆå§‹åŒ–å˜é‡å°±å¥½äº†ï¼Œæ²¡æœ‰å¿…è¦å…ˆ <code>useState</code> ï¼Œå†å¯¹ state <code>useRef</code> ã€‚ä½†æœ‰æ—¶ä½¿ç”¨äº† <code>useReducer</code> ï¼Œå¦‚æœéœ€è¦ç”¨åˆ°å…¶ä¸­æŸä¸ªå˜é‡ï¼Œå°±å¯ä»¥ç”¨ä¸Šè¿°ä»£ç ä¸­æåˆ°çš„æ–¹æ³•ã€‚<br>ç¬¬äºŒç§æ–¹æ³•æ˜¯é€šè¿‡è°ƒç”¨ <code>setState</code> ï¼Œä¼ å…¥å‡½æ•°æ¥å–åˆ°æœ€æ–°çš„ state ï¼Œå¦‚ï¼š<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">...</span><br><span class=\"line\">const handleWheelChange = () =&gt; &#123;</span><br><span class=\"line\">    setState(prev =&gt; &#123;</span><br><span class=\"line\">      // prev is the newest state, do anything you need</span><br><span class=\"line\">      // remenber to return value</span><br><span class=\"line\">      return prev;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"20200224\"><a href=\"#2020-02-24\" class=\"headerlink\" title=\"2020/02/24\"></a>2020/02/24</h4><p>ä»Šæ—¥é˜…è¯»ï¼š<a href=\"https://stackoverflow.com/questions/54666401/how-to-use-throttle-or-debounce-with-react-hook\" target=\"_blank\" rel=\"noopener\">How to use throttle or debounce with React Hook?</a><br>åœ¨ä½¿ç”¨å‡½æ•°å¼ç»„ä»¶æ—¶ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦å¼•å…¥ lodash çš„ <code>throttle</code> æˆ– <code>debounce</code> ï¼Œå¾ˆå®¹æ˜“å†™å‡ºå¦‚ä¸‹é”™è¯¯ä»£ç ï¼š<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const ExComp:React.FC = () =&gt; &#123;</span><br><span class=\"line\">  ....</span><br><span class=\"line\">  // call it somewhere</span><br><span class=\"line\">  const throttle = lodash.throttle((value) =&gt; &#123;</span><br><span class=\"line\">    // do something</span><br><span class=\"line\">  &#125;,2000)</span><br><span class=\"line\">  ...</span><br><span class=\"line\">  return &lt;&gt;&lt;/&gt;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>ä¸Šè¿°ä»£ç ä¸­ï¼Œåœ¨å‡½æ•°å¼ç»„ä»¶ä¸­å¼•å…¥äº†ä¸€ä¸ª throttle å‡½æ•°ï¼ˆåº•å±‚å®ç°æ˜¯ <code>setTimeout</code>ï¼‰ï¼Œç„¶è€Œå¯¹äºå‡½æ•°å¼ç»„ä»¶è€Œè¨€ï¼Œæ¯ä¸€æ¬¡ rerender éƒ½ä¼šé‡æ–°åˆå§‹åŒ–å˜é‡ï¼Œæ‰€ä»¥ throttle å¹¶ä¸ä¼šç”Ÿæ•ˆã€‚è§£å†³è¿™ä¸ªé—®é¢˜å¯ä»¥ä½¿ç”¨ <code>useRef</code> æˆ–æ˜¯ <code>useCallback</code> ã€‚å¦‚ï¼š<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const App = () =&gt; &#123;</span><br><span class=\"line\">  const [value, setValue] = useState(0)ï¼›</span><br><span class=\"line\"></span><br><span class=\"line\">  const throttled = useRef(</span><br><span class=\"line\">    throttle((newValue) =&gt; console.log(newValue), 1000)</span><br><span class=\"line\">  )</span><br><span class=\"line\">  useEffect(() =&gt; throttled.current(value), [value])</span><br><span class=\"line\"></span><br><span class=\"line\">  // or</span><br><span class=\"line\">  // const throttled = useCallback(</span><br><span class=\"line\">  //  throttle((newValue) =&gt; console.log(newValue), 1000),</span><br><span class=\"line\">  //  []</span><br><span class=\"line\">  // );</span><br><span class=\"line\">  // useEffect(() =&gt; throttled(value), [value])</span><br><span class=\"line\"></span><br><span class=\"line\">  return (</span><br><span class=\"line\">    &lt;button onClick=&#123;() =&gt; setValue(value + 1)&#125;&gt;&#123;value&#125;&lt;/button&gt;</span><br><span class=\"line\">  )</span><br></pre></td></tr></table></figure></p>\n<p>è°ƒç”¨æ—¶ç›´æ¥ä½¿ç”¨ <code>throttled.current()</code> ï¼ˆæˆ– <code>throttled()</code> ï¼‰å³å¯ã€‚æ³¨æ„å¦‚æœåœ¨ throttle å‡½æ•°ä¸­éœ€è¦ç”¨åˆ°å‡½æ•°å¤–çš„ state å€¼ï¼Œåªèƒ½å–åˆ°åˆå§‹å€¼ï¼ˆé—­åŒ…ï¼‰ï¼Œè¿™ç§æ—¶å€™åªèƒ½å°†æ‰€éœ€å‚æ•°ä½œä¸º params ä¼ è¿›å»ã€‚æˆ–æ˜¯å°† throttle å‡½æ•°ç§»åˆ°ç»„ä»¶å¤–ã€‚</p>\n<h4 id=\"20200221\"><a href=\"#2020-02-21\" class=\"headerlink\" title=\"2020/02/21\"></a>2020/02/21</h4><p>åœ¨ä½¿ç”¨ react hooks æ—¶ï¼Œå¦‚æœéœ€è¦åœ¨ç»„ä»¶ä¸­å®ä¾‹ä¸€ä¸ªç±»ï¼ˆå¦‚ <code>new stroe()</code>ï¼‰ï¼›ä¸ºäº†è®©è¯¥å˜é‡å˜æˆä¸€ä¸ª state ï¼Œè€Œä¸æ˜¯æ¯æ¬¡é‡æ–°æ¸²æŸ“æ—¶éƒ½ä¼šé‡æ–°åˆå§‹åŒ–ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨ <code>useState</code> ï¼š<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import &#123; useState &#125; from &quot;react&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">const XXX:React.FC = () =&gt; &#123;</span><br><span class=\"line\">  const [store] = useState(new Store());</span><br><span class=\"line\"></span><br><span class=\"line\">  return &lt;&gt;&lt;/&gt;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>å¼•å…¥æƒ°æ€§åˆå§‹ state ï¼Œä¼ å…¥ function ï¼Œå…³äºæƒ°æ€§åˆå§‹ state å¯ä»¥å‚è€ƒæ–‡æ¡£ <a href=\"https://reactjs.org/docs/hooks-reference.html#lazy-initial-state\" target=\"_blank\" rel=\"noopener\">Lazy initial state</a> éƒ¨åˆ†ï¼Œæ›´è¯¦ç»†çš„è§£é‡Šå¯ä»¥å‚è€ƒ StackOverflow ä¸Šè¿™ä¸ª <a href=\"https://stackoverflow.com/a/58539958\" target=\"_blank\" rel=\"noopener\">å›ç­”</a> ï¼Œå…·ä½“è€Œè¨€ï¼Œä¼ å…¥ function æ—¶åªä¼šåœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶è°ƒç”¨ï¼›å¦‚æœä¸å¼•å…¥æƒ°æ€§åˆå§‹ state ï¼Œè™½ç„¶ initialState åªä¼šåœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶ä½¿ç”¨ï¼Œä½†ä¼ å…¥ <code>useState</code> çš„å‡½æ•°è¿˜æ˜¯ä¼šè¿›è¡Œåˆå§‹åŒ–å’Œè°ƒç”¨ã€‚<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import &#123; useState &#125; from &quot;react&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">const XXX:React.FC = () =&gt; &#123;</span><br><span class=\"line\">  const [store] = useState(() =&gt; new Store());</span><br><span class=\"line\"></span><br><span class=\"line\">  return &lt;&gt;&lt;/&gt;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>è¿™æ ·å¸¦æ¥çš„é—®é¢˜æ˜¯ï¼Œå¦‚æœ store ä¸­çš„æˆå‘˜æ›´æ–°äº†ï¼Œå¹¶ä¸ä¼šè§¦å‘é‡æ–°æ¸²æŸ“ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å¼•å…¥ Mobx ï¼Œå‚è€ƒ mobx-react-lite ä¸­ <a href=\"https://github.com/mobxjs/mobx-react-lite#lazy-initialization\" target=\"_blank\" rel=\"noopener\">Lazy initialization</a> è¿™ä¸€èŠ‚ï¼š<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import &#123; observer &#125; from &quot;mobx-react-lite&quot;</span><br><span class=\"line\">import &#123; observable &#125; from &quot;mobx&quot;</span><br><span class=\"line\">import &#123; useState &#125; from &quot;react&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">const XXX:React.FC = observer(() =&gt; &#123;</span><br><span class=\"line\">  const [store] = useState(() =&gt; observable(new Store()));</span><br><span class=\"line\"></span><br><span class=\"line\">  return &lt;&gt;&lt;/&gt;;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure></p>\n","site":{"data":{}},"excerpt":"","more":"<h4 id=\"About\"><a href=\"#About\" class=\"headerlink\" title=\"About\"></a>About</h4><p>ğŸ“… 2020 å¹´ 2 æœˆçš„é›¶æ•£å­¦ä¹ è®°å½•ã€‚</p>\n<p>åŠ¨ç¬”æ—¶å‘ç°å·²ç»æ˜¯2æœˆ21å·äº†ï¼Œæƒ­æ„§å•Šæƒ­æ„§ã€‚</p>\n<h4 id=\"2020-02-27\"><a href=\"#2020-02-27\" class=\"headerlink\" title=\"2020/02/27\"></a>2020/02/27</h4><p>ä»Šå¤©åœ¨å¤„ç†å‡½æ•°å¼ç»„ä»¶æ—¶é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œå°†æŸä¸ªå‡½æ•°ä½œä¸ºå›è°ƒå‡½æ•°ä¼ åˆ°å­ç»„ä»¶ï¼Œåœ¨å›è°ƒå‡½æ•°ä¸­æ‰“å° state ï¼Œåªèƒ½å–åˆ°åˆå§‹å€¼ï¼Œæ²¡æœ‰æ‰“å°å‡ºæœ€æ–°ç»“æœã€‚æ’æŸ¥äº†å¾ˆä¹…ï¼Œåæ¥å‘ç°åœ¨å­ç»„ä»¶ä¸­ï¼Œè¯¥å‡½æ•°ç”¨äºæ³¨å†Œäº‹ä»¶ç›‘å¬å‡½æ•°ï¼Œå› æ­¤äº‹ä»¶ç›‘å¬ç»‘å®šçš„å‡½æ•°ï¼Œæ˜¯ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶ä¼ è¿›å»çš„ï¼Œåç»­å¹¶ä¸ä¼šæ›´æ–°ï¼Œæ‰€ä»¥æ°¸è¿œåªèƒ½è·å–åˆ°åˆå§‹å€¼ã€‚<br>ä¸è€ƒè™‘çˆ¶å­ç»„ä»¶ï¼Œç”¨æœ€ç®€å•çš„ä¾‹å­å¤ç°è¿™ä¸ªé—®é¢˜ï¼š<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const App:React.FC = () =&gt; &#123;</span><br><span class=\"line\">  const [state,setState] = useState(0);</span><br><span class=\"line\"></span><br><span class=\"line\">  useEffect(() =&gt; &#123;</span><br><span class=\"line\">    window.addEventListener(&quot;wheel&quot;, handleWheelChange);</span><br><span class=\"line\">    return () =&gt; &#123;</span><br><span class=\"line\">      window.removeEventListener(&quot;wheel&quot;, handleWheelChange);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;,[]);</span><br><span class=\"line\"></span><br><span class=\"line\">  const handleWheelChange = () =&gt; &#123;</span><br><span class=\"line\">    // å§‹ç»ˆæ‰“å°0</span><br><span class=\"line\">    console.log(state)</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">  </span><br><span class=\"line\">  return &lt;&gt;&lt;/&gt;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>å¦‚æœè¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ ref ï¼Œå–å€¼æ—¶é€šè¿‡ <code>ref.current</code> å–ï¼š<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const App:React.FC = () =&gt; &#123;</span><br><span class=\"line\">  const [state,setState] = useState(0);</span><br><span class=\"line\">  // create ref</span><br><span class=\"line\">  const stateRef = useRef(state);</span><br><span class=\"line\"></span><br><span class=\"line\">  // update ref.current when state changes</span><br><span class=\"line\">  useEffect(() =&gt; &#123;</span><br><span class=\"line\">    ref.current = state;</span><br><span class=\"line\">  &#125;,[state])</span><br><span class=\"line\"></span><br><span class=\"line\">  useEffect(() =&gt; &#123;</span><br><span class=\"line\">    window.addEventListener(&quot;wheel&quot;, handleWheelChange);</span><br><span class=\"line\">    return () =&gt; &#123;</span><br><span class=\"line\">      window.removeEventListener(&quot;wheel&quot;, handleWheelChange);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;,[]);</span><br><span class=\"line\"></span><br><span class=\"line\">  const handleWheelChange = () =&gt; &#123;</span><br><span class=\"line\">    // access newest state correctly</span><br><span class=\"line\">    console.log(ref.current)</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">  </span><br><span class=\"line\">  return &lt;&gt;&lt;/&gt;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>ä¸Šè¿°ä»£ç åªæ˜¯ä¸€ç§æ€è·¯çš„è¡¨è¾¾ï¼Œåœ¨å®é™…é¡¹ç›®ä¸­ï¼Œç›´æ¥ä½¿ç”¨ <code>useRef</code> åˆå§‹åŒ–å˜é‡å°±å¥½äº†ï¼Œæ²¡æœ‰å¿…è¦å…ˆ <code>useState</code> ï¼Œå†å¯¹ state <code>useRef</code> ã€‚ä½†æœ‰æ—¶ä½¿ç”¨äº† <code>useReducer</code> ï¼Œå¦‚æœéœ€è¦ç”¨åˆ°å…¶ä¸­æŸä¸ªå˜é‡ï¼Œå°±å¯ä»¥ç”¨ä¸Šè¿°ä»£ç ä¸­æåˆ°çš„æ–¹æ³•ã€‚<br>ç¬¬äºŒç§æ–¹æ³•æ˜¯é€šè¿‡è°ƒç”¨ <code>setState</code> ï¼Œä¼ å…¥å‡½æ•°æ¥å–åˆ°æœ€æ–°çš„ state ï¼Œå¦‚ï¼š<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">...</span><br><span class=\"line\">const handleWheelChange = () =&gt; &#123;</span><br><span class=\"line\">    setState(prev =&gt; &#123;</span><br><span class=\"line\">      // prev is the newest state, do anything you need</span><br><span class=\"line\">      // remenber to return value</span><br><span class=\"line\">      return prev;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"2020-02-24\"><a href=\"#2020-02-24\" class=\"headerlink\" title=\"2020/02/24\"></a>2020/02/24</h4><p>ä»Šæ—¥é˜…è¯»ï¼š<a href=\"https://stackoverflow.com/questions/54666401/how-to-use-throttle-or-debounce-with-react-hook\" target=\"_blank\" rel=\"noopener\">How to use throttle or debounce with React Hook?</a><br>åœ¨ä½¿ç”¨å‡½æ•°å¼ç»„ä»¶æ—¶ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦å¼•å…¥ lodash çš„ <code>throttle</code> æˆ– <code>debounce</code> ï¼Œå¾ˆå®¹æ˜“å†™å‡ºå¦‚ä¸‹é”™è¯¯ä»£ç ï¼š<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const ExComp:React.FC = () =&gt; &#123;</span><br><span class=\"line\">  ....</span><br><span class=\"line\">  // call it somewhere</span><br><span class=\"line\">  const throttle = lodash.throttle((value) =&gt; &#123;</span><br><span class=\"line\">    // do something</span><br><span class=\"line\">  &#125;,2000)</span><br><span class=\"line\">  ...</span><br><span class=\"line\">  return &lt;&gt;&lt;/&gt;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>ä¸Šè¿°ä»£ç ä¸­ï¼Œåœ¨å‡½æ•°å¼ç»„ä»¶ä¸­å¼•å…¥äº†ä¸€ä¸ª throttle å‡½æ•°ï¼ˆåº•å±‚å®ç°æ˜¯ <code>setTimeout</code>ï¼‰ï¼Œç„¶è€Œå¯¹äºå‡½æ•°å¼ç»„ä»¶è€Œè¨€ï¼Œæ¯ä¸€æ¬¡ rerender éƒ½ä¼šé‡æ–°åˆå§‹åŒ–å˜é‡ï¼Œæ‰€ä»¥ throttle å¹¶ä¸ä¼šç”Ÿæ•ˆã€‚è§£å†³è¿™ä¸ªé—®é¢˜å¯ä»¥ä½¿ç”¨ <code>useRef</code> æˆ–æ˜¯ <code>useCallback</code> ã€‚å¦‚ï¼š<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const App = () =&gt; &#123;</span><br><span class=\"line\">  const [value, setValue] = useState(0)ï¼›</span><br><span class=\"line\"></span><br><span class=\"line\">  const throttled = useRef(</span><br><span class=\"line\">    throttle((newValue) =&gt; console.log(newValue), 1000)</span><br><span class=\"line\">  )</span><br><span class=\"line\">  useEffect(() =&gt; throttled.current(value), [value])</span><br><span class=\"line\"></span><br><span class=\"line\">  // or</span><br><span class=\"line\">  // const throttled = useCallback(</span><br><span class=\"line\">  //  throttle((newValue) =&gt; console.log(newValue), 1000),</span><br><span class=\"line\">  //  []</span><br><span class=\"line\">  // );</span><br><span class=\"line\">  // useEffect(() =&gt; throttled(value), [value])</span><br><span class=\"line\"></span><br><span class=\"line\">  return (</span><br><span class=\"line\">    &lt;button onClick=&#123;() =&gt; setValue(value + 1)&#125;&gt;&#123;value&#125;&lt;/button&gt;</span><br><span class=\"line\">  )</span><br></pre></td></tr></table></figure></p>\n<p>è°ƒç”¨æ—¶ç›´æ¥ä½¿ç”¨ <code>throttled.current()</code> ï¼ˆæˆ– <code>throttled()</code> ï¼‰å³å¯ã€‚æ³¨æ„å¦‚æœåœ¨ throttle å‡½æ•°ä¸­éœ€è¦ç”¨åˆ°å‡½æ•°å¤–çš„ state å€¼ï¼Œåªèƒ½å–åˆ°åˆå§‹å€¼ï¼ˆé—­åŒ…ï¼‰ï¼Œè¿™ç§æ—¶å€™åªèƒ½å°†æ‰€éœ€å‚æ•°ä½œä¸º params ä¼ è¿›å»ã€‚æˆ–æ˜¯å°† throttle å‡½æ•°ç§»åˆ°ç»„ä»¶å¤–ã€‚</p>\n<h4 id=\"2020-02-21\"><a href=\"#2020-02-21\" class=\"headerlink\" title=\"2020/02/21\"></a>2020/02/21</h4><p>åœ¨ä½¿ç”¨ react hooks æ—¶ï¼Œå¦‚æœéœ€è¦åœ¨ç»„ä»¶ä¸­å®ä¾‹ä¸€ä¸ªç±»ï¼ˆå¦‚ <code>new stroe()</code>ï¼‰ï¼›ä¸ºäº†è®©è¯¥å˜é‡å˜æˆä¸€ä¸ª state ï¼Œè€Œä¸æ˜¯æ¯æ¬¡é‡æ–°æ¸²æŸ“æ—¶éƒ½ä¼šé‡æ–°åˆå§‹åŒ–ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨ <code>useState</code> ï¼š<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import &#123; useState &#125; from &quot;react&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">const XXX:React.FC = () =&gt; &#123;</span><br><span class=\"line\">  const [store] = useState(new Store());</span><br><span class=\"line\"></span><br><span class=\"line\">  return &lt;&gt;&lt;/&gt;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>å¼•å…¥æƒ°æ€§åˆå§‹ state ï¼Œä¼ å…¥ function ï¼Œå…³äºæƒ°æ€§åˆå§‹ state å¯ä»¥å‚è€ƒæ–‡æ¡£ <a href=\"https://reactjs.org/docs/hooks-reference.html#lazy-initial-state\" target=\"_blank\" rel=\"noopener\">Lazy initial state</a> éƒ¨åˆ†ï¼Œæ›´è¯¦ç»†çš„è§£é‡Šå¯ä»¥å‚è€ƒ StackOverflow ä¸Šè¿™ä¸ª <a href=\"https://stackoverflow.com/a/58539958\" target=\"_blank\" rel=\"noopener\">å›ç­”</a> ï¼Œå…·ä½“è€Œè¨€ï¼Œä¼ å…¥ function æ—¶åªä¼šåœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶è°ƒç”¨ï¼›å¦‚æœä¸å¼•å…¥æƒ°æ€§åˆå§‹ state ï¼Œè™½ç„¶ initialState åªä¼šåœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶ä½¿ç”¨ï¼Œä½†ä¼ å…¥ <code>useState</code> çš„å‡½æ•°è¿˜æ˜¯ä¼šè¿›è¡Œåˆå§‹åŒ–å’Œè°ƒç”¨ã€‚<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import &#123; useState &#125; from &quot;react&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">const XXX:React.FC = () =&gt; &#123;</span><br><span class=\"line\">  const [store] = useState(() =&gt; new Store());</span><br><span class=\"line\"></span><br><span class=\"line\">  return &lt;&gt;&lt;/&gt;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>è¿™æ ·å¸¦æ¥çš„é—®é¢˜æ˜¯ï¼Œå¦‚æœ store ä¸­çš„æˆå‘˜æ›´æ–°äº†ï¼Œå¹¶ä¸ä¼šè§¦å‘é‡æ–°æ¸²æŸ“ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å¼•å…¥ Mobx ï¼Œå‚è€ƒ mobx-react-lite ä¸­ <a href=\"https://github.com/mobxjs/mobx-react-lite#lazy-initialization\" target=\"_blank\" rel=\"noopener\">Lazy initialization</a> è¿™ä¸€èŠ‚ï¼š<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import &#123; observer &#125; from &quot;mobx-react-lite&quot;</span><br><span class=\"line\">import &#123; observable &#125; from &quot;mobx&quot;</span><br><span class=\"line\">import &#123; useState &#125; from &quot;react&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">const XXX:React.FC = observer(() =&gt; &#123;</span><br><span class=\"line\">  const [store] = useState(() =&gt; observable(new Store()));</span><br><span class=\"line\"></span><br><span class=\"line\">  return &lt;&gt;&lt;/&gt;;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure></p>\n"},{"title":"ã€Šä½ ä¸çŸ¥é“çš„ JavaScriptã€‹ï¼ˆä¸Šå·ï¼‰- è¯»ä¹¦ç¬”è®°","catalog":true,"date":"2020-01-16T03:47:52.000Z","subtitle":null,"header-img":null,"_content":"\n# DEPRECATED !!!\nâš ï¸âš ï¸âš ï¸\nä¸å‡ºæ„å¤–çš„è¯æœ¬ç³»åˆ—å¼ƒæ›´äº†ã€‚\né˜…è¯»åŠç¬”è®°éƒ½åœ¨å¾®ä¿¡è¯»ä¹¦ä¸Šå®Œæˆäº†ã€‚\n\n## ç¬¬ä¸€ç« ï¼šä½œç”¨åŸŸæ˜¯ä»€ä¹ˆ\n### 1.1 ç¼–è¯‘åŸç†\n1. ç¼–è¯‘çš„ä¸‰ä¸ªæ­¥éª¤ï¼šåˆ†è¯/è¯æ³•åˆ†æï¼ˆTokenizing/Lexingï¼‰ï¼›è§£æ/è¯­æ³•åˆ†æï¼ˆParsingï¼‰ï¼›ä»£ç ç”Ÿæˆï¼ˆAST->å¯æ‰§è¡Œä»£ç ï¼‰ã€‚\nç®€å•è€Œè¨€ï¼Œè€ƒè™‘è¯­å¥ `var a = 2;` ï¼Œå¼•æ“æœ‰åŠæ³•å°†è¯¥è¯­å¥å¯¹åº”çš„ AST è½¬æ¢ä¸ºæœºå™¨èƒ½ç†è§£çš„ä¸€ç»„æŒ‡ä»¤ï¼šåˆ›å»ºä¸€ä¸ªå«åš a çš„å˜é‡ï¼ˆåˆ†é…å†…å­˜ç­‰ï¼‰ï¼Œå¹¶å°†ä¸€ä¸ªå€¼å­˜å‚¨åœ¨ a ä¸­ã€‚\n2. å°½ç®¡é€šå¸¸å°† JavaScript å½’ç±»ä¸ºâ€œåŠ¨æ€â€æˆ–â€œè§£é‡Šæ‰§è¡Œâ€è¯­è¨€ï¼Œä½†äº‹å®ä¸Šå®ƒæ˜¯ä¸€é—¨ç¼–è¯‘è¯­è¨€ã€‚ä¸å¤§å¤šæ•°è¯­è¨€ä¸åŒçš„æ˜¯ï¼Œ JavaScript çš„ç¼–è¯‘ä¸æ˜¯å‘ç”Ÿåœ¨æ„å»ºä¹‹å‰çš„ï¼Œè€Œæ˜¯é€šå¸¸å‘ç”Ÿåœ¨ä»£ç æ‰§è¡Œå‰çš„å‡ å¾®ç§’ã€‚\n\n### 1.2 ç†è§£ä½œç”¨åŸŸ\n1. ç†è§£ä¸‰ä¸ªæ¦‚å¿µï¼š\n**å¼•æ“**ï¼šä»å¤´åˆ°å°¾è´Ÿè´£æ•´ä¸ª JavaScript ç¨‹åºçš„ç¼–è¯‘åŠæ‰§è¡Œè¿‡ç¨‹ï¼›\n**ç¼–è¯‘å™¨**ï¼šè´Ÿè´£è¯­æ³•åˆ†æåŠä»£ç ç”Ÿæˆç­‰ï¼›\n**ä½œç”¨åŸŸ**ï¼šè´Ÿè´£æ”¶é›†å¹¶ç»´æŠ¤ç”±æ‰€æœ‰å£°æ˜çš„æ ‡è¯†ç¬¦ï¼ˆå˜é‡ï¼‰ç»„æˆçš„ä¸€ç³»åˆ—æŸ¥è¯¢ï¼Œç¡®å®šå½“å‰æ‰§è¡Œçš„ä»£ç å¯¹è¿™äº›æ ‡è¯†ç¬¦çš„è®¿é—®æƒé™ã€‚\n2. `var a = 2;` çœ‹èµ·æ¥æ˜¯ä¸€å¥å£°æ˜ï¼Œä½†äº‹å®ä¸Šå¼•æ“ä¼šå½“æˆä¸¤ä¸ªå®Œå…¨ä¸åŒçš„å£°æ˜ï¼šä¸€ä¸ªç”±ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶å¤„ç†ï¼Œåœ¨å½“å‰ä½œç”¨åŸŸå£°æ˜ä¸€ä¸ª a å˜é‡ï¼›ä¸€ä¸ªç”±å¼•æ“åœ¨è¿è¡Œæ—¶å¤„ç†ï¼Œåœ¨ä½œç”¨åŸŸä¸­æŸ¥æ‰¾è¯¥å˜é‡ï¼Œè‹¥æ‰¾åˆ°ï¼Œåˆ™å¯¹ä»–è¿›è¡Œèµ‹å€¼ã€‚","source":"_posts/ã€Šä½ ä¸çŸ¥é“çš„-JavaScriptã€‹ï¼ˆä¸Šå·ï¼‰-è¯»ä¹¦ç¬”è®°.md","raw":"---\ntitle: ã€Šä½ ä¸çŸ¥é“çš„ JavaScriptã€‹ï¼ˆä¸Šå·ï¼‰- è¯»ä¹¦ç¬”è®°\ncatalog: true\ndate: 2020-01-16 11:47:52\nsubtitle:\nheader-img:\ntags: [FE,YDKJS]\n---\n\n# DEPRECATED !!!\nâš ï¸âš ï¸âš ï¸\nä¸å‡ºæ„å¤–çš„è¯æœ¬ç³»åˆ—å¼ƒæ›´äº†ã€‚\né˜…è¯»åŠç¬”è®°éƒ½åœ¨å¾®ä¿¡è¯»ä¹¦ä¸Šå®Œæˆäº†ã€‚\n\n## ç¬¬ä¸€ç« ï¼šä½œç”¨åŸŸæ˜¯ä»€ä¹ˆ\n### 1.1 ç¼–è¯‘åŸç†\n1. ç¼–è¯‘çš„ä¸‰ä¸ªæ­¥éª¤ï¼šåˆ†è¯/è¯æ³•åˆ†æï¼ˆTokenizing/Lexingï¼‰ï¼›è§£æ/è¯­æ³•åˆ†æï¼ˆParsingï¼‰ï¼›ä»£ç ç”Ÿæˆï¼ˆAST->å¯æ‰§è¡Œä»£ç ï¼‰ã€‚\nç®€å•è€Œè¨€ï¼Œè€ƒè™‘è¯­å¥ `var a = 2;` ï¼Œå¼•æ“æœ‰åŠæ³•å°†è¯¥è¯­å¥å¯¹åº”çš„ AST è½¬æ¢ä¸ºæœºå™¨èƒ½ç†è§£çš„ä¸€ç»„æŒ‡ä»¤ï¼šåˆ›å»ºä¸€ä¸ªå«åš a çš„å˜é‡ï¼ˆåˆ†é…å†…å­˜ç­‰ï¼‰ï¼Œå¹¶å°†ä¸€ä¸ªå€¼å­˜å‚¨åœ¨ a ä¸­ã€‚\n2. å°½ç®¡é€šå¸¸å°† JavaScript å½’ç±»ä¸ºâ€œåŠ¨æ€â€æˆ–â€œè§£é‡Šæ‰§è¡Œâ€è¯­è¨€ï¼Œä½†äº‹å®ä¸Šå®ƒæ˜¯ä¸€é—¨ç¼–è¯‘è¯­è¨€ã€‚ä¸å¤§å¤šæ•°è¯­è¨€ä¸åŒçš„æ˜¯ï¼Œ JavaScript çš„ç¼–è¯‘ä¸æ˜¯å‘ç”Ÿåœ¨æ„å»ºä¹‹å‰çš„ï¼Œè€Œæ˜¯é€šå¸¸å‘ç”Ÿåœ¨ä»£ç æ‰§è¡Œå‰çš„å‡ å¾®ç§’ã€‚\n\n### 1.2 ç†è§£ä½œç”¨åŸŸ\n1. ç†è§£ä¸‰ä¸ªæ¦‚å¿µï¼š\n**å¼•æ“**ï¼šä»å¤´åˆ°å°¾è´Ÿè´£æ•´ä¸ª JavaScript ç¨‹åºçš„ç¼–è¯‘åŠæ‰§è¡Œè¿‡ç¨‹ï¼›\n**ç¼–è¯‘å™¨**ï¼šè´Ÿè´£è¯­æ³•åˆ†æåŠä»£ç ç”Ÿæˆç­‰ï¼›\n**ä½œç”¨åŸŸ**ï¼šè´Ÿè´£æ”¶é›†å¹¶ç»´æŠ¤ç”±æ‰€æœ‰å£°æ˜çš„æ ‡è¯†ç¬¦ï¼ˆå˜é‡ï¼‰ç»„æˆçš„ä¸€ç³»åˆ—æŸ¥è¯¢ï¼Œç¡®å®šå½“å‰æ‰§è¡Œçš„ä»£ç å¯¹è¿™äº›æ ‡è¯†ç¬¦çš„è®¿é—®æƒé™ã€‚\n2. `var a = 2;` çœ‹èµ·æ¥æ˜¯ä¸€å¥å£°æ˜ï¼Œä½†äº‹å®ä¸Šå¼•æ“ä¼šå½“æˆä¸¤ä¸ªå®Œå…¨ä¸åŒçš„å£°æ˜ï¼šä¸€ä¸ªç”±ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶å¤„ç†ï¼Œåœ¨å½“å‰ä½œç”¨åŸŸå£°æ˜ä¸€ä¸ª a å˜é‡ï¼›ä¸€ä¸ªç”±å¼•æ“åœ¨è¿è¡Œæ—¶å¤„ç†ï¼Œåœ¨ä½œç”¨åŸŸä¸­æŸ¥æ‰¾è¯¥å˜é‡ï¼Œè‹¥æ‰¾åˆ°ï¼Œåˆ™å¯¹ä»–è¿›è¡Œèµ‹å€¼ã€‚","slug":"ã€Šä½ ä¸çŸ¥é“çš„-JavaScriptã€‹ï¼ˆä¸Šå·ï¼‰-è¯»ä¹¦ç¬”è®°","published":1,"updated":"2020-02-24T06:50:24.981Z","_id":"ck6vknhfs000hosue6dxnpqel","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"deprecated\"><a href=\"#DEPRECATED\" class=\"headerlink\" title=\"DEPRECATED !!!\"></a>DEPRECATED !!!</h1><p>âš ï¸âš ï¸âš ï¸<br>ä¸å‡ºæ„å¤–çš„è¯æœ¬ç³»åˆ—å¼ƒæ›´äº†ã€‚<br>é˜…è¯»åŠç¬”è®°éƒ½åœ¨å¾®ä¿¡è¯»ä¹¦ä¸Šå®Œæˆäº†ã€‚</p>\n<h2 id=\"ç¬¬ä¸€ç« ä½œç”¨åŸŸæ˜¯ä»€ä¹ˆ\"><a href=\"#ç¬¬ä¸€ç« ï¼šä½œç”¨åŸŸæ˜¯ä»€ä¹ˆ\" class=\"headerlink\" title=\"ç¬¬ä¸€ç« ï¼šä½œç”¨åŸŸæ˜¯ä»€ä¹ˆ\"></a>ç¬¬ä¸€ç« ï¼šä½œç”¨åŸŸæ˜¯ä»€ä¹ˆ</h2><h3 id=\"11-ç¼–è¯‘åŸç†\"><a href=\"#1-1-ç¼–è¯‘åŸç†\" class=\"headerlink\" title=\"1.1 ç¼–è¯‘åŸç†\"></a>1.1 ç¼–è¯‘åŸç†</h3><ol>\n<li>ç¼–è¯‘çš„ä¸‰ä¸ªæ­¥éª¤ï¼šåˆ†è¯/è¯æ³•åˆ†æï¼ˆTokenizing/Lexingï¼‰ï¼›è§£æ/è¯­æ³•åˆ†æï¼ˆParsingï¼‰ï¼›ä»£ç ç”Ÿæˆï¼ˆAST-&gt;å¯æ‰§è¡Œä»£ç ï¼‰ã€‚<br>ç®€å•è€Œè¨€ï¼Œè€ƒè™‘è¯­å¥ <code>var a = 2;</code> ï¼Œå¼•æ“æœ‰åŠæ³•å°†è¯¥è¯­å¥å¯¹åº”çš„ AST è½¬æ¢ä¸ºæœºå™¨èƒ½ç†è§£çš„ä¸€ç»„æŒ‡ä»¤ï¼šåˆ›å»ºä¸€ä¸ªå«åš a çš„å˜é‡ï¼ˆåˆ†é…å†…å­˜ç­‰ï¼‰ï¼Œå¹¶å°†ä¸€ä¸ªå€¼å­˜å‚¨åœ¨ a ä¸­ã€‚</li>\n<li>å°½ç®¡é€šå¸¸å°† JavaScript å½’ç±»ä¸ºâ€œåŠ¨æ€â€æˆ–â€œè§£é‡Šæ‰§è¡Œâ€è¯­è¨€ï¼Œä½†äº‹å®ä¸Šå®ƒæ˜¯ä¸€é—¨ç¼–è¯‘è¯­è¨€ã€‚ä¸å¤§å¤šæ•°è¯­è¨€ä¸åŒçš„æ˜¯ï¼Œ JavaScript çš„ç¼–è¯‘ä¸æ˜¯å‘ç”Ÿåœ¨æ„å»ºä¹‹å‰çš„ï¼Œè€Œæ˜¯é€šå¸¸å‘ç”Ÿåœ¨ä»£ç æ‰§è¡Œå‰çš„å‡ å¾®ç§’ã€‚</li>\n</ol>\n<h3 id=\"12-ç†è§£ä½œç”¨åŸŸ\"><a href=\"#1-2-ç†è§£ä½œç”¨åŸŸ\" class=\"headerlink\" title=\"1.2 ç†è§£ä½œç”¨åŸŸ\"></a>1.2 ç†è§£ä½œç”¨åŸŸ</h3><ol>\n<li>ç†è§£ä¸‰ä¸ªæ¦‚å¿µï¼š<br><strong>å¼•æ“</strong>ï¼šä»å¤´åˆ°å°¾è´Ÿè´£æ•´ä¸ª JavaScript ç¨‹åºçš„ç¼–è¯‘åŠæ‰§è¡Œè¿‡ç¨‹ï¼›<br><strong>ç¼–è¯‘å™¨</strong>ï¼šè´Ÿè´£è¯­æ³•åˆ†æåŠä»£ç ç”Ÿæˆç­‰ï¼›<br><strong>ä½œç”¨åŸŸ</strong>ï¼šè´Ÿè´£æ”¶é›†å¹¶ç»´æŠ¤ç”±æ‰€æœ‰å£°æ˜çš„æ ‡è¯†ç¬¦ï¼ˆå˜é‡ï¼‰ç»„æˆçš„ä¸€ç³»åˆ—æŸ¥è¯¢ï¼Œç¡®å®šå½“å‰æ‰§è¡Œçš„ä»£ç å¯¹è¿™äº›æ ‡è¯†ç¬¦çš„è®¿é—®æƒé™ã€‚</li>\n<li><code>var a = 2;</code> çœ‹èµ·æ¥æ˜¯ä¸€å¥å£°æ˜ï¼Œä½†äº‹å®ä¸Šå¼•æ“ä¼šå½“æˆä¸¤ä¸ªå®Œå…¨ä¸åŒçš„å£°æ˜ï¼šä¸€ä¸ªç”±ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶å¤„ç†ï¼Œåœ¨å½“å‰ä½œç”¨åŸŸå£°æ˜ä¸€ä¸ª a å˜é‡ï¼›ä¸€ä¸ªç”±å¼•æ“åœ¨è¿è¡Œæ—¶å¤„ç†ï¼Œåœ¨ä½œç”¨åŸŸä¸­æŸ¥æ‰¾è¯¥å˜é‡ï¼Œè‹¥æ‰¾åˆ°ï¼Œåˆ™å¯¹ä»–è¿›è¡Œèµ‹å€¼ã€‚</li>\n</ol>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"DEPRECATED\"><a href=\"#DEPRECATED\" class=\"headerlink\" title=\"DEPRECATED !!!\"></a>DEPRECATED !!!</h1><p>âš ï¸âš ï¸âš ï¸<br>ä¸å‡ºæ„å¤–çš„è¯æœ¬ç³»åˆ—å¼ƒæ›´äº†ã€‚<br>é˜…è¯»åŠç¬”è®°éƒ½åœ¨å¾®ä¿¡è¯»ä¹¦ä¸Šå®Œæˆäº†ã€‚</p>\n<h2 id=\"ç¬¬ä¸€ç« ï¼šä½œç”¨åŸŸæ˜¯ä»€ä¹ˆ\"><a href=\"#ç¬¬ä¸€ç« ï¼šä½œç”¨åŸŸæ˜¯ä»€ä¹ˆ\" class=\"headerlink\" title=\"ç¬¬ä¸€ç« ï¼šä½œç”¨åŸŸæ˜¯ä»€ä¹ˆ\"></a>ç¬¬ä¸€ç« ï¼šä½œç”¨åŸŸæ˜¯ä»€ä¹ˆ</h2><h3 id=\"1-1-ç¼–è¯‘åŸç†\"><a href=\"#1-1-ç¼–è¯‘åŸç†\" class=\"headerlink\" title=\"1.1 ç¼–è¯‘åŸç†\"></a>1.1 ç¼–è¯‘åŸç†</h3><ol>\n<li>ç¼–è¯‘çš„ä¸‰ä¸ªæ­¥éª¤ï¼šåˆ†è¯/è¯æ³•åˆ†æï¼ˆTokenizing/Lexingï¼‰ï¼›è§£æ/è¯­æ³•åˆ†æï¼ˆParsingï¼‰ï¼›ä»£ç ç”Ÿæˆï¼ˆAST-&gt;å¯æ‰§è¡Œä»£ç ï¼‰ã€‚<br>ç®€å•è€Œè¨€ï¼Œè€ƒè™‘è¯­å¥ <code>var a = 2;</code> ï¼Œå¼•æ“æœ‰åŠæ³•å°†è¯¥è¯­å¥å¯¹åº”çš„ AST è½¬æ¢ä¸ºæœºå™¨èƒ½ç†è§£çš„ä¸€ç»„æŒ‡ä»¤ï¼šåˆ›å»ºä¸€ä¸ªå«åš a çš„å˜é‡ï¼ˆåˆ†é…å†…å­˜ç­‰ï¼‰ï¼Œå¹¶å°†ä¸€ä¸ªå€¼å­˜å‚¨åœ¨ a ä¸­ã€‚</li>\n<li>å°½ç®¡é€šå¸¸å°† JavaScript å½’ç±»ä¸ºâ€œåŠ¨æ€â€æˆ–â€œè§£é‡Šæ‰§è¡Œâ€è¯­è¨€ï¼Œä½†äº‹å®ä¸Šå®ƒæ˜¯ä¸€é—¨ç¼–è¯‘è¯­è¨€ã€‚ä¸å¤§å¤šæ•°è¯­è¨€ä¸åŒçš„æ˜¯ï¼Œ JavaScript çš„ç¼–è¯‘ä¸æ˜¯å‘ç”Ÿåœ¨æ„å»ºä¹‹å‰çš„ï¼Œè€Œæ˜¯é€šå¸¸å‘ç”Ÿåœ¨ä»£ç æ‰§è¡Œå‰çš„å‡ å¾®ç§’ã€‚</li>\n</ol>\n<h3 id=\"1-2-ç†è§£ä½œç”¨åŸŸ\"><a href=\"#1-2-ç†è§£ä½œç”¨åŸŸ\" class=\"headerlink\" title=\"1.2 ç†è§£ä½œç”¨åŸŸ\"></a>1.2 ç†è§£ä½œç”¨åŸŸ</h3><ol>\n<li>ç†è§£ä¸‰ä¸ªæ¦‚å¿µï¼š<br><strong>å¼•æ“</strong>ï¼šä»å¤´åˆ°å°¾è´Ÿè´£æ•´ä¸ª JavaScript ç¨‹åºçš„ç¼–è¯‘åŠæ‰§è¡Œè¿‡ç¨‹ï¼›<br><strong>ç¼–è¯‘å™¨</strong>ï¼šè´Ÿè´£è¯­æ³•åˆ†æåŠä»£ç ç”Ÿæˆç­‰ï¼›<br><strong>ä½œç”¨åŸŸ</strong>ï¼šè´Ÿè´£æ”¶é›†å¹¶ç»´æŠ¤ç”±æ‰€æœ‰å£°æ˜çš„æ ‡è¯†ç¬¦ï¼ˆå˜é‡ï¼‰ç»„æˆçš„ä¸€ç³»åˆ—æŸ¥è¯¢ï¼Œç¡®å®šå½“å‰æ‰§è¡Œçš„ä»£ç å¯¹è¿™äº›æ ‡è¯†ç¬¦çš„è®¿é—®æƒé™ã€‚</li>\n<li><code>var a = 2;</code> çœ‹èµ·æ¥æ˜¯ä¸€å¥å£°æ˜ï¼Œä½†äº‹å®ä¸Šå¼•æ“ä¼šå½“æˆä¸¤ä¸ªå®Œå…¨ä¸åŒçš„å£°æ˜ï¼šä¸€ä¸ªç”±ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶å¤„ç†ï¼Œåœ¨å½“å‰ä½œç”¨åŸŸå£°æ˜ä¸€ä¸ª a å˜é‡ï¼›ä¸€ä¸ªç”±å¼•æ“åœ¨è¿è¡Œæ—¶å¤„ç†ï¼Œåœ¨ä½œç”¨åŸŸä¸­æŸ¥æ‰¾è¯¥å˜é‡ï¼Œè‹¥æ‰¾åˆ°ï¼Œåˆ™å¯¹ä»–è¿›è¡Œèµ‹å€¼ã€‚</li>\n</ol>\n"},{"title":"ML Resources Collection","catalog":true,"date":"2019-10-06T09:52:54.000Z","subtitle":null,"header-img":null,"mathjax":true,"_content":"\n## Tools\n\n1. Loss Landscape Visualization \nA tools for visualizing the Loss Landscape of Neural Nets.  \nNote: Support PyTorch 0.4 and 0.4+ is not evaluated.\nLink: [Github](https://github.com/tomgoldstein/loss-landscape)  \n2. Wasabi: A lightweight console printing and formatting toolkit\nNote: Work in progress but no updates since May 2019.\nLink: [Github](https://github.com/ines/wasabi)\n\n\n## Writing Guide\n1. [Research Proposal Guide](https://www.monash.edu/rlo/graduate-research-writing/write-the-thesis/writing-a-research-proposal)\n2. [How to write research paper](https://m.v.qq.com/play.html?&vid=k07751x7n6y&ptag=v_qq_com%23v.play.adaptor%233), çŸ­çŸ­16åˆ†é’Ÿï¼Œé’ˆé’ˆè§è¡€ï¼Œè¿™ä¸ªçœ‹äº†æŒºå¥½çš„\n\n## Blog\n1. [Tim Dettmers](https://timdettmers.com/): UW çš„ML PhDï¼Œå†™äº†äº›å­¦æœ¯æ€è€ƒ\n2. [Marvin Petersen\n](https://vinpetersen.github.io/): Dlå…¥é—¨çš„æ–‡ç« ","source":"_posts/Resources.md","raw":"---\ntitle: ML Resources Collection\ncatalog: true\ndate: 2019-10-06 17:52:54\nsubtitle:\nheader-img:\nmathjax: true\ntags: ML\n---\n\n## Tools\n\n1. Loss Landscape Visualization \nA tools for visualizing the Loss Landscape of Neural Nets.  \nNote: Support PyTorch 0.4 and 0.4+ is not evaluated.\nLink: [Github](https://github.com/tomgoldstein/loss-landscape)  \n2. Wasabi: A lightweight console printing and formatting toolkit\nNote: Work in progress but no updates since May 2019.\nLink: [Github](https://github.com/ines/wasabi)\n\n\n## Writing Guide\n1. [Research Proposal Guide](https://www.monash.edu/rlo/graduate-research-writing/write-the-thesis/writing-a-research-proposal)\n2. [How to write research paper](https://m.v.qq.com/play.html?&vid=k07751x7n6y&ptag=v_qq_com%23v.play.adaptor%233), çŸ­çŸ­16åˆ†é’Ÿï¼Œé’ˆé’ˆè§è¡€ï¼Œè¿™ä¸ªçœ‹äº†æŒºå¥½çš„\n\n## Blog\n1. [Tim Dettmers](https://timdettmers.com/): UW çš„ML PhDï¼Œå†™äº†äº›å­¦æœ¯æ€è€ƒ\n2. [Marvin Petersen\n](https://vinpetersen.github.io/): Dlå…¥é—¨çš„æ–‡ç« ","slug":"Resources","published":1,"updated":"2020-01-02T02:00:52.567Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck6vknhfw000josuew5wds524","content":"<h2 id=\"tools\">Tools</h2>\n<ol>\n<li>Loss Landscape Visualization<br>\nA tools for visualizing the Loss Landscape of Neural Nets.<br>\nNote: Support PyTorch 0.4 and 0.4+ is not evaluated.<br>\nLink: <a href=\"https://github.com/tomgoldstein/loss-landscape\" target=\"_blank\" rel=\"noopener\">Github</a></li>\n<li>Wasabi: A lightweight console printing and formatting toolkit<br>\nNote: Work in progress but no updates since May 2019.<br>\nLink: <a href=\"https://github.com/ines/wasabi\" target=\"_blank\" rel=\"noopener\">Github</a></li>\n</ol>\n<h2 id=\"writing-guide\">Writing Guide</h2>\n<ol>\n<li><a href=\"https://www.monash.edu/rlo/graduate-research-writing/write-the-thesis/writing-a-research-proposal\" target=\"_blank\" rel=\"noopener\">Research Proposal Guide</a></li>\n<li><a href=\"https://m.v.qq.com/play.html?&amp;vid=k07751x7n6y&amp;ptag=v_qq_com%23v.play.adaptor%233\" target=\"_blank\" rel=\"noopener\">How to write research paper</a>, çŸ­çŸ­16åˆ†é’Ÿï¼Œé’ˆé’ˆè§è¡€ï¼Œè¿™ä¸ªçœ‹äº†æŒºå¥½çš„</li>\n</ol>\n<h2 id=\"blog\">Blog</h2>\n<ol>\n<li><a href=\"https://timdettmers.com/\" target=\"_blank\" rel=\"noopener\">Tim Dettmers</a>: UW çš„ML PhDï¼Œå†™äº†äº›å­¦æœ¯æ€è€ƒ</li>\n<li><a href=\"https://vinpetersen.github.io/\" target=\"_blank\" rel=\"noopener\">Marvin Petersen<br>\n</a>: Dlå…¥é—¨çš„æ–‡ç« </li>\n</ol>\n","site":{"data":{}},"excerpt":"","more":"<h2>Tools</h2>\n<ol>\n<li>Loss Landscape Visualization<br>\nA tools for visualizing the Loss Landscape of Neural Nets.<br>\nNote: Support PyTorch 0.4 and 0.4+ is not evaluated.<br>\nLink: <a href=\"https://github.com/tomgoldstein/loss-landscape\" target=\"_blank\" rel=\"noopener\">Github</a></li>\n<li>Wasabi: A lightweight console printing and formatting toolkit<br>\nNote: Work in progress but no updates since May 2019.<br>\nLink: <a href=\"https://github.com/ines/wasabi\" target=\"_blank\" rel=\"noopener\">Github</a></li>\n</ol>\n<h2>Writing Guide</h2>\n<ol>\n<li><a href=\"https://www.monash.edu/rlo/graduate-research-writing/write-the-thesis/writing-a-research-proposal\" target=\"_blank\" rel=\"noopener\">Research Proposal Guide</a></li>\n<li><a href=\"https://m.v.qq.com/play.html?&amp;vid=k07751x7n6y&amp;ptag=v_qq_com%23v.play.adaptor%233\" target=\"_blank\" rel=\"noopener\">How to write research paper</a>, çŸ­çŸ­16åˆ†é’Ÿï¼Œé’ˆé’ˆè§è¡€ï¼Œè¿™ä¸ªçœ‹äº†æŒºå¥½çš„</li>\n</ol>\n<h2>Blog</h2>\n<ol>\n<li><a href=\"https://timdettmers.com/\" target=\"_blank\" rel=\"noopener\">Tim Dettmers</a>: UW çš„ML PhDï¼Œå†™äº†äº›å­¦æœ¯æ€è€ƒ</li>\n<li><a href=\"https://vinpetersen.github.io/\" target=\"_blank\" rel=\"noopener\">Marvin Petersen<br>\n</a>: Dlå…¥é—¨çš„æ–‡ç« </li>\n</ol>\n"},{"title":"We Are Graduated!","catalog":true,"date":"2019-06-13T09:53:24.000Z","subtitle":null,"header-img":null,"_content":"\nWe Are Graduated ! ğŸ“\n\nReady to move on ! ğŸ’ª","source":"_posts/We Are Graduated!.md","raw":"---\ntitle: We Are Graduated!\ncatalog: true\ndate: 2019-06-13 17:53:24\nsubtitle:\nheader-img:\ntags: Daily\n---\n\nWe Are Graduated ! ğŸ“\n\nReady to move on ! ğŸ’ª","slug":"We Are Graduated!","published":1,"updated":"2019-12-08T06:55:16.892Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck6vknhg0000mosuemt2vnnzz","content":"<p>We Are Graduated ! ğŸ“</p>\n<p>Ready to move on ! ğŸ’ª</p>\n","site":{"data":{}},"excerpt":"","more":"<p>We Are Graduated ! ğŸ“</p>\n<p>Ready to move on ! ğŸ’ª</p>\n"},{"title":"What is Gumbel-Softmax Trickï¼Ÿ","catalog":true,"date":"2019-07-16T12:02:54.000Z","subtitle":null,"header-img":null,"mathjax":true,"_content":"\nGumbel-Softmax trick åœ¨VAEã€GANã€NASç­‰æ·±åº¦å­¦ä¹ é¢†åŸŸç»å¸¸å‡ºç°ï¼Œé‚£å®ƒåˆ°åº•æ˜¯å•¥ï¼Œæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ  \n\n### èƒŒæ™¯é—®é¢˜\né¦–å…ˆç®€è¦ä»‹ç»ä¸€ä¸‹é—®é¢˜çš„èƒŒæ™¯ã€‚å‡è®¾æˆ‘ä»¬åœ¨ç½‘ç»œä¸­æœ‰ä¸€ä¸ªæœ‰ \\\\(n\\\\) ä¸ªå–å€¼çš„ç¦»æ•£åˆ†å¸ƒ\\\\(P(x)\\\\)ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ª\\\\(n\\\\)ç»´çš„å‘é‡ï¼Œæ¯ä¸€ä¸ªå…ƒç´ å°±æ˜¯ä¸€ä¸ªæ¦‚ç‡å€¼ã€‚å¦‚æœæˆ‘ä»¬åªæ˜¯è¦å¯¹å…¶è¿›è¡Œé‡‡æ ·æˆ–è€…å¾—åˆ°æœ€ç»ˆæ¦‚ç‡æœ€å¤§çš„ä¸€ä¸ªå–å€¼ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å°±å¯ä»¥ç›´æ¥é‡‡æ ·æˆ–å–\\\\(arg \\max\\\\)å¾—åˆ°ç»“æœã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬å¸Œæœ›è¿™ä¸ªè¿‡ç¨‹æ˜¯å¯å¯¼çš„ï¼Œè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ\n\n### Re-Parameterization Trick\né¦–å…ˆä»‹ç»ä¸€ä¸ªå«é‡å‚æ•°åŒ–(Re-Parameterization)çš„ä¸œè¥¿ï¼ŒRe-Parameterizationè§£å†³äº†ä¸Šé¢æåˆ°çš„é‡‡æ ·ä¸å¯å¯¼çš„é—®é¢˜ã€‚è¿™é‡Œç”¨æ²¹ç®¡ä¸Šä¸€ä¸ª[å˜åˆ†è‡ªåŠ¨ç¼–ç å™¨æ•™ç¨‹](https://www.youtube.com/watch?v=9zKuYvjFFS8)ä¸­çš„å›¾ç‰‡æ¥è§£é‡Šã€‚\n![re-paramerise](re-paramerise.png)\né¦–å…ˆå·¦è¾¹æ˜¯é‡å‚æ•°åŒ–ä¹‹å‰çš„å½¢å¼ï¼Œæˆ‘ä»¬å¸Œæœ›é€šè¿‡å­¦ä¹ åˆ°äº†æ ‡å‡†å·®\\\\(\\phi\\\\)å’Œå‡å€¼\\\\(x\\\\)ï¼Œé€šè¿‡å¯¹åˆ†å¸ƒ\\\\(q\\\\)è¿›è¡Œé‡‡æ ·å¾—åˆ°\\\\(z\\\\)ï¼Œç„¶åä¼ å…¥ä¸‹ä¸€å±‚ç½‘ç»œã€‚ç„¶è€Œè¿™å°±æœ‰ä¸ªé—®é¢˜ï¼Œé‡‡æ ·è¿‡ç¨‹æ˜¯æ²¡æ³•åä¼ çš„ï¼Œè¿™æ ·åŠ è½½ç½‘ç»œä¸­å°±æ²¡æ³•å­¦ä¹ äº†ï¼Œå› æ­¤å°±æœ‰äº†å³è¾¹çš„å½¢å¼ã€‚  \n\nåœ¨è¿™é‡Œå‘¢ï¼Œå…¶å®å°±æ˜¯åœ¨ç½‘ç»œä¸­åªä¿ç•™å¯ä»¥æ±‚å¯¼çš„éƒ¨åˆ†ï¼ŒæŠŠä¸å¯å¯¼çš„é‡‡æ ·éƒ¨åˆ†æ”¾åˆ°ç½‘ç»œå¤–ç”¨ä¸€ä¸ªæ–°çš„è¾“å…¥èŠ‚ç‚¹\\\\(\\epsilon\\\\)è¡¨ç¤ºã€‚\\\\(\\epsilon\\\\)é‡‡æ ·çš„è¿‡ç¨‹å’Œç½‘ç»œå­¦ä¹ æ˜¯åˆ†ç¦»çš„ï¼Œå› æ­¤ä¸å½±å“ç½‘ç»œåä¼ ã€‚  \n\nå…·ä½“è€Œè¨€ï¼Œå‡è®¾æˆ‘ä»¬éœ€è¦æ ¹æ®å‡å€¼å’Œæ–¹å·®ä»æ­£å¤ªåˆ†å¸ƒ\\\\(N(x,\\phi^2)\\\\)é‡‡æ ·ï¼Œæˆ‘ä»¬å¯ä»¥è½¬åŒ–ä¸ºå…ˆä»\\\\(\\epsilon=N(0,1)\\\\)é‡‡æ ·ï¼Œç„¶åè®¡ç®—\\\\(z=x+\\epsilon\\cdot \\phi\\\\)æ¥å¾—åˆ°æˆ‘ä»¬éœ€è¦çš„\\\\(z\\\\)ã€‚\n\n### Gumbel-Softmax Trick\né€šè¿‡Re-Parameterization Trickæˆ‘ä»¬å¯ä»¥ä¸€å®šæ¡ä»¶ä¸‹è§£å†³é‡‡æ ·ä¸å¯å¯¼çš„é—®é¢˜ã€‚ä½†å›åˆ°æˆ‘ä»¬æœ€åˆçš„é—®é¢˜ï¼Œæˆ‘ä»¬å¹¶ä¸æ˜¯åœ¨è¿ç»­çš„é«˜æ–¯åˆ†å¸ƒä¸Šé‡‡æ ·ï¼Œè€Œæ˜¯åœ¨ä¸€ä¸ªç¦»æ•£åˆ†å¸ƒ\\\\(P(x)\\\\)ä¸Šé‡‡æ ·ã€‚ä¸Šé¢çš„é‡å‚æ•°åæ˜¯å¯å¯¼çš„ï¼Œè€Œæ¢æˆç¦»æ•£åˆ†å¸ƒä»¥åï¼Œå°±æ— æ³•æ»¡è¶³äº†ã€‚æ‰€ä»¥ï¼Œå¯¹äºç¦»æ•£åˆ†å¸ƒè¦æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ\nç±»ä¼¼ä¸å‰é¢çš„é‡å‚æ•°æŠ€å·§ï¼Œæˆ‘ä»¬å¯¹äºç¦»æ•£å˜é‡æœ‰Gumbel-Max trickçš„é‡‡æ ·æ–¹æ³•ï¼š\n![gumbel-max](gumbel1.png)\nä»ä¸Šå›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬å°†ç¦»æ•£å˜é‡\\\\(\\log{\\alpha_1}, \\log{\\alpha_2}, \\log{\\alpha_3}\\\\)åŠ ä¸ŠGumbelå™ªå£°ï¼Œç„¶åå¯¹ç›¸åŠ åçš„éšæœºå˜é‡å–\\\\(\\arg \\max\\\\)åå¾—åˆ°ä¸€ä¸ªonehotå‘é‡ï¼Œå°±æ˜¯æˆ‘ä»¬çš„é‡‡æ ·ç»“æœï¼Œå¯ä»¥è¡¨ç¤ºä¸ºï¼š\n$$x_{\\alpha}=\\arg\\max(\\log(\\alpha_i)+G_i)$$\nä½†\\\\(\\arg \\max\\\\)è¿™ä¸ªæ“ä½œæ˜¯æ²¡æ³•æ±‚å¯¼çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ç”¨softmaxæ¥å¯¹\\\\(\\arg \\max\\\\)è¿›è¡Œæ¾å¼›ï¼Œè¿™å°±å¾—åˆ°äº†æˆ‘ä»¬çš„Gumbel-Softmax Trick:\n![gumbel-back](gumbel2.png)\nå…¶ä¸­ï¼Œ\\\\(\\lambda\\\\)æ˜¯softmaxå‡½æ•°çš„temperatureå‚æ•°ï¼Œç”¨äºæ§åˆ¶é‡‡æ · å½“\\\\(\\lambda \\to \\infty\\\\)æ—¶ï¼Œæ‰€æœ‰çš„æ¿€æ´»å€¼å¯¹åº”çš„æ¿€æ´»æ¦‚ç‡è¶‹è¿‘äºç›¸åŒï¼ˆæ¿€æ´»æ¦‚ç‡å·®å¼‚æ€§è¾ƒå°ï¼‰ï¼›è€Œå½“\\\\(\\lambda \\to 0\\\\)ï¼Œä¸åŒçš„æ¿€æ´»å€¼å¯¹åº”çš„æ¿€æ´»æ¦‚ç‡å·®å¼‚ä¹Ÿå°±è¶Šå¤§ï¼Œä¹Ÿå°±è¶Šè¶‹å‘äºonehotå‘é‡ã€‚ï¼ˆæ¸©åº¦è¿™ä¸ªè¯ä¸»è¦æ¥è‡ªäºç‰©ç†å­¦ä¸­çš„æ¸©åº¦ï¼Œå½“æ¸©åº¦é«˜çš„æ—¶å€™ï¼Œåˆ†å­çš„è¿åŠ¨å°±è¶Šå‰§çƒˆï¼Œéšæœºæ€§å°±è¶Šå¤§ï¼Œåä¹‹åˆ™è¶Šç¨³å®šï¼Œéšæœºæ€§è¶Šå°ï¼‰  \nåˆ°è¿™é‡Œï¼Œæˆ‘ä»¬æ—¢å¯ä»¥å¯¹åˆ†å¸ƒè¿›è¡Œé‡‡æ ·ï¼Œåˆèƒ½å¤Ÿæ»¡è¶³åœ¨ç½‘ç»œä¸­å¯ä»¥åå‘ä¼ æ’­å­¦ä¹ ã€‚  \nä½†æˆ‘ä»¬å¯èƒ½è¿˜ä¼šæœ‰è¿™æ ·çš„é—®é¢˜ï¼šä¸ºä»€ä¹ˆä¸ç›´æ¥å°±ç”¨softmaxå‡½æ•°å‘¢ï¼Œè¿™æ ·ä¸æ˜¯ä¹Ÿèƒ½åœ¨ç½‘ç»œä¸­å­¦ä¹ ä¹ˆï¼Ÿæˆ‘ä»¬å†å›é¡¾ä¸‹æˆ‘ä»¬çš„é—®é¢˜å°±èƒ½å‘ç°ï¼Œæˆ‘ä»¬éœ€è¦é‡‡æ ·+èƒ½åä¼ ï¼Œsoftmaxæ»¡è¶³èƒ½åä¼ ä½†æ˜¯å®ƒä¸èƒ½è¾¾åˆ°æˆ‘ä»¬æ ¹æ®æ¦‚ç‡åˆ†å¸ƒé‡‡æ ·çš„ç›®çš„ï¼Œè€ŒGumbel-Max Trickå°±æ˜¯ç”¨æ¥è¿‘ä¼¼åˆ†å¸ƒç„¶åé‡‡æ ·çš„ã€‚  \nå¦å¤–ï¼Œæˆ‘ä»¬åœ¨æ­¤ç”¨åˆ°äº†Gumbel Distribution--\\\\(G\\\\)ï¼Œæ˜¯ä¸€ä¸ªæå€¼åˆ†å¸ƒï¼Œé€šä¿—æ¥è®²å°±æ˜¯åˆ†å¸ƒçš„æå€¼çš„åˆ†å¸ƒï¼Œå…·ä½“å¯å‚è€ƒï¼š\n[Gumbel distribution](https://en.wikipedia.org/wiki/Gumbel_distribution)\n\n### å‚è€ƒ\n[Gumbel-Softmax Trickå’ŒGumbelåˆ†å¸ƒ](https://www.cnblogs.com/initial-h/p/9468974.html)\n[The Gumbel-Softmax Trick for Inference of Discrete Variables](https://casmls.github.io/general/2017/02/01/GumbelSoftmax.html)\n[Variational Autoencoders](https://www.youtube.com/watch?v=9zKuYvjFFS8)\n[å¸¦ä½ è®¤è¯†ç¥å¥‡çš„Gumbel trick](https://blog.csdn.net/a358463121/article/details/80820878)\n[Talk: Categorical Reparameterization with Gumbel-Softmax & The Concrete Distribution](https://www.youtube.com/watch?v=wVkLM2KKHp8)","source":"_posts/What-is-Gumbel-Softmax-Trick.md","raw":"---\ntitle: What is Gumbel-Softmax Trickï¼Ÿ\ncatalog: true\ndate: 2019-07-16 20:02:54\nsubtitle:\nheader-img:\nmathjax: true\ntags: ML\n---\n\nGumbel-Softmax trick åœ¨VAEã€GANã€NASç­‰æ·±åº¦å­¦ä¹ é¢†åŸŸç»å¸¸å‡ºç°ï¼Œé‚£å®ƒåˆ°åº•æ˜¯å•¥ï¼Œæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ  \n\n### èƒŒæ™¯é—®é¢˜\né¦–å…ˆç®€è¦ä»‹ç»ä¸€ä¸‹é—®é¢˜çš„èƒŒæ™¯ã€‚å‡è®¾æˆ‘ä»¬åœ¨ç½‘ç»œä¸­æœ‰ä¸€ä¸ªæœ‰ \\\\(n\\\\) ä¸ªå–å€¼çš„ç¦»æ•£åˆ†å¸ƒ\\\\(P(x)\\\\)ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ª\\\\(n\\\\)ç»´çš„å‘é‡ï¼Œæ¯ä¸€ä¸ªå…ƒç´ å°±æ˜¯ä¸€ä¸ªæ¦‚ç‡å€¼ã€‚å¦‚æœæˆ‘ä»¬åªæ˜¯è¦å¯¹å…¶è¿›è¡Œé‡‡æ ·æˆ–è€…å¾—åˆ°æœ€ç»ˆæ¦‚ç‡æœ€å¤§çš„ä¸€ä¸ªå–å€¼ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å°±å¯ä»¥ç›´æ¥é‡‡æ ·æˆ–å–\\\\(arg \\max\\\\)å¾—åˆ°ç»“æœã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬å¸Œæœ›è¿™ä¸ªè¿‡ç¨‹æ˜¯å¯å¯¼çš„ï¼Œè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ\n\n### Re-Parameterization Trick\né¦–å…ˆä»‹ç»ä¸€ä¸ªå«é‡å‚æ•°åŒ–(Re-Parameterization)çš„ä¸œè¥¿ï¼ŒRe-Parameterizationè§£å†³äº†ä¸Šé¢æåˆ°çš„é‡‡æ ·ä¸å¯å¯¼çš„é—®é¢˜ã€‚è¿™é‡Œç”¨æ²¹ç®¡ä¸Šä¸€ä¸ª[å˜åˆ†è‡ªåŠ¨ç¼–ç å™¨æ•™ç¨‹](https://www.youtube.com/watch?v=9zKuYvjFFS8)ä¸­çš„å›¾ç‰‡æ¥è§£é‡Šã€‚\n![re-paramerise](re-paramerise.png)\né¦–å…ˆå·¦è¾¹æ˜¯é‡å‚æ•°åŒ–ä¹‹å‰çš„å½¢å¼ï¼Œæˆ‘ä»¬å¸Œæœ›é€šè¿‡å­¦ä¹ åˆ°äº†æ ‡å‡†å·®\\\\(\\phi\\\\)å’Œå‡å€¼\\\\(x\\\\)ï¼Œé€šè¿‡å¯¹åˆ†å¸ƒ\\\\(q\\\\)è¿›è¡Œé‡‡æ ·å¾—åˆ°\\\\(z\\\\)ï¼Œç„¶åä¼ å…¥ä¸‹ä¸€å±‚ç½‘ç»œã€‚ç„¶è€Œè¿™å°±æœ‰ä¸ªé—®é¢˜ï¼Œé‡‡æ ·è¿‡ç¨‹æ˜¯æ²¡æ³•åä¼ çš„ï¼Œè¿™æ ·åŠ è½½ç½‘ç»œä¸­å°±æ²¡æ³•å­¦ä¹ äº†ï¼Œå› æ­¤å°±æœ‰äº†å³è¾¹çš„å½¢å¼ã€‚  \n\nåœ¨è¿™é‡Œå‘¢ï¼Œå…¶å®å°±æ˜¯åœ¨ç½‘ç»œä¸­åªä¿ç•™å¯ä»¥æ±‚å¯¼çš„éƒ¨åˆ†ï¼ŒæŠŠä¸å¯å¯¼çš„é‡‡æ ·éƒ¨åˆ†æ”¾åˆ°ç½‘ç»œå¤–ç”¨ä¸€ä¸ªæ–°çš„è¾“å…¥èŠ‚ç‚¹\\\\(\\epsilon\\\\)è¡¨ç¤ºã€‚\\\\(\\epsilon\\\\)é‡‡æ ·çš„è¿‡ç¨‹å’Œç½‘ç»œå­¦ä¹ æ˜¯åˆ†ç¦»çš„ï¼Œå› æ­¤ä¸å½±å“ç½‘ç»œåä¼ ã€‚  \n\nå…·ä½“è€Œè¨€ï¼Œå‡è®¾æˆ‘ä»¬éœ€è¦æ ¹æ®å‡å€¼å’Œæ–¹å·®ä»æ­£å¤ªåˆ†å¸ƒ\\\\(N(x,\\phi^2)\\\\)é‡‡æ ·ï¼Œæˆ‘ä»¬å¯ä»¥è½¬åŒ–ä¸ºå…ˆä»\\\\(\\epsilon=N(0,1)\\\\)é‡‡æ ·ï¼Œç„¶åè®¡ç®—\\\\(z=x+\\epsilon\\cdot \\phi\\\\)æ¥å¾—åˆ°æˆ‘ä»¬éœ€è¦çš„\\\\(z\\\\)ã€‚\n\n### Gumbel-Softmax Trick\né€šè¿‡Re-Parameterization Trickæˆ‘ä»¬å¯ä»¥ä¸€å®šæ¡ä»¶ä¸‹è§£å†³é‡‡æ ·ä¸å¯å¯¼çš„é—®é¢˜ã€‚ä½†å›åˆ°æˆ‘ä»¬æœ€åˆçš„é—®é¢˜ï¼Œæˆ‘ä»¬å¹¶ä¸æ˜¯åœ¨è¿ç»­çš„é«˜æ–¯åˆ†å¸ƒä¸Šé‡‡æ ·ï¼Œè€Œæ˜¯åœ¨ä¸€ä¸ªç¦»æ•£åˆ†å¸ƒ\\\\(P(x)\\\\)ä¸Šé‡‡æ ·ã€‚ä¸Šé¢çš„é‡å‚æ•°åæ˜¯å¯å¯¼çš„ï¼Œè€Œæ¢æˆç¦»æ•£åˆ†å¸ƒä»¥åï¼Œå°±æ— æ³•æ»¡è¶³äº†ã€‚æ‰€ä»¥ï¼Œå¯¹äºç¦»æ•£åˆ†å¸ƒè¦æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ\nç±»ä¼¼ä¸å‰é¢çš„é‡å‚æ•°æŠ€å·§ï¼Œæˆ‘ä»¬å¯¹äºç¦»æ•£å˜é‡æœ‰Gumbel-Max trickçš„é‡‡æ ·æ–¹æ³•ï¼š\n![gumbel-max](gumbel1.png)\nä»ä¸Šå›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬å°†ç¦»æ•£å˜é‡\\\\(\\log{\\alpha_1}, \\log{\\alpha_2}, \\log{\\alpha_3}\\\\)åŠ ä¸ŠGumbelå™ªå£°ï¼Œç„¶åå¯¹ç›¸åŠ åçš„éšæœºå˜é‡å–\\\\(\\arg \\max\\\\)åå¾—åˆ°ä¸€ä¸ªonehotå‘é‡ï¼Œå°±æ˜¯æˆ‘ä»¬çš„é‡‡æ ·ç»“æœï¼Œå¯ä»¥è¡¨ç¤ºä¸ºï¼š\n$$x_{\\alpha}=\\arg\\max(\\log(\\alpha_i)+G_i)$$\nä½†\\\\(\\arg \\max\\\\)è¿™ä¸ªæ“ä½œæ˜¯æ²¡æ³•æ±‚å¯¼çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ç”¨softmaxæ¥å¯¹\\\\(\\arg \\max\\\\)è¿›è¡Œæ¾å¼›ï¼Œè¿™å°±å¾—åˆ°äº†æˆ‘ä»¬çš„Gumbel-Softmax Trick:\n![gumbel-back](gumbel2.png)\nå…¶ä¸­ï¼Œ\\\\(\\lambda\\\\)æ˜¯softmaxå‡½æ•°çš„temperatureå‚æ•°ï¼Œç”¨äºæ§åˆ¶é‡‡æ · å½“\\\\(\\lambda \\to \\infty\\\\)æ—¶ï¼Œæ‰€æœ‰çš„æ¿€æ´»å€¼å¯¹åº”çš„æ¿€æ´»æ¦‚ç‡è¶‹è¿‘äºç›¸åŒï¼ˆæ¿€æ´»æ¦‚ç‡å·®å¼‚æ€§è¾ƒå°ï¼‰ï¼›è€Œå½“\\\\(\\lambda \\to 0\\\\)ï¼Œä¸åŒçš„æ¿€æ´»å€¼å¯¹åº”çš„æ¿€æ´»æ¦‚ç‡å·®å¼‚ä¹Ÿå°±è¶Šå¤§ï¼Œä¹Ÿå°±è¶Šè¶‹å‘äºonehotå‘é‡ã€‚ï¼ˆæ¸©åº¦è¿™ä¸ªè¯ä¸»è¦æ¥è‡ªäºç‰©ç†å­¦ä¸­çš„æ¸©åº¦ï¼Œå½“æ¸©åº¦é«˜çš„æ—¶å€™ï¼Œåˆ†å­çš„è¿åŠ¨å°±è¶Šå‰§çƒˆï¼Œéšæœºæ€§å°±è¶Šå¤§ï¼Œåä¹‹åˆ™è¶Šç¨³å®šï¼Œéšæœºæ€§è¶Šå°ï¼‰  \nåˆ°è¿™é‡Œï¼Œæˆ‘ä»¬æ—¢å¯ä»¥å¯¹åˆ†å¸ƒè¿›è¡Œé‡‡æ ·ï¼Œåˆèƒ½å¤Ÿæ»¡è¶³åœ¨ç½‘ç»œä¸­å¯ä»¥åå‘ä¼ æ’­å­¦ä¹ ã€‚  \nä½†æˆ‘ä»¬å¯èƒ½è¿˜ä¼šæœ‰è¿™æ ·çš„é—®é¢˜ï¼šä¸ºä»€ä¹ˆä¸ç›´æ¥å°±ç”¨softmaxå‡½æ•°å‘¢ï¼Œè¿™æ ·ä¸æ˜¯ä¹Ÿèƒ½åœ¨ç½‘ç»œä¸­å­¦ä¹ ä¹ˆï¼Ÿæˆ‘ä»¬å†å›é¡¾ä¸‹æˆ‘ä»¬çš„é—®é¢˜å°±èƒ½å‘ç°ï¼Œæˆ‘ä»¬éœ€è¦é‡‡æ ·+èƒ½åä¼ ï¼Œsoftmaxæ»¡è¶³èƒ½åä¼ ä½†æ˜¯å®ƒä¸èƒ½è¾¾åˆ°æˆ‘ä»¬æ ¹æ®æ¦‚ç‡åˆ†å¸ƒé‡‡æ ·çš„ç›®çš„ï¼Œè€ŒGumbel-Max Trickå°±æ˜¯ç”¨æ¥è¿‘ä¼¼åˆ†å¸ƒç„¶åé‡‡æ ·çš„ã€‚  \nå¦å¤–ï¼Œæˆ‘ä»¬åœ¨æ­¤ç”¨åˆ°äº†Gumbel Distribution--\\\\(G\\\\)ï¼Œæ˜¯ä¸€ä¸ªæå€¼åˆ†å¸ƒï¼Œé€šä¿—æ¥è®²å°±æ˜¯åˆ†å¸ƒçš„æå€¼çš„åˆ†å¸ƒï¼Œå…·ä½“å¯å‚è€ƒï¼š\n[Gumbel distribution](https://en.wikipedia.org/wiki/Gumbel_distribution)\n\n### å‚è€ƒ\n[Gumbel-Softmax Trickå’ŒGumbelåˆ†å¸ƒ](https://www.cnblogs.com/initial-h/p/9468974.html)\n[The Gumbel-Softmax Trick for Inference of Discrete Variables](https://casmls.github.io/general/2017/02/01/GumbelSoftmax.html)\n[Variational Autoencoders](https://www.youtube.com/watch?v=9zKuYvjFFS8)\n[å¸¦ä½ è®¤è¯†ç¥å¥‡çš„Gumbel trick](https://blog.csdn.net/a358463121/article/details/80820878)\n[Talk: Categorical Reparameterization with Gumbel-Softmax & The Concrete Distribution](https://www.youtube.com/watch?v=wVkLM2KKHp8)","slug":"What-is-Gumbel-Softmax-Trick","published":1,"updated":"2019-12-09T16:09:11.836Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck6vknhg3000oosuehdqs7xdr","content":"<p>Gumbel-Softmax trick åœ¨VAEã€GANã€NASç­‰æ·±åº¦å­¦ä¹ é¢†åŸŸç»å¸¸å‡ºç°ï¼Œé‚£å®ƒåˆ°åº•æ˜¯å•¥ï¼Œæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ</p>\n<h3 id=\"èƒŒæ™¯é—®é¢˜\">èƒŒæ™¯é—®é¢˜</h3>\n<p>é¦–å…ˆç®€è¦ä»‹ç»ä¸€ä¸‹é—®é¢˜çš„èƒŒæ™¯ã€‚å‡è®¾æˆ‘ä»¬åœ¨ç½‘ç»œä¸­æœ‰ä¸€ä¸ªæœ‰ \\(n\\) ä¸ªå–å€¼çš„ç¦»æ•£åˆ†å¸ƒ\\(P(x)\\)ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ª\\(n\\)ç»´çš„å‘é‡ï¼Œæ¯ä¸€ä¸ªå…ƒç´ å°±æ˜¯ä¸€ä¸ªæ¦‚ç‡å€¼ã€‚å¦‚æœæˆ‘ä»¬åªæ˜¯è¦å¯¹å…¶è¿›è¡Œé‡‡æ ·æˆ–è€…å¾—åˆ°æœ€ç»ˆæ¦‚ç‡æœ€å¤§çš„ä¸€ä¸ªå–å€¼ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å°±å¯ä»¥ç›´æ¥é‡‡æ ·æˆ–å–\\(arg \\max\\)å¾—åˆ°ç»“æœã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬å¸Œæœ›è¿™ä¸ªè¿‡ç¨‹æ˜¯å¯å¯¼çš„ï¼Œè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p>\n<h3 id=\"re-parameterization-trick\">Re-Parameterization Trick</h3>\n<p>é¦–å…ˆä»‹ç»ä¸€ä¸ªå«é‡å‚æ•°åŒ–(Re-Parameterization)çš„ä¸œè¥¿ï¼ŒRe-Parameterizationè§£å†³äº†ä¸Šé¢æåˆ°çš„é‡‡æ ·ä¸å¯å¯¼çš„é—®é¢˜ã€‚è¿™é‡Œç”¨æ²¹ç®¡ä¸Šä¸€ä¸ª<a href=\"https://www.youtube.com/watch?v=9zKuYvjFFS8\" target=\"_blank\" rel=\"noopener\">å˜åˆ†è‡ªåŠ¨ç¼–ç å™¨æ•™ç¨‹</a>ä¸­çš„å›¾ç‰‡æ¥è§£é‡Šã€‚<br>\n<img src=\"re-paramerise.png\" alt=\"re-paramerise\"><br>\né¦–å…ˆå·¦è¾¹æ˜¯é‡å‚æ•°åŒ–ä¹‹å‰çš„å½¢å¼ï¼Œæˆ‘ä»¬å¸Œæœ›é€šè¿‡å­¦ä¹ åˆ°äº†æ ‡å‡†å·®\\(\\phi\\)å’Œå‡å€¼\\(x\\)ï¼Œé€šè¿‡å¯¹åˆ†å¸ƒ\\(q\\)è¿›è¡Œé‡‡æ ·å¾—åˆ°\\(z\\)ï¼Œç„¶åä¼ å…¥ä¸‹ä¸€å±‚ç½‘ç»œã€‚ç„¶è€Œè¿™å°±æœ‰ä¸ªé—®é¢˜ï¼Œé‡‡æ ·è¿‡ç¨‹æ˜¯æ²¡æ³•åä¼ çš„ï¼Œè¿™æ ·åŠ è½½ç½‘ç»œä¸­å°±æ²¡æ³•å­¦ä¹ äº†ï¼Œå› æ­¤å°±æœ‰äº†å³è¾¹çš„å½¢å¼ã€‚</p>\n<p>åœ¨è¿™é‡Œå‘¢ï¼Œå…¶å®å°±æ˜¯åœ¨ç½‘ç»œä¸­åªä¿ç•™å¯ä»¥æ±‚å¯¼çš„éƒ¨åˆ†ï¼ŒæŠŠä¸å¯å¯¼çš„é‡‡æ ·éƒ¨åˆ†æ”¾åˆ°ç½‘ç»œå¤–ç”¨ä¸€ä¸ªæ–°çš„è¾“å…¥èŠ‚ç‚¹\\(\\epsilon\\)è¡¨ç¤ºã€‚\\(\\epsilon\\)é‡‡æ ·çš„è¿‡ç¨‹å’Œç½‘ç»œå­¦ä¹ æ˜¯åˆ†ç¦»çš„ï¼Œå› æ­¤ä¸å½±å“ç½‘ç»œåä¼ ã€‚</p>\n<p>å…·ä½“è€Œè¨€ï¼Œå‡è®¾æˆ‘ä»¬éœ€è¦æ ¹æ®å‡å€¼å’Œæ–¹å·®ä»æ­£å¤ªåˆ†å¸ƒ\\(N(x,\\phi^2)\\)é‡‡æ ·ï¼Œæˆ‘ä»¬å¯ä»¥è½¬åŒ–ä¸ºå…ˆä»\\(\\epsilon=N(0,1)\\)é‡‡æ ·ï¼Œç„¶åè®¡ç®—\\(z=x+\\epsilon\\cdot \\phi\\)æ¥å¾—åˆ°æˆ‘ä»¬éœ€è¦çš„\\(z\\)ã€‚</p>\n<h3 id=\"gumbel-softmax-trick\">Gumbel-Softmax Trick</h3>\n<p>é€šè¿‡Re-Parameterization Trickæˆ‘ä»¬å¯ä»¥ä¸€å®šæ¡ä»¶ä¸‹è§£å†³é‡‡æ ·ä¸å¯å¯¼çš„é—®é¢˜ã€‚ä½†å›åˆ°æˆ‘ä»¬æœ€åˆçš„é—®é¢˜ï¼Œæˆ‘ä»¬å¹¶ä¸æ˜¯åœ¨è¿ç»­çš„é«˜æ–¯åˆ†å¸ƒä¸Šé‡‡æ ·ï¼Œè€Œæ˜¯åœ¨ä¸€ä¸ªç¦»æ•£åˆ†å¸ƒ\\(P(x)\\)ä¸Šé‡‡æ ·ã€‚ä¸Šé¢çš„é‡å‚æ•°åæ˜¯å¯å¯¼çš„ï¼Œè€Œæ¢æˆç¦»æ•£åˆ†å¸ƒä»¥åï¼Œå°±æ— æ³•æ»¡è¶³äº†ã€‚æ‰€ä»¥ï¼Œå¯¹äºç¦»æ•£åˆ†å¸ƒè¦æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ<br>\nç±»ä¼¼ä¸å‰é¢çš„é‡å‚æ•°æŠ€å·§ï¼Œæˆ‘ä»¬å¯¹äºç¦»æ•£å˜é‡æœ‰Gumbel-Max trickçš„é‡‡æ ·æ–¹æ³•ï¼š<br>\n<img src=\"gumbel1.png\" alt=\"gumbel-max\"><br>\nä»ä¸Šå›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬å°†ç¦»æ•£å˜é‡\\(\\log{\\alpha_1}, \\log{\\alpha_2}, \\log{\\alpha_3}\\)åŠ ä¸ŠGumbelå™ªå£°ï¼Œç„¶åå¯¹ç›¸åŠ åçš„éšæœºå˜é‡å–\\(\\arg \\max\\)åå¾—åˆ°ä¸€ä¸ªonehotå‘é‡ï¼Œå°±æ˜¯æˆ‘ä»¬çš„é‡‡æ ·ç»“æœï¼Œå¯ä»¥è¡¨ç¤ºä¸ºï¼š<br>\n$$x_{\\alpha}=\\arg\\max(\\log(\\alpha_i)+G_i)$$<br>\nä½†\\(\\arg \\max\\)è¿™ä¸ªæ“ä½œæ˜¯æ²¡æ³•æ±‚å¯¼çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ç”¨softmaxæ¥å¯¹\\(\\arg \\max\\)è¿›è¡Œæ¾å¼›ï¼Œè¿™å°±å¾—åˆ°äº†æˆ‘ä»¬çš„Gumbel-Softmax Trick:<br>\n<img src=\"gumbel2.png\" alt=\"gumbel-back\"><br>\nå…¶ä¸­ï¼Œ\\(\\lambda\\)æ˜¯softmaxå‡½æ•°çš„temperatureå‚æ•°ï¼Œç”¨äºæ§åˆ¶é‡‡æ · å½“\\(\\lambda \\to \\infty\\)æ—¶ï¼Œæ‰€æœ‰çš„æ¿€æ´»å€¼å¯¹åº”çš„æ¿€æ´»æ¦‚ç‡è¶‹è¿‘äºç›¸åŒï¼ˆæ¿€æ´»æ¦‚ç‡å·®å¼‚æ€§è¾ƒå°ï¼‰ï¼›è€Œå½“\\(\\lambda \\to 0\\)ï¼Œä¸åŒçš„æ¿€æ´»å€¼å¯¹åº”çš„æ¿€æ´»æ¦‚ç‡å·®å¼‚ä¹Ÿå°±è¶Šå¤§ï¼Œä¹Ÿå°±è¶Šè¶‹å‘äºonehotå‘é‡ã€‚ï¼ˆæ¸©åº¦è¿™ä¸ªè¯ä¸»è¦æ¥è‡ªäºç‰©ç†å­¦ä¸­çš„æ¸©åº¦ï¼Œå½“æ¸©åº¦é«˜çš„æ—¶å€™ï¼Œåˆ†å­çš„è¿åŠ¨å°±è¶Šå‰§çƒˆï¼Œéšæœºæ€§å°±è¶Šå¤§ï¼Œåä¹‹åˆ™è¶Šç¨³å®šï¼Œéšæœºæ€§è¶Šå°ï¼‰<br>\nåˆ°è¿™é‡Œï¼Œæˆ‘ä»¬æ—¢å¯ä»¥å¯¹åˆ†å¸ƒè¿›è¡Œé‡‡æ ·ï¼Œåˆèƒ½å¤Ÿæ»¡è¶³åœ¨ç½‘ç»œä¸­å¯ä»¥åå‘ä¼ æ’­å­¦ä¹ ã€‚<br>\nä½†æˆ‘ä»¬å¯èƒ½è¿˜ä¼šæœ‰è¿™æ ·çš„é—®é¢˜ï¼šä¸ºä»€ä¹ˆä¸ç›´æ¥å°±ç”¨softmaxå‡½æ•°å‘¢ï¼Œè¿™æ ·ä¸æ˜¯ä¹Ÿèƒ½åœ¨ç½‘ç»œä¸­å­¦ä¹ ä¹ˆï¼Ÿæˆ‘ä»¬å†å›é¡¾ä¸‹æˆ‘ä»¬çš„é—®é¢˜å°±èƒ½å‘ç°ï¼Œæˆ‘ä»¬éœ€è¦é‡‡æ ·+èƒ½åä¼ ï¼Œsoftmaxæ»¡è¶³èƒ½åä¼ ä½†æ˜¯å®ƒä¸èƒ½è¾¾åˆ°æˆ‘ä»¬æ ¹æ®æ¦‚ç‡åˆ†å¸ƒé‡‡æ ·çš„ç›®çš„ï¼Œè€ŒGumbel-Max Trickå°±æ˜¯ç”¨æ¥è¿‘ä¼¼åˆ†å¸ƒç„¶åé‡‡æ ·çš„ã€‚<br>\nå¦å¤–ï¼Œæˆ‘ä»¬åœ¨æ­¤ç”¨åˆ°äº†Gumbel Distributionâ€“\\(G\\)ï¼Œæ˜¯ä¸€ä¸ªæå€¼åˆ†å¸ƒï¼Œé€šä¿—æ¥è®²å°±æ˜¯åˆ†å¸ƒçš„æå€¼çš„åˆ†å¸ƒï¼Œå…·ä½“å¯å‚è€ƒï¼š<br>\n<a href=\"https://en.wikipedia.org/wiki/Gumbel_distribution\" target=\"_blank\" rel=\"noopener\">Gumbel distribution</a></p>\n<h3 id=\"å‚è€ƒ\">å‚è€ƒ</h3>\n<p><a href=\"https://www.cnblogs.com/initial-h/p/9468974.html\" target=\"_blank\" rel=\"noopener\">Gumbel-Softmax Trickå’ŒGumbelåˆ†å¸ƒ</a><br>\n<a href=\"https://casmls.github.io/general/2017/02/01/GumbelSoftmax.html\" target=\"_blank\" rel=\"noopener\">The Gumbel-Softmax Trick for Inference of Discrete Variables</a><br>\n<a href=\"https://www.youtube.com/watch?v=9zKuYvjFFS8\" target=\"_blank\" rel=\"noopener\">Variational Autoencoders</a><br>\n<a href=\"https://blog.csdn.net/a358463121/article/details/80820878\" target=\"_blank\" rel=\"noopener\">å¸¦ä½ è®¤è¯†ç¥å¥‡çš„Gumbel trick</a><br>\n<a href=\"https://www.youtube.com/watch?v=wVkLM2KKHp8\" target=\"_blank\" rel=\"noopener\">Talk: Categorical Reparameterization with Gumbel-Softmax &amp; The Concrete Distribution</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p>Gumbel-Softmax trick åœ¨VAEã€GANã€NASç­‰æ·±åº¦å­¦ä¹ é¢†åŸŸç»å¸¸å‡ºç°ï¼Œé‚£å®ƒåˆ°åº•æ˜¯å•¥ï¼Œæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ</p>\n<h3>èƒŒæ™¯é—®é¢˜</h3>\n<p>é¦–å…ˆç®€è¦ä»‹ç»ä¸€ä¸‹é—®é¢˜çš„èƒŒæ™¯ã€‚å‡è®¾æˆ‘ä»¬åœ¨ç½‘ç»œä¸­æœ‰ä¸€ä¸ªæœ‰ \\(n\\) ä¸ªå–å€¼çš„ç¦»æ•£åˆ†å¸ƒ\\(P(x)\\)ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ª\\(n\\)ç»´çš„å‘é‡ï¼Œæ¯ä¸€ä¸ªå…ƒç´ å°±æ˜¯ä¸€ä¸ªæ¦‚ç‡å€¼ã€‚å¦‚æœæˆ‘ä»¬åªæ˜¯è¦å¯¹å…¶è¿›è¡Œé‡‡æ ·æˆ–è€…å¾—åˆ°æœ€ç»ˆæ¦‚ç‡æœ€å¤§çš„ä¸€ä¸ªå–å€¼ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å°±å¯ä»¥ç›´æ¥é‡‡æ ·æˆ–å–\\(arg \\max\\)å¾—åˆ°ç»“æœã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬å¸Œæœ›è¿™ä¸ªè¿‡ç¨‹æ˜¯å¯å¯¼çš„ï¼Œè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p>\n<h3>Re-Parameterization Trick</h3>\n<p>é¦–å…ˆä»‹ç»ä¸€ä¸ªå«é‡å‚æ•°åŒ–(Re-Parameterization)çš„ä¸œè¥¿ï¼ŒRe-Parameterizationè§£å†³äº†ä¸Šé¢æåˆ°çš„é‡‡æ ·ä¸å¯å¯¼çš„é—®é¢˜ã€‚è¿™é‡Œç”¨æ²¹ç®¡ä¸Šä¸€ä¸ª<a href=\"https://www.youtube.com/watch?v=9zKuYvjFFS8\" target=\"_blank\" rel=\"noopener\">å˜åˆ†è‡ªåŠ¨ç¼–ç å™¨æ•™ç¨‹</a>ä¸­çš„å›¾ç‰‡æ¥è§£é‡Šã€‚<br>\n<img src=\"re-paramerise.png\" alt=\"re-paramerise\"><br>\né¦–å…ˆå·¦è¾¹æ˜¯é‡å‚æ•°åŒ–ä¹‹å‰çš„å½¢å¼ï¼Œæˆ‘ä»¬å¸Œæœ›é€šè¿‡å­¦ä¹ åˆ°äº†æ ‡å‡†å·®\\(\\phi\\)å’Œå‡å€¼\\(x\\)ï¼Œé€šè¿‡å¯¹åˆ†å¸ƒ\\(q\\)è¿›è¡Œé‡‡æ ·å¾—åˆ°\\(z\\)ï¼Œç„¶åä¼ å…¥ä¸‹ä¸€å±‚ç½‘ç»œã€‚ç„¶è€Œè¿™å°±æœ‰ä¸ªé—®é¢˜ï¼Œé‡‡æ ·è¿‡ç¨‹æ˜¯æ²¡æ³•åä¼ çš„ï¼Œè¿™æ ·åŠ è½½ç½‘ç»œä¸­å°±æ²¡æ³•å­¦ä¹ äº†ï¼Œå› æ­¤å°±æœ‰äº†å³è¾¹çš„å½¢å¼ã€‚</p>\n<p>åœ¨è¿™é‡Œå‘¢ï¼Œå…¶å®å°±æ˜¯åœ¨ç½‘ç»œä¸­åªä¿ç•™å¯ä»¥æ±‚å¯¼çš„éƒ¨åˆ†ï¼ŒæŠŠä¸å¯å¯¼çš„é‡‡æ ·éƒ¨åˆ†æ”¾åˆ°ç½‘ç»œå¤–ç”¨ä¸€ä¸ªæ–°çš„è¾“å…¥èŠ‚ç‚¹\\(\\epsilon\\)è¡¨ç¤ºã€‚\\(\\epsilon\\)é‡‡æ ·çš„è¿‡ç¨‹å’Œç½‘ç»œå­¦ä¹ æ˜¯åˆ†ç¦»çš„ï¼Œå› æ­¤ä¸å½±å“ç½‘ç»œåä¼ ã€‚</p>\n<p>å…·ä½“è€Œè¨€ï¼Œå‡è®¾æˆ‘ä»¬éœ€è¦æ ¹æ®å‡å€¼å’Œæ–¹å·®ä»æ­£å¤ªåˆ†å¸ƒ\\(N(x,\\phi^2)\\)é‡‡æ ·ï¼Œæˆ‘ä»¬å¯ä»¥è½¬åŒ–ä¸ºå…ˆä»\\(\\epsilon=N(0,1)\\)é‡‡æ ·ï¼Œç„¶åè®¡ç®—\\(z=x+\\epsilon\\cdot \\phi\\)æ¥å¾—åˆ°æˆ‘ä»¬éœ€è¦çš„\\(z\\)ã€‚</p>\n<h3>Gumbel-Softmax Trick</h3>\n<p>é€šè¿‡Re-Parameterization Trickæˆ‘ä»¬å¯ä»¥ä¸€å®šæ¡ä»¶ä¸‹è§£å†³é‡‡æ ·ä¸å¯å¯¼çš„é—®é¢˜ã€‚ä½†å›åˆ°æˆ‘ä»¬æœ€åˆçš„é—®é¢˜ï¼Œæˆ‘ä»¬å¹¶ä¸æ˜¯åœ¨è¿ç»­çš„é«˜æ–¯åˆ†å¸ƒä¸Šé‡‡æ ·ï¼Œè€Œæ˜¯åœ¨ä¸€ä¸ªç¦»æ•£åˆ†å¸ƒ\\(P(x)\\)ä¸Šé‡‡æ ·ã€‚ä¸Šé¢çš„é‡å‚æ•°åæ˜¯å¯å¯¼çš„ï¼Œè€Œæ¢æˆç¦»æ•£åˆ†å¸ƒä»¥åï¼Œå°±æ— æ³•æ»¡è¶³äº†ã€‚æ‰€ä»¥ï¼Œå¯¹äºç¦»æ•£åˆ†å¸ƒè¦æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ<br>\nç±»ä¼¼ä¸å‰é¢çš„é‡å‚æ•°æŠ€å·§ï¼Œæˆ‘ä»¬å¯¹äºç¦»æ•£å˜é‡æœ‰Gumbel-Max trickçš„é‡‡æ ·æ–¹æ³•ï¼š<br>\n<img src=\"gumbel1.png\" alt=\"gumbel-max\"><br>\nä»ä¸Šå›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬å°†ç¦»æ•£å˜é‡\\(\\log{\\alpha_1}, \\log{\\alpha_2}, \\log{\\alpha_3}\\)åŠ ä¸ŠGumbelå™ªå£°ï¼Œç„¶åå¯¹ç›¸åŠ åçš„éšæœºå˜é‡å–\\(\\arg \\max\\)åå¾—åˆ°ä¸€ä¸ªonehotå‘é‡ï¼Œå°±æ˜¯æˆ‘ä»¬çš„é‡‡æ ·ç»“æœï¼Œå¯ä»¥è¡¨ç¤ºä¸ºï¼š<br>\n$$x_{\\alpha}=\\arg\\max(\\log(\\alpha_i)+G_i)$$<br>\nä½†\\(\\arg \\max\\)è¿™ä¸ªæ“ä½œæ˜¯æ²¡æ³•æ±‚å¯¼çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ç”¨softmaxæ¥å¯¹\\(\\arg \\max\\)è¿›è¡Œæ¾å¼›ï¼Œè¿™å°±å¾—åˆ°äº†æˆ‘ä»¬çš„Gumbel-Softmax Trick:<br>\n<img src=\"gumbel2.png\" alt=\"gumbel-back\"><br>\nå…¶ä¸­ï¼Œ\\(\\lambda\\)æ˜¯softmaxå‡½æ•°çš„temperatureå‚æ•°ï¼Œç”¨äºæ§åˆ¶é‡‡æ · å½“\\(\\lambda \\to \\infty\\)æ—¶ï¼Œæ‰€æœ‰çš„æ¿€æ´»å€¼å¯¹åº”çš„æ¿€æ´»æ¦‚ç‡è¶‹è¿‘äºç›¸åŒï¼ˆæ¿€æ´»æ¦‚ç‡å·®å¼‚æ€§è¾ƒå°ï¼‰ï¼›è€Œå½“\\(\\lambda \\to 0\\)ï¼Œä¸åŒçš„æ¿€æ´»å€¼å¯¹åº”çš„æ¿€æ´»æ¦‚ç‡å·®å¼‚ä¹Ÿå°±è¶Šå¤§ï¼Œä¹Ÿå°±è¶Šè¶‹å‘äºonehotå‘é‡ã€‚ï¼ˆæ¸©åº¦è¿™ä¸ªè¯ä¸»è¦æ¥è‡ªäºç‰©ç†å­¦ä¸­çš„æ¸©åº¦ï¼Œå½“æ¸©åº¦é«˜çš„æ—¶å€™ï¼Œåˆ†å­çš„è¿åŠ¨å°±è¶Šå‰§çƒˆï¼Œéšæœºæ€§å°±è¶Šå¤§ï¼Œåä¹‹åˆ™è¶Šç¨³å®šï¼Œéšæœºæ€§è¶Šå°ï¼‰<br>\nåˆ°è¿™é‡Œï¼Œæˆ‘ä»¬æ—¢å¯ä»¥å¯¹åˆ†å¸ƒè¿›è¡Œé‡‡æ ·ï¼Œåˆèƒ½å¤Ÿæ»¡è¶³åœ¨ç½‘ç»œä¸­å¯ä»¥åå‘ä¼ æ’­å­¦ä¹ ã€‚<br>\nä½†æˆ‘ä»¬å¯èƒ½è¿˜ä¼šæœ‰è¿™æ ·çš„é—®é¢˜ï¼šä¸ºä»€ä¹ˆä¸ç›´æ¥å°±ç”¨softmaxå‡½æ•°å‘¢ï¼Œè¿™æ ·ä¸æ˜¯ä¹Ÿèƒ½åœ¨ç½‘ç»œä¸­å­¦ä¹ ä¹ˆï¼Ÿæˆ‘ä»¬å†å›é¡¾ä¸‹æˆ‘ä»¬çš„é—®é¢˜å°±èƒ½å‘ç°ï¼Œæˆ‘ä»¬éœ€è¦é‡‡æ ·+èƒ½åä¼ ï¼Œsoftmaxæ»¡è¶³èƒ½åä¼ ä½†æ˜¯å®ƒä¸èƒ½è¾¾åˆ°æˆ‘ä»¬æ ¹æ®æ¦‚ç‡åˆ†å¸ƒé‡‡æ ·çš„ç›®çš„ï¼Œè€ŒGumbel-Max Trickå°±æ˜¯ç”¨æ¥è¿‘ä¼¼åˆ†å¸ƒç„¶åé‡‡æ ·çš„ã€‚<br>\nå¦å¤–ï¼Œæˆ‘ä»¬åœ¨æ­¤ç”¨åˆ°äº†Gumbel Distributionâ€“\\(G\\)ï¼Œæ˜¯ä¸€ä¸ªæå€¼åˆ†å¸ƒï¼Œé€šä¿—æ¥è®²å°±æ˜¯åˆ†å¸ƒçš„æå€¼çš„åˆ†å¸ƒï¼Œå…·ä½“å¯å‚è€ƒï¼š<br>\n<a href=\"https://en.wikipedia.org/wiki/Gumbel_distribution\" target=\"_blank\" rel=\"noopener\">Gumbel distribution</a></p>\n<h3>å‚è€ƒ</h3>\n<p><a href=\"https://www.cnblogs.com/initial-h/p/9468974.html\" target=\"_blank\" rel=\"noopener\">Gumbel-Softmax Trickå’ŒGumbelåˆ†å¸ƒ</a><br>\n<a href=\"https://casmls.github.io/general/2017/02/01/GumbelSoftmax.html\" target=\"_blank\" rel=\"noopener\">The Gumbel-Softmax Trick for Inference of Discrete Variables</a><br>\n<a href=\"https://www.youtube.com/watch?v=9zKuYvjFFS8\" target=\"_blank\" rel=\"noopener\">Variational Autoencoders</a><br>\n<a href=\"https://blog.csdn.net/a358463121/article/details/80820878\" target=\"_blank\" rel=\"noopener\">å¸¦ä½ è®¤è¯†ç¥å¥‡çš„Gumbel trick</a><br>\n<a href=\"https://www.youtube.com/watch?v=wVkLM2KKHp8\" target=\"_blank\" rel=\"noopener\">Talk: Categorical Reparameterization with Gumbel-Softmax &amp; The Concrete Distribution</a></p>\n"},{"title":"Paper Reading 2020-02-23","catalog":true,"date":"2020-02-23T12:48:34.000Z","subtitle":null,"header-img":null,"mathjax":true,"_content":"\nä¸¤ç¯‡è®ºæ–‡çš„è®°å½•\n### Scaling Up Neural Architecture Search with Big Single-Stage Models\nUniversal slimmable networkçš„kernel+depth+resolutionæ‰©å±•ç‰ˆï¼Œæ–¹æ³•ä¸Šæ²¡å•¥åˆ›æ–°ï¼Œæ‰€ä»¥è¢«æ‹’äº†  \næ–¹æ³•ä¸Šå°±æ˜¯Universal slimmable networké‚£ä¸€å¥—ï¼Œç„¶ååŠ ä¸Šäº†å­¦ä¹ ç‡å’Œåˆå§‹åŒ–çš„trickï¼Œä¹‹åè¦trainè¿™ç§åŒ…å«å¤šä¸ªå­ç½‘ç»œçš„ç½‘ç»œå¯ä»¥å€Ÿé‰´ä¸€ä¸‹é‡Œé¢çš„è¿™äº›trickå§\n\nPaper:[Scaling Up Neural Architecture Search with Big Single-Stage Models](https://openreview.net/forum?id=HJe7unNFDH)  \nCodes:æœªå¼€æº\n\n### Once for All: Train One Network and Specialize it for Efficient Deployment \nå’Œä¸Šä¸€ç¯‡æƒ³æ³•å·®ä¸å¤šï¼Œåªæ˜¯åšçš„æ¯”è¾ƒç»†ï¼Œæ–¹æ³•ä¸Šçœ‹èµ·æ¥æœ‰ç‚¹ä¸œè¥¿ä¸æ˜¯é‚£ä¹ˆç³™ã€‚\n\n![progressive shrinking](progressive_shrinking.png)\nè®­ç»ƒçš„æ—¶å€™æå‡ºäº†ä¸€ä¸ªprogressive shrinkingçš„æ–¹æ³•ï¼Œå…ˆè®­å¥½æœ€å¤§çš„ç½‘ç»œï¼Œç„¶åä¸€æ­¥ä¸€æ­¥ä»kernelï¼Œdepthå’Œwidthè¿›è¡Œelasticè®­ç»ƒï¼Œä¸­é—´kernelä½¿ç”¨äº†ä¸€ä¸ªtransformation matrixï¼Œwidthç”¨äº†channel sortting.\n\nç»“æœæ–¹é¢ï¼Œæœ€ç»ˆæ•ˆæœå¾ˆå¥½å°±å¯¹äº†ï¼Œfinetuneä»¥åæ•ˆæœè¿˜èƒ½ç»§ç»­æé«˜\n![results](ofa-results1.png)\n\nPaper:[Once for All: Train One Network and Specialize it for Efficient Deployment ](https://openreview.net/forum?id=HylxE1HKwS)  \nCodes:[github](https://github.com/mit-han-lab/once-for-all)  \næ€»çš„æ¥çœ‹ï¼Œå…¶å®ä¹Ÿæ²¡æœ‰å¾ˆåˆ›æ–°çš„æ–¹æ³•ï¼Œåªæ˜¯çœ‹èµ·æ¥æ¯”ä¸Šä¸€ç¯‡ç»†è‡´ä¸€äº›ç„¶åå®éªŒä¸Šä¹Ÿå……åˆ†ï¼Œä½†å®ç°ä¸Šæ„Ÿè§‰è¿˜æ˜¯å¾ˆtrickyä¸çŸ¥é“æœ‰å¤šå°‘æ°´åˆ†ã€‚ä»£ç ä¸Šæ„Ÿè§‰æ²¡æœ‰æŠŠå®Œæ•´è¿‡ç¨‹å¼€æºå‡ºæ¥ï¼Œéœ€è¦å¤šæœºå¤šå¡çš„è¯å¤ç°ä¹Ÿæ˜¯ä¸ªå¤§éº»çƒ¦ï¼Œissueä¹Ÿä¸å›ï¼Œåªèƒ½å†è§‚æœ›ä¸€ä¸‹çœ‹çœ‹æ€ä¹ˆå¾€detectionèµ°ã€‚\n\n","source":"_posts/PaperReadingNotes2020-0223.md","raw":"---\ntitle: Paper Reading 2020-02-23\ncatalog: true\ndate: 2020-02-23 20:48:34\nsubtitle:\nheader-img:\nmathjax: true\ntags: ML\n---\n\nä¸¤ç¯‡è®ºæ–‡çš„è®°å½•\n### Scaling Up Neural Architecture Search with Big Single-Stage Models\nUniversal slimmable networkçš„kernel+depth+resolutionæ‰©å±•ç‰ˆï¼Œæ–¹æ³•ä¸Šæ²¡å•¥åˆ›æ–°ï¼Œæ‰€ä»¥è¢«æ‹’äº†  \næ–¹æ³•ä¸Šå°±æ˜¯Universal slimmable networké‚£ä¸€å¥—ï¼Œç„¶ååŠ ä¸Šäº†å­¦ä¹ ç‡å’Œåˆå§‹åŒ–çš„trickï¼Œä¹‹åè¦trainè¿™ç§åŒ…å«å¤šä¸ªå­ç½‘ç»œçš„ç½‘ç»œå¯ä»¥å€Ÿé‰´ä¸€ä¸‹é‡Œé¢çš„è¿™äº›trickå§\n\nPaper:[Scaling Up Neural Architecture Search with Big Single-Stage Models](https://openreview.net/forum?id=HJe7unNFDH)  \nCodes:æœªå¼€æº\n\n### Once for All: Train One Network and Specialize it for Efficient Deployment \nå’Œä¸Šä¸€ç¯‡æƒ³æ³•å·®ä¸å¤šï¼Œåªæ˜¯åšçš„æ¯”è¾ƒç»†ï¼Œæ–¹æ³•ä¸Šçœ‹èµ·æ¥æœ‰ç‚¹ä¸œè¥¿ä¸æ˜¯é‚£ä¹ˆç³™ã€‚\n\n![progressive shrinking](progressive_shrinking.png)\nè®­ç»ƒçš„æ—¶å€™æå‡ºäº†ä¸€ä¸ªprogressive shrinkingçš„æ–¹æ³•ï¼Œå…ˆè®­å¥½æœ€å¤§çš„ç½‘ç»œï¼Œç„¶åä¸€æ­¥ä¸€æ­¥ä»kernelï¼Œdepthå’Œwidthè¿›è¡Œelasticè®­ç»ƒï¼Œä¸­é—´kernelä½¿ç”¨äº†ä¸€ä¸ªtransformation matrixï¼Œwidthç”¨äº†channel sortting.\n\nç»“æœæ–¹é¢ï¼Œæœ€ç»ˆæ•ˆæœå¾ˆå¥½å°±å¯¹äº†ï¼Œfinetuneä»¥åæ•ˆæœè¿˜èƒ½ç»§ç»­æé«˜\n![results](ofa-results1.png)\n\nPaper:[Once for All: Train One Network and Specialize it for Efficient Deployment ](https://openreview.net/forum?id=HylxE1HKwS)  \nCodes:[github](https://github.com/mit-han-lab/once-for-all)  \næ€»çš„æ¥çœ‹ï¼Œå…¶å®ä¹Ÿæ²¡æœ‰å¾ˆåˆ›æ–°çš„æ–¹æ³•ï¼Œåªæ˜¯çœ‹èµ·æ¥æ¯”ä¸Šä¸€ç¯‡ç»†è‡´ä¸€äº›ç„¶åå®éªŒä¸Šä¹Ÿå……åˆ†ï¼Œä½†å®ç°ä¸Šæ„Ÿè§‰è¿˜æ˜¯å¾ˆtrickyä¸çŸ¥é“æœ‰å¤šå°‘æ°´åˆ†ã€‚ä»£ç ä¸Šæ„Ÿè§‰æ²¡æœ‰æŠŠå®Œæ•´è¿‡ç¨‹å¼€æºå‡ºæ¥ï¼Œéœ€è¦å¤šæœºå¤šå¡çš„è¯å¤ç°ä¹Ÿæ˜¯ä¸ªå¤§éº»çƒ¦ï¼Œissueä¹Ÿä¸å›ï¼Œåªèƒ½å†è§‚æœ›ä¸€ä¸‹çœ‹çœ‹æ€ä¹ˆå¾€detectionèµ°ã€‚\n\n","slug":"PaperReadingNotes2020-0223","published":1,"updated":"2020-02-24T06:51:35.233Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck74q35u40000hwuedjcwjukr","content":"<p>ä¸¤ç¯‡è®ºæ–‡çš„è®°å½•</p>\n<h3 id=\"scaling-up-neural-architecture-search-with-big-single-stage-models\"><a href=\"#Scaling-Up-Neural-Architecture-Search-with-Big-Single-Stage-Models\" class=\"headerlink\" title=\"Scaling Up Neural Architecture Search with Big Single-Stage Models\"></a>Scaling Up Neural Architecture Search with Big Single-Stage Models</h3><p>Universal slimmable networkçš„kernel+depth+resolutionæ‰©å±•ç‰ˆï¼Œæ–¹æ³•ä¸Šæ²¡å•¥åˆ›æ–°ï¼Œæ‰€ä»¥è¢«æ‹’äº†<br>æ–¹æ³•ä¸Šå°±æ˜¯Universal slimmable networké‚£ä¸€å¥—ï¼Œç„¶ååŠ ä¸Šäº†å­¦ä¹ ç‡å’Œåˆå§‹åŒ–çš„trickï¼Œä¹‹åè¦trainè¿™ç§åŒ…å«å¤šä¸ªå­ç½‘ç»œçš„ç½‘ç»œå¯ä»¥å€Ÿé‰´ä¸€ä¸‹é‡Œé¢çš„è¿™äº›trickå§</p>\n<p>Paper:<a href=\"https://openreview.net/forum?id=HJe7unNFDH\" target=\"_blank\" rel=\"noopener\">Scaling Up Neural Architecture Search with Big Single-Stage Models</a><br>Codes:æœªå¼€æº</p>\n<h3 id=\"once-for-all-train-one-network-and-specialize-it-for-efficient-deployment\"><a href=\"#Once-for-All-Train-One-Network-and-Specialize-it-for-Efficient-Deployment\" class=\"headerlink\" title=\"Once for All: Train One Network and Specialize it for Efficient Deployment\"></a>Once for All: Train One Network and Specialize it for Efficient Deployment</h3><p>å’Œä¸Šä¸€ç¯‡æƒ³æ³•å·®ä¸å¤šï¼Œåªæ˜¯åšçš„æ¯”è¾ƒç»†ï¼Œæ–¹æ³•ä¸Šçœ‹èµ·æ¥æœ‰ç‚¹ä¸œè¥¿ä¸æ˜¯é‚£ä¹ˆç³™ã€‚</p>\n<p><img src=\"progressive_shrinking.png\" alt=\"progressive shrinking\"><br>è®­ç»ƒçš„æ—¶å€™æå‡ºäº†ä¸€ä¸ªprogressive shrinkingçš„æ–¹æ³•ï¼Œå…ˆè®­å¥½æœ€å¤§çš„ç½‘ç»œï¼Œç„¶åä¸€æ­¥ä¸€æ­¥ä»kernelï¼Œdepthå’Œwidthè¿›è¡Œelasticè®­ç»ƒï¼Œä¸­é—´kernelä½¿ç”¨äº†ä¸€ä¸ªtransformation matrixï¼Œwidthç”¨äº†channel sortting.</p>\n<p>ç»“æœæ–¹é¢ï¼Œæœ€ç»ˆæ•ˆæœå¾ˆå¥½å°±å¯¹äº†ï¼Œfinetuneä»¥åæ•ˆæœè¿˜èƒ½ç»§ç»­æé«˜<br><img src=\"ofa-results1.png\" alt=\"results\"></p>\n<p>Paper:<a href=\"https://openreview.net/forum?id=HylxE1HKwS\" target=\"_blank\" rel=\"noopener\">Once for All: Train One Network and Specialize it for Efficient Deployment </a><br>Codes:<a href=\"https://github.com/mit-han-lab/once-for-all\" target=\"_blank\" rel=\"noopener\">github</a><br>æ€»çš„æ¥çœ‹ï¼Œå…¶å®ä¹Ÿæ²¡æœ‰å¾ˆåˆ›æ–°çš„æ–¹æ³•ï¼Œåªæ˜¯çœ‹èµ·æ¥æ¯”ä¸Šä¸€ç¯‡ç»†è‡´ä¸€äº›ç„¶åå®éªŒä¸Šä¹Ÿå……åˆ†ï¼Œä½†å®ç°ä¸Šæ„Ÿè§‰è¿˜æ˜¯å¾ˆtrickyä¸çŸ¥é“æœ‰å¤šå°‘æ°´åˆ†ã€‚ä»£ç ä¸Šæ„Ÿè§‰æ²¡æœ‰æŠŠå®Œæ•´è¿‡ç¨‹å¼€æºå‡ºæ¥ï¼Œéœ€è¦å¤šæœºå¤šå¡çš„è¯å¤ç°ä¹Ÿæ˜¯ä¸ªå¤§éº»çƒ¦ï¼Œissueä¹Ÿä¸å›ï¼Œåªèƒ½å†è§‚æœ›ä¸€ä¸‹çœ‹çœ‹æ€ä¹ˆå¾€detectionèµ°ã€‚</p>\n","site":{"data":{}},"excerpt":"","more":"<p>ä¸¤ç¯‡è®ºæ–‡çš„è®°å½•</p>\n<h3 id=\"Scaling-Up-Neural-Architecture-Search-with-Big-Single-Stage-Models\"><a href=\"#Scaling-Up-Neural-Architecture-Search-with-Big-Single-Stage-Models\" class=\"headerlink\" title=\"Scaling Up Neural Architecture Search with Big Single-Stage Models\"></a>Scaling Up Neural Architecture Search with Big Single-Stage Models</h3><p>Universal slimmable networkçš„kernel+depth+resolutionæ‰©å±•ç‰ˆï¼Œæ–¹æ³•ä¸Šæ²¡å•¥åˆ›æ–°ï¼Œæ‰€ä»¥è¢«æ‹’äº†<br>æ–¹æ³•ä¸Šå°±æ˜¯Universal slimmable networké‚£ä¸€å¥—ï¼Œç„¶ååŠ ä¸Šäº†å­¦ä¹ ç‡å’Œåˆå§‹åŒ–çš„trickï¼Œä¹‹åè¦trainè¿™ç§åŒ…å«å¤šä¸ªå­ç½‘ç»œçš„ç½‘ç»œå¯ä»¥å€Ÿé‰´ä¸€ä¸‹é‡Œé¢çš„è¿™äº›trickå§</p>\n<p>Paper:<a href=\"https://openreview.net/forum?id=HJe7unNFDH\" target=\"_blank\" rel=\"noopener\">Scaling Up Neural Architecture Search with Big Single-Stage Models</a><br>Codes:æœªå¼€æº</p>\n<h3 id=\"Once-for-All-Train-One-Network-and-Specialize-it-for-Efficient-Deployment\"><a href=\"#Once-for-All-Train-One-Network-and-Specialize-it-for-Efficient-Deployment\" class=\"headerlink\" title=\"Once for All: Train One Network and Specialize it for Efficient Deployment\"></a>Once for All: Train One Network and Specialize it for Efficient Deployment</h3><p>å’Œä¸Šä¸€ç¯‡æƒ³æ³•å·®ä¸å¤šï¼Œåªæ˜¯åšçš„æ¯”è¾ƒç»†ï¼Œæ–¹æ³•ä¸Šçœ‹èµ·æ¥æœ‰ç‚¹ä¸œè¥¿ä¸æ˜¯é‚£ä¹ˆç³™ã€‚</p>\n<p><img src=\"progressive_shrinking.png\" alt=\"progressive shrinking\"><br>è®­ç»ƒçš„æ—¶å€™æå‡ºäº†ä¸€ä¸ªprogressive shrinkingçš„æ–¹æ³•ï¼Œå…ˆè®­å¥½æœ€å¤§çš„ç½‘ç»œï¼Œç„¶åä¸€æ­¥ä¸€æ­¥ä»kernelï¼Œdepthå’Œwidthè¿›è¡Œelasticè®­ç»ƒï¼Œä¸­é—´kernelä½¿ç”¨äº†ä¸€ä¸ªtransformation matrixï¼Œwidthç”¨äº†channel sortting.</p>\n<p>ç»“æœæ–¹é¢ï¼Œæœ€ç»ˆæ•ˆæœå¾ˆå¥½å°±å¯¹äº†ï¼Œfinetuneä»¥åæ•ˆæœè¿˜èƒ½ç»§ç»­æé«˜<br><img src=\"ofa-results1.png\" alt=\"results\"></p>\n<p>Paper:<a href=\"https://openreview.net/forum?id=HylxE1HKwS\" target=\"_blank\" rel=\"noopener\">Once for All: Train One Network and Specialize it for Efficient Deployment </a><br>Codes:<a href=\"https://github.com/mit-han-lab/once-for-all\" target=\"_blank\" rel=\"noopener\">github</a><br>æ€»çš„æ¥çœ‹ï¼Œå…¶å®ä¹Ÿæ²¡æœ‰å¾ˆåˆ›æ–°çš„æ–¹æ³•ï¼Œåªæ˜¯çœ‹èµ·æ¥æ¯”ä¸Šä¸€ç¯‡ç»†è‡´ä¸€äº›ç„¶åå®éªŒä¸Šä¹Ÿå……åˆ†ï¼Œä½†å®ç°ä¸Šæ„Ÿè§‰è¿˜æ˜¯å¾ˆtrickyä¸çŸ¥é“æœ‰å¤šå°‘æ°´åˆ†ã€‚ä»£ç ä¸Šæ„Ÿè§‰æ²¡æœ‰æŠŠå®Œæ•´è¿‡ç¨‹å¼€æºå‡ºæ¥ï¼Œéœ€è¦å¤šæœºå¤šå¡çš„è¯å¤ç°ä¹Ÿæ˜¯ä¸ªå¤§éº»çƒ¦ï¼Œissueä¹Ÿä¸å›ï¼Œåªèƒ½å†è§‚æœ›ä¸€ä¸‹çœ‹çœ‹æ€ä¹ˆå¾€detectionèµ°ã€‚</p>\n"}],"PostAsset":[{"_id":"source/_posts/What-is-Gumbel-Softmax-Trick/gumbel1.png","slug":"gumbel1.png","post":"ck6vknhg3000oosuehdqs7xdr","modified":0,"renderable":0},{"_id":"source/_posts/FrontEnd-Daily-Learning/FE_20190806.png","slug":"FE_20190806.png","post":"ck6vknhe80001osuewtvta71u","modified":0,"renderable":0},{"_id":"source/_posts/FrontEnd-Daily-Learning/FE_20190808.png","slug":"FE_20190808.png","post":"ck6vknhe80001osuewtvta71u","modified":0,"renderable":0},{"_id":"source/_posts/FrontEnd-Daily-Learning/FE_20190809.png","slug":"FE_20190809.png","post":"ck6vknhe80001osuewtvta71u","modified":0,"renderable":0},{"_id":"source/_posts/What-is-Gumbel-Softmax-Trick/gumbel2.png","slug":"gumbel2.png","post":"ck6vknhg3000oosuehdqs7xdr","modified":0,"renderable":0},{"_id":"source/_posts/What-is-Gumbel-Softmax-Trick/re-paramerise.png","slug":"re-paramerise.png","post":"ck6vknhg3000oosuehdqs7xdr","modified":0,"renderable":0},{"_id":"source/_posts/PaperReadingNotes2020-0223/ofa-results1.png","post":"ck74q35u40000hwuedjcwjukr","slug":"ofa-results1.png","modified":1,"renderable":1},{"_id":"source/_posts/PaperReadingNotes2020-0223/progressive_shrinking.png","post":"ck74q35u40000hwuedjcwjukr","slug":"progressive_shrinking.png","modified":1,"renderable":1}],"PostCategory":[],"PostTag":[{"post_id":"ck6vknhf20008osueik478gy2","tag_id":"ck6vknheq0005osuenywqcdl6","_id":"ck6vknhfd000bosuezfrxupau"},{"post_id":"ck6vknhe80001osuewtvta71u","tag_id":"ck6vknheq0005osuenywqcdl6","_id":"ck6vknhfm000dosuebyt6l9q8"},{"post_id":"ck6vknhf60009osue8panwanm","tag_id":"ck6vknheq0005osuenywqcdl6","_id":"ck6vknhfs000gosuegym81hs7"},{"post_id":"ck6vknhfe000cosuen4malt96","tag_id":"ck6vknheq0005osuenywqcdl6","_id":"ck6vknhfv000iosue8fihqk99"},{"post_id":"ck6vknhek0003osuewhpciwkn","tag_id":"ck6vknheq0005osuenywqcdl6","_id":"ck6vknhg0000losuem367j815"},{"post_id":"ck6vknheu0006osue2be75k6s","tag_id":"ck6vknheq0005osuenywqcdl6","_id":"ck6vknhg3000nosuekbyszrl5"},{"post_id":"ck6vknhfs000hosue6dxnpqel","tag_id":"ck6vknheq0005osuenywqcdl6","_id":"ck6vknhg5000qosued6ml67sg"},{"post_id":"ck6vknhfs000hosue6dxnpqel","tag_id":"ck6vknhfz000kosuevtt85sjx","_id":"ck6vknhg6000rosue0vktzdo4"},{"post_id":"ck6vknhfw000josuew5wds524","tag_id":"ck6vknhg5000posueypcgcoe1","_id":"ck6vknhg6000tosuecfplk22d"},{"post_id":"ck6vknhg0000mosuemt2vnnzz","tag_id":"ck6vknhg6000sosuepso3o7ad","_id":"ck6vknhg8000vosuegsryjh39"},{"post_id":"ck6vknhg3000oosuehdqs7xdr","tag_id":"ck6vknhg5000posueypcgcoe1","_id":"ck6vknhg9000wosued5b0ejj4"},{"post_id":"ck74q35u40000hwuedjcwjukr","tag_id":"ck6vknhg5000posueypcgcoe1","_id":"ck74q35ub0001hwuezlrzjy4b"},{"post_id":"ck6vknhfn000eosuekguik41s","tag_id":"ck6vknheq0005osuenywqcdl6","_id":"ck74q35ue0002hwue7539wroc"}],"Tag":[{"name":"FE","_id":"ck6vknheq0005osuenywqcdl6"},{"name":"YDKJS","_id":"ck6vknhfz000kosuevtt85sjx"},{"name":"ML","_id":"ck6vknhg5000posueypcgcoe1"},{"name":"Daily","_id":"ck6vknhg6000sosuepso3o7ad"}]}}